(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9394],{31614:function(e,t,r){Promise.resolve().then(r.bind(r,93990))},93990:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return F}});var n=r(82363),a=r(38954),l=r(13494),s=r(40922),c=r(11033),i=r(86746),o=r(4897),d=r(89738),u=r(16818),g=r(17490),m=r(68254),b=r(26882),x=r(76066),h=r(43333),v=r(20595),p=r(79613),y=r(25596),f=r(67888),w=r(7601),N=r(11374),j=r(15189),S=r(63283),k=r(45482),P=r(12851),C=r(61345),Z=r(56086),B=r(90935),R=r(60195);function E(e){let{message:t,type:r,onClose:l}=e;return(0,a.useEffect)(()=>{let e=setTimeout(l,3e3);return()=>clearTimeout(e)},[l]),(0,n.jsxs)("div",{className:"fixed bottom-4 right-4 px-4 py-3 rounded-lg shadow-lg flex items-center gap-2 z-50 ".concat("success"===r?"bg-green-500/90 text-white":"bg-red-500/90 text-white"),children:["success"===r?(0,n.jsx)(s.Z,{className:"w-4 h-4"}):(0,n.jsx)(c.Z,{className:"w-4 h-4"}),(0,n.jsx)("span",{className:"text-sm font-medium",children:t})]})}let O=[{id:"brain",name:"Brain",icon:i.Z,color:"purple",description:"Master orchestrator",link:"/brain"},{id:"money",name:"Treasury",icon:o.Z,color:"green",description:"Funds & allocations",link:"/treasury"},{id:"growth",name:"Growth",icon:d.Z,color:"blue",description:"Content & marketing",link:"/growth"},{id:"product",name:"Product",icon:u.Z,color:"orange",description:"Discovery & building",link:"/product"},{id:"autonomy",name:"Autonomy",icon:g.Z,color:"yellow",description:"Approvals & audit",link:"/brain"},{id:"hunter",name:"Hunter",icon:m.Z,color:"red",description:"Opportunity discovery",link:"/hunter"}],I={green:{bg:"bg-green-500/10",border:"border-green-500/30",text:"text-green-400",dot:"bg-green-400"},blue:{bg:"bg-blue-500/10",border:"border-blue-500/30",text:"text-blue-400",dot:"bg-blue-400"},purple:{bg:"bg-purple-500/10",border:"border-purple-500/30",text:"text-purple-400",dot:"bg-purple-400"},orange:{bg:"bg-orange-500/10",border:"border-orange-500/30",text:"text-orange-400",dot:"bg-orange-400"},yellow:{bg:"bg-yellow-500/10",border:"border-yellow-500/30",text:"text-yellow-400",dot:"bg-yellow-400"},red:{bg:"bg-red-500/10",border:"border-red-500/30",text:"text-red-400",dot:"bg-red-400"},gray:{bg:"bg-gray-500/10",border:"border-gray-500/30",text:"text-gray-400",dot:"bg-gray-400"}};function A(e){let{status:t}=e,r={healthy:{icon:s.Z,label:"Healthy",color:"green"},degraded:{icon:b.Z,label:"Degraded",color:"yellow"},offline:{icon:c.Z,label:"Offline",color:"red"},unknown:{icon:b.Z,label:"Unknown",color:"gray"}}[t];r.icon;let a=I[r.color];return(0,n.jsxs)("div",{className:"flex items-center gap-1.5 px-2 py-1 rounded-full ".concat(a.bg," ").concat(a.border," border"),children:[(0,n.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(a.dot," ").concat("healthy"===t?"animate-pulse":"")}),(0,n.jsx)("span",{className:"text-xs font-medium ".concat(a.text),children:r.label})]})}function K(e){var t;let{engine:r,health:s,metrics:c,brainRunning:i,onAction:o}=e,[d,u]=(0,a.useState)(!1),[g,m]=(0,a.useState)(null),b=r.icon,j=I[r.color],S=null!==(t=null==s?void 0:s.status)&&void 0!==t?t:"unknown",k=function(e,t){var r,n,a,l,s,c,i,o,d,u,g,m,b,x,h,v,p,y,f;switch(e){case"brain":if(!t.brain)return[{label:"Status",value:"—"},{label:"Actions",value:"—"}];return[{label:"Phase",value:null!==(n=t.brain.currentPhase)&&void 0!==n?n:"Idle"},{label:"Today",value:"".concat(null!==(a=null===(r=t.brain.metrics)||void 0===r?void 0:r.todayActions)&&void 0!==a?a:0," actions")}];case"money":if(!t.treasury)return[{label:"Value",value:"—"},{label:"Runway",value:"—"}];return[{label:"Value",value:(f=t.treasury.totalValueUsd)>=1e6?"$".concat((f/1e6).toFixed(1),"M"):f>=1e3?"$".concat((f/1e3).toFixed(1),"K"):"$".concat(f.toFixed(0))},{label:"Runway",value:"".concat(null!==(l=t.treasury.runway)&&void 0!==l?l:0," mo")}];case"growth":if(!t.growth)return[{label:"Posts",value:"—"},{label:"Queue",value:"—"}];return[{label:"Posts",value:"".concat(null!==(o=null===(c=t.growth.metrics)||void 0===c?void 0:null===(s=c.content)||void 0===s?void 0:s.postsPublished)&&void 0!==o?o:0)},{label:"Queue",value:"".concat(null!==(d=null===(i=t.growth.upcomingContent)||void 0===i?void 0:i.tweets)&&void 0!==d?d:0," tweets")}];case"product":if(!t.product)return[{label:"Backlog",value:"—"},{label:"Built",value:"—"}];return[{label:"Backlog",value:"".concat(null!==(m=null===(u=t.product.backlog)||void 0===u?void 0:u.total)&&void 0!==m?m:0)},{label:"Built",value:"".concat(null!==(b=null===(g=t.product.metrics)||void 0===g?void 0:g.built)&&void 0!==b?b:0)}];case"autonomy":if(!t.autonomy)return[{label:"Level",value:"—"},{label:"Pending",value:"—"}];return[{label:"Level",value:"L".concat(t.autonomy.level)},{label:"Pending",value:"".concat(null!==(h=null===(x=t.autonomy.queue)||void 0===x?void 0:x.pending)&&void 0!==h?h:0)}];case"hunter":if(!t.hunter)return[{label:"Signals",value:"—"},{label:"Sources",value:"—"}];return[{label:"Signals",value:"".concat(null!==(p=t.hunter.actionableSignals)&&void 0!==p?p:0)},{label:"Sources",value:"".concat(null!==(y=null===(v=t.hunter.enabledSources)||void 0===v?void 0:v.length)&&void 0!==y?y:0)}];default:return[{label:"Status",value:"—"},{label:"Data",value:"—"}]}}(r.id,c),P=function(e,t,r){switch(e){case"brain":return t?[{id:"stop",label:"Stop Brain",icon:x.Z,action:async()=>{let e=await B.PK.stopBrain();r("Brain stopped",!!(null==e?void 0:e.ok))}}]:[{id:"start",label:"Start Brain",icon:h.Z,action:async()=>{let e=await B.PK.startBrain();r("Brain started",!!(null==e?void 0:e.ok))}}];case"growth":return[{id:"tweet",label:"Generate Tweet",icon:v.Z,action:async()=>{let e=await B.PK.generateContent("tweet");r("Tweet generated",!!(null==e?void 0:e.ok))}},{id:"blog",label:"Generate Blog",icon:p.Z,action:async()=>{let e=await B.PK.generateContent("blog");r("Blog generated",!!(null==e?void 0:e.ok))}}];case"product":return[{id:"discovery",label:"Run Discovery",icon:y.Z,action:async()=>{let e=await B.PK.runDiscovery();r("Discovery started",!!(null==e?void 0:e.ok))}}];default:return[]}}(r.id,i,o),C=async e=>{m(e.id);try{await e.action()}catch(t){o("".concat(e.label," failed"),!1)}finally{m(null),u(!1)}};return(0,n.jsxs)("div",{className:"bg-gicm-card border border-gicm-border rounded-xl p-5 hover:border-gicm-primary/50 transition-all relative",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"p-2.5 rounded-lg ".concat(j.bg," border ").concat(j.border),children:(0,n.jsx)(b,{className:"w-5 h-5 ".concat(j.text)})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-semibold text-white",children:r.name}),(0,n.jsx)("p",{className:"text-xs text-gray-500",children:r.description})]})]}),(0,n.jsx)(A,{status:S})]}),(0,n.jsx)("div",{className:"grid grid-cols-2 gap-2 mb-4",children:k.map((e,t)=>(0,n.jsxs)("div",{className:"p-2 rounded-lg ".concat(j.bg," border ").concat(j.border),children:[(0,n.jsx)("div",{className:"text-xs text-gray-500",children:e.label}),(0,n.jsx)("div",{className:"text-sm font-semibold ".concat(j.text),children:e.value})]},t))}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(l.default,{href:r.link,className:"flex-1 px-3 py-2 rounded-lg text-center text-sm font-medium bg-white/5 border border-gicm-border text-gray-300 hover:bg-white/10 hover:text-white transition-all",children:"View"}),P.length>0&&(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("button",{onClick:()=>u(!d),className:"px-3 py-2 rounded-lg text-sm font-medium bg-gicm-primary/10 border border-gicm-primary/30 text-gicm-primary hover:bg-gicm-primary/20 transition-all flex items-center gap-1",children:[(0,n.jsx)(f.Z,{className:"w-4 h-4"}),(0,n.jsx)(w.Z,{className:"w-3 h-3 transition-transform ".concat(d?"rotate-180":"")})]}),d&&(0,n.jsx)("div",{className:"absolute top-full right-0 mt-1 w-48 bg-gicm-card border border-gicm-border rounded-lg shadow-xl z-10 overflow-hidden",children:P.map(e=>{let t=e.icon,r=g===e.id;return(0,n.jsxs)("button",{onClick:()=>C(e),disabled:r,className:"w-full px-4 py-2.5 text-left text-sm text-gray-300 hover:bg-white/5 hover:text-white transition-colors flex items-center gap-2 disabled:opacity-50",children:[r?(0,n.jsx)(N.Z,{className:"w-4 h-4 animate-spin"}):(0,n.jsx)(t,{className:"w-4 h-4"}),e.label]},e.id)})})]})]})]})}function T(e){let{status:t,isRealtime:r}=e,a={connected:{icon:j.Z,label:"Real-time",color:"text-green-400",dot:"bg-green-400 animate-pulse"},connecting:{icon:j.Z,label:"Connecting...",color:"text-yellow-400",dot:"bg-yellow-400 animate-pulse"},disconnected:{icon:S.Z,label:"Polling",color:"text-gray-400",dot:"bg-gray-400"},error:{icon:S.Z,label:"Polling",color:"text-gray-400",dot:"bg-gray-400"}}[t],l=a.icon;return(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(a.dot)}),(0,n.jsx)(l,{className:"w-4 h-4 ".concat(a.color)}),(0,n.jsx)("span",{className:"text-sm ".concat(a.color),children:a.label})]})}function D(e){let{events:t}=e,r=e=>{switch(e){case"trade":case"treasury":return(0,n.jsx)(k.Z,{className:"w-4 h-4 text-green-400"});case"content":return(0,n.jsx)(p.Z,{className:"w-4 h-4 text-blue-400"});case"build":case"discovery":return(0,n.jsx)(u.Z,{className:"w-4 h-4 text-orange-400"});case"engine":return(0,n.jsx)(f.Z,{className:"w-4 h-4 text-purple-400"});case"brain":return(0,n.jsx)(i.Z,{className:"w-4 h-4 text-purple-400"});case"hunter":case"signal":return(0,n.jsx)(m.Z,{className:"w-4 h-4 text-red-400"});default:return(0,n.jsx)(P.Z,{className:"w-4 h-4 text-gray-400"})}},a=e=>{switch(e){case"trade":case"treasury":return"green";case"content":return"blue";case"build":case"discovery":return"orange";case"engine":case"brain":return"purple";case"hunter":case"signal":return"red";default:return"gray"}},l=e=>new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),s=e=>{let t=e.payload;return t.message?String(t.message):t.action?"Action: ".concat(t.action):t.status?"Status: ".concat(t.status):t.name?String(t.name):e.type};return 0===t.length?(0,n.jsxs)("div",{className:"bg-gicm-card border border-gicm-border rounded-xl p-6",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,n.jsx)("div",{className:"p-2 rounded-lg bg-gicm-primary/10",children:(0,n.jsx)(P.Z,{className:"w-5 h-5 text-gicm-primary"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-semibold",children:"Activity Feed"}),(0,n.jsx)("p",{className:"text-sm text-gray-400",children:"Real-time event stream"})]})]}),(0,n.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,n.jsx)(P.Z,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,n.jsx)("p",{children:"No events yet"}),(0,n.jsx)("p",{className:"text-xs mt-1",children:"Events will appear here as engines operate"})]})]}):(0,n.jsxs)("div",{className:"bg-gicm-card border border-gicm-border rounded-xl p-6",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,n.jsx)("div",{className:"p-2 rounded-lg bg-gicm-primary/10",children:(0,n.jsx)(P.Z,{className:"w-5 h-5 text-gicm-primary"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-semibold",children:"Activity Feed"}),(0,n.jsx)("p",{className:"text-sm text-gray-400",children:"Real-time event stream"})]}),(0,n.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,n.jsx)("span",{className:"w-2 h-2 rounded-full bg-green-400 animate-pulse"}),(0,n.jsx)("span",{className:"text-sm text-gray-400",children:"Live"})]})]}),(0,n.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:t.map(e=>{let t=I[a(e.category)];return(0,n.jsxs)("div",{className:"flex items-start gap-3 p-3 rounded-lg ".concat(t.bg," border ").concat(t.border),children:[(0,n.jsx)("div",{className:"mt-0.5",children:r(e.category)}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"text-xs font-medium ".concat(t.text," uppercase"),children:e.source}),(0,n.jsx)("span",{className:"text-xs text-gray-500",children:e.type})]}),(0,n.jsx)("p",{className:"text-sm text-gray-300 truncate mt-0.5",children:s(e)})]}),(0,n.jsx)("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:l(e.timestamp)})]},e.id)})})]})}function W(e){var t,r;let{status:a}=e,l=null!==(r=null==a?void 0:null===(t=a.engines)||void 0===t?void 0:t.details)&&void 0!==r?r:[],s=l.filter(e=>"healthy"===e.status).length,c=l.filter(e=>"degraded"===e.status).length,i=l.filter(e=>"offline"===e.status).length,o=l.length||5,d=i>0?"degraded":c>0?"degraded":s===o?"healthy":"unknown";return(0,n.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,n.jsxs)("div",{className:"p-4 rounded-lg bg-green-500/10 border border-green-500/30",children:[(0,n.jsx)("div",{className:"text-sm text-green-400 mb-1",children:"Healthy"}),(0,n.jsx)("div",{className:"text-2xl font-bold text-white",children:s})]}),(0,n.jsxs)("div",{className:"p-4 rounded-lg bg-yellow-500/10 border border-yellow-500/30",children:[(0,n.jsx)("div",{className:"text-sm text-yellow-400 mb-1",children:"Degraded"}),(0,n.jsx)("div",{className:"text-2xl font-bold text-white",children:c})]}),(0,n.jsxs)("div",{className:"p-4 rounded-lg bg-red-500/10 border border-red-500/30",children:[(0,n.jsx)("div",{className:"text-sm text-red-400 mb-1",children:"Offline"}),(0,n.jsx)("div",{className:"text-2xl font-bold text-white",children:i})]}),(0,n.jsxs)("div",{className:"p-4 rounded-lg ".concat("healthy"===d?"bg-green-500/10 border-green-500/30":"degraded"===d?"bg-yellow-500/10 border-yellow-500/30":"bg-gray-500/10 border-gray-500/30"," border"),children:[(0,n.jsx)("div",{className:"text-sm ".concat("healthy"===d?"text-green-400":"degraded"===d?"text-yellow-400":"text-gray-400"," mb-1"),children:"System"}),(0,n.jsx)("div",{className:"text-2xl font-bold text-white capitalize",children:d})]})]})}function F(){var e,t,r,l,s,c;let[i,o]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!0),[g,m]=(0,a.useState)(null),[b,x]=(0,a.useState)([]),[h,v]=(0,a.useState)({}),[p,y]=(0,a.useState)(null),[f,w]=(0,a.useState)(null),N=a.useRef(null),j=(0,R.s)({autoReconnect:!0,reconnectDelay:3e3,maxReconnectAttempts:10,heartbeat:!0,onEvent:e=>{}}),S=a.useMemo(()=>{let e=[...j.events,...b],t=new Set;return e.filter(e=>!t.has(e.id)&&(t.add(e.id),!0)).sort((e,t)=>t.timestamp-e.timestamp).slice(0,50)},[j.events,b]),k=(e,t)=>{w({message:e,type:t?"success":"error"}),t&&setTimeout(P,500)},P=(0,a.useCallback)(async()=>{try{var e;let[t,r,n,a,l,s,c,i]=await Promise.all([B.PK.getStatus(),B.PK.getEvents(20),B.PK.getTreasury(),B.PK.getGrowth(),B.PK.getProduct(),B.PK.getAutonomy(),B.PK.getBrain(),B.PK.getHunter()]);m(t),x(null!==(e=null==r?void 0:r.events)&&void 0!==e?e:[]),v({treasury:n,growth:a,product:l,autonomy:s,brain:null==c?void 0:c.status,hunter:i}),y(new Date)}catch(e){console.error("Failed to fetch data:",e)}finally{u(!1)}},[]);if((0,a.useEffect)(()=>(o(!0),P(),()=>{N.current&&clearInterval(N.current)}),[P]),(0,a.useEffect)(()=>(j.isConnected?(N.current&&clearInterval(N.current),N.current=setInterval(P,3e4)):N.current||(N.current=setInterval(P,1e4)),()=>{N.current&&(clearInterval(N.current),N.current=null)}),[j.isConnected,P]),!i)return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("div",{className:"h-12 bg-gicm-card rounded-lg animate-pulse"}),(0,n.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[...Array(6)].map((e,t)=>(0,n.jsx)("div",{className:"h-48 bg-gicm-card rounded-xl animate-pulse"},t))})]});let I=null!==(r=null==g?void 0:null===(t=g.engines)||void 0===t?void 0:null===(e=t.details)||void 0===e?void 0:e.reduce((e,t)=>({...e,[t.id]:t}),{}))&&void 0!==r?r:{};return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-3",children:[(0,n.jsx)("div",{className:"p-2 rounded-lg bg-gicm-primary/10",children:(0,n.jsx)(C.Z,{className:"w-6 h-6 text-gicm-primary"})}),"Command Center"]}),(0,n.jsx)("p",{className:"text-gray-400 mt-1 ml-12",children:"Unified control for all gICM engines"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(T,{status:j.status,isRealtime:j.isConnected}),(null==g?void 0:g.running)&&(0,n.jsxs)("div",{className:"flex items-center gap-2 ml-2",children:[(0,n.jsx)("span",{className:"w-2 h-2 rounded-full bg-green-400 animate-pulse"}),(0,n.jsx)("span",{className:"text-sm text-gray-400",children:"Hub"})]}),(0,n.jsx)("button",{onClick:()=>{u(!0),P()},className:"p-2 rounded-lg bg-white/5 hover:bg-white/10 transition-colors",disabled:d,title:"Refresh data",children:(0,n.jsx)(Z.Z,{className:"w-5 h-5 text-gray-400 ".concat(d?"animate-spin":"")})})]})]}),(0,n.jsx)(W,{status:g}),(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:O.map(e=>{var t,r;return(0,n.jsx)(K,{engine:e,health:I[e.id],metrics:h,brainRunning:null!==(r=null===(t=h.brain)||void 0===t?void 0:t.isRunning)&&void 0!==r&&r,onAction:k},e.id)})}),(0,n.jsx)(D,{events:S}),(0,n.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 pt-4 border-t border-gicm-border",children:[(0,n.jsxs)("span",{children:["Hub: ",(null==g?void 0:g.running)?"Running":"Stopped"," on port ",null!==(l=null==g?void 0:g.apiPort)&&void 0!==l?l:3001]}),(0,n.jsxs)("span",{children:["Last updated: ",null!==(s=null==p?void 0:p.toLocaleTimeString())&&void 0!==s?s:"Never"]}),(0,n.jsxs)("span",{children:[null!==(c=null==g?void 0:g.workflows)&&void 0!==c?c:0," workflows registered"]})]}),f&&(0,n.jsx)(E,{message:f.message,type:f.type,onClose:()=>w(null)})]})}},60195:function(e,t,r){"use strict";r.d(t,{s:function(){return s}});var n=r(38954);let a=r(32608).env.NEXT_PUBLIC_WS_URL||"ws://localhost:3001/ws",l={autoReconnect:!0,reconnectDelay:3e3,maxReconnectAttempts:10,heartbeat:!0,heartbeatInterval:3e4,rooms:[],onEvent:()=>{},onMessage:()=>{},onStatusChange:()=>{}};function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={...l,...e},[r,s]=(0,n.useState)("disconnected"),[c,i]=(0,n.useState)([]),[o,d]=(0,n.useState)(null),[u,g]=(0,n.useState)(null),m=(0,n.useRef)(null),b=(0,n.useRef)(0),x=(0,n.useRef)(null),h=(0,n.useRef)(null),v=(0,n.useRef)(!0),p=(0,n.useCallback)(e=>{v.current&&(s(e),t.onStatusChange(e))},[t]),y=(0,n.useCallback)(()=>{h.current&&(clearInterval(h.current),h.current=null)},[]),f=(0,n.useCallback)(()=>{var e;y(),t.heartbeat&&(null===(e=m.current)||void 0===e?void 0:e.readyState)===WebSocket.OPEN&&(h.current=setInterval(()=>{var e;(null===(e=m.current)||void 0===e?void 0:e.readyState)===WebSocket.OPEN&&m.current.send(JSON.stringify({type:"ping"}))},t.heartbeatInterval))},[t.heartbeat,t.heartbeatInterval,y]),w=(0,n.useCallback)(()=>{x.current&&(clearTimeout(x.current),x.current=null),y(),m.current&&(m.current.close(),m.current=null),b.current=0,p("disconnected")},[y,p]),N=(0,n.useCallback)(()=>{var e,r;if((null===(e=m.current)||void 0===e?void 0:e.readyState)!==WebSocket.CONNECTING&&(null===(r=m.current)||void 0===r?void 0:r.readyState)!==WebSocket.OPEN){m.current&&m.current.close(),p("connecting"),g(null);try{let e=new WebSocket(a);m.current=e,e.onopen=()=>{v.current&&(b.current=0,p("connected"),f(),e.send(JSON.stringify({type:"subscribe",channels:["events","status","metrics"]})),t.rooms.length>0&&e.send(JSON.stringify({action:"subscribe",rooms:t.rooms})))},e.onmessage=e=>{if(v.current)try{let r=JSON.parse(e.data);if(d(r),t.onMessage(r),"event"===r.type&&r.payload){let e=r.payload;i(t=>[e,...t].slice(0,100)),t.onEvent(e)}}catch(e){console.warn("Failed to parse WebSocket message:",e)}},e.onerror=e=>{v.current&&(console.error("WebSocket error:",e),g("Connection error"),p("error"))},e.onclose=e=>{if(v.current){if(y(),1e3===e.code){p("disconnected");return}if(p("disconnected"),t.autoReconnect&&(0===t.maxReconnectAttempts||b.current<t.maxReconnectAttempts)){b.current++;let e=t.reconnectDelay*Math.min(b.current,5);x.current=setTimeout(()=>{v.current&&N()},e)}}}}catch(e){console.error("Failed to create WebSocket:",e),g(e instanceof Error?e.message:"Failed to connect"),p("error")}}},[t,p,f,y]),j=(0,n.useCallback)(e=>{var t;return(null===(t=m.current)||void 0===t?void 0:t.readyState)===WebSocket.OPEN&&(m.current.send(JSON.stringify(e)),!0)},[]),S=(0,n.useCallback)(()=>{i([])},[]),k=(0,n.useCallback)(e=>{var t;return(null===(t=m.current)||void 0===t?void 0:t.readyState)===WebSocket.OPEN&&e.length>0&&(m.current.send(JSON.stringify({action:"subscribe",rooms:e})),!0)},[]),P=(0,n.useCallback)(e=>{var t;return(null===(t=m.current)||void 0===t?void 0:t.readyState)===WebSocket.OPEN&&e.length>0&&(m.current.send(JSON.stringify({action:"unsubscribe",rooms:e})),!0)},[]);return(0,n.useEffect)(()=>(v.current=!0,N(),()=>{v.current=!1,w()}),[N,w]),{status:r,events:c,lastMessage:o,error:u,isConnected:"connected"===r,reconnectAttempts:b.current,connect:N,disconnect:w,send:j,clearEvents:S,subscribe:k,unsubscribe:P}}},90935:function(e,t,r){"use strict";r.d(t,{Lf:function(){return a},PK:function(){return c},yu:function(){return n}});let n="http://localhost:3100",a=n.replace(/^http/,"ws")+"/ws";async function l(e){try{let t=await fetch("".concat(n,"/api").concat(e),{signal:AbortSignal.timeout(5e3),cache:"no-store"});if(!t.ok)return null;return t.json()}catch(e){return null}}async function s(e,t){try{let r=await fetch("".concat(n,"/api").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:t?JSON.stringify(t):void 0,signal:AbortSignal.timeout(1e4)});if(!r.ok)return null;return r.json()}catch(e){return null}}let c={getStatus:()=>l("/status"),getBrain:()=>l("/brain/status"),getBrainStatus:()=>l("/brain/status"),getBrainStats:()=>l("/brain/stats"),getBrainRecent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return l("/brain/recent?limit=".concat(e))},getBrainPatterns:()=>l("/brain/patterns"),getBrainPredictions:()=>l("/brain/predictions"),searchBrain:e=>s("/brain/search",{query:e}),triggerIngest:e=>s("/brain/ingest",{source:e}),getBrainKnowledgeById:e=>l("/brain/knowledge/".concat(e)),getBrainKnowledgeByTopic:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return l("/brain/knowledge/topic/".concat(e,"?limit=").concat(t))},getBrainKnowledgeSimilar:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return l("/brain/knowledge/".concat(e,"/similar?limit=").concat(t))},getBrainPatternById:e=>l("/brain/patterns/".concat(e)),getBrainPredictionById:e=>l("/brain/predictions/".concat(e)),generateBrainPredictions:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return s("/brain/predictions/generate",{type:e,count:t})},getBrainIngestStats:()=>l("/brain/ingest/stats"),getTreasury:()=>l("/treasury"),getMoney:()=>l("/money/status"),getGrowth:()=>l("/growth/status"),getProduct:()=>l("/product/status"),getHunter:()=>l("/hunter/status"),getAutonomy:()=>l("/autonomy/status"),getPredictions:()=>l("/predictions/status"),getEvents:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1?arguments[1]:void 0;return l("/events?limit=".concat(e).concat(t?"&category=".concat(t):""))},getEnrichedEvents:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;return l("/events/enriched?limit=".concat(e).concat(t?"&category=".concat(t):"").concat(r?"&severity=".concat(r):""))},getEventCategories:()=>l("/events/categories"),startBrain:()=>s("/brain/start"),stopBrain:()=>s("/brain/stop"),triggerPhase:e=>s("/brain/phase",{phase:e}),runDiscovery:()=>s("/discovery/run"),generateContent:e=>s("/content/generate",{type:e})}}},function(e){e.O(0,[3277,9104,6829,8854,1744],function(){return e(e.s=31614)}),_N_E=e.O()}]);