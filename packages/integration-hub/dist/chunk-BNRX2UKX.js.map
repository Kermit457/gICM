{"version":3,"sources":["../src/event-bus.ts","../src/engine-manager.ts","../src/storage/content-storage.ts","../src/workflows/content.ts","../src/distribution/index.ts","../src/auth/types.ts","../src/auth/permissions.ts","../src/auth/rbac-manager.ts","../src/audit/types.ts","../src/audit/audit-logger.ts","../src/git/types.ts","../src/git/yaml-parser.ts","../src/git/git-manager.ts","../src/chat/types.ts","../src/chat/chat-manager.ts","../src/terraform/types.ts","../src/terraform/terraform-manager.ts","../src/vscode/types.ts","../src/vscode/vscode-manager.ts","../src/ha/types.ts","../src/ha/health-checker.ts","../src/ha/load-balancer.ts","../src/ha/failover-manager.ts","../src/ha/ha-manager.ts","../src/dr/types.ts","../src/dr/backup-manager.ts","../src/dr/restore-manager.ts","../src/observability/types.ts","../src/observability/tracer.ts","../src/observability/metrics.ts","../src/observability/logger.ts","../src/observability/observability-manager.ts","../src/api/server.ts","../src/api/content-routes.ts","../src/api/org-routes.ts","../src/api/audit-routes.ts","../src/api/git-routes.ts","../src/api/bot-routes.ts","../src/api/terraform-routes.ts","../src/api/vscode-routes.ts","../src/api/ha-routes.ts","../src/api/dr-routes.ts","../src/api/observability-routes.ts","../src/api/routes.ts","../src/api/auth-plugin.ts","../src/workflows/index.ts","../src/scheduler/content-scheduler.ts","../src/hub.ts"],"sourcesContent":["/**\n * Event Bus - Cross-engine pub/sub system\n *\n * Central message bus for all gICM events.\n */\n\nimport EventEmitter from \"eventemitter3\";\n\n// ============================================================================\n// EVENT TYPES\n// ============================================================================\n\nexport type EventCategory =\n  | \"engine\"\n  | \"brain\"\n  | \"discovery\"\n  | \"build\"\n  | \"content\"\n  | \"trade\"\n  | \"treasury\"\n  | \"pipeline\"\n  | \"opus67\"\n  | \"error\";\n\nexport interface HubEvent {\n  id: string;\n  timestamp: number;\n  source: string;\n  category: EventCategory;\n  type: string;\n  payload: Record<string, unknown>;\n}\n\nexport interface EventBusEvents {\n  // Engine lifecycle\n  \"engine.started\": (event: HubEvent) => void;\n  \"engine.stopped\": (event: HubEvent) => void;\n  \"engine.error\": (event: HubEvent) => void;\n  \"engine.heartbeat\": (event: HubEvent) => void;\n\n  // Brain events\n  \"brain.phase_started\": (event: HubEvent) => void;\n  \"brain.phase_completed\": (event: HubEvent) => void;\n  \"brain.decision_made\": (event: HubEvent) => void;\n  \"brain.goal_achieved\": (event: HubEvent) => void;\n\n  // Discovery events\n  \"discovery.found\": (event: HubEvent) => void;\n  \"discovery.approved\": (event: HubEvent) => void;\n  \"discovery.rejected\": (event: HubEvent) => void;\n\n  // Build events\n  \"build.started\": (event: HubEvent) => void;\n  \"build.completed\": (event: HubEvent) => void;\n  \"build.failed\": (event: HubEvent) => void;\n\n  // Content events\n  \"content.published\": (event: HubEvent) => void;\n  \"content.scheduled\": (event: HubEvent) => void;\n\n  // Trade events\n  \"trade.executed\": (event: HubEvent) => void;\n  \"trade.profit\": (event: HubEvent) => void;\n  \"trade.loss\": (event: HubEvent) => void;\n\n  // Treasury events\n  \"treasury.low\": (event: HubEvent) => void;\n  \"treasury.critical\": (event: HubEvent) => void;\n  \"treasury.healthy\": (event: HubEvent) => void;\n\n  // Pipeline events (PTC)\n  \"pipeline.started\": (event: HubEvent) => void;\n  \"pipeline.step_started\": (event: HubEvent) => void;\n  \"pipeline.step_completed\": (event: HubEvent) => void;\n  \"pipeline.step_failed\": (event: HubEvent) => void;\n  \"pipeline.step_skipped\": (event: HubEvent) => void;\n  \"pipeline.completed\": (event: HubEvent) => void;\n  \"pipeline.failed\": (event: HubEvent) => void;\n  \"pipeline.paused\": (event: HubEvent) => void;\n  \"pipeline.resumed\": (event: HubEvent) => void;\n  \"pipeline.cancelled\": (event: HubEvent) => void;\n\n  // OPUS67 events\n  \"opus67.mode_changed\": (event: HubEvent) => void;\n  \"opus67.skills_loaded\": (event: HubEvent) => void;\n  \"opus67.query_processed\": (event: HubEvent) => void;\n  \"opus67.agent_spawned\": (event: HubEvent) => void;\n  \"opus67.boot\": (event: HubEvent) => void;\n\n  // Generic catch-all\n  \"*\": (event: HubEvent) => void;\n}\n\n// ============================================================================\n// EVENT BUS\n// ============================================================================\n\nexport class EventBus extends EventEmitter<EventBusEvents> {\n  private eventLog: HubEvent[] = [];\n  private maxLogSize = 1000;\n\n  /**\n   * Emit a typed event\n   */\n  emit<K extends keyof EventBusEvents>(\n    event: K,\n    ...args: Parameters<EventBusEvents[K]>\n  ): boolean {\n    const hubEvent = args[0] as HubEvent;\n\n    // Log event\n    this.eventLog.push(hubEvent);\n    if (this.eventLog.length > this.maxLogSize) {\n      this.eventLog.shift();\n    }\n\n    // Emit to specific listeners\n    const result = super.emit(event, ...args);\n\n    // Also emit to wildcard listeners\n    super.emit(\"*\", hubEvent);\n\n    return result;\n  }\n\n  /**\n   * Create and emit an event\n   */\n  publish(\n    source: string,\n    type: keyof EventBusEvents,\n    payload: Record<string, unknown> = {}\n  ): void {\n    const category = type.split(\".\")[0] as EventCategory;\n\n    const event: HubEvent = {\n      id: generateEventId(),\n      timestamp: Date.now(),\n      source,\n      category,\n      type,\n      payload,\n    };\n\n    this.emit(type, event);\n  }\n\n  /**\n   * Subscribe to an event (alias for on, but with source filtering support if needed)\n   * Currently ignores source for compatibility with simple event names\n   */\n  subscribe(\n    source: string,\n    type: keyof EventBusEvents,\n    handler: (event: HubEvent) => void\n  ): void {\n    this.on(type, (event) => {\n      // Optional: Filter by source if needed\n      // if (event.source === source) { ... }\n      handler(event);\n    });\n  }\n\n  /**\n   * Get recent events\n   */\n  getRecentEvents(limit = 50): HubEvent[] {\n    return this.eventLog.slice(-limit);\n  }\n\n  /**\n   * Get events by category\n   */\n  getEventsByCategory(category: EventCategory, limit = 50): HubEvent[] {\n    return this.eventLog\n      .filter((e) => e.category === category)\n      .slice(-limit);\n  }\n\n  /**\n   * Clear event log\n   */\n  clearLog(): void {\n    this.eventLog = [];\n  }\n}\n\nfunction generateEventId(): string {\n  return Date.now().toString() + \"-\" + Math.random().toString(36).slice(2, 9);\n}\n\n// Singleton instance\nexport const eventBus = new EventBus();\n","/**\n * Engine Manager - Central engine connection management\n *\n * Manages lifecycle and health of all gICM engines.\n */\n\nimport { EventBus } from \"./event-bus.js\";\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\nexport type EngineId = \"brain\" | \"money\" | \"growth\" | \"product\" | \"trading\" | \"opus67\";\n\nexport interface EngineHealth {\n  id: EngineId;\n  connected: boolean;\n  lastHeartbeat: number | null;\n  status: \"healthy\" | \"degraded\" | \"offline\";\n  error?: string;\n}\n\nexport interface EngineManagerConfig {\n  healthCheckInterval?: number; // ms, default 30000\n  heartbeatTimeout?: number; // ms, default 60000\n}\n\n// ============================================================================\n// ENGINE MANAGER\n// ============================================================================\n\nexport class EngineManager {\n  private eventBus: EventBus;\n  private engines: Map<EngineId, EngineHealth> = new Map();\n  private healthCheckTimer?: NodeJS.Timeout;\n  private config: Required<EngineManagerConfig>;\n\n  constructor(eventBus: EventBus, config?: EngineManagerConfig) {\n    this.eventBus = eventBus;\n    this.config = {\n      healthCheckInterval: config?.healthCheckInterval ?? 30000,\n      heartbeatTimeout: config?.heartbeatTimeout ?? 60000,\n    };\n\n    // Initialize engine states\n    const engineIds: EngineId[] = [\"brain\", \"money\", \"growth\", \"product\", \"trading\", \"opus67\"];\n    for (const id of engineIds) {\n      this.engines.set(id, {\n        id,\n        connected: false,\n        lastHeartbeat: null,\n        status: \"offline\",\n      });\n    }\n\n    // Listen for heartbeats\n    this.eventBus.on(\"engine.heartbeat\", (event) => {\n      const engineId = event.source as EngineId;\n      this.recordHeartbeat(engineId);\n    });\n\n    // Listen for engine start/stop\n    this.eventBus.on(\"engine.started\", (event) => {\n      const engineId = event.source as EngineId;\n      this.markConnected(engineId);\n    });\n\n    this.eventBus.on(\"engine.stopped\", (event) => {\n      const engineId = event.source as EngineId;\n      this.markDisconnected(engineId);\n    });\n  }\n\n  /**\n   * Start health monitoring\n   */\n  startHealthChecks(): void {\n    this.healthCheckTimer = setInterval(() => {\n      this.checkAllEngines();\n    }, this.config.healthCheckInterval);\n  }\n\n  /**\n   * Stop health monitoring\n   */\n  stopHealthChecks(): void {\n    if (this.healthCheckTimer) {\n      clearInterval(this.healthCheckTimer);\n      this.healthCheckTimer = undefined;\n    }\n  }\n\n  /**\n   * Record a heartbeat from an engine\n   */\n  recordHeartbeat(engineId: EngineId): void {\n    const engine = this.engines.get(engineId);\n    if (engine) {\n      engine.lastHeartbeat = Date.now();\n      engine.connected = true;\n      engine.status = \"healthy\";\n      engine.error = undefined;\n    }\n  }\n\n  /**\n   * Mark an engine as connected\n   */\n  markConnected(engineId: EngineId): void {\n    const engine = this.engines.get(engineId);\n    if (engine) {\n      engine.connected = true;\n      engine.lastHeartbeat = Date.now();\n      engine.status = \"healthy\";\n      engine.error = undefined;\n    }\n  }\n\n  /**\n   * Mark an engine as disconnected\n   */\n  markDisconnected(engineId: EngineId): void {\n    const engine = this.engines.get(engineId);\n    if (engine) {\n      engine.connected = false;\n      engine.status = \"offline\";\n    }\n  }\n\n  /**\n   * Mark an engine as having an error\n   */\n  markError(engineId: EngineId, error: string): void {\n    const engine = this.engines.get(engineId);\n    if (engine) {\n      engine.status = \"degraded\";\n      engine.error = error;\n    }\n\n    this.eventBus.publish(engineId, \"engine.error\", { error });\n  }\n\n  /**\n   * Check all engines for health\n   */\n  private checkAllEngines(): void {\n    const now = Date.now();\n\n    for (const [id, engine] of this.engines) {\n      if (engine.connected && engine.lastHeartbeat) {\n        const timeSinceHeartbeat = now - engine.lastHeartbeat;\n\n        if (timeSinceHeartbeat > this.config.heartbeatTimeout) {\n          engine.status = \"degraded\";\n          engine.error = \"Heartbeat timeout\";\n        }\n      }\n    }\n  }\n\n  /**\n   * Get health status for all engines\n   */\n  getAllHealth(): EngineHealth[] {\n    return Array.from(this.engines.values());\n  }\n\n  /**\n   * Get health status for a specific engine\n   */\n  getHealth(engineId: EngineId): EngineHealth | undefined {\n    return this.engines.get(engineId);\n  }\n\n  /**\n   * Get aggregated status\n   */\n  getAggregatedStatus(): {\n    healthy: number;\n    degraded: number;\n    offline: number;\n    total: number;\n  } {\n    let healthy = 0;\n    let degraded = 0;\n    let offline = 0;\n\n    for (const engine of this.engines.values()) {\n      switch (engine.status) {\n        case \"healthy\":\n          healthy++;\n          break;\n        case \"degraded\":\n          degraded++;\n          break;\n        case \"offline\":\n          offline++;\n          break;\n      }\n    }\n\n    return { healthy, degraded, offline, total: this.engines.size };\n  }\n}\n","import { EventEmitter } from \"eventemitter3\";\nimport type {\n  EngineEvent,\n  WinRecord,\n  ContentBrief,\n  ContentArticle,\n  DistributionPacket,\n} from \"../types/content.js\";\n\n// Mock SupabaseClient for demonstration purposes.\n// In a real application, you would import: `import { createClient, SupabaseClient } from '@supabase/supabase-js';`\nconst MOCK_SUPABASE_DB = new Map<string, Map<string, any>>();\n\nconst createClient = (url: string, serviceKey: string) => {\n    console.log(`[ContentStorage] Mock Supabase Client created for URL: ${url}`);\n\n    // Helper to create chainable query builder\n    const createQueryBuilder = (tableName: string, currentData: any[] | null = null) => {\n        const getTableData = () => {\n            if (currentData !== null) return currentData;\n            if (!MOCK_SUPABASE_DB.has(tableName)) return [];\n            return Array.from(MOCK_SUPABASE_DB.get(tableName)!.values());\n        };\n\n        return {\n            insert: async (data: any) => {\n                console.log(`[ContentStorage] Mock Supabase: Inserting into ${tableName}`, data);\n                if (!MOCK_SUPABASE_DB.has(tableName)) MOCK_SUPABASE_DB.set(tableName, new Map());\n                const table = MOCK_SUPABASE_DB.get(tableName)!;\n                const id = data.id || `mock_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`;\n                table.set(id, { ...data, id });\n                return { data: [{ id }], error: null };\n            },\n            upsert: async (data: any, { onConflict }: { onConflict: string }) => {\n                console.log(`[ContentStorage] Mock Supabase: Upserting into ${tableName} on conflict ${onConflict}`, data);\n                if (!MOCK_SUPABASE_DB.has(tableName)) MOCK_SUPABASE_DB.set(tableName, new Map());\n                const table = MOCK_SUPABASE_DB.get(tableName)!;\n                const id = data.id || `mock_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`;\n                table.set(id, { ...data, id });\n                return { data: [{ id }], error: null };\n            },\n            select: (columns: string) => {\n                console.log(`[ContentStorage] Mock Supabase: Selecting ${columns} from ${tableName}`);\n                return createQueryBuilder(tableName, getTableData());\n            },\n            eq: (column: string, value: any) => {\n                console.log(`[ContentStorage] Mock Supabase: eq ${column} = ${value}`);\n                const filtered = getTableData().filter(item => item[column] === value);\n                // Return data directly for terminal operations\n                return { data: filtered, error: null, ...createQueryBuilder(tableName, filtered) };\n            },\n            gte: (column: string, value: any) => {\n                console.log(`[ContentStorage] Mock Supabase: gte ${column} >= ${value}`);\n                const filtered = getTableData().filter(item =>\n                    new Date(item[column]).getTime() >= new Date(value).getTime()\n                );\n                return createQueryBuilder(tableName, filtered);\n            },\n            filter: (column: string, operator: string, value: any) => {\n                console.log(`[ContentStorage] Mock Supabase: Filtering ${column} ${operator} ${value}`);\n                const filtered = getTableData().filter(item => {\n                    if (operator === \"gte\") return new Date(item[column]).getTime() >= new Date(value).getTime();\n                    if (operator === \"eq\") return item[column] === value;\n                    return false;\n                });\n                return { data: filtered, error: null, ...createQueryBuilder(tableName, filtered) };\n            },\n            order: (column: string, { ascending = true }: { ascending?: boolean } = {}) => {\n                console.log(`[ContentStorage] Mock Supabase: Ordering by ${column} ${ascending ? 'ASC' : 'DESC'}`);\n                const sorted = [...getTableData()].sort((a, b) => {\n                    const valA = new Date(a[column]).getTime();\n                    const valB = new Date(b[column]).getTime();\n                    return ascending ? valA - valB : valB - valA;\n                });\n                return { data: sorted, error: null, ...createQueryBuilder(tableName, sorted) };\n            },\n            limit: (count: number) => {\n                console.log(`[ContentStorage] Mock Supabase: Limiting to ${count}`);\n                const limited = getTableData().slice(0, count);\n                return { data: limited, error: null };\n            },\n            // Allow direct data access after chaining\n            then: (resolve: (result: { data: any[]; error: null }) => void) => {\n                resolve({ data: getTableData(), error: null });\n            }\n        };\n    };\n\n    return {\n        from: (tableName: string) => createQueryBuilder(tableName)\n    };\n};\n\ntype SupabaseClient = ReturnType<typeof createClient>;\n\n\n// =========================================================================\n// TYPES\n// =========================================================================\n\nexport interface ContentStorageConfig {\n  url?: string;\n  serviceKey?: string;\n  /** If true, fall back to in-memory when Supabase unavailable */\n  fallbackToMemory?: boolean;\n}\n\nexport interface ContentStorageEvents {\n  \"event:saved\": (event: EngineEvent) => void;\n  \"brief:saved\": (brief: ContentBrief) => void;\n  \"article:saved\": (article: ContentArticle) => void;\n  \"packet:saved\": (packet: DistributionPacket) => void;\n  \"error\": (error: Error) => void;\n  \"connected\": () => void;\n}\n\n// =========================================================================\n// SUPABASE TABLE SCHEMAS (Conceptual - for reference)\n// =========================================================================\n/*\nCREATE TABLE public.engine_events (\n    id uuid PRIMARY KEY DEFAULT uuid_generate_v4(),\n    timestamp timestamptz NOT NULL DEFAULT now(),\n    engine text NOT NULL,\n    type text NOT NULL,\n    title text NOT NULL,\n    description text,\n    metrics jsonb,\n    tags text[],\n    links text[],\n    source jsonb\n);\n\nCREATE TABLE public.win_records (\n    id uuid PRIMARY KEY DEFAULT uuid_generate_v4(),\n    created_at timestamptz NOT NULL DEFAULT now(),\n    category text NOT NULL,\n    subcategory text NOT NULL,\n    title text NOT NULL,\n    value numeric NOT NULL,\n    unit text NOT NULL,\n    engine_event_id uuid REFERENCES public.engine_events(id)\n);\n\nCREATE TABLE public.content_briefs (\n    id uuid PRIMARY KEY DEFAULT uuid_generate_v4(),\n    created_at timestamptz NOT NULL DEFAULT now(),\n    primary_goal text NOT NULL,\n    narrative_angle text NOT NULL,\n    primary_audience text NOT NULL,\n    time_scope text NOT NULL,\n    key_idea text NOT NULL,\n    events jsonb, -- Storing relevant events as JSONB for simplicity\n    wins jsonb,   -- Storing relevant wins as JSONB for simplicity\n    market_context jsonb,\n    target_length text NOT NULL,\n    target_channels text[],\n    primary_cta text NOT NULL,\n    seed_keywords text[]\n);\n\nCREATE TABLE public.content_articles (\n    id uuid PRIMARY KEY DEFAULT uuid_generate_v4(),\n    brief_id uuid NOT NULL REFERENCES public.content_briefs(id),\n    created_at timestamptz NOT NULL DEFAULT now(),\n    updated_at timestamptz NOT NULL DEFAULT now(),\n    markdown text NOT NULL,\n    seo jsonb NOT NULL,\n    status text NOT NULL DEFAULT 'draft'\n);\n\nCREATE TABLE public.distribution_packets (\n    id uuid PRIMARY KEY DEFAULT uuid_generate_v4(),\n    article_id uuid NOT NULL REFERENCES public.content_articles(id),\n    created_at timestamptz NOT NULL DEFAULT now(),\n    base_slug text NOT NULL,\n    blog_post text,\n    twitter_thread jsonb,\n    linkedin_post text,\n    substack_body text,\n    mirror_body text,\n    devto_body text\n);\n*/\n\n// =========================================================================\n// CONTENT STORAGE CLASS\n// =========================================================================\n\nexport class ContentStorage extends EventEmitter<ContentStorageEvents> {\n  private config: ContentStorageConfig;\n  private supabase: SupabaseClient | null = null;\n  private isConnected = false;\n\n  // In-memory fallbacks\n  private events: Map<string, EngineEvent> = new Map();\n  private wins: Map<string, WinRecord> = new Map();\n  private briefs: Map<string, ContentBrief> = new Map();\n  private articles: Map<string, ContentArticle> = new Map();\n  private packets: Map<string, DistributionPacket> = new Map();\n\n  constructor(config: ContentStorageConfig = {}) {\n    super();\n    this.config = {\n      fallbackToMemory: true,\n      ...config,\n    };\n  }\n\n  /**\n   * Initialize connection and verify schema\n   */\n  async initialize(): Promise<boolean> {\n    if (this.config.url && this.config.serviceKey) {\n      try {\n        this.supabase = createClient(this.config.url, this.config.serviceKey);\n        // A simple query to test connection, e.g., fetching a non-existent table\n        // const { error } = await this.supabase.from('some_test_table').select('*').limit(1);\n        // if (error) throw error;\n\n        this.isConnected = true;\n        this.emit(\"connected\");\n        console.log(\"[ContentStorage] Connected to Supabase.\");\n        return true;\n      } catch (error) {\n        console.error(\"[ContentStorage] Supabase connection failed:\", error);\n        this.isConnected = false;\n        this.emit(\"error\", error instanceof Error ? error : new Error(String(error)));\n      }\n    }\n\n    if (this.config.fallbackToMemory || !this.isConnected) {\n      console.warn(\"[ContentStorage] Using in-memory fallback for content storage.\");\n      this.isConnected = false; // Ensure isConnected is false if falling back\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Check if connected to Supabase\n   */\n  get connected(): boolean {\n    return this.isConnected;\n  }\n\n  // =========================================================================\n  // EVENTS & WINS\n  // =========================================================================\n\n  async saveEngineEvent(event: EngineEvent): Promise<void> {\n    if (this.isConnected && this.supabase) {\n      const { error } = await this.supabase.from('engine_events').upsert(event, { onConflict: 'id' });\n      if (error) {\n        console.error(\"[ContentStorage] Supabase saveEngineEvent failed:\", error);\n        // Fallback to memory on error if configured\n        if (this.config.fallbackToMemory) this.events.set(event.id, event);\n        else throw error;\n      }\n    } else {\n      this.events.set(event.id, event);\n    }\n    this.emit(\"event:saved\", event);\n  }\n\n  async getEngineEventsSince(since: Date): Promise<EngineEvent[]> {\n    if (this.isConnected && this.supabase) {\n      const { data, error } = await this.supabase\n        .from('engine_events')\n        .select('*')\n        .gte('timestamp', since.toISOString())\n        .order('timestamp', { ascending: false });\n      if (error) {\n        console.error(\"[ContentStorage] Supabase getEngineEventsSince failed:\", error);\n        // Fallback to memory on error if configured\n        if (this.config.fallbackToMemory) {\n            const sinceTime = since.getTime();\n            return Array.from(this.events.values())\n                .filter((e) => new Date(e.timestamp).getTime() >= sinceTime)\n                .sort((a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime());\n        }\n        throw error;\n      }\n      return data as EngineEvent[];\n    } else {\n      const sinceTime = since.getTime();\n      return Array.from(this.events.values())\n        .filter((e) => new Date(e.timestamp).getTime() >= sinceTime)\n        .sort((a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime());\n    }\n  }\n\n  async saveWinRecord(win: WinRecord): Promise<void> {\n    if (this.isConnected && this.supabase) {\n        const { error } = await this.supabase.from('win_records').upsert(win, { onConflict: 'id' });\n        if (error) {\n          console.error(\"[ContentStorage] Supabase saveWinRecord failed:\", error);\n          if (this.config.fallbackToMemory) this.wins.set(win.id, win);\n          else throw error;\n        }\n    } else {\n        this.wins.set(win.id, win);\n    }\n  }\n\n  async getWinRecordsSince(since: Date): Promise<WinRecord[]> {\n    if (this.isConnected && this.supabase) {\n        const { data, error } = await this.supabase\n          .from('win_records')\n          .select('*')\n          .gte('created_at', since.toISOString())\n          .order('created_at', { ascending: false });\n        if (error) {\n          console.error(\"[ContentStorage] Supabase getWinRecordsSince failed:\", error);\n          if (this.config.fallbackToMemory) {\n            const sinceTime = since.getTime();\n            return Array.from(this.wins.values())\n              .filter((w) => new Date(w.createdAt).getTime() >= sinceTime)\n              .sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n          }\n          throw error;\n        }\n        return data as WinRecord[];\n    } else {\n      const sinceTime = since.getTime();\n      return Array.from(this.wins.values())\n        .filter((w) => new Date(w.createdAt).getTime() >= sinceTime)\n        .sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n    }\n  }\n\n  // =========================================================================\n  // BRIEFS\n  // =========================================================================\n\n  async saveContentBrief(brief: ContentBrief): Promise<void> {\n    if (this.isConnected && this.supabase) {\n        const { error } = await this.supabase.from('content_briefs').upsert(brief, { onConflict: 'id' });\n        if (error) {\n          console.error(\"[ContentStorage] Supabase saveContentBrief failed:\", error);\n          if (this.config.fallbackToMemory) this.briefs.set(brief.id, brief);\n          else throw error;\n        }\n    } else {\n        this.briefs.set(brief.id, brief);\n    }\n    this.emit(\"brief:saved\", brief);\n  }\n\n  async listPendingBriefs(): Promise<ContentBrief[]> {\n    if (this.isConnected && this.supabase) {\n        // This is a simplified check. A real implementation would involve a join\n        // or a more complex query to find briefs that do not have associated articles.\n        // For now, we'll fetch all briefs and filter in-memory.\n        const { data: briefsData, error: briefsError } = await this.supabase\n          .from('content_briefs')\n          .select('*');\n        if (briefsError) {\n          console.error(\"[ContentStorage] Supabase listPendingBriefs failed (briefs fetch):\", briefsError);\n          if (this.config.fallbackToMemory) {\n            const articleBriefIds = new Set(Array.from(this.articles.values()).map(a => a.briefId));\n            return Array.from(this.briefs.values()).filter(b => !articleBriefIds.has(b.id));\n          }\n          throw briefsError;\n        }\n\n        const { data: articlesData, error: articlesError } = await this.supabase\n          .from('content_articles')\n          .select('brief_id');\n        if (articlesError) {\n          console.error(\"[ContentStorage] Supabase listPendingBriefs failed (articles fetch):\", articlesError);\n          if (this.config.fallbackToMemory) {\n            const articleBriefIds = new Set(Array.from(this.articles.values()).map(a => a.briefId));\n            return Array.from(this.briefs.values()).filter(b => !articleBriefIds.has(b.id));\n          }\n          throw articlesError;\n        }\n\n        const articleBriefIds = new Set(articlesData?.map(a => a.brief_id));\n        return (briefsData as ContentBrief[]).filter(b => !articleBriefIds.has(b.id));\n\n    } else {\n      const articleBriefIds = new Set(Array.from(this.articles.values()).map(a => a.briefId));\n      return Array.from(this.briefs.values()).filter(b => !articleBriefIds.has(b.id));\n    }\n  }\n\n  async getBrief(id: string): Promise<ContentBrief | undefined> {\n    if (this.isConnected && this.supabase) {\n        const { data, error } = await this.supabase\n          .from('content_briefs')\n          .select('*')\n          .eq('id', id);\n        if (error) {\n          console.error(\"[ContentStorage] Supabase getBrief failed:\", error);\n          if (this.config.fallbackToMemory) return this.briefs.get(id);\n          throw error;\n        }\n        return data?.[0] as ContentBrief | undefined;\n    } else {\n      return this.briefs.get(id);\n    }\n  }\n\n  // =========================================================================\n  // ARTICLES\n  // =========================================================================\n\n  async saveContentArticle(article: ContentArticle): Promise<void> {\n    if (this.isConnected && this.supabase) {\n        const { error } = await this.supabase.from('content_articles').upsert(article, { onConflict: 'id' });\n        if (error) {\n          console.error(\"[ContentStorage] Supabase saveContentArticle failed:\", error);\n          if (this.config.fallbackToMemory) this.articles.set(article.id, article);\n          else throw error;\n        }\n    } else {\n        this.articles.set(article.id, article);\n    }\n    this.emit(\"article:saved\", article);\n  }\n\n  async updateContentArticle(article: ContentArticle): Promise<void> {\n    // Upsert acts as update if ID exists\n    await this.saveContentArticle(article);\n    this.emit(\"article:saved\", article);\n  }\n\n  async getArticleByBriefId(briefId: string): Promise<ContentArticle | undefined> {\n    if (this.isConnected && this.supabase) {\n        const { data, error } = await this.supabase\n          .from('content_articles')\n          .select('*')\n          .eq('brief_id', briefId);\n        if (error) {\n          console.error(\"[ContentStorage] Supabase getArticleByBriefId failed:\", error);\n          if (this.config.fallbackToMemory) return Array.from(this.articles.values()).find(a => a.briefId === briefId);\n          throw error;\n        }\n        return data?.[0] as ContentArticle | undefined;\n    } else {\n      return Array.from(this.articles.values()).find(a => a.briefId === briefId);\n    }\n  }\n\n  // =========================================================================\n  // DISTRIBUTION\n  // =========================================================================\n\n  async saveDistributionPacket(packet: DistributionPacket): Promise<void> {\n    if (this.isConnected && this.supabase) {\n        const { error } = await this.supabase.from('distribution_packets').upsert(packet, { onConflict: 'id' });\n        if (error) {\n          console.error(\"[ContentStorage] Supabase saveDistributionPacket failed:\", error);\n          if (this.config.fallbackToMemory) this.packets.set(packet.id, packet);\n          else throw error;\n        }\n    } else {\n        this.packets.set(packet.id, packet);\n    }\n    this.emit(\"packet:saved\", packet);\n  }\n\n  async getDistributionPacketByArticleId(articleId: string): Promise<DistributionPacket | undefined> {\n    if (this.isConnected && this.supabase) {\n        const { data, error } = await this.supabase\n          .from('distribution_packets')\n          .select('*')\n          .eq('article_id', articleId);\n        if (error) {\n          console.error(\"[ContentStorage] Supabase getDistributionPacketByArticleId failed:\", error);\n          if (this.config.fallbackToMemory) {\n            return Array.from(this.packets.values()).find(p => p.articleId === articleId);\n          }\n          throw error;\n        }\n        return data?.[0] as DistributionPacket | undefined;\n    } else {\n      return Array.from(this.packets.values()).find(p => p.articleId === articleId);\n    }\n  }\n\n  async getDistributionPacket(id: string): Promise<DistributionPacket | undefined> {\n    if (this.isConnected && this.supabase) {\n        const { error, data } = await this.supabase\n          .from('distribution_packets')\n          .select('*')\n          .eq('id', id);\n        if (error) {\n          console.error(\"[ContentStorage] Supabase getDistributionPacket failed:\", error);\n          if (this.config.fallbackToMemory) return this.packets.get(id);\n          throw error;\n        }\n        return data?.[0] as DistributionPacket | undefined;\n    } else {\n      return this.packets.get(id);\n    }\n  }\n\n  async updateDistributionPacketStatus(id: string, status: DistributionPacket[\"status\"]): Promise<void> {\n    const packet = await this.getDistributionPacket(id);\n    if (packet) {\n      packet.status = status;\n      await this.saveDistributionPacket(packet);\n    }\n  }\n}\n\n// Singleton instance\nlet instance: ContentStorage | null = null;\n\nexport function getContentStorage(): ContentStorage {\n  if (!instance) {\n    instance = new ContentStorage({\n        url: process.env.SUPABASE_URL,\n        serviceKey: process.env.SUPABASE_SERVICE_KEY,\n        fallbackToMemory: process.env.NODE_ENV !== 'production' // Fallback in dev by default\n    });\n  }\n  return instance;\n}","import { getContentStorage } from \"../storage/content-storage.js\";\nimport type {\n  EngineEvent,\n  WinRecord,\n  ContentBrief,\n  ContentArticle,\n  ContentSEO,\n  DistributionPacket,\n} from \"../types/content.js\";\nimport fs from \"fs/promises\";\nimport path from \"path\";\nimport { fileURLToPath } from \"url\";\n\n// Get directory of this file for relative prompt paths\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\nconst PROMPTS_DIR = path.resolve(__dirname, \"../../prompts\");\n\n// =============================================================================\n// LLM CLIENT SETUP\n// =============================================================================\n\ninterface LLMConfig {\n  provider: \"anthropic\" | \"openai\" | \"gemini\";\n  apiKey: string;\n  model?: string;\n}\n\ninterface ContentLLMOptions {\n  useMock?: boolean; // For testing without API calls\n  config?: LLMConfig;\n}\n\n// Get LLM config from environment\nfunction getLLMConfig(): LLMConfig | null {\n  const anthropicKey = process.env.ANTHROPIC_API_KEY;\n  const openaiKey = process.env.OPENAI_API_KEY;\n  const geminiKey = process.env.GEMINI_API_KEY;\n\n  if (anthropicKey) {\n    return {\n      provider: \"anthropic\",\n      apiKey: anthropicKey,\n      model: process.env.ANTHROPIC_MODEL || \"claude-sonnet-4-20250514\",\n    };\n  }\n  if (openaiKey) {\n    return {\n      provider: \"openai\",\n      apiKey: openaiKey,\n      model: process.env.OPENAI_MODEL || \"gpt-4o\",\n    };\n  }\n  if (geminiKey) {\n    return {\n      provider: \"gemini\",\n      apiKey: geminiKey,\n      model: process.env.GEMINI_MODEL || \"gemini-2.0-flash\",\n    };\n  }\n  return null;\n}\n\n// =============================================================================\n// REAL LLM CALL\n// =============================================================================\n\nasync function callRealLLM(\n  systemPrompt: string,\n  userInput: string,\n  config: LLMConfig\n): Promise<string> {\n  if (config.provider === \"anthropic\") {\n    const response = await fetch(\"https://api.anthropic.com/v1/messages\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"x-api-key\": config.apiKey,\n        \"anthropic-version\": \"2023-06-01\",\n      },\n      body: JSON.stringify({\n        model: config.model,\n        max_tokens: 8192,\n        temperature: 0.7,\n        system: systemPrompt,\n        messages: [{ role: \"user\", content: userInput }],\n      }),\n    });\n\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`Anthropic API error: ${response.status} - ${error}`);\n    }\n\n    const data = await response.json() as { content: Array<{ text?: string }> };\n    return data.content[0]?.text || \"\";\n  }\n\n  if (config.provider === \"openai\") {\n    const response = await fetch(\"https://api.openai.com/v1/chat/completions\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${config.apiKey}`,\n      },\n      body: JSON.stringify({\n        model: config.model,\n        messages: [\n          { role: \"system\", content: systemPrompt },\n          { role: \"user\", content: userInput },\n        ],\n        temperature: 0.7,\n        max_tokens: 8192,\n      }),\n    });\n\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`OpenAI API error: ${response.status} - ${error}`);\n    }\n\n    const data = await response.json() as { choices: Array<{ message: { content: string } }> };\n    return data.choices[0]?.message?.content || \"\";\n  }\n\n  if (config.provider === \"gemini\") {\n    const url = `https://generativelanguage.googleapis.com/v1beta/models/${config.model}:generateContent?key=${config.apiKey}`;\n    const response = await fetch(url, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        contents: [{ role: \"user\", parts: [{ text: userInput }] }],\n        systemInstruction: { parts: [{ text: systemPrompt }] },\n        generationConfig: { temperature: 0.7, maxOutputTokens: 8192 },\n      }),\n    });\n\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`Gemini API error: ${response.status} - ${error}`);\n    }\n\n    const data = await response.json() as { candidates?: Array<{ content?: { parts?: Array<{ text?: string }> } }> };\n    return data.candidates?.[0]?.content?.parts?.[0]?.text || \"\";\n  }\n\n  throw new Error(`Unsupported provider: ${config.provider}`);\n}\n\n// =============================================================================\n// MOCK LLM CALL (for testing/fallback)\n// =============================================================================\n\nfunction generateMockResponse(promptName: string, input: any): any {\n  console.log(`[CONTENT-MOCK] Generating mock response for ${promptName}`);\n\n  if (promptName === \"orchestrator-content-agent\") {\n    const briefId = `brief_${Date.now()}`;\n    const keyIdea =\n      input.events.length > 0\n        ? `Insights from ${input.events[0].engine} regarding ${input.events[0].title}`\n        : \"General market update and agent performance summary\";\n\n    return [\n      {\n        id: briefId,\n        createdAt: new Date().toISOString(),\n        primaryGoal: \"build_authority\",\n        narrativeAngle: \"macro_thesis\",\n        primaryAudience: \"traders\",\n        timeScope: \"daily\",\n        keyIdea,\n        events: input.events.slice(0, 3),\n        wins: input.wins?.slice(0, 2) || [],\n        marketContext: input.marketContext || { notes: \"Market context\" },\n        targetLength: \"longform\",\n        targetChannels: [\"blog\", \"substack\", \"twitter\"],\n        primaryCTA: \"try_agent\",\n        seedKeywords: [\"gICM\", \"AI agents\", \"trading\", \"market analysis\", \"ICM\"],\n      } as ContentBrief,\n    ];\n  }\n\n  if (promptName.startsWith(\"writer-\")) {\n    const brief: ContentBrief = input;\n    let title = \"\";\n    let body = \"\";\n\n    if (brief.narrativeAngle === \"macro_thesis\" || brief.narrativeAngle === \"playbook_howto\") {\n      title = `Macro Outlook: ${brief.keyIdea}`;\n      body = `## What changed in the market\\n\\nDetails about recent market movements and trends.\\n\\n`;\n      body += `## How our agents responded\\n\\nOur agents detected patterns and executed strategies.\\n\\n`;\n      body += `## Key takeaways\\n\\n- Takeaway 1\\n- Takeaway 2\\n- Takeaway 3\\n\\n`;\n    } else if (brief.narrativeAngle === \"devlog\" || brief.narrativeAngle === \"product_launch\") {\n      title = `Devlog: ${brief.keyIdea}`;\n      body = `## What we shipped\\n\\nNew features and improvements.\\n\\n`;\n      body += `## Why it matters\\n\\nPerformance improvements and new capabilities.\\n\\n`;\n      body += `## How to use it\\n\\n1. Step one\\n2. Step two\\n3. Step three\\n\\n`;\n    } else if (brief.narrativeAngle === \"trading_case_study\") {\n      title = `Trading Case Study: ${brief.keyIdea}`;\n      body = `## Setup\\n\\nMarket conditions and context.\\n\\n`;\n      body += `## Agent Behavior\\n\\nHow our agents responded.\\n\\n`;\n      body += `## Results\\n\\nPerformance metrics.\\n\\n`;\n      body += `## Disclaimer\\n\\nTrading involves risk.\\n\\n`;\n    }\n    return `# ${title}\\n\\n${body}`;\n  }\n\n  if (promptName === \"seo-optimizer\") {\n    const { brief } = input;\n    const slug = brief.keyIdea\n      .toLowerCase()\n      .replace(/[^a-z0-9]+/g, \"-\")\n      .replace(/^-*|-*$/g, \"\");\n    return {\n      seoTitle: brief.keyIdea.slice(0, 60),\n      metaDescription: `${brief.keyIdea} - gICM AI agents platform insights.`,\n      slug,\n      keywords: [...(brief.seedKeywords || []), \"AI\", \"ICM\", \"agents\"],\n      faqs: [`What is ${brief.keyIdea}?`, \"How do AI agents work?\"],\n      internalLinks: [\"[LINK:gicm_agents]\", \"[LINK:money_engine]\"],\n      externalLinks: [],\n    } as ContentSEO;\n  }\n\n  if (promptName === \"distribution-splitter\") {\n    const { articleMarkdown, seo, brief } = input;\n    const firstLine = articleMarkdown.split(\"\\n\")[0].replace(\"# \", \"\");\n    return {\n      baseSlug: seo.slug,\n      canonicalUrl: `https://gicm.dev/blog/${seo.slug}`,\n      blogPost: articleMarkdown,\n      substackBody: articleMarkdown,\n      mirrorBody: articleMarkdown,\n      mediumBody: articleMarkdown,\n      devtoBody: brief.narrativeAngle === \"devlog\" ? articleMarkdown : undefined,\n      hashnodeBody: brief.narrativeAngle === \"devlog\" ? articleMarkdown : undefined,\n      twitterThread: [\n        `${firstLine.slice(0, 200)}... #ICM #AI`,\n        \"Key insights from our latest analysis.\",\n        `Read the full article: https://gicm.dev/blog/${seo.slug}`,\n      ],\n      linkedinPost: `${brief.keyIdea}\\n\\n- Key insight 1\\n- Key insight 2\\n\\n#AI #InternetCapitalMarkets`,\n      status: \"ready\" as const,\n    };\n  }\n\n  return {};\n}\n\n// =============================================================================\n// UNIFIED LLM CALL\n// =============================================================================\n\nasync function callLLM(\n  promptName: string,\n  input: any,\n  options: ContentLLMOptions = {}\n): Promise<any> {\n  const promptPath = path.join(PROMPTS_DIR, `${promptName}.prompt.md`);\n  let promptContent: string;\n\n  try {\n    promptContent = await fs.readFile(promptPath, \"utf-8\");\n  } catch (error) {\n    console.error(`[CONTENT] Failed to read prompt file ${promptPath}:`, error);\n    throw new Error(`Prompt file not found: ${promptName}`);\n  }\n\n  // Check if we should use mock\n  const config = options.config || getLLMConfig();\n  const useMock = options.useMock || !config || process.env.CONTENT_USE_MOCK === \"true\";\n\n  if (useMock) {\n    console.log(`[CONTENT] Using mock LLM for ${promptName}`);\n    return generateMockResponse(promptName, input);\n  }\n\n  // Real LLM call\n  console.log(`[CONTENT] Calling ${config.provider} for ${promptName}...`);\n\n  const userInput = JSON.stringify(input, null, 2);\n\n  try {\n    const response = await callRealLLM(promptContent, userInput, config);\n\n    // Parse JSON from response if expected\n    if (\n      promptName === \"orchestrator-content-agent\" ||\n      promptName === \"seo-optimizer\" ||\n      promptName === \"distribution-splitter\"\n    ) {\n      // Extract JSON from response (might be wrapped in markdown code blocks)\n      const jsonMatch = response.match(/```json\\n?([\\s\\S]*?)\\n?```/) ||\n                        response.match(/\\[[\\s\\S]*\\]/) ||\n                        response.match(/\\{[\\s\\S]*\\}/);\n      if (jsonMatch) {\n        const jsonStr = jsonMatch[1] || jsonMatch[0];\n        return JSON.parse(jsonStr);\n      }\n      // If no JSON found, try parsing the whole response\n      return JSON.parse(response);\n    }\n\n    // For writer prompts, return markdown as-is\n    return response;\n  } catch (error) {\n    console.error(`[CONTENT] LLM call failed for ${promptName}:`, error);\n    console.log(`[CONTENT] Falling back to mock response`);\n    return generateMockResponse(promptName, input);\n  }\n}\n\nexport async function generateContentBriefsDaily(): Promise<void> {\n  const storage = getContentStorage();\n  await storage.initialize();\n\n  const since = new Date(Date.now() - 24 * 60 * 60 * 1000);\n  const events = await storage.getEngineEventsSince(since);\n  const wins = await storage.getWinRecordsSince(since);\n\n  console.log(`[CONTENT-ORCHESTRATOR] Processing ${events.length} events and ${wins.length} wins`);\n\n  const marketContext = {\n    btcUsd: 0, // In real app, fetch from price feed\n    notes: \"Market data stub\",\n  };\n\n  // Call Orchestrator Agent\n  // In a real scenario, this would involve sending `promptContent` and `input` to an LLM API.\n  // The LLM's response (a JSON string) would then be parsed here.\n  const input = { events, wins, marketContext };\n  const briefs: ContentBrief[] = await callLLM(\"orchestrator-content-agent\", input);\n\n  for (const brief of briefs) {\n    await storage.saveContentBrief(brief);\n    console.log(`[CONTENT-ORCHESTRATOR] Generated brief: ${brief.id} - ${brief.keyIdea}`);\n  }\n}\n\nexport async function materializeContentFromBriefs(): Promise<void> {\n  const storage = getContentStorage();\n  await storage.initialize();\n\n  const pendingBriefs = await storage.listPendingBriefs();\n  console.log(`[CONTENT-PRODUCTION] Found ${pendingBriefs.length} pending briefs`);\n\n  for (const brief of pendingBriefs) {\n    // 1. Writer Agent\n    let writerPrompt = \"writer-macro\";\n    if (brief.narrativeAngle === \"devlog\" || brief.narrativeAngle === \"product_launch\") {\n      writerPrompt = \"writer-devlog\";\n    } else if (brief.narrativeAngle === \"trading_case_study\") {\n      writerPrompt = \"writer-trading\";\n    }\n\n    // Call Writer Agent\n    // The LLM would generate the markdown article based on the prompt and brief.\n    const articleMarkdown = await callLLM(writerPrompt, brief);\n\n    // 2. SEO Optimizer\n    // The LLM would generate SEO metadata based on the prompt, article, and brief.\n    const seo = await callLLM(\"seo-optimizer\", { articleMarkdown, brief });\n\n    const article = {\n        id: `art_${Date.now()}`,\n        briefId: brief.id,\n        createdAt: new Date().toISOString(),\n        updatedAt: new Date().toISOString(),\n        markdown: articleMarkdown,\n        seo,\n        status: \"draft\" as const\n    };\n    \n    await storage.saveContentArticle(article);\n\n    // 3. Distribution Splitter\n    // The LLM would generate channel-specific content based on the prompt, article, seo, and brief.\n    const packetData = await callLLM(\"distribution-splitter\", { articleMarkdown, seo, brief });\n    \n    await storage.saveDistributionPacket({\n        ...packetData,\n        id: `pkt_${Date.now()}`,\n        articleId: article.id,\n        createdAt: new Date().toISOString()\n    });\n    \n    console.log(`[CONTENT-PRODUCTION] Produced content for brief ${brief.id}`);\n  }\n}","/**\n * Content Distribution Service\n *\n * Handles publishing content to various platforms.\n * - Tier 1 (Automated): blog, substack, mirror, medium, devto, hashnode, github, rss, email\n * - Tier 2 (Approval Required): twitter, linkedin, reddit\n */\n\nimport type {\n  DistributionPacket,\n  DistributionAttempt,\n  ContentChannel,\n  ContentArticle,\n} from \"../types/content.js\";\n\n// =============================================================================\n// TYPES\n// =============================================================================\n\nexport interface DistributionConfig {\n  // Blog (your own site)\n  blogApiUrl?: string;\n  blogApiKey?: string;\n\n  // Substack\n  substackApiUrl?: string;\n  substackApiKey?: string;\n\n  // Mirror.xyz\n  mirrorAddress?: string;\n  mirrorPrivateKey?: string;\n\n  // Medium\n  mediumIntegrationToken?: string;\n  mediumPublicationId?: string;\n\n  // Dev.to\n  devtoApiKey?: string;\n\n  // Hashnode\n  hashnodeApiKey?: string;\n  hashnodePublicationId?: string;\n\n  // GitHub\n  githubToken?: string;\n  githubOwner?: string;\n  githubRepo?: string;\n  githubBranch?: string;\n\n  // Email (via ESP)\n  emailProvider?: \"buttondown\" | \"mailerlite\" | \"mailchimp\";\n  emailApiKey?: string;\n  emailListId?: string;\n\n  // Twitter (for drafts queue)\n  twitterBearerToken?: string;\n\n  // LinkedIn (for drafts queue)\n  linkedinAccessToken?: string;\n\n  // =========================================================================\n  // NEW: Web3 Social Channels\n  // =========================================================================\n\n  // Farcaster (via Neynar API)\n  farcasterApiKey?: string;        // Neynar API key\n  farcasterSignerUuid?: string;    // Signer UUID from Neynar\n\n  // Lens Protocol\n  lensProfileId?: string;\n  lensAccessToken?: string;\n\n  // Paragraph.xyz\n  paragraphApiKey?: string;\n  paragraphPublicationId?: string;\n\n  // =========================================================================\n  // NEW: Decentralized Social Channels\n  // =========================================================================\n\n  // Bluesky (AT Protocol)\n  blueskyHandle?: string;          // e.g., \"gicm.bsky.social\"\n  blueskyAppPassword?: string;     // App password (not main password)\n\n  // Mastodon (ActivityPub)\n  mastodonInstance?: string;       // e.g., \"mastodon.social\"\n  mastodonAccessToken?: string;\n\n  // =========================================================================\n  // NEW: Other Channels\n  // =========================================================================\n\n  // Threads (Meta) - Limited API\n  threadsUserId?: string;\n  threadsAccessToken?: string;\n\n  // Dry run mode (log but don't publish)\n  dryRun?: boolean;\n}\n\nexport interface DistributionResult {\n  channel: ContentChannel;\n  success: boolean;\n  externalUrl?: string;\n  externalId?: string;\n  error?: string;\n  timestamp: string;\n}\n\n// =============================================================================\n// DISTRIBUTION SERVICE\n// =============================================================================\n\nexport class DistributionService {\n  private config: DistributionConfig;\n  private attempts: Map<string, DistributionAttempt[]> = new Map();\n\n  constructor(config: DistributionConfig = {}) {\n    this.config = {\n      dryRun: process.env.DISTRIBUTION_DRY_RUN === \"true\",\n      ...config,\n    };\n  }\n\n  /**\n   * Distribute content to specified channels\n   */\n  async distribute(\n    packet: DistributionPacket,\n    channels?: ContentChannel[]\n  ): Promise<DistributionResult[]> {\n    const targetChannels = channels || this.getDefaultChannels(packet);\n    const results: DistributionResult[] = [];\n\n    for (const channel of targetChannels) {\n      try {\n        const result = await this.publishToChannel(packet, channel);\n        results.push(result);\n        this.recordAttempt(packet.id, result);\n      } catch (error) {\n        const errorResult: DistributionResult = {\n          channel,\n          success: false,\n          error: error instanceof Error ? error.message : String(error),\n          timestamp: new Date().toISOString(),\n        };\n        results.push(errorResult);\n        this.recordAttempt(packet.id, errorResult);\n      }\n    }\n\n    return results;\n  }\n\n  /**\n   * Get default channels based on packet content\n   */\n  private getDefaultChannels(packet: DistributionPacket): ContentChannel[] {\n    const channels: ContentChannel[] = [\"blog\"];\n\n    // Tier 1: Traditional platforms\n    if (packet.substackBody) channels.push(\"substack\");\n    if (packet.mirrorBody) channels.push(\"mirror\");\n    if (packet.mediumBody) channels.push(\"medium\");\n    if (packet.devtoBody) channels.push(\"devto\");\n    if (packet.hashnodeBody) channels.push(\"hashnode\");\n    if (packet.githubReadme) channels.push(\"github\");\n    if (packet.rssEntry) channels.push(\"rss\");\n    if (packet.emailDigest) channels.push(\"email\");\n\n    // Tier 1: Web3 social (NEW)\n    if (packet.farcasterCast) channels.push(\"farcaster\");\n    if (packet.lensPost) channels.push(\"lens\");\n    if (packet.paragraphPost) channels.push(\"paragraph\");\n\n    // Tier 1: Decentralized social (NEW)\n    if (packet.blueskyPost) channels.push(\"bluesky\");\n    if (packet.mastodonPost) channels.push(\"mastodon\");\n\n    // Tier 2 channels always included as drafts\n    if (packet.twitterThread?.length) channels.push(\"twitter\");\n    if (packet.linkedinPost) channels.push(\"linkedin\");\n    if (packet.redditDraft) channels.push(\"reddit\");\n    if (packet.threadsDraft) channels.push(\"threads\");\n\n    return channels;\n  }\n\n  /**\n   * Publish to a specific channel\n   */\n  private async publishToChannel(\n    packet: DistributionPacket,\n    channel: ContentChannel\n  ): Promise<DistributionResult> {\n    if (this.config.dryRun) {\n      console.log(`[DISTRIBUTION] DRY RUN: Would publish to ${channel}`);\n      return {\n        channel,\n        success: true,\n        externalUrl: `https://${channel}.example.com/${packet.baseSlug}`,\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    switch (channel) {\n      // Tier 1: Traditional platforms\n      case \"blog\":\n        return this.publishToBlog(packet);\n      case \"substack\":\n        return this.publishToSubstack(packet);\n      case \"mirror\":\n        return this.publishToMirror(packet);\n      case \"medium\":\n        return this.publishToMedium(packet);\n      case \"devto\":\n        return this.publishToDevTo(packet);\n      case \"hashnode\":\n        return this.publishToHashnode(packet);\n      case \"github\":\n        return this.publishToGitHub(packet);\n      case \"rss\":\n        return this.publishToRSS(packet);\n      case \"email\":\n        return this.publishToEmail(packet);\n\n      // Tier 1: Web3 Social (NEW)\n      case \"farcaster\":\n        return this.publishToFarcaster(packet);\n      case \"lens\":\n        return this.publishToLens(packet);\n      case \"paragraph\":\n        return this.publishToParagraph(packet);\n\n      // Tier 1: Decentralized Social (NEW)\n      case \"bluesky\":\n        return this.publishToBluesky(packet);\n      case \"mastodon\":\n        return this.publishToMastodon(packet);\n\n      // Tier 2: Approval required\n      case \"twitter\":\n        return this.queueForTwitter(packet);\n      case \"linkedin\":\n        return this.queueForLinkedIn(packet);\n      case \"reddit\":\n        return this.queueForReddit(packet);\n      case \"threads\":\n        return this.queueForThreads(packet);\n\n      default:\n        throw new Error(`Unsupported channel: ${channel}`);\n    }\n  }\n\n  // ===========================================================================\n  // TIER 1: AUTOMATED PUBLISHING\n  // ===========================================================================\n\n  /**\n   * Publish to own blog via API\n   */\n  private async publishToBlog(packet: DistributionPacket): Promise<DistributionResult> {\n    if (!this.config.blogApiUrl) {\n      // Fallback: Write to local file system\n      console.log(`[DISTRIBUTION] Blog API not configured, logging to console`);\n      console.log(`[BLOG] Title: ${packet.baseSlug}`);\n      console.log(`[BLOG] Content: ${packet.blogPost?.slice(0, 500)}...`);\n\n      return {\n        channel: \"blog\",\n        success: true,\n        externalUrl: `https://gicm.dev/blog/${packet.baseSlug}`,\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    const response = await fetch(this.config.blogApiUrl, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${this.config.blogApiKey}`,\n      },\n      body: JSON.stringify({\n        slug: packet.baseSlug,\n        content: packet.blogPost,\n        canonicalUrl: packet.canonicalUrl,\n      }),\n    });\n\n    if (!response.ok) {\n      throw new Error(`Blog API error: ${response.status}`);\n    }\n\n    const data = await response.json() as { url?: string; id?: string };\n    return {\n      channel: \"blog\",\n      success: true,\n      externalUrl: data.url || `https://gicm.dev/blog/${packet.baseSlug}`,\n      externalId: data.id,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Publish to Substack via API or email\n   */\n  private async publishToSubstack(packet: DistributionPacket): Promise<DistributionResult> {\n    if (!this.config.substackApiUrl) {\n      console.log(`[DISTRIBUTION] Substack not configured, skipping`);\n      return {\n        channel: \"substack\",\n        success: false,\n        error: \"Substack API not configured\",\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    // Substack API implementation would go here\n    // For now, log and return success\n    console.log(`[SUBSTACK] Would publish: ${packet.baseSlug}`);\n    return {\n      channel: \"substack\",\n      success: true,\n      externalUrl: `https://gicm.substack.com/p/${packet.baseSlug}`,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Publish to Mirror.xyz via wallet signature\n   */\n  private async publishToMirror(packet: DistributionPacket): Promise<DistributionResult> {\n    if (!this.config.mirrorAddress) {\n      console.log(`[DISTRIBUTION] Mirror not configured, skipping`);\n      return {\n        channel: \"mirror\",\n        success: false,\n        error: \"Mirror wallet not configured\",\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    // Mirror.xyz requires wallet-based publishing\n    console.log(`[MIRROR] Would publish: ${packet.baseSlug}`);\n    return {\n      channel: \"mirror\",\n      success: true,\n      externalUrl: `https://mirror.xyz/${this.config.mirrorAddress}/${packet.baseSlug}`,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Publish to Medium via Integration Token\n   */\n  private async publishToMedium(packet: DistributionPacket): Promise<DistributionResult> {\n    if (!this.config.mediumIntegrationToken) {\n      console.log(`[DISTRIBUTION] Medium not configured, skipping`);\n      return {\n        channel: \"medium\",\n        success: false,\n        error: \"Medium integration token not configured\",\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    const response = await fetch(\"https://api.medium.com/v1/users/me/posts\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${this.config.mediumIntegrationToken}`,\n      },\n      body: JSON.stringify({\n        title: packet.baseSlug.replace(/-/g, \" \"),\n        contentFormat: \"markdown\",\n        content: packet.mediumBody,\n        canonicalUrl: packet.canonicalUrl,\n        publishStatus: \"draft\", // Start as draft for review\n      }),\n    });\n\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`Medium API error: ${response.status} - ${error}`);\n    }\n\n    const data = await response.json() as { data?: { url?: string; id?: string } };\n    return {\n      channel: \"medium\",\n      success: true,\n      externalUrl: data.data?.url,\n      externalId: data.data?.id,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Publish to Dev.to via API\n   */\n  private async publishToDevTo(packet: DistributionPacket): Promise<DistributionResult> {\n    if (!this.config.devtoApiKey || !packet.devtoBody) {\n      console.log(`[DISTRIBUTION] Dev.to not configured or no content, skipping`);\n      return {\n        channel: \"devto\",\n        success: false,\n        error: \"Dev.to API key not configured or no content\",\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    const response = await fetch(\"https://dev.to/api/articles\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"api-key\": this.config.devtoApiKey,\n      },\n      body: JSON.stringify({\n        article: {\n          title: packet.baseSlug.replace(/-/g, \" \"),\n          body_markdown: packet.devtoBody,\n          published: false, // Start as draft\n          canonical_url: packet.canonicalUrl,\n          tags: [\"ai\", \"webdev\", \"programming\"],\n        },\n      }),\n    });\n\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`Dev.to API error: ${response.status} - ${error}`);\n    }\n\n    const data = await response.json() as { url?: string; id?: number };\n    return {\n      channel: \"devto\",\n      success: true,\n      externalUrl: data.url,\n      externalId: data.id?.toString(),\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Publish to Hashnode via GraphQL API\n   */\n  private async publishToHashnode(packet: DistributionPacket): Promise<DistributionResult> {\n    if (!this.config.hashnodeApiKey || !packet.hashnodeBody) {\n      console.log(`[DISTRIBUTION] Hashnode not configured or no content, skipping`);\n      return {\n        channel: \"hashnode\",\n        success: false,\n        error: \"Hashnode API key not configured or no content\",\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    const mutation = `\n      mutation CreatePost($input: CreatePostInput!) {\n        createPost(input: $input) {\n          post {\n            id\n            url\n          }\n        }\n      }\n    `;\n\n    const response = await fetch(\"https://gql.hashnode.com\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: this.config.hashnodeApiKey,\n      },\n      body: JSON.stringify({\n        query: mutation,\n        variables: {\n          input: {\n            title: packet.baseSlug.replace(/-/g, \" \"),\n            contentMarkdown: packet.hashnodeBody,\n            publicationId: this.config.hashnodePublicationId,\n            originalArticleURL: packet.canonicalUrl,\n          },\n        },\n      }),\n    });\n\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`Hashnode API error: ${response.status} - ${error}`);\n    }\n\n    const data = await response.json() as { data?: { createPost?: { post?: { id?: string; url?: string } } } };\n    return {\n      channel: \"hashnode\",\n      success: true,\n      externalUrl: data.data?.createPost?.post?.url,\n      externalId: data.data?.createPost?.post?.id,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Publish to GitHub repo (CHANGELOG, docs, etc.)\n   */\n  private async publishToGitHub(packet: DistributionPacket): Promise<DistributionResult> {\n    if (!this.config.githubToken || !packet.githubReadme) {\n      console.log(`[DISTRIBUTION] GitHub not configured or no content, skipping`);\n      return {\n        channel: \"github\",\n        success: false,\n        error: \"GitHub token not configured or no content\",\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    const { githubOwner, githubRepo, githubBranch = \"main\" } = this.config;\n    const filePath = `content/blog/${packet.baseSlug}.md`;\n\n    // Create or update file via GitHub API\n    const response = await fetch(\n      `https://api.github.com/repos/${githubOwner}/${githubRepo}/contents/${filePath}`,\n      {\n        method: \"PUT\",\n        headers: {\n          Accept: \"application/vnd.github.v3+json\",\n          Authorization: `token ${this.config.githubToken}`,\n        },\n        body: JSON.stringify({\n          message: `Add blog post: ${packet.baseSlug}`,\n          content: Buffer.from(packet.githubReadme).toString(\"base64\"),\n          branch: githubBranch,\n        }),\n      }\n    );\n\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`GitHub API error: ${response.status} - ${error}`);\n    }\n\n    const data = await response.json() as { content?: { html_url?: string; sha?: string } };\n    return {\n      channel: \"github\",\n      success: true,\n      externalUrl: data.content?.html_url,\n      externalId: data.content?.sha,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Update RSS feed\n   */\n  private async publishToRSS(packet: DistributionPacket): Promise<DistributionResult> {\n    if (!packet.rssEntry) {\n      return {\n        channel: \"rss\",\n        success: false,\n        error: \"No RSS entry in packet\",\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    // RSS is typically generated from the blog database\n    // Here we just log that it would be included\n    console.log(`[RSS] Entry added: ${packet.rssEntry.title}`);\n\n    return {\n      channel: \"rss\",\n      success: true,\n      externalUrl: packet.rssEntry.link,\n      externalId: packet.rssEntry.guid,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Send email digest via ESP\n   */\n  private async publishToEmail(packet: DistributionPacket): Promise<DistributionResult> {\n    if (!this.config.emailApiKey || !packet.emailDigest) {\n      console.log(`[DISTRIBUTION] Email not configured or no digest, skipping`);\n      return {\n        channel: \"email\",\n        success: false,\n        error: \"Email provider not configured or no digest\",\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    const provider = this.config.emailProvider || \"buttondown\";\n    let response: Response;\n\n    switch (provider) {\n      case \"buttondown\":\n        response = await fetch(\"https://api.buttondown.email/v1/emails\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Token ${this.config.emailApiKey}`,\n          },\n          body: JSON.stringify({\n            subject: packet.emailDigest.subject,\n            body: packet.emailDigest.htmlBody,\n            status: \"draft\", // Start as draft\n          }),\n        });\n        break;\n\n      case \"mailerlite\":\n        response = await fetch(\"https://connect.mailerlite.com/api/campaigns\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${this.config.emailApiKey}`,\n          },\n          body: JSON.stringify({\n            name: packet.emailDigest.subject,\n            type: \"regular\",\n            emails: [\n              {\n                subject: packet.emailDigest.subject,\n                content: packet.emailDigest.htmlBody,\n              },\n            ],\n          }),\n        });\n        break;\n\n      default:\n        throw new Error(`Unsupported email provider: ${provider}`);\n    }\n\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`Email API error: ${response.status} - ${error}`);\n    }\n\n    const data = await response.json() as { id?: string };\n    return {\n      channel: \"email\",\n      success: true,\n      externalId: data.id,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  // ===========================================================================\n  // TIER 1: WEB3 SOCIAL CHANNELS (NEW)\n  // ===========================================================================\n\n  /**\n   * Publish to Farcaster via Neynar API\n   * @see https://docs.neynar.com/reference/post-cast\n   */\n  private async publishToFarcaster(packet: DistributionPacket): Promise<DistributionResult> {\n    if (!this.config.farcasterApiKey || !this.config.farcasterSignerUuid || !packet.farcasterCast) {\n      console.log(`[DISTRIBUTION] Farcaster not configured or no cast, skipping`);\n      return {\n        channel: \"farcaster\",\n        success: false,\n        error: \"Farcaster API key/signer not configured or no cast content\",\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    const response = await fetch(\"https://api.neynar.com/v2/farcaster/cast\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"api_key\": this.config.farcasterApiKey,\n      },\n      body: JSON.stringify({\n        signer_uuid: this.config.farcasterSignerUuid,\n        text: packet.farcasterCast,\n        // Optional: Add embeds for links\n        embeds: packet.canonicalUrl ? [{ url: packet.canonicalUrl }] : undefined,\n      }),\n    });\n\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`Farcaster API error: ${response.status} - ${error}`);\n    }\n\n    const data = await response.json() as { cast?: { hash?: string; author?: { username?: string } } };\n    const hash = data.cast?.hash;\n    const username = data.cast?.author?.username;\n\n    return {\n      channel: \"farcaster\",\n      success: true,\n      externalUrl: hash && username ? `https://warpcast.com/${username}/${hash.slice(0, 10)}` : undefined,\n      externalId: hash,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Publish to Lens Protocol via API\n   * @see https://docs.lens.xyz/docs/create-post-typed-data\n   */\n  private async publishToLens(packet: DistributionPacket): Promise<DistributionResult> {\n    if (!this.config.lensProfileId || !this.config.lensAccessToken || !packet.lensPost) {\n      console.log(`[DISTRIBUTION] Lens not configured or no post, skipping`);\n      return {\n        channel: \"lens\",\n        success: false,\n        error: \"Lens profile/token not configured or no post content\",\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    // Lens uses GraphQL API\n    const mutation = `\n      mutation CreatePostOnLens($request: OnchainPostRequest!) {\n        postOnchain(request: $request) {\n          ... on RelaySuccess {\n            txHash\n            txId\n          }\n          ... on LensProfileManagerRelayError {\n            reason\n          }\n        }\n      }\n    `;\n\n    const response = await fetch(\"https://api-v2.lens.dev/\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": `Bearer ${this.config.lensAccessToken}`,\n        \"x-access-token\": this.config.lensAccessToken,\n      },\n      body: JSON.stringify({\n        query: mutation,\n        variables: {\n          request: {\n            contentURI: `data:application/json,${encodeURIComponent(JSON.stringify({\n              $schema: \"https://json-schemas.lens.dev/publications/text-only/3.0.0.json\",\n              lens: {\n                mainContentFocus: \"TEXT_ONLY\",\n                content: packet.lensPost,\n                locale: \"en\",\n              },\n            }))}`,\n          },\n        },\n      }),\n    });\n\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`Lens API error: ${response.status} - ${error}`);\n    }\n\n    const data = await response.json() as { data?: { postOnchain?: { txHash?: string; txId?: string } } };\n    const txHash = data.data?.postOnchain?.txHash;\n\n    return {\n      channel: \"lens\",\n      success: true,\n      externalUrl: txHash ? `https://hey.xyz/posts/${txHash}` : undefined,\n      externalId: txHash || data.data?.postOnchain?.txId,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Publish to Paragraph.xyz\n   * @see https://docs.paragraph.xyz/api\n   */\n  private async publishToParagraph(packet: DistributionPacket): Promise<DistributionResult> {\n    if (!this.config.paragraphApiKey || !packet.paragraphPost) {\n      console.log(`[DISTRIBUTION] Paragraph not configured or no post, skipping`);\n      return {\n        channel: \"paragraph\",\n        success: false,\n        error: \"Paragraph API key not configured or no post content\",\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    const response = await fetch(\"https://api.paragraph.xyz/v1/posts\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": `Bearer ${this.config.paragraphApiKey}`,\n      },\n      body: JSON.stringify({\n        title: packet.baseSlug.replace(/-/g, \" \"),\n        markdown: packet.paragraphPost,\n        slug: packet.baseSlug,\n        status: \"draft\", // Start as draft for review\n        publicationId: this.config.paragraphPublicationId,\n      }),\n    });\n\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`Paragraph API error: ${response.status} - ${error}`);\n    }\n\n    const data = await response.json() as { id?: string; slug?: string };\n    return {\n      channel: \"paragraph\",\n      success: true,\n      externalUrl: data.slug ? `https://paragraph.xyz/@gicm/${data.slug}` : undefined,\n      externalId: data.id,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  // ===========================================================================\n  // TIER 1: DECENTRALIZED SOCIAL CHANNELS (NEW)\n  // ===========================================================================\n\n  /**\n   * Publish to Bluesky via AT Protocol\n   * @see https://docs.bsky.app/docs/api/com-atproto-repo-create-record\n   */\n  private async publishToBluesky(packet: DistributionPacket): Promise<DistributionResult> {\n    if (!this.config.blueskyHandle || !this.config.blueskyAppPassword || !packet.blueskyPost) {\n      console.log(`[DISTRIBUTION] Bluesky not configured or no post, skipping`);\n      return {\n        channel: \"bluesky\",\n        success: false,\n        error: \"Bluesky handle/password not configured or no post content\",\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    // Step 1: Create session\n    const sessionResponse = await fetch(\"https://bsky.social/xrpc/com.atproto.server.createSession\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        identifier: this.config.blueskyHandle,\n        password: this.config.blueskyAppPassword,\n      }),\n    });\n\n    if (!sessionResponse.ok) {\n      const error = await sessionResponse.text();\n      throw new Error(`Bluesky auth error: ${sessionResponse.status} - ${error}`);\n    }\n\n    const session = await sessionResponse.json() as { accessJwt: string; did: string };\n\n    // Step 2: Create post\n    const postResponse = await fetch(\"https://bsky.social/xrpc/com.atproto.repo.createRecord\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": `Bearer ${session.accessJwt}`,\n      },\n      body: JSON.stringify({\n        repo: session.did,\n        collection: \"app.bsky.feed.post\",\n        record: {\n          $type: \"app.bsky.feed.post\",\n          text: packet.blueskyPost,\n          createdAt: new Date().toISOString(),\n          // Add link card if canonical URL exists\n          embed: packet.canonicalUrl ? {\n            $type: \"app.bsky.embed.external\",\n            external: {\n              uri: packet.canonicalUrl,\n              title: packet.baseSlug.replace(/-/g, \" \"),\n              description: packet.blueskyPost.slice(0, 300),\n            },\n          } : undefined,\n        },\n      }),\n    });\n\n    if (!postResponse.ok) {\n      const error = await postResponse.text();\n      throw new Error(`Bluesky post error: ${postResponse.status} - ${error}`);\n    }\n\n    const postData = await postResponse.json() as { uri?: string; cid?: string };\n    // Convert AT URI to web URL\n    const webUrl = postData.uri?.replace(\"at://\", \"https://bsky.app/profile/\").replace(\"/app.bsky.feed.post/\", \"/post/\");\n\n    return {\n      channel: \"bluesky\",\n      success: true,\n      externalUrl: webUrl,\n      externalId: postData.cid,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Publish to Mastodon via ActivityPub\n   * @see https://docs.joinmastodon.org/methods/statuses/\n   */\n  private async publishToMastodon(packet: DistributionPacket): Promise<DistributionResult> {\n    if (!this.config.mastodonInstance || !this.config.mastodonAccessToken || !packet.mastodonPost) {\n      console.log(`[DISTRIBUTION] Mastodon not configured or no toot, skipping`);\n      return {\n        channel: \"mastodon\",\n        success: false,\n        error: \"Mastodon instance/token not configured or no post content\",\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    const instance = this.config.mastodonInstance.replace(/^https?:\\/\\//, \"\").replace(/\\/$/, \"\");\n\n    const response = await fetch(`https://${instance}/api/v1/statuses`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": `Bearer ${this.config.mastodonAccessToken}`,\n      },\n      body: JSON.stringify({\n        status: packet.mastodonPost,\n        visibility: \"public\",\n        // Add link preview\n        ...(packet.canonicalUrl && {\n          media_ids: [], // Could add preview image\n        }),\n      }),\n    });\n\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`Mastodon API error: ${response.status} - ${error}`);\n    }\n\n    const data = await response.json() as { id?: string; url?: string };\n    return {\n      channel: \"mastodon\",\n      success: true,\n      externalUrl: data.url,\n      externalId: data.id,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  // ===========================================================================\n  // TIER 2: QUEUED FOR APPROVAL\n  // ===========================================================================\n\n  /**\n   * Queue Twitter thread for approval\n   */\n  private async queueForTwitter(packet: DistributionPacket): Promise<DistributionResult> {\n    if (!packet.twitterThread?.length) {\n      return {\n        channel: \"twitter\",\n        success: false,\n        error: \"No Twitter thread in packet\",\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    // Store in approval queue (would be a database in production)\n    console.log(`[TWITTER] Queued thread with ${packet.twitterThread.length} tweets for approval`);\n    console.log(`[TWITTER] First tweet: ${packet.twitterThread[0]}`);\n\n    return {\n      channel: \"twitter\",\n      success: true,\n      externalUrl: undefined, // No URL until approved and posted\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Queue LinkedIn post for approval\n   */\n  private async queueForLinkedIn(packet: DistributionPacket): Promise<DistributionResult> {\n    if (!packet.linkedinPost) {\n      return {\n        channel: \"linkedin\",\n        success: false,\n        error: \"No LinkedIn post in packet\",\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    console.log(`[LINKEDIN] Queued post for approval`);\n    console.log(`[LINKEDIN] Preview: ${packet.linkedinPost.slice(0, 200)}...`);\n\n    return {\n      channel: \"linkedin\",\n      success: true,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Queue Reddit draft for approval\n   */\n  private async queueForReddit(packet: DistributionPacket): Promise<DistributionResult> {\n    if (!packet.redditDraft) {\n      return {\n        channel: \"reddit\",\n        success: false,\n        error: \"No Reddit draft in packet\",\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    console.log(`[REDDIT] Queued draft for approval`);\n    console.log(`[REDDIT] Preview: ${packet.redditDraft.slice(0, 200)}...`);\n\n    return {\n      channel: \"reddit\",\n      success: true,\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Queue Threads draft for approval (Meta's Threads - limited API)\n   */\n  private async queueForThreads(packet: DistributionPacket): Promise<DistributionResult> {\n    if (!packet.threadsDraft) {\n      return {\n        channel: \"threads\",\n        success: false,\n        error: \"No Threads draft in packet\",\n        timestamp: new Date().toISOString(),\n      };\n    }\n\n    // Threads API is still limited - queue for manual posting or use unofficial methods\n    console.log(`[THREADS] Queued draft for approval`);\n    console.log(`[THREADS] Preview: ${packet.threadsDraft.slice(0, 200)}...`);\n\n    // If API credentials are available, attempt to post\n    if (this.config.threadsUserId && this.config.threadsAccessToken) {\n      try {\n        // Threads uses Instagram's Graph API (via Meta Business Suite)\n        const response = await fetch(\n          `https://graph.threads.net/v1.0/${this.config.threadsUserId}/threads`,\n          {\n            method: \"POST\",\n            headers: { \"Content-Type\": \"application/json\" },\n            body: JSON.stringify({\n              media_type: \"TEXT\",\n              text: packet.threadsDraft,\n              access_token: this.config.threadsAccessToken,\n            }),\n          }\n        );\n\n        if (response.ok) {\n          const data = await response.json() as { id?: string };\n          return {\n            channel: \"threads\",\n            success: true,\n            externalId: data.id,\n            externalUrl: data.id ? `https://threads.net/t/${data.id}` : undefined,\n            timestamp: new Date().toISOString(),\n          };\n        }\n      } catch (error) {\n        console.warn(`[THREADS] API call failed, queuing for manual:`, error);\n      }\n    }\n\n    return {\n      channel: \"threads\",\n      success: true, // Success = queued for manual posting\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  // ===========================================================================\n  // UTILITIES\n  // ===========================================================================\n\n  /**\n   * Record a distribution attempt\n   */\n  private recordAttempt(packetId: string, result: DistributionResult): void {\n    const attempt: DistributionAttempt = {\n      id: `attempt_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`,\n      packetId,\n      channel: result.channel,\n      attemptedAt: result.timestamp,\n      status: result.success ? \"success\" : \"failed\",\n      externalUrl: result.externalUrl,\n      externalId: result.externalId,\n      errorMessage: result.error,\n      retryCount: 0,\n    };\n\n    const existing = this.attempts.get(packetId) || [];\n    existing.push(attempt);\n    this.attempts.set(packetId, existing);\n  }\n\n  /**\n   * Get all attempts for a packet\n   */\n  getAttempts(packetId: string): DistributionAttempt[] {\n    return this.attempts.get(packetId) || [];\n  }\n\n  /**\n   * Get distribution summary\n   */\n  getSummary(): {\n    totalAttempts: number;\n    successfulChannels: ContentChannel[];\n    failedChannels: ContentChannel[];\n  } {\n    let totalAttempts = 0;\n    const successful = new Set<ContentChannel>();\n    const failed = new Set<ContentChannel>();\n\n    for (const attempts of this.attempts.values()) {\n      for (const attempt of attempts) {\n        totalAttempts++;\n        if (attempt.status === \"success\") {\n          successful.add(attempt.channel);\n        } else {\n          failed.add(attempt.channel);\n        }\n      }\n    }\n\n    return {\n      totalAttempts,\n      successfulChannels: Array.from(successful),\n      failedChannels: Array.from(failed),\n    };\n  }\n}\n\n// =============================================================================\n// SINGLETON\n// =============================================================================\n\nlet instance: DistributionService | null = null;\n\nexport function getDistributionService(config?: DistributionConfig): DistributionService {\n  if (!instance) {\n    instance = new DistributionService({\n      // Load from environment\n      blogApiUrl: process.env.BLOG_API_URL,\n      blogApiKey: process.env.BLOG_API_KEY,\n      devtoApiKey: process.env.DEVTO_API_KEY,\n      mediumIntegrationToken: process.env.MEDIUM_INTEGRATION_TOKEN,\n      hashnodeApiKey: process.env.HASHNODE_API_KEY,\n      hashnodePublicationId: process.env.HASHNODE_PUBLICATION_ID,\n      githubToken: process.env.GITHUB_TOKEN,\n      githubOwner: process.env.GITHUB_OWNER || \"gicm\",\n      githubRepo: process.env.GITHUB_REPO || \"gicm-content\",\n      emailProvider: (process.env.EMAIL_PROVIDER || \"buttondown\") as \"buttondown\" | \"mailerlite\" | \"mailchimp\",\n      emailApiKey: process.env.EMAIL_API_KEY,\n      ...config,\n    });\n  }\n  return instance;\n}\n\nexport default DistributionService;\n","/**\n * Multi-Tenancy & RBAC - Type Definitions\n * Phase 9A: Enterprise Security Foundation\n */\n\nimport { z } from \"zod\";\n\n// ============================================================================\n// ROLES & PERMISSIONS\n// ============================================================================\n\n// Role hierarchy: Owner > Admin > Editor > Viewer\nexport const RoleSchema = z.enum([\"owner\", \"admin\", \"editor\", \"viewer\"]);\nexport type Role = z.infer<typeof RoleSchema>;\n\n// Permission format: resource:action\nexport const PermissionSchema = z.string().regex(/^[a-z_]+:[a-z_]+$/);\nexport type Permission = z.infer<typeof PermissionSchema>;\n\n// Resource types\nexport const ResourceTypeSchema = z.enum([\n  \"organization\",\n  \"pipeline\",\n  \"schedule\",\n  \"budget\",\n  \"webhook\",\n  \"marketplace\",\n  \"analytics\",\n  \"audit\",\n  \"settings\",\n  \"member\",\n  \"invite\",\n]);\nexport type ResourceType = z.infer<typeof ResourceTypeSchema>;\n\n// Action types\nexport const ActionTypeSchema = z.enum([\n  \"create\",\n  \"read\",\n  \"update\",\n  \"delete\",\n  \"execute\",\n  \"manage\",\n  \"invite\",\n  \"export\",\n]);\nexport type ActionType = z.infer<typeof ActionTypeSchema>;\n\n// ============================================================================\n// ORGANIZATION\n// ============================================================================\n\n// Organization plan tiers\nexport const OrgPlanSchema = z.enum([\"free\", \"pro\", \"enterprise\"]);\nexport type OrgPlan = z.infer<typeof OrgPlanSchema>;\n\n// Organization settings\nexport const OrgSettingsSchema = z.object({\n  // Branding\n  logoUrl: z.string().url().optional(),\n  primaryColor: z.string().regex(/^#[0-9a-fA-F]{6}$/).optional(),\n\n  // Limits (based on plan)\n  maxPipelines: z.number().int().positive().default(10),\n  maxMembers: z.number().int().positive().default(5),\n  maxSchedules: z.number().int().positive().default(5),\n  maxBudgets: z.number().int().positive().default(3),\n\n  // Features\n  auditLogRetentionDays: z.number().int().min(7).default(30),\n  apiRateLimit: z.number().int().positive().default(100),\n  webhooksEnabled: z.boolean().default(true),\n  ssoEnabled: z.boolean().default(false),\n\n  // Notifications\n  notifyOnBudgetAlert: z.boolean().default(true),\n  notifyOnPipelineFailure: z.boolean().default(true),\n  notifyOnNewMember: z.boolean().default(true),\n});\nexport type OrgSettings = z.infer<typeof OrgSettingsSchema>;\n\n// Organization schema\nexport const OrganizationSchema = z.object({\n  id: z.string().uuid(),\n  name: z.string().min(1).max(100),\n  slug: z.string().regex(/^[a-z0-9-]+$/).min(3).max(50),\n  description: z.string().max(500).optional(),\n\n  // Plan & billing\n  plan: OrgPlanSchema.default(\"free\"),\n  billingEmail: z.string().email().optional(),\n  stripeCustomerId: z.string().optional(),\n\n  // Settings\n  settings: OrgSettingsSchema.default({}),\n\n  // Metadata\n  createdAt: z.date(),\n  updatedAt: z.date(),\n  createdBy: z.string().uuid(),\n});\nexport type Organization = z.infer<typeof OrganizationSchema>;\n\n// Create organization input\nexport const CreateOrgSchema = OrganizationSchema.omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n}).partial({\n  settings: true,\n  plan: true,\n});\nexport type CreateOrg = z.infer<typeof CreateOrgSchema>;\n\n// Update organization input\nexport const UpdateOrgSchema = OrganizationSchema.omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n  createdBy: true,\n}).partial();\nexport type UpdateOrg = z.infer<typeof UpdateOrgSchema>;\n\n// ============================================================================\n// MEMBERS\n// ============================================================================\n\n// Member status\nexport const MemberStatusSchema = z.enum([\"active\", \"suspended\", \"removed\"]);\nexport type MemberStatus = z.infer<typeof MemberStatusSchema>;\n\n// Organization member\nexport const OrgMemberSchema = z.object({\n  id: z.string().uuid(),\n  orgId: z.string().uuid(),\n  userId: z.string().uuid(),\n\n  // Role & permissions\n  role: RoleSchema,\n  customPermissions: z.array(PermissionSchema).optional(), // Override role permissions\n\n  // User info (denormalized for display)\n  email: z.string().email(),\n  displayName: z.string().optional(),\n  avatarUrl: z.string().url().optional(),\n\n  // Status\n  status: MemberStatusSchema.default(\"active\"),\n\n  // Metadata\n  invitedBy: z.string().uuid().optional(),\n  invitedAt: z.date().optional(),\n  joinedAt: z.date(),\n  lastActiveAt: z.date().optional(),\n});\nexport type OrgMember = z.infer<typeof OrgMemberSchema>;\n\n// Add member input\nexport const AddMemberSchema = z.object({\n  userId: z.string().uuid(),\n  role: RoleSchema,\n  email: z.string().email(),\n  displayName: z.string().optional(),\n  avatarUrl: z.string().url().optional(),\n});\nexport type AddMember = z.infer<typeof AddMemberSchema>;\n\n// Update member input\nexport const UpdateMemberSchema = z.object({\n  role: RoleSchema.optional(),\n  customPermissions: z.array(PermissionSchema).optional(),\n  status: MemberStatusSchema.optional(),\n});\nexport type UpdateMember = z.infer<typeof UpdateMemberSchema>;\n\n// ============================================================================\n// INVITATIONS\n// ============================================================================\n\n// Invite status\nexport const InviteStatusSchema = z.enum([\"pending\", \"accepted\", \"expired\", \"revoked\"]);\nexport type InviteStatus = z.infer<typeof InviteStatusSchema>;\n\n// Organization invite\nexport const OrgInviteSchema = z.object({\n  id: z.string().uuid(),\n  orgId: z.string().uuid(),\n  email: z.string().email(),\n  role: RoleSchema,\n\n  // Token for accepting invite\n  token: z.string().min(32),\n  expiresAt: z.date(),\n\n  // Status\n  status: InviteStatusSchema.default(\"pending\"),\n\n  // Metadata\n  invitedBy: z.string().uuid(),\n  invitedAt: z.date(),\n  acceptedAt: z.date().optional(),\n  acceptedBy: z.string().uuid().optional(),\n\n  // Personalization\n  message: z.string().max(500).optional(),\n});\nexport type OrgInvite = z.infer<typeof OrgInviteSchema>;\n\n// Create invite input\nexport const CreateInviteSchema = z.object({\n  email: z.string().email(),\n  role: RoleSchema.default(\"viewer\"),\n  message: z.string().max(500).optional(),\n  expiresInDays: z.number().int().min(1).max(30).default(7),\n});\nexport type CreateInvite = z.infer<typeof CreateInviteSchema>;\n\n// ============================================================================\n// PERMISSION CHECK\n// ============================================================================\n\n// Permission check request\nexport const PermissionCheckSchema = z.object({\n  userId: z.string().uuid(),\n  orgId: z.string().uuid(),\n  resource: ResourceTypeSchema,\n  action: ActionTypeSchema,\n  resourceId: z.string().optional(), // For resource-specific checks\n});\nexport type PermissionCheck = z.infer<typeof PermissionCheckSchema>;\n\n// Permission check result\nexport const PermissionResultSchema = z.object({\n  allowed: z.boolean(),\n  reason: z.string().optional(),\n  role: RoleSchema.optional(),\n  checkedAt: z.date(),\n});\nexport type PermissionResult = z.infer<typeof PermissionResultSchema>;\n\n// ============================================================================\n// CONTEXT\n// ============================================================================\n\n// Auth context (attached to requests)\nexport const AuthContextSchema = z.object({\n  userId: z.string().uuid(),\n  orgId: z.string().uuid(),\n  role: RoleSchema,\n  permissions: z.array(PermissionSchema),\n\n  // User info\n  email: z.string().email(),\n  displayName: z.string().optional(),\n\n  // Organization info\n  orgName: z.string(),\n  orgPlan: OrgPlanSchema,\n});\nexport type AuthContext = z.infer<typeof AuthContextSchema>;\n\n// ============================================================================\n// EVENTS\n// ============================================================================\n\nexport interface RBACEvents {\n  \"org:created\": (org: Organization) => void;\n  \"org:updated\": (org: Organization) => void;\n  \"org:deleted\": (orgId: string) => void;\n\n  \"member:added\": (member: OrgMember) => void;\n  \"member:updated\": (member: OrgMember) => void;\n  \"member:removed\": (memberId: string, orgId: string) => void;\n\n  \"invite:created\": (invite: OrgInvite) => void;\n  \"invite:accepted\": (invite: OrgInvite, member: OrgMember) => void;\n  \"invite:revoked\": (inviteId: string) => void;\n  \"invite:expired\": (inviteId: string) => void;\n\n  \"permission:denied\": (check: PermissionCheck, result: PermissionResult) => void;\n}\n\n// ============================================================================\n// PLAN LIMITS\n// ============================================================================\n\nexport const PLAN_LIMITS: Record<OrgPlan, OrgSettings> = {\n  free: {\n    maxPipelines: 10,\n    maxMembers: 5,\n    maxSchedules: 5,\n    maxBudgets: 3,\n    auditLogRetentionDays: 7,\n    apiRateLimit: 100,\n    webhooksEnabled: true,\n    ssoEnabled: false,\n    notifyOnBudgetAlert: true,\n    notifyOnPipelineFailure: true,\n    notifyOnNewMember: true,\n  },\n  pro: {\n    maxPipelines: 100,\n    maxMembers: 25,\n    maxSchedules: 50,\n    maxBudgets: 20,\n    auditLogRetentionDays: 90,\n    apiRateLimit: 1000,\n    webhooksEnabled: true,\n    ssoEnabled: false,\n    notifyOnBudgetAlert: true,\n    notifyOnPipelineFailure: true,\n    notifyOnNewMember: true,\n  },\n  enterprise: {\n    maxPipelines: -1, // unlimited\n    maxMembers: -1,\n    maxSchedules: -1,\n    maxBudgets: -1,\n    auditLogRetentionDays: 365,\n    apiRateLimit: 10000,\n    webhooksEnabled: true,\n    ssoEnabled: true,\n    notifyOnBudgetAlert: true,\n    notifyOnPipelineFailure: true,\n    notifyOnNewMember: true,\n  },\n};\n\n// Role hierarchy levels (higher = more permissions)\nexport const ROLE_LEVELS: Record<Role, number> = {\n  viewer: 1,\n  editor: 2,\n  admin: 3,\n  owner: 4,\n};\n","/**\n * Permission Definitions & Matrix\n * Phase 9A: Enterprise Security Foundation\n */\n\nimport {\n  Role,\n  ResourceType,\n  ActionType,\n  Permission,\n  ROLE_LEVELS,\n} from \"./types.js\";\n\n// ============================================================================\n// PERMISSION DEFINITIONS\n// ============================================================================\n\n/**\n * All available permissions in the system.\n * Format: \"resource:action\"\n */\nexport const PERMISSIONS = {\n  // Organization\n  \"organization:read\": \"organization:read\",\n  \"organization:update\": \"organization:update\",\n  \"organization:delete\": \"organization:delete\",\n  \"organization:manage\": \"organization:manage\",\n\n  // Pipeline\n  \"pipeline:create\": \"pipeline:create\",\n  \"pipeline:read\": \"pipeline:read\",\n  \"pipeline:update\": \"pipeline:update\",\n  \"pipeline:delete\": \"pipeline:delete\",\n  \"pipeline:execute\": \"pipeline:execute\",\n\n  // Schedule\n  \"schedule:create\": \"schedule:create\",\n  \"schedule:read\": \"schedule:read\",\n  \"schedule:update\": \"schedule:update\",\n  \"schedule:delete\": \"schedule:delete\",\n\n  // Budget\n  \"budget:create\": \"budget:create\",\n  \"budget:read\": \"budget:read\",\n  \"budget:update\": \"budget:update\",\n  \"budget:delete\": \"budget:delete\",\n\n  // Webhook\n  \"webhook:create\": \"webhook:create\",\n  \"webhook:read\": \"webhook:read\",\n  \"webhook:update\": \"webhook:update\",\n  \"webhook:delete\": \"webhook:delete\",\n\n  // Marketplace\n  \"marketplace:read\": \"marketplace:read\",\n  \"marketplace:create\": \"marketplace:create\",\n  \"marketplace:update\": \"marketplace:update\",\n  \"marketplace:delete\": \"marketplace:delete\",\n\n  // Analytics\n  \"analytics:read\": \"analytics:read\",\n  \"analytics:export\": \"analytics:export\",\n\n  // Audit\n  \"audit:read\": \"audit:read\",\n  \"audit:export\": \"audit:export\",\n\n  // Settings\n  \"settings:read\": \"settings:read\",\n  \"settings:update\": \"settings:update\",\n\n  // Members\n  \"member:read\": \"member:read\",\n  \"member:update\": \"member:update\",\n  \"member:delete\": \"member:delete\",\n\n  // Invites\n  \"invite:create\": \"invite:create\",\n  \"invite:read\": \"invite:read\",\n  \"invite:delete\": \"invite:delete\",\n} as const;\n\nexport type PermissionKey = keyof typeof PERMISSIONS;\n\n// ============================================================================\n// ROLE PERMISSION MATRIX\n// ============================================================================\n\n/**\n * Permission matrix for each role.\n * Higher roles inherit all permissions from lower roles.\n */\nconst VIEWER_PERMISSIONS: Permission[] = [\n  PERMISSIONS[\"organization:read\"],\n  PERMISSIONS[\"pipeline:read\"],\n  PERMISSIONS[\"schedule:read\"],\n  PERMISSIONS[\"budget:read\"],\n  PERMISSIONS[\"webhook:read\"],\n  PERMISSIONS[\"marketplace:read\"],\n  PERMISSIONS[\"analytics:read\"],\n  PERMISSIONS[\"settings:read\"],\n  PERMISSIONS[\"member:read\"],\n  PERMISSIONS[\"invite:read\"],\n];\n\nconst EDITOR_PERMISSIONS: Permission[] = [\n  ...VIEWER_PERMISSIONS,\n  PERMISSIONS[\"pipeline:create\"],\n  PERMISSIONS[\"pipeline:update\"],\n  PERMISSIONS[\"pipeline:execute\"],\n  PERMISSIONS[\"schedule:create\"],\n  PERMISSIONS[\"schedule:update\"],\n  PERMISSIONS[\"budget:create\"],\n  PERMISSIONS[\"budget:update\"],\n  PERMISSIONS[\"webhook:create\"],\n  PERMISSIONS[\"webhook:update\"],\n  PERMISSIONS[\"marketplace:create\"],\n];\n\nconst ADMIN_PERMISSIONS: Permission[] = [\n  ...EDITOR_PERMISSIONS,\n  PERMISSIONS[\"pipeline:delete\"],\n  PERMISSIONS[\"schedule:delete\"],\n  PERMISSIONS[\"budget:delete\"],\n  PERMISSIONS[\"webhook:delete\"],\n  PERMISSIONS[\"marketplace:update\"],\n  PERMISSIONS[\"marketplace:delete\"],\n  PERMISSIONS[\"analytics:export\"],\n  PERMISSIONS[\"audit:read\"],\n  PERMISSIONS[\"audit:export\"],\n  PERMISSIONS[\"settings:update\"],\n  PERMISSIONS[\"member:update\"],\n  PERMISSIONS[\"member:delete\"],\n  PERMISSIONS[\"invite:create\"],\n  PERMISSIONS[\"invite:delete\"],\n];\n\nconst OWNER_PERMISSIONS: Permission[] = [\n  ...ADMIN_PERMISSIONS,\n  PERMISSIONS[\"organization:update\"],\n  PERMISSIONS[\"organization:delete\"],\n  PERMISSIONS[\"organization:manage\"],\n];\n\n/**\n * Role to permissions mapping\n */\nexport const ROLE_PERMISSIONS: Record<Role, Permission[]> = {\n  viewer: VIEWER_PERMISSIONS,\n  editor: EDITOR_PERMISSIONS,\n  admin: ADMIN_PERMISSIONS,\n  owner: OWNER_PERMISSIONS,\n};\n\n// ============================================================================\n// PERMISSION HELPERS\n// ============================================================================\n\n/**\n * Build permission string from resource and action\n */\nexport function buildPermission(resource: ResourceType, action: ActionType): Permission {\n  return `${resource}:${action}` as Permission;\n}\n\n/**\n * Parse permission string into resource and action\n */\nexport function parsePermission(permission: Permission): { resource: string; action: string } {\n  const [resource, action] = permission.split(\":\");\n  return { resource, action };\n}\n\n/**\n * Check if a role has a specific permission\n */\nexport function roleHasPermission(role: Role, permission: Permission): boolean {\n  const permissions = ROLE_PERMISSIONS[role];\n  return permissions.includes(permission);\n}\n\n/**\n * Get all permissions for a role\n */\nexport function getPermissionsForRole(role: Role): Permission[] {\n  return [...ROLE_PERMISSIONS[role]];\n}\n\n/**\n * Check if role A is higher than role B\n */\nexport function isHigherRole(roleA: Role, roleB: Role): boolean {\n  return ROLE_LEVELS[roleA] > ROLE_LEVELS[roleB];\n}\n\n/**\n * Check if role A is at least as high as role B\n */\nexport function isAtLeastRole(roleA: Role, roleB: Role): boolean {\n  return ROLE_LEVELS[roleA] >= ROLE_LEVELS[roleB];\n}\n\n/**\n * Get the minimum role required for a permission\n */\nexport function getMinRoleForPermission(permission: Permission): Role | null {\n  const roles: Role[] = [\"viewer\", \"editor\", \"admin\", \"owner\"];\n\n  for (const role of roles) {\n    if (roleHasPermission(role, permission)) {\n      return role;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Merge custom permissions with role permissions\n */\nexport function mergePermissions(\n  role: Role,\n  customPermissions?: Permission[]\n): Permission[] {\n  const basePermissions = getPermissionsForRole(role);\n\n  if (!customPermissions || customPermissions.length === 0) {\n    return basePermissions;\n  }\n\n  // Merge and deduplicate\n  const merged = new Set([...basePermissions, ...customPermissions]);\n  return Array.from(merged);\n}\n\n/**\n * Get all resources a role can access for a given action\n */\nexport function getResourcesForAction(role: Role, action: ActionType): ResourceType[] {\n  const permissions = ROLE_PERMISSIONS[role];\n  const resources: ResourceType[] = [];\n\n  for (const permission of permissions) {\n    const { resource, action: permAction } = parsePermission(permission);\n    if (permAction === action) {\n      resources.push(resource as ResourceType);\n    }\n  }\n\n  return resources;\n}\n\n/**\n * Get all actions a role can perform on a resource\n */\nexport function getActionsForResource(role: Role, resource: ResourceType): ActionType[] {\n  const permissions = ROLE_PERMISSIONS[role];\n  const actions: ActionType[] = [];\n\n  for (const permission of permissions) {\n    const { resource: permResource, action } = parsePermission(permission);\n    if (permResource === resource) {\n      actions.push(action as ActionType);\n    }\n  }\n\n  return actions;\n}\n\n// ============================================================================\n// PERMISSION GROUPS\n// ============================================================================\n\n/**\n * Grouped permissions for UI display\n */\nexport const PERMISSION_GROUPS = {\n  pipelines: {\n    label: \"Pipelines\",\n    permissions: [\n      { key: \"pipeline:create\", label: \"Create pipelines\" },\n      { key: \"pipeline:read\", label: \"View pipelines\" },\n      { key: \"pipeline:update\", label: \"Edit pipelines\" },\n      { key: \"pipeline:delete\", label: \"Delete pipelines\" },\n      { key: \"pipeline:execute\", label: \"Execute pipelines\" },\n    ],\n  },\n  schedules: {\n    label: \"Schedules\",\n    permissions: [\n      { key: \"schedule:create\", label: \"Create schedules\" },\n      { key: \"schedule:read\", label: \"View schedules\" },\n      { key: \"schedule:update\", label: \"Edit schedules\" },\n      { key: \"schedule:delete\", label: \"Delete schedules\" },\n    ],\n  },\n  budgets: {\n    label: \"Budgets\",\n    permissions: [\n      { key: \"budget:create\", label: \"Create budgets\" },\n      { key: \"budget:read\", label: \"View budgets\" },\n      { key: \"budget:update\", label: \"Edit budgets\" },\n      { key: \"budget:delete\", label: \"Delete budgets\" },\n    ],\n  },\n  webhooks: {\n    label: \"Webhooks\",\n    permissions: [\n      { key: \"webhook:create\", label: \"Create webhooks\" },\n      { key: \"webhook:read\", label: \"View webhooks\" },\n      { key: \"webhook:update\", label: \"Edit webhooks\" },\n      { key: \"webhook:delete\", label: \"Delete webhooks\" },\n    ],\n  },\n  marketplace: {\n    label: \"Marketplace\",\n    permissions: [\n      { key: \"marketplace:read\", label: \"Browse marketplace\" },\n      { key: \"marketplace:create\", label: \"Publish templates\" },\n      { key: \"marketplace:update\", label: \"Edit templates\" },\n      { key: \"marketplace:delete\", label: \"Delete templates\" },\n    ],\n  },\n  analytics: {\n    label: \"Analytics\",\n    permissions: [\n      { key: \"analytics:read\", label: \"View analytics\" },\n      { key: \"analytics:export\", label: \"Export analytics\" },\n    ],\n  },\n  audit: {\n    label: \"Audit Logs\",\n    permissions: [\n      { key: \"audit:read\", label: \"View audit logs\" },\n      { key: \"audit:export\", label: \"Export audit logs\" },\n    ],\n  },\n  team: {\n    label: \"Team Management\",\n    permissions: [\n      { key: \"member:read\", label: \"View members\" },\n      { key: \"member:update\", label: \"Update member roles\" },\n      { key: \"member:delete\", label: \"Remove members\" },\n      { key: \"invite:create\", label: \"Invite members\" },\n      { key: \"invite:read\", label: \"View invites\" },\n      { key: \"invite:delete\", label: \"Revoke invites\" },\n    ],\n  },\n  organization: {\n    label: \"Organization\",\n    permissions: [\n      { key: \"organization:read\", label: \"View organization\" },\n      { key: \"organization:update\", label: \"Edit organization\" },\n      { key: \"organization:delete\", label: \"Delete organization\" },\n      { key: \"organization:manage\", label: \"Manage billing & plan\" },\n      { key: \"settings:read\", label: \"View settings\" },\n      { key: \"settings:update\", label: \"Edit settings\" },\n    ],\n  },\n};\n\n// ============================================================================\n// ROLE DESCRIPTIONS\n// ============================================================================\n\nexport const ROLE_DESCRIPTIONS: Record<Role, { label: string; description: string }> = {\n  viewer: {\n    label: \"Viewer\",\n    description: \"Can view pipelines, schedules, and analytics. Read-only access.\",\n  },\n  editor: {\n    label: \"Editor\",\n    description: \"Can create and edit pipelines, schedules, and budgets. Cannot delete or manage team.\",\n  },\n  admin: {\n    label: \"Admin\",\n    description: \"Full access to all features. Can manage team members and settings.\",\n  },\n  owner: {\n    label: \"Owner\",\n    description: \"Organization owner with full control including billing and organization deletion.\",\n  },\n};\n","/**\n * RBAC Manager - Role-Based Access Control & Multi-Tenancy\n * Phase 9A: Enterprise Security Foundation\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport crypto from \"crypto\";\nimport {\n  Organization,\n  CreateOrg,\n  UpdateOrg,\n  OrganizationSchema,\n  CreateOrgSchema,\n  OrgMember,\n  AddMember,\n  UpdateMember,\n  OrgMemberSchema,\n  AddMemberSchema,\n  OrgInvite,\n  CreateInvite,\n  OrgInviteSchema,\n  CreateInviteSchema,\n  Role,\n  Permission,\n  PermissionCheck,\n  PermissionResult,\n  AuthContext,\n  RBACEvents,\n  PLAN_LIMITS,\n  ROLE_LEVELS,\n} from \"./types.js\";\nimport {\n  roleHasPermission,\n  getPermissionsForRole,\n  mergePermissions,\n  buildPermission,\n  isAtLeastRole,\n} from \"./permissions.js\";\n\n// ============================================================================\n// CONFIGURATION\n// ============================================================================\n\nexport interface RBACManagerConfig {\n  inviteExpirationDays?: number;\n  enableInviteEmails?: boolean;\n  maxOrgsPerUser?: number;\n  checkIntervalMs?: number;\n}\n\nconst DEFAULT_CONFIG: Required<RBACManagerConfig> = {\n  inviteExpirationDays: 7,\n  enableInviteEmails: true,\n  maxOrgsPerUser: 10,\n  checkIntervalMs: 60000, // Check for expired invites\n};\n\n// ============================================================================\n// RBAC MANAGER CLASS\n// ============================================================================\n\nexport class RBACManager extends EventEmitter<RBACEvents> {\n  private config: Required<RBACManagerConfig>;\n\n  // In-memory storage (replace with database in production)\n  private organizations: Map<string, Organization> = new Map();\n  private members: Map<string, OrgMember[]> = new Map(); // orgId -> members[]\n  private invites: Map<string, OrgInvite[]> = new Map(); // orgId -> invites[]\n  private userOrgs: Map<string, string[]> = new Map(); // userId -> orgIds[]\n\n  private checkInterval: NodeJS.Timeout | null = null;\n\n  constructor(config: RBACManagerConfig = {}) {\n    super();\n    this.config = { ...DEFAULT_CONFIG, ...config };\n  }\n\n  // ==========================================================================\n  // LIFECYCLE\n  // ==========================================================================\n\n  start(): void {\n    if (this.checkInterval) return;\n\n    this.checkInterval = setInterval(() => {\n      this.expireInvites();\n    }, this.config.checkIntervalMs);\n\n    console.log(\"[RBACManager] Started invite expiration monitoring\");\n  }\n\n  stop(): void {\n    if (this.checkInterval) {\n      clearInterval(this.checkInterval);\n      this.checkInterval = null;\n    }\n    console.log(\"[RBACManager] Stopped\");\n  }\n\n  // ==========================================================================\n  // ORGANIZATION MANAGEMENT\n  // ==========================================================================\n\n  async createOrganization(input: CreateOrg, creatorUserId: string): Promise<Organization> {\n    const validated = CreateOrgSchema.parse(input);\n\n    // Check user org limit\n    const userOrgs = this.userOrgs.get(creatorUserId) || [];\n    if (userOrgs.length >= this.config.maxOrgsPerUser) {\n      throw new Error(`User has reached maximum organization limit (${this.config.maxOrgsPerUser})`);\n    }\n\n    // Check slug uniqueness\n    for (const org of this.organizations.values()) {\n      if (org.slug === validated.slug) {\n        throw new Error(`Organization slug \"${validated.slug}\" is already taken`);\n      }\n    }\n\n    const now = new Date();\n    const plan = validated.plan || \"free\";\n\n    const org: Organization = OrganizationSchema.parse({\n      ...validated,\n      id: uuidv4(),\n      plan,\n      settings: { ...PLAN_LIMITS[plan], ...validated.settings },\n      createdAt: now,\n      updatedAt: now,\n      createdBy: creatorUserId,\n    });\n\n    // Store organization\n    this.organizations.set(org.id, org);\n    this.members.set(org.id, []);\n    this.invites.set(org.id, []);\n\n    // Add creator as owner\n    await this.addMember(org.id, {\n      userId: creatorUserId,\n      role: \"owner\",\n      email: validated.billingEmail || \"owner@example.com\",\n      displayName: \"Owner\",\n    });\n\n    this.emit(\"org:created\", org);\n    console.log(`[RBACManager] Created organization: ${org.name} (${org.slug})`);\n\n    return org;\n  }\n\n  getOrganization(orgId: string): Organization | undefined {\n    return this.organizations.get(orgId);\n  }\n\n  getOrganizationBySlug(slug: string): Organization | undefined {\n    for (const org of this.organizations.values()) {\n      if (org.slug === slug) return org;\n    }\n    return undefined;\n  }\n\n  async updateOrganization(orgId: string, updates: UpdateOrg): Promise<Organization | null> {\n    const org = this.organizations.get(orgId);\n    if (!org) return null;\n\n    // If changing slug, check uniqueness\n    if (updates.slug && updates.slug !== org.slug) {\n      for (const o of this.organizations.values()) {\n        if (o.slug === updates.slug && o.id !== orgId) {\n          throw new Error(`Organization slug \"${updates.slug}\" is already taken`);\n        }\n      }\n    }\n\n    // If changing plan, update limits\n    let settings = org.settings;\n    if (updates.plan && updates.plan !== org.plan) {\n      settings = { ...PLAN_LIMITS[updates.plan], ...updates.settings };\n    }\n\n    const updated: Organization = {\n      ...org,\n      ...updates,\n      settings: updates.settings ? { ...settings, ...updates.settings } : settings,\n      updatedAt: new Date(),\n    };\n\n    this.organizations.set(orgId, updated);\n    this.emit(\"org:updated\", updated);\n\n    return updated;\n  }\n\n  async deleteOrganization(orgId: string): Promise<boolean> {\n    const org = this.organizations.get(orgId);\n    if (!org) return false;\n\n    // Remove all members from userOrgs\n    const orgMembers = this.members.get(orgId) || [];\n    for (const member of orgMembers) {\n      const userOrgList = this.userOrgs.get(member.userId) || [];\n      this.userOrgs.set(\n        member.userId,\n        userOrgList.filter((id) => id !== orgId)\n      );\n    }\n\n    // Delete organization data\n    this.organizations.delete(orgId);\n    this.members.delete(orgId);\n    this.invites.delete(orgId);\n\n    this.emit(\"org:deleted\", orgId);\n    console.log(`[RBACManager] Deleted organization: ${org.name}`);\n\n    return true;\n  }\n\n  getUserOrganizations(userId: string): Organization[] {\n    const orgIds = this.userOrgs.get(userId) || [];\n    return orgIds\n      .map((id) => this.organizations.get(id))\n      .filter((org): org is Organization => org !== undefined);\n  }\n\n  // ==========================================================================\n  // MEMBER MANAGEMENT\n  // ==========================================================================\n\n  async addMember(orgId: string, input: AddMember): Promise<OrgMember> {\n    const org = this.organizations.get(orgId);\n    if (!org) throw new Error(`Organization not found: ${orgId}`);\n\n    const validated = AddMemberSchema.parse(input);\n    const orgMembers = this.members.get(orgId) || [];\n\n    // Check if already a member\n    if (orgMembers.some((m) => m.userId === validated.userId)) {\n      throw new Error(\"User is already a member of this organization\");\n    }\n\n    // Check member limit\n    if (org.settings.maxMembers !== -1 && orgMembers.length >= org.settings.maxMembers) {\n      throw new Error(`Organization has reached maximum member limit (${org.settings.maxMembers})`);\n    }\n\n    const now = new Date();\n    const member: OrgMember = OrgMemberSchema.parse({\n      id: uuidv4(),\n      orgId,\n      ...validated,\n      status: \"active\",\n      joinedAt: now,\n      lastActiveAt: now,\n    });\n\n    // Store member\n    orgMembers.push(member);\n    this.members.set(orgId, orgMembers);\n\n    // Update user orgs\n    const userOrgList = this.userOrgs.get(member.userId) || [];\n    userOrgList.push(orgId);\n    this.userOrgs.set(member.userId, userOrgList);\n\n    this.emit(\"member:added\", member);\n    console.log(`[RBACManager] Added member ${member.email} to ${org.name} as ${member.role}`);\n\n    return member;\n  }\n\n  getMember(orgId: string, userId: string): OrgMember | undefined {\n    const orgMembers = this.members.get(orgId) || [];\n    return orgMembers.find((m) => m.userId === userId && m.status === \"active\");\n  }\n\n  getMemberById(memberId: string): OrgMember | undefined {\n    for (const members of this.members.values()) {\n      const member = members.find((m) => m.id === memberId);\n      if (member) return member;\n    }\n    return undefined;\n  }\n\n  getOrgMembers(orgId: string): OrgMember[] {\n    return (this.members.get(orgId) || []).filter((m) => m.status === \"active\");\n  }\n\n  async updateMember(orgId: string, userId: string, updates: UpdateMember): Promise<OrgMember | null> {\n    const orgMembers = this.members.get(orgId) || [];\n    const memberIndex = orgMembers.findIndex((m) => m.userId === userId);\n\n    if (memberIndex === -1) return null;\n\n    const member = orgMembers[memberIndex];\n\n    // Prevent demoting the last owner\n    if (updates.role && member.role === \"owner\" && updates.role !== \"owner\") {\n      const owners = orgMembers.filter((m) => m.role === \"owner\" && m.status === \"active\");\n      if (owners.length <= 1) {\n        throw new Error(\"Cannot demote the last owner. Transfer ownership first.\");\n      }\n    }\n\n    const updated: OrgMember = {\n      ...member,\n      ...updates,\n      lastActiveAt: new Date(),\n    };\n\n    orgMembers[memberIndex] = updated;\n    this.members.set(orgId, orgMembers);\n\n    this.emit(\"member:updated\", updated);\n    return updated;\n  }\n\n  async removeMember(orgId: string, userId: string): Promise<boolean> {\n    const orgMembers = this.members.get(orgId) || [];\n    const member = orgMembers.find((m) => m.userId === userId);\n\n    if (!member) return false;\n\n    // Prevent removing the last owner\n    if (member.role === \"owner\") {\n      const owners = orgMembers.filter((m) => m.role === \"owner\" && m.status === \"active\");\n      if (owners.length <= 1) {\n        throw new Error(\"Cannot remove the last owner. Transfer ownership first.\");\n      }\n    }\n\n    // Soft delete - mark as removed\n    member.status = \"removed\";\n    this.members.set(orgId, orgMembers);\n\n    // Remove from user orgs\n    const userOrgList = this.userOrgs.get(userId) || [];\n    this.userOrgs.set(\n      userId,\n      userOrgList.filter((id) => id !== orgId)\n    );\n\n    this.emit(\"member:removed\", member.id, orgId);\n    console.log(`[RBACManager] Removed member ${member.email} from org ${orgId}`);\n\n    return true;\n  }\n\n  // ==========================================================================\n  // INVITE MANAGEMENT\n  // ==========================================================================\n\n  async createInvite(orgId: string, input: CreateInvite, invitedBy: string): Promise<OrgInvite> {\n    const org = this.organizations.get(orgId);\n    if (!org) throw new Error(`Organization not found: ${orgId}`);\n\n    const validated = CreateInviteSchema.parse(input);\n    const orgInvites = this.invites.get(orgId) || [];\n    const orgMembers = this.members.get(orgId) || [];\n\n    // Check if email is already a member\n    if (orgMembers.some((m) => m.email === validated.email && m.status === \"active\")) {\n      throw new Error(\"User with this email is already a member\");\n    }\n\n    // Check if invite already exists (and is pending)\n    const existingInvite = orgInvites.find(\n      (i) => i.email === validated.email && i.status === \"pending\"\n    );\n    if (existingInvite) {\n      throw new Error(\"An invite for this email is already pending\");\n    }\n\n    // Check member limit\n    if (org.settings.maxMembers !== -1 && orgMembers.length >= org.settings.maxMembers) {\n      throw new Error(`Organization has reached maximum member limit (${org.settings.maxMembers})`);\n    }\n\n    const now = new Date();\n    const expiresAt = new Date(now);\n    expiresAt.setDate(expiresAt.getDate() + validated.expiresInDays);\n\n    const invite: OrgInvite = OrgInviteSchema.parse({\n      id: uuidv4(),\n      orgId,\n      email: validated.email,\n      role: validated.role,\n      token: crypto.randomBytes(32).toString(\"hex\"),\n      expiresAt,\n      status: \"pending\",\n      invitedBy,\n      invitedAt: now,\n      message: validated.message,\n    });\n\n    orgInvites.push(invite);\n    this.invites.set(orgId, orgInvites);\n\n    this.emit(\"invite:created\", invite);\n    console.log(`[RBACManager] Created invite for ${invite.email} to ${org.name}`);\n\n    return invite;\n  }\n\n  getInvite(inviteId: string): OrgInvite | undefined {\n    for (const invites of this.invites.values()) {\n      const invite = invites.find((i) => i.id === inviteId);\n      if (invite) return invite;\n    }\n    return undefined;\n  }\n\n  getInviteByToken(token: string): OrgInvite | undefined {\n    for (const invites of this.invites.values()) {\n      const invite = invites.find((i) => i.token === token && i.status === \"pending\");\n      if (invite) return invite;\n    }\n    return undefined;\n  }\n\n  getOrgInvites(orgId: string, pendingOnly = true): OrgInvite[] {\n    const invites = this.invites.get(orgId) || [];\n    if (pendingOnly) {\n      return invites.filter((i) => i.status === \"pending\");\n    }\n    return invites;\n  }\n\n  async acceptInvite(token: string, userId: string, userEmail: string, displayName?: string): Promise<OrgMember> {\n    const invite = this.getInviteByToken(token);\n    if (!invite) throw new Error(\"Invalid or expired invite\");\n\n    // Check if expired\n    if (new Date() > invite.expiresAt) {\n      invite.status = \"expired\";\n      this.emit(\"invite:expired\", invite.id);\n      throw new Error(\"Invite has expired\");\n    }\n\n    // Create member\n    const member = await this.addMember(invite.orgId, {\n      userId,\n      role: invite.role,\n      email: userEmail,\n      displayName,\n    });\n\n    // Update invite status\n    invite.status = \"accepted\";\n    invite.acceptedAt = new Date();\n    invite.acceptedBy = userId;\n\n    this.emit(\"invite:accepted\", invite, member);\n    console.log(`[RBACManager] Invite accepted by ${userEmail}`);\n\n    return member;\n  }\n\n  async revokeInvite(inviteId: string): Promise<boolean> {\n    for (const [orgId, invites] of this.invites.entries()) {\n      const invite = invites.find((i) => i.id === inviteId);\n      if (invite && invite.status === \"pending\") {\n        invite.status = \"revoked\";\n        this.emit(\"invite:revoked\", inviteId);\n        console.log(`[RBACManager] Revoked invite ${inviteId}`);\n        return true;\n      }\n    }\n    return false;\n  }\n\n  private expireInvites(): void {\n    const now = new Date();\n\n    for (const invites of this.invites.values()) {\n      for (const invite of invites) {\n        if (invite.status === \"pending\" && now > invite.expiresAt) {\n          invite.status = \"expired\";\n          this.emit(\"invite:expired\", invite.id);\n        }\n      }\n    }\n  }\n\n  // ==========================================================================\n  // PERMISSION CHECKING\n  // ==========================================================================\n\n  async checkPermission(check: PermissionCheck): Promise<PermissionResult> {\n    const { userId, orgId, resource, action, resourceId } = check;\n    const permission = buildPermission(resource, action);\n\n    // Get member\n    const member = this.getMember(orgId, userId);\n    if (!member) {\n      return {\n        allowed: false,\n        reason: \"User is not a member of this organization\",\n        checkedAt: new Date(),\n      };\n    }\n\n    // Check if suspended\n    if (member.status === \"suspended\") {\n      return {\n        allowed: false,\n        reason: \"User account is suspended\",\n        role: member.role,\n        checkedAt: new Date(),\n      };\n    }\n\n    // Get effective permissions\n    const permissions = mergePermissions(member.role, member.customPermissions);\n\n    // Check permission\n    if (!permissions.includes(permission)) {\n      this.emit(\"permission:denied\", check, {\n        allowed: false,\n        reason: `Role \"${member.role}\" does not have permission \"${permission}\"`,\n        role: member.role,\n        checkedAt: new Date(),\n      });\n\n      return {\n        allowed: false,\n        reason: `Permission denied: ${permission}`,\n        role: member.role,\n        checkedAt: new Date(),\n      };\n    }\n\n    return {\n      allowed: true,\n      role: member.role,\n      checkedAt: new Date(),\n    };\n  }\n\n  hasPermission(userId: string, orgId: string, permission: Permission): boolean {\n    const member = this.getMember(orgId, userId);\n    if (!member || member.status !== \"active\") return false;\n\n    const permissions = mergePermissions(member.role, member.customPermissions);\n    return permissions.includes(permission);\n  }\n\n  hasRole(userId: string, orgId: string, minRole: Role): boolean {\n    const member = this.getMember(orgId, userId);\n    if (!member || member.status !== \"active\") return false;\n\n    return isAtLeastRole(member.role, minRole);\n  }\n\n  // ==========================================================================\n  // AUTH CONTEXT\n  // ==========================================================================\n\n  getAuthContext(userId: string, orgId: string): AuthContext | null {\n    const member = this.getMember(orgId, userId);\n    if (!member || member.status !== \"active\") return null;\n\n    const org = this.organizations.get(orgId);\n    if (!org) return null;\n\n    const permissions = mergePermissions(member.role, member.customPermissions);\n\n    return {\n      userId: member.userId,\n      orgId,\n      role: member.role,\n      permissions,\n      email: member.email,\n      displayName: member.displayName,\n      orgName: org.name,\n      orgPlan: org.plan,\n    };\n  }\n\n  // ==========================================================================\n  // STATISTICS\n  // ==========================================================================\n\n  getStats(): {\n    totalOrgs: number;\n    totalMembers: number;\n    totalInvites: number;\n    orgsByPlan: Record<string, number>;\n  } {\n    const orgsByPlan: Record<string, number> = { free: 0, pro: 0, enterprise: 0 };\n    let totalMembers = 0;\n    let totalInvites = 0;\n\n    for (const org of this.organizations.values()) {\n      orgsByPlan[org.plan] = (orgsByPlan[org.plan] || 0) + 1;\n    }\n\n    for (const members of this.members.values()) {\n      totalMembers += members.filter((m) => m.status === \"active\").length;\n    }\n\n    for (const invites of this.invites.values()) {\n      totalInvites += invites.filter((i) => i.status === \"pending\").length;\n    }\n\n    return {\n      totalOrgs: this.organizations.size,\n      totalMembers,\n      totalInvites,\n      orgsByPlan,\n    };\n  }\n}\n\n// ============================================================================\n// SINGLETON & FACTORY\n// ============================================================================\n\nlet rbacManager: RBACManager | null = null;\n\nexport function getRBACManager(config?: RBACManagerConfig): RBACManager {\n  if (!rbacManager) {\n    rbacManager = new RBACManager(config);\n  }\n  return rbacManager;\n}\n\nexport function createRBACManager(config?: RBACManagerConfig): RBACManager {\n  return new RBACManager(config);\n}\n","/**\n * Audit Logging Types & Schemas\n * Phase 9B: Enterprise Security\n */\n\nimport { z } from \"zod\";\n\n// ============================================================================\n// AUDIT EVENT CATEGORIES\n// ============================================================================\n\nexport const AuditCategorySchema = z.enum([\n  \"auth\",           // Authentication events\n  \"organization\",   // Org-level changes\n  \"member\",         // Member management\n  \"pipeline\",       // Pipeline operations\n  \"schedule\",       // Schedule changes\n  \"budget\",         // Budget operations\n  \"webhook\",        // Webhook management\n  \"settings\",       // Settings changes\n  \"api\",            // API access\n  \"security\",       // Security events\n  \"system\",         // System events\n]);\nexport type AuditCategory = z.infer<typeof AuditCategorySchema>;\n\n// ============================================================================\n// AUDIT EVENT ACTIONS\n// ============================================================================\n\nexport const AuditActionSchema = z.enum([\n  // Auth actions\n  \"login\",\n  \"logout\",\n  \"login_failed\",\n  \"token_refresh\",\n  \"password_change\",\n  \"mfa_enabled\",\n  \"mfa_disabled\",\n\n  // CRUD actions\n  \"create\",\n  \"read\",\n  \"update\",\n  \"delete\",\n\n  // Execution actions\n  \"execute\",\n  \"pause\",\n  \"resume\",\n  \"cancel\",\n\n  // Member actions\n  \"invite\",\n  \"join\",\n  \"leave\",\n  \"role_change\",\n\n  // API actions\n  \"api_call\",\n  \"rate_limited\",\n  \"quota_exceeded\",\n\n  // Security actions\n  \"permission_denied\",\n  \"suspicious_activity\",\n  \"ip_blocked\",\n\n  // System actions\n  \"export\",\n  \"import\",\n  \"backup\",\n  \"restore\",\n]);\nexport type AuditAction = z.infer<typeof AuditActionSchema>;\n\n// ============================================================================\n// AUDIT SEVERITY\n// ============================================================================\n\nexport const AuditSeveritySchema = z.enum([\n  \"debug\",    // Development/debug info\n  \"info\",     // Normal operations\n  \"warning\",  // Potential issues\n  \"error\",    // Errors\n  \"critical\", // Critical security events\n]);\nexport type AuditSeverity = z.infer<typeof AuditSeveritySchema>;\n\n// ============================================================================\n// AUDIT RESULT\n// ============================================================================\n\nexport const AuditResultSchema = z.enum([\n  \"success\",\n  \"failure\",\n  \"partial\",\n  \"pending\",\n]);\nexport type AuditResult = z.infer<typeof AuditResultSchema>;\n\n// ============================================================================\n// AUDIT CONTEXT\n// ============================================================================\n\nexport const AuditContextSchema = z.object({\n  // User context\n  userId: z.string().optional(),\n  userEmail: z.string().email().optional(),\n  userRole: z.string().optional(),\n\n  // Organization context\n  orgId: z.string().optional(),\n  orgName: z.string().optional(),\n\n  // Request context\n  ipAddress: z.string().optional(),\n  userAgent: z.string().optional(),\n  requestId: z.string().optional(),\n  sessionId: z.string().optional(),\n\n  // API context\n  apiKeyId: z.string().optional(),\n  apiKeyName: z.string().optional(),\n\n  // Geo context\n  country: z.string().optional(),\n  region: z.string().optional(),\n  city: z.string().optional(),\n});\nexport type AuditContext = z.infer<typeof AuditContextSchema>;\n\n// ============================================================================\n// AUDIT RESOURCE\n// ============================================================================\n\nexport const AuditResourceSchema = z.object({\n  type: z.string(),       // pipeline, schedule, budget, etc.\n  id: z.string(),         // Resource ID\n  name: z.string().optional(),\n  attributes: z.record(z.unknown()).optional(),\n});\nexport type AuditResource = z.infer<typeof AuditResourceSchema>;\n\n// ============================================================================\n// AUDIT CHANGE\n// ============================================================================\n\nexport const AuditChangeSchema = z.object({\n  field: z.string(),\n  oldValue: z.unknown().optional(),\n  newValue: z.unknown().optional(),\n});\nexport type AuditChange = z.infer<typeof AuditChangeSchema>;\n\n// ============================================================================\n// AUDIT EVENT\n// ============================================================================\n\nexport const AuditEventSchema = z.object({\n  id: z.string(),\n  timestamp: z.date(),\n\n  // Event classification\n  category: AuditCategorySchema,\n  action: AuditActionSchema,\n  severity: AuditSeveritySchema,\n  result: AuditResultSchema,\n\n  // Event details\n  description: z.string(),\n  message: z.string().optional(),\n\n  // Context\n  context: AuditContextSchema,\n\n  // Resource affected\n  resource: AuditResourceSchema.optional(),\n\n  // Changes made\n  changes: z.array(AuditChangeSchema).optional(),\n\n  // Additional metadata\n  metadata: z.record(z.unknown()).optional(),\n\n  // Error details (if applicable)\n  errorCode: z.string().optional(),\n  errorMessage: z.string().optional(),\n\n  // Retention\n  retentionDays: z.number().optional(),\n\n  // Hash for integrity verification\n  hash: z.string().optional(),\n  previousHash: z.string().optional(),\n});\nexport type AuditEvent = z.infer<typeof AuditEventSchema>;\n\n// ============================================================================\n// CREATE AUDIT EVENT INPUT\n// ============================================================================\n\nexport const CreateAuditEventSchema = AuditEventSchema.omit({\n  id: true,\n  timestamp: true,\n  hash: true,\n  previousHash: true,\n});\nexport type CreateAuditEvent = z.infer<typeof CreateAuditEventSchema>;\n\n// ============================================================================\n// AUDIT QUERY\n// ============================================================================\n\nexport const AuditQuerySchema = z.object({\n  // Filters\n  orgId: z.string().optional(),\n  userId: z.string().optional(),\n  category: AuditCategorySchema.optional(),\n  action: AuditActionSchema.optional(),\n  severity: AuditSeveritySchema.optional(),\n  result: AuditResultSchema.optional(),\n  resourceType: z.string().optional(),\n  resourceId: z.string().optional(),\n\n  // Date range\n  startDate: z.date().optional(),\n  endDate: z.date().optional(),\n\n  // Search\n  search: z.string().optional(),\n\n  // Pagination\n  limit: z.number().min(1).max(1000).default(100),\n  offset: z.number().min(0).default(0),\n\n  // Sorting\n  sortBy: z.enum([\"timestamp\", \"severity\", \"category\"]).default(\"timestamp\"),\n  sortOrder: z.enum([\"asc\", \"desc\"]).default(\"desc\"),\n});\nexport type AuditQuery = z.infer<typeof AuditQuerySchema>;\n\n// ============================================================================\n// AUDIT QUERY RESULT\n// ============================================================================\n\nexport const AuditQueryResultSchema = z.object({\n  events: z.array(AuditEventSchema),\n  total: z.number(),\n  limit: z.number(),\n  offset: z.number(),\n  hasMore: z.boolean(),\n});\nexport type AuditQueryResult = z.infer<typeof AuditQueryResultSchema>;\n\n// ============================================================================\n// AUDIT EXPORT OPTIONS\n// ============================================================================\n\nexport const AuditExportOptionsSchema = z.object({\n  format: z.enum([\"json\", \"csv\", \"pdf\"]),\n  query: AuditQuerySchema,\n  includeContext: z.boolean().default(true),\n  includeChanges: z.boolean().default(true),\n  includeMetadata: z.boolean().default(false),\n});\nexport type AuditExportOptions = z.infer<typeof AuditExportOptionsSchema>;\n\n// ============================================================================\n// AUDIT RETENTION POLICY\n// ============================================================================\n\nexport const AuditRetentionPolicySchema = z.object({\n  category: AuditCategorySchema,\n  retentionDays: z.number().min(1),\n  archiveAfterDays: z.number().optional(),\n  deleteAfterArchive: z.boolean().default(false),\n});\nexport type AuditRetentionPolicy = z.infer<typeof AuditRetentionPolicySchema>;\n\n// ============================================================================\n// AUDIT STATS\n// ============================================================================\n\nexport const AuditStatsSchema = z.object({\n  totalEvents: z.number(),\n  eventsByCategory: z.record(z.number()),\n  eventsBySeverity: z.record(z.number()),\n  eventsByResult: z.record(z.number()),\n  topUsers: z.array(z.object({\n    userId: z.string(),\n    email: z.string().optional(),\n    eventCount: z.number(),\n  })),\n  topResources: z.array(z.object({\n    resourceType: z.string(),\n    resourceId: z.string(),\n    eventCount: z.number(),\n  })),\n  recentActivity: z.array(z.object({\n    date: z.string(),\n    count: z.number(),\n  })),\n});\nexport type AuditStats = z.infer<typeof AuditStatsSchema>;\n\n// ============================================================================\n// EVENTS\n// ============================================================================\n\nexport interface AuditLoggerEvents {\n  \"event:logged\": (event: AuditEvent) => void;\n  \"event:exported\": (format: string, count: number) => void;\n  \"retention:applied\": (deleted: number, archived: number) => void;\n  \"error\": (error: Error) => void;\n}\n\n// ============================================================================\n// CONSTANTS\n// ============================================================================\n\nexport const DEFAULT_RETENTION_DAYS: Record<AuditCategory, number> = {\n  auth: 365,\n  organization: 730,\n  member: 365,\n  pipeline: 90,\n  schedule: 90,\n  budget: 365,\n  webhook: 90,\n  settings: 365,\n  api: 30,\n  security: 730,\n  system: 365,\n};\n\nexport const SEVERITY_LEVELS: Record<AuditSeverity, number> = {\n  debug: 0,\n  info: 1,\n  warning: 2,\n  error: 3,\n  critical: 4,\n};\n","/**\n * Audit Logger Implementation\n * Phase 9B: Enterprise Security\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport { createHash } from \"crypto\";\nimport {\n  AuditEvent,\n  AuditLoggerEvents,\n  CreateAuditEvent,\n  AuditQuery,\n  AuditQueryResult,\n  AuditCategory,\n  AuditAction,\n  AuditSeverity,\n  AuditResult,\n  AuditContext,\n  AuditResource,\n  AuditChange,\n  AuditStats,\n  AuditExportOptions,\n  AuditRetentionPolicy,\n  DEFAULT_RETENTION_DAYS,\n  SEVERITY_LEVELS,\n} from \"./types.js\";\n\n// ============================================================================\n// CONFIGURATION\n// ============================================================================\n\nexport interface AuditLoggerConfig {\n  // Storage\n  storageType: \"memory\" | \"database\" | \"external\";\n  databaseUrl?: string;\n  externalEndpoint?: string;\n\n  // Batching\n  batchSize: number;\n  batchIntervalMs: number;\n\n  // Retention\n  retentionPolicies?: AuditRetentionPolicy[];\n\n  // Security\n  enableIntegrityHash: boolean;\n  hashAlgorithm: \"sha256\" | \"sha512\";\n\n  // Performance\n  asyncLogging: boolean;\n  maxQueueSize: number;\n\n  // Filtering\n  minSeverity: AuditSeverity;\n  excludeCategories?: AuditCategory[];\n  excludeActions?: AuditAction[];\n\n  // Export\n  exportDir?: string;\n}\n\nconst DEFAULT_CONFIG: AuditLoggerConfig = {\n  storageType: \"memory\",\n  batchSize: 100,\n  batchIntervalMs: 5000,\n  enableIntegrityHash: true,\n  hashAlgorithm: \"sha256\",\n  asyncLogging: true,\n  maxQueueSize: 10000,\n  minSeverity: \"info\",\n};\n\n// ============================================================================\n// AUDIT LOGGER CLASS\n// ============================================================================\n\nexport class AuditLogger extends EventEmitter<AuditLoggerEvents> {\n  private config: AuditLoggerConfig;\n  private events: AuditEvent[] = [];\n  private queue: CreateAuditEvent[] = [];\n  private lastHash: string | null = null;\n  private batchTimer: ReturnType<typeof setInterval> | null = null;\n  private isProcessing = false;\n\n  constructor(config: Partial<AuditLoggerConfig> = {}) {\n    super();\n    this.config = { ...DEFAULT_CONFIG, ...config };\n\n    if (this.config.asyncLogging) {\n      this.startBatchProcessor();\n    }\n  }\n\n  // ==========================================================================\n  // LOGGING METHODS\n  // ==========================================================================\n\n  /**\n   * Log an audit event\n   */\n  async log(input: CreateAuditEvent): Promise<AuditEvent> {\n    // Check severity filter\n    if (SEVERITY_LEVELS[input.severity] < SEVERITY_LEVELS[this.config.minSeverity]) {\n      throw new Error(`Event severity ${input.severity} below minimum ${this.config.minSeverity}`);\n    }\n\n    // Check category exclusion\n    if (this.config.excludeCategories?.includes(input.category)) {\n      throw new Error(`Category ${input.category} is excluded`);\n    }\n\n    // Check action exclusion\n    if (this.config.excludeActions?.includes(input.action)) {\n      throw new Error(`Action ${input.action} is excluded`);\n    }\n\n    if (this.config.asyncLogging) {\n      // Queue for batch processing\n      if (this.queue.length >= this.config.maxQueueSize) {\n        await this.processBatch();\n      }\n      this.queue.push(input);\n\n      // Return placeholder event\n      const event = this.createEvent(input);\n      return event;\n    } else {\n      // Sync logging\n      const event = this.createEvent(input);\n      await this.storeEvent(event);\n      return event;\n    }\n  }\n\n  /**\n   * Log a simple info event\n   */\n  async info(\n    category: AuditCategory,\n    action: AuditAction,\n    description: string,\n    context?: Partial<AuditContext>,\n    resource?: AuditResource\n  ): Promise<AuditEvent> {\n    return this.log({\n      category,\n      action,\n      severity: \"info\",\n      result: \"success\",\n      description,\n      context: context || {},\n      resource,\n    });\n  }\n\n  /**\n   * Log a warning event\n   */\n  async warn(\n    category: AuditCategory,\n    action: AuditAction,\n    description: string,\n    context?: Partial<AuditContext>,\n    resource?: AuditResource\n  ): Promise<AuditEvent> {\n    return this.log({\n      category,\n      action,\n      severity: \"warning\",\n      result: \"success\",\n      description,\n      context: context || {},\n      resource,\n    });\n  }\n\n  /**\n   * Log an error event\n   */\n  async error(\n    category: AuditCategory,\n    action: AuditAction,\n    description: string,\n    error: Error,\n    context?: Partial<AuditContext>,\n    resource?: AuditResource\n  ): Promise<AuditEvent> {\n    return this.log({\n      category,\n      action,\n      severity: \"error\",\n      result: \"failure\",\n      description,\n      errorCode: error.name,\n      errorMessage: error.message,\n      context: context || {},\n      resource,\n    });\n  }\n\n  /**\n   * Log a security event\n   */\n  async security(\n    action: AuditAction,\n    description: string,\n    severity: AuditSeverity = \"warning\",\n    context?: Partial<AuditContext>,\n    resource?: AuditResource\n  ): Promise<AuditEvent> {\n    return this.log({\n      category: \"security\",\n      action,\n      severity,\n      result: severity === \"critical\" ? \"failure\" : \"success\",\n      description,\n      context: context || {},\n      resource,\n    });\n  }\n\n  /**\n   * Log a change event with diff\n   */\n  async change(\n    category: AuditCategory,\n    resourceType: string,\n    resourceId: string,\n    changes: AuditChange[],\n    context?: Partial<AuditContext>\n  ): Promise<AuditEvent> {\n    const description = `Updated ${resourceType} ${resourceId}: ${changes.map(c => c.field).join(\", \")}`;\n\n    return this.log({\n      category,\n      action: \"update\",\n      severity: \"info\",\n      result: \"success\",\n      description,\n      context: context || {},\n      resource: {\n        type: resourceType,\n        id: resourceId,\n      },\n      changes,\n    });\n  }\n\n  // ==========================================================================\n  // QUERY METHODS\n  // ==========================================================================\n\n  /**\n   * Query audit events\n   */\n  async query(query: AuditQuery): Promise<AuditQueryResult> {\n    let filtered = [...this.events];\n\n    // Apply filters\n    if (query.orgId) {\n      filtered = filtered.filter(e => e.context.orgId === query.orgId);\n    }\n    if (query.userId) {\n      filtered = filtered.filter(e => e.context.userId === query.userId);\n    }\n    if (query.category) {\n      filtered = filtered.filter(e => e.category === query.category);\n    }\n    if (query.action) {\n      filtered = filtered.filter(e => e.action === query.action);\n    }\n    if (query.severity) {\n      filtered = filtered.filter(e => e.severity === query.severity);\n    }\n    if (query.result) {\n      filtered = filtered.filter(e => e.result === query.result);\n    }\n    if (query.resourceType) {\n      filtered = filtered.filter(e => e.resource?.type === query.resourceType);\n    }\n    if (query.resourceId) {\n      filtered = filtered.filter(e => e.resource?.id === query.resourceId);\n    }\n\n    // Date range\n    if (query.startDate) {\n      filtered = filtered.filter(e => e.timestamp >= query.startDate!);\n    }\n    if (query.endDate) {\n      filtered = filtered.filter(e => e.timestamp <= query.endDate!);\n    }\n\n    // Search\n    if (query.search) {\n      const searchLower = query.search.toLowerCase();\n      filtered = filtered.filter(e =>\n        e.description.toLowerCase().includes(searchLower) ||\n        e.message?.toLowerCase().includes(searchLower) ||\n        e.context.userEmail?.toLowerCase().includes(searchLower) ||\n        e.resource?.name?.toLowerCase().includes(searchLower)\n      );\n    }\n\n    // Sort\n    filtered.sort((a, b) => {\n      let compare = 0;\n      switch (query.sortBy) {\n        case \"timestamp\":\n          compare = a.timestamp.getTime() - b.timestamp.getTime();\n          break;\n        case \"severity\":\n          compare = SEVERITY_LEVELS[a.severity] - SEVERITY_LEVELS[b.severity];\n          break;\n        case \"category\":\n          compare = a.category.localeCompare(b.category);\n          break;\n      }\n      return query.sortOrder === \"desc\" ? -compare : compare;\n    });\n\n    // Pagination\n    const total = filtered.length;\n    const offset = query.offset || 0;\n    const limit = query.limit || 100;\n    const paginated = filtered.slice(offset, offset + limit);\n\n    return {\n      events: paginated,\n      total,\n      limit,\n      offset,\n      hasMore: offset + limit < total,\n    };\n  }\n\n  /**\n   * Get event by ID\n   */\n  async getEvent(id: string): Promise<AuditEvent | null> {\n    return this.events.find(e => e.id === id) || null;\n  }\n\n  /**\n   * Get recent events for a user\n   */\n  async getUserEvents(userId: string, limit = 50): Promise<AuditEvent[]> {\n    const result = await this.query({\n      userId,\n      limit,\n      sortBy: \"timestamp\",\n      sortOrder: \"desc\",\n    });\n    return result.events;\n  }\n\n  /**\n   * Get recent events for an organization\n   */\n  async getOrgEvents(orgId: string, limit = 100): Promise<AuditEvent[]> {\n    const result = await this.query({\n      orgId,\n      limit,\n      sortBy: \"timestamp\",\n      sortOrder: \"desc\",\n    });\n    return result.events;\n  }\n\n  /**\n   * Get security events\n   */\n  async getSecurityEvents(\n    orgId?: string,\n    severity?: AuditSeverity,\n    limit = 100\n  ): Promise<AuditEvent[]> {\n    const result = await this.query({\n      orgId,\n      category: \"security\",\n      severity,\n      limit,\n      sortBy: \"timestamp\",\n      sortOrder: \"desc\",\n    });\n    return result.events;\n  }\n\n  // ==========================================================================\n  // STATISTICS\n  // ==========================================================================\n\n  /**\n   * Get audit statistics\n   */\n  async getStats(orgId?: string, days = 30): Promise<AuditStats> {\n    const startDate = new Date();\n    startDate.setDate(startDate.getDate() - days);\n\n    const result = await this.query({\n      orgId,\n      startDate,\n      limit: 10000,\n    });\n\n    const events = result.events;\n\n    // Count by category\n    const eventsByCategory: Record<string, number> = {};\n    for (const e of events) {\n      eventsByCategory[e.category] = (eventsByCategory[e.category] || 0) + 1;\n    }\n\n    // Count by severity\n    const eventsBySeverity: Record<string, number> = {};\n    for (const e of events) {\n      eventsBySeverity[e.severity] = (eventsBySeverity[e.severity] || 0) + 1;\n    }\n\n    // Count by result\n    const eventsByResult: Record<string, number> = {};\n    for (const e of events) {\n      eventsByResult[e.result] = (eventsByResult[e.result] || 0) + 1;\n    }\n\n    // Top users\n    const userCounts: Record<string, { email?: string; count: number }> = {};\n    for (const e of events) {\n      if (e.context.userId) {\n        if (!userCounts[e.context.userId]) {\n          userCounts[e.context.userId] = { email: e.context.userEmail, count: 0 };\n        }\n        userCounts[e.context.userId].count++;\n      }\n    }\n    const topUsers = Object.entries(userCounts)\n      .map(([userId, data]) => ({ userId, email: data.email, eventCount: data.count }))\n      .sort((a, b) => b.eventCount - a.eventCount)\n      .slice(0, 10);\n\n    // Top resources\n    const resourceCounts: Record<string, number> = {};\n    for (const e of events) {\n      if (e.resource) {\n        const key = `${e.resource.type}:${e.resource.id}`;\n        resourceCounts[key] = (resourceCounts[key] || 0) + 1;\n      }\n    }\n    const topResources = Object.entries(resourceCounts)\n      .map(([key, count]) => {\n        const [type, id] = key.split(\":\");\n        return { resourceType: type, resourceId: id, eventCount: count };\n      })\n      .sort((a, b) => b.eventCount - a.eventCount)\n      .slice(0, 10);\n\n    // Recent activity (daily counts)\n    const dailyCounts: Record<string, number> = {};\n    for (const e of events) {\n      const date = e.timestamp.toISOString().split(\"T\")[0];\n      dailyCounts[date] = (dailyCounts[date] || 0) + 1;\n    }\n    const recentActivity = Object.entries(dailyCounts)\n      .map(([date, count]) => ({ date, count }))\n      .sort((a, b) => a.date.localeCompare(b.date));\n\n    return {\n      totalEvents: events.length,\n      eventsByCategory,\n      eventsBySeverity,\n      eventsByResult,\n      topUsers,\n      topResources,\n      recentActivity,\n    };\n  }\n\n  // ==========================================================================\n  // EXPORT\n  // ==========================================================================\n\n  /**\n   * Export audit logs\n   */\n  async export(options: AuditExportOptions): Promise<string> {\n    const result = await this.query(options.query);\n\n    let output: string;\n\n    switch (options.format) {\n      case \"json\":\n        output = JSON.stringify(\n          result.events.map(e => this.serializeForExport(e, options)),\n          null,\n          2\n        );\n        break;\n\n      case \"csv\":\n        output = this.exportToCSV(result.events, options);\n        break;\n\n      case \"pdf\":\n        // PDF export would need a library - return JSON for now\n        output = JSON.stringify(\n          result.events.map(e => this.serializeForExport(e, options)),\n          null,\n          2\n        );\n        break;\n\n      default:\n        throw new Error(`Unsupported export format: ${options.format}`);\n    }\n\n    this.emit(\"event:exported\", options.format, result.events.length);\n\n    return output;\n  }\n\n  private serializeForExport(\n    event: AuditEvent,\n    options: AuditExportOptions\n  ): Record<string, unknown> {\n    const result: Record<string, unknown> = {\n      id: event.id,\n      timestamp: event.timestamp.toISOString(),\n      category: event.category,\n      action: event.action,\n      severity: event.severity,\n      result: event.result,\n      description: event.description,\n    };\n\n    if (options.includeContext) {\n      result.context = event.context;\n    }\n\n    if (options.includeChanges && event.changes) {\n      result.changes = event.changes;\n    }\n\n    if (options.includeMetadata && event.metadata) {\n      result.metadata = event.metadata;\n    }\n\n    if (event.resource) {\n      result.resource = event.resource;\n    }\n\n    if (event.errorCode) {\n      result.errorCode = event.errorCode;\n      result.errorMessage = event.errorMessage;\n    }\n\n    return result;\n  }\n\n  private exportToCSV(events: AuditEvent[], options: AuditExportOptions): string {\n    const headers = [\n      \"id\",\n      \"timestamp\",\n      \"category\",\n      \"action\",\n      \"severity\",\n      \"result\",\n      \"description\",\n      \"userId\",\n      \"userEmail\",\n      \"orgId\",\n      \"resourceType\",\n      \"resourceId\",\n    ];\n\n    const rows = events.map(e => [\n      e.id,\n      e.timestamp.toISOString(),\n      e.category,\n      e.action,\n      e.severity,\n      e.result,\n      `\"${e.description.replace(/\"/g, '\"\"')}\"`,\n      e.context.userId || \"\",\n      e.context.userEmail || \"\",\n      e.context.orgId || \"\",\n      e.resource?.type || \"\",\n      e.resource?.id || \"\",\n    ]);\n\n    return [headers.join(\",\"), ...rows.map(r => r.join(\",\"))].join(\"\\n\");\n  }\n\n  // ==========================================================================\n  // RETENTION\n  // ==========================================================================\n\n  /**\n   * Apply retention policies\n   */\n  async applyRetention(): Promise<{ deleted: number; archived: number }> {\n    const policies = this.config.retentionPolicies || this.getDefaultPolicies();\n    let deleted = 0;\n    let archived = 0;\n\n    for (const policy of policies) {\n      const cutoffDate = new Date();\n      cutoffDate.setDate(cutoffDate.getDate() - policy.retentionDays);\n\n      // Find events to process\n      const toProcess = this.events.filter(\n        e => e.category === policy.category && e.timestamp < cutoffDate\n      );\n\n      // Archive if configured\n      if (policy.archiveAfterDays) {\n        const archiveCutoff = new Date();\n        archiveCutoff.setDate(archiveCutoff.getDate() - policy.archiveAfterDays);\n\n        const toArchive = toProcess.filter(e => e.timestamp >= archiveCutoff);\n        // In a real implementation, archive these events\n        archived += toArchive.length;\n      }\n\n      // Delete\n      const toDelete = policy.deleteAfterArchive\n        ? toProcess\n        : toProcess.filter(e => {\n            if (policy.archiveAfterDays) {\n              const archiveCutoff = new Date();\n              archiveCutoff.setDate(archiveCutoff.getDate() - policy.archiveAfterDays);\n              return e.timestamp < archiveCutoff;\n            }\n            return true;\n          });\n\n      this.events = this.events.filter(e => !toDelete.includes(e));\n      deleted += toDelete.length;\n    }\n\n    this.emit(\"retention:applied\", deleted, archived);\n\n    return { deleted, archived };\n  }\n\n  private getDefaultPolicies(): AuditRetentionPolicy[] {\n    return Object.entries(DEFAULT_RETENTION_DAYS).map(([category, days]) => ({\n      category: category as AuditCategory,\n      retentionDays: days,\n    }));\n  }\n\n  // ==========================================================================\n  // INTEGRITY\n  // ==========================================================================\n\n  /**\n   * Verify event chain integrity\n   */\n  async verifyIntegrity(events?: AuditEvent[]): Promise<{\n    valid: boolean;\n    invalidEvents: string[];\n  }> {\n    const toVerify = events || this.events;\n    const invalidEvents: string[] = [];\n\n    let previousHash: string | null = null;\n\n    for (const event of toVerify.sort((a, b) => a.timestamp.getTime() - b.timestamp.getTime())) {\n      if (!event.hash) {\n        invalidEvents.push(event.id);\n        continue;\n      }\n\n      // Verify hash matches\n      const computedHash = this.computeHash(event);\n      if (computedHash !== event.hash) {\n        invalidEvents.push(event.id);\n        continue;\n      }\n\n      // Verify chain\n      if (previousHash && event.previousHash !== previousHash) {\n        invalidEvents.push(event.id);\n      }\n\n      previousHash = event.hash;\n    }\n\n    return {\n      valid: invalidEvents.length === 0,\n      invalidEvents,\n    };\n  }\n\n  // ==========================================================================\n  // INTERNAL METHODS\n  // ==========================================================================\n\n  private createEvent(input: CreateAuditEvent): AuditEvent {\n    const id = this.generateId();\n    const timestamp = new Date();\n\n    const event: AuditEvent = {\n      id,\n      timestamp,\n      ...input,\n      retentionDays: input.retentionDays || DEFAULT_RETENTION_DAYS[input.category],\n    };\n\n    if (this.config.enableIntegrityHash) {\n      event.previousHash = this.lastHash || undefined;\n      event.hash = this.computeHash(event);\n      this.lastHash = event.hash;\n    }\n\n    return event;\n  }\n\n  private async storeEvent(event: AuditEvent): Promise<void> {\n    switch (this.config.storageType) {\n      case \"memory\":\n        this.events.push(event);\n        break;\n\n      case \"database\":\n        // In a real implementation, store to database\n        this.events.push(event);\n        break;\n\n      case \"external\":\n        // In a real implementation, send to external service\n        this.events.push(event);\n        break;\n    }\n\n    this.emit(\"event:logged\", event);\n  }\n\n  private startBatchProcessor(): void {\n    this.batchTimer = setInterval(() => {\n      if (this.queue.length > 0 && !this.isProcessing) {\n        this.processBatch().catch(err => this.emit(\"error\", err));\n      }\n    }, this.config.batchIntervalMs);\n  }\n\n  private async processBatch(): Promise<void> {\n    if (this.queue.length === 0 || this.isProcessing) return;\n\n    this.isProcessing = true;\n\n    try {\n      const batch = this.queue.splice(0, this.config.batchSize);\n      const events = batch.map(input => this.createEvent(input));\n\n      for (const event of events) {\n        await this.storeEvent(event);\n      }\n    } finally {\n      this.isProcessing = false;\n    }\n  }\n\n  private computeHash(event: AuditEvent): string {\n    const data = JSON.stringify({\n      id: event.id,\n      timestamp: event.timestamp.toISOString(),\n      category: event.category,\n      action: event.action,\n      description: event.description,\n      context: event.context,\n      resource: event.resource,\n      previousHash: event.previousHash,\n    });\n\n    return createHash(this.config.hashAlgorithm).update(data).digest(\"hex\");\n  }\n\n  private generateId(): string {\n    return `aud_${Date.now()}_${Math.random().toString(36).slice(2, 11)}`;\n  }\n\n  // ==========================================================================\n  // LIFECYCLE\n  // ==========================================================================\n\n  /**\n   * Flush pending events\n   */\n  async flush(): Promise<void> {\n    if (this.queue.length > 0) {\n      await this.processBatch();\n    }\n  }\n\n  /**\n   * Stop the logger\n   */\n  async stop(): Promise<void> {\n    if (this.batchTimer) {\n      clearInterval(this.batchTimer);\n      this.batchTimer = null;\n    }\n    await this.flush();\n  }\n\n  /**\n   * Get queue size\n   */\n  getQueueSize(): number {\n    return this.queue.length;\n  }\n\n  /**\n   * Get total event count\n   */\n  getEventCount(): number {\n    return this.events.length;\n  }\n}\n\n// ============================================================================\n// SINGLETON & FACTORY\n// ============================================================================\n\nlet auditLoggerInstance: AuditLogger | null = null;\n\nexport function getAuditLogger(): AuditLogger {\n  if (!auditLoggerInstance) {\n    auditLoggerInstance = new AuditLogger();\n  }\n  return auditLoggerInstance;\n}\n\nexport function createAuditLogger(config?: Partial<AuditLoggerConfig>): AuditLogger {\n  return new AuditLogger(config);\n}\n","/**\n * Git Integration Types\n *\n * Enables pipeline-as-code with GitHub/GitLab/Bitbucket sync\n */\n\nimport { z } from \"zod\";\n\n// =============================================================================\n// GIT PROVIDERS\n// =============================================================================\n\nexport const GitProviderSchema = z.enum([\"github\", \"gitlab\", \"bitbucket\"]);\nexport type GitProvider = z.infer<typeof GitProviderSchema>;\n\n// =============================================================================\n// REPOSITORY CONFIG\n// =============================================================================\n\nexport const RepoConfigSchema = z.object({\n  id: z.string(),\n  orgId: z.string(),\n  provider: GitProviderSchema,\n  owner: z.string(),\n  repo: z.string(),\n  branch: z.string().default(\"main\"),\n  path: z.string().default(\".gicm/pipelines\"), // Where pipeline YAML files live\n  accessToken: z.string().optional(), // Encrypted\n  webhookSecret: z.string().optional(), // For validating webhooks\n  syncEnabled: z.boolean().default(true),\n  autoSync: z.boolean().default(true), // Auto-sync on push\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\nexport type RepoConfig = z.infer<typeof RepoConfigSchema>;\n\nexport const CreateRepoConfigSchema = RepoConfigSchema.omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type CreateRepoConfig = z.infer<typeof CreateRepoConfigSchema>;\n\n// =============================================================================\n// PIPELINE YAML FORMAT\n// =============================================================================\n\nexport const PipelineYAMLStepSchema = z.object({\n  id: z.string(),\n  name: z.string(),\n  tool: z.string(),\n  config: z.record(z.unknown()).optional(),\n  timeout: z.number().optional(),\n  retries: z.number().optional(),\n  condition: z.string().optional(), // e.g., \"previous.success\"\n  dependsOn: z.array(z.string()).optional(),\n});\nexport type PipelineYAMLStep = z.infer<typeof PipelineYAMLStepSchema>;\n\nexport const PipelineYAMLSchema = z.object({\n  version: z.literal(\"1.0\"),\n  name: z.string(),\n  description: z.string().optional(),\n  schedule: z.string().optional(), // Cron expression\n  trigger: z.object({\n    events: z.array(z.enum([\"push\", \"pull_request\", \"schedule\", \"manual\", \"webhook\"])).optional(),\n    branches: z.array(z.string()).optional(),\n    paths: z.array(z.string()).optional(),\n  }).optional(),\n  env: z.record(z.string()).optional(),\n  steps: z.array(PipelineYAMLStepSchema),\n  notifications: z.object({\n    onSuccess: z.array(z.string()).optional(), // Webhook URLs\n    onFailure: z.array(z.string()).optional(),\n  }).optional(),\n  budget: z.object({\n    maxCostPerRun: z.number().optional(),\n    maxDailyCost: z.number().optional(),\n  }).optional(),\n});\nexport type PipelineYAML = z.infer<typeof PipelineYAMLSchema>;\n\n// =============================================================================\n// SYNC STATUS\n// =============================================================================\n\nexport const SyncStatusSchema = z.enum([\n  \"synced\",\n  \"pending\",\n  \"syncing\",\n  \"conflict\",\n  \"error\",\n]);\nexport type SyncStatus = z.infer<typeof SyncStatusSchema>;\n\nexport const SyncRecordSchema = z.object({\n  id: z.string(),\n  repoConfigId: z.string(),\n  pipelineId: z.string(),\n  filePath: z.string(),\n  commitSha: z.string(),\n  status: SyncStatusSchema,\n  direction: z.enum([\"pull\", \"push\"]),\n  message: z.string().optional(),\n  createdAt: z.string(),\n});\nexport type SyncRecord = z.infer<typeof SyncRecordSchema>;\n\n// =============================================================================\n// WEBHOOK EVENTS\n// =============================================================================\n\nexport const GitWebhookEventSchema = z.object({\n  id: z.string(),\n  provider: GitProviderSchema,\n  event: z.string(), // \"push\", \"pull_request\", etc.\n  action: z.string().optional(), // \"opened\", \"closed\", etc.\n  repo: z.object({\n    owner: z.string(),\n    name: z.string(),\n  }),\n  ref: z.string().optional(), // \"refs/heads/main\"\n  commit: z.object({\n    sha: z.string(),\n    message: z.string(),\n    author: z.string(),\n  }).optional(),\n  pullRequest: z.object({\n    number: z.number(),\n    title: z.string(),\n    state: z.string(),\n    sourceBranch: z.string(),\n    targetBranch: z.string(),\n  }).optional(),\n  sender: z.object({\n    login: z.string(),\n    avatarUrl: z.string().optional(),\n  }),\n  receivedAt: z.string(),\n});\nexport type GitWebhookEvent = z.infer<typeof GitWebhookEventSchema>;\n\n// =============================================================================\n// DIFF & CHANGES\n// =============================================================================\n\nexport const FileChangeSchema = z.object({\n  path: z.string(),\n  status: z.enum([\"added\", \"modified\", \"deleted\", \"renamed\"]),\n  oldPath: z.string().optional(), // For renames\n  additions: z.number(),\n  deletions: z.number(),\n});\nexport type FileChange = z.infer<typeof FileChangeSchema>;\n\nexport const PipelineChangeSchema = z.object({\n  pipelineId: z.string().optional(), // Null for new pipelines\n  pipelineName: z.string(),\n  filePath: z.string(),\n  changeType: z.enum([\"create\", \"update\", \"delete\"]),\n  oldYaml: PipelineYAMLSchema.optional(),\n  newYaml: PipelineYAMLSchema.optional(),\n  diff: z.string().optional(), // Unified diff format\n});\nexport type PipelineChange = z.infer<typeof PipelineChangeSchema>;\n\n// =============================================================================\n// PR-BASED CHANGES\n// =============================================================================\n\nexport const PipelinePRSchema = z.object({\n  id: z.string(),\n  repoConfigId: z.string(),\n  prNumber: z.number(),\n  title: z.string(),\n  description: z.string().optional(),\n  status: z.enum([\"open\", \"merged\", \"closed\"]),\n  changes: z.array(PipelineChangeSchema),\n  author: z.string(),\n  createdAt: z.string(),\n  mergedAt: z.string().optional(),\n  reviewStatus: z.enum([\"pending\", \"approved\", \"changes_requested\"]).optional(),\n});\nexport type PipelinePR = z.infer<typeof PipelinePRSchema>;\n\n// =============================================================================\n// GIT MANAGER CONFIG\n// =============================================================================\n\nexport const GitManagerConfigSchema = z.object({\n  // Default provider settings\n  defaultProvider: GitProviderSchema.default(\"github\"),\n\n  // Sync settings\n  syncIntervalMs: z.number().default(60000), // 1 minute\n  maxConcurrentSyncs: z.number().default(5),\n\n  // Conflict resolution\n  conflictStrategy: z.enum([\"local_wins\", \"remote_wins\", \"manual\"]).default(\"manual\"),\n\n  // Webhook settings\n  webhookPath: z.string().default(\"/api/git/webhook\"),\n\n  // Security\n  encryptTokens: z.boolean().default(true),\n});\nexport type GitManagerConfig = z.infer<typeof GitManagerConfigSchema>;\n\n// =============================================================================\n// EVENTS\n// =============================================================================\n\nexport interface GitEvents {\n  \"repo:connected\": (repo: RepoConfig) => void;\n  \"repo:disconnected\": (repoId: string) => void;\n  \"sync:started\": (repoId: string, direction: \"pull\" | \"push\") => void;\n  \"sync:completed\": (record: SyncRecord) => void;\n  \"sync:failed\": (repoId: string, error: Error) => void;\n  \"webhook:received\": (event: GitWebhookEvent) => void;\n  \"pipeline:imported\": (pipelineId: string, filePath: string) => void;\n  \"pipeline:exported\": (pipelineId: string, filePath: string) => void;\n  \"conflict:detected\": (pipelineId: string, filePath: string) => void;\n  \"pr:opened\": (pr: PipelinePR) => void;\n  \"pr:merged\": (pr: PipelinePR) => void;\n}\n","/**\n * Pipeline YAML Parser\n *\n * Converts between Pipeline objects and YAML format\n */\n\nimport { parse as parseYAML, stringify as stringifyYAML } from \"yaml\";\nimport {\n  PipelineYAMLSchema,\n  type PipelineYAML,\n  type PipelineYAMLStep,\n} from \"./types.js\";\n\n// =============================================================================\n// PARSE YAML TO PIPELINE\n// =============================================================================\n\nexport interface ParseResult {\n  success: boolean;\n  pipeline?: PipelineYAML;\n  errors?: string[];\n}\n\n/**\n * Parse YAML string to PipelineYAML object\n */\nexport function parsePipelineYAML(yamlContent: string): ParseResult {\n  try {\n    const parsed = parseYAML(yamlContent);\n\n    // Validate against schema\n    const result = PipelineYAMLSchema.safeParse(parsed);\n\n    if (!result.success) {\n      return {\n        success: false,\n        errors: result.error.errors.map(\n          (e) => `${e.path.join(\".\")}: ${e.message}`\n        ),\n      };\n    }\n\n    return {\n      success: true,\n      pipeline: result.data,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      errors: [error instanceof Error ? error.message : \"Invalid YAML syntax\"],\n    };\n  }\n}\n\n/**\n * Convert PipelineYAML to YAML string\n */\nexport function stringifyPipelineYAML(pipeline: PipelineYAML): string {\n  return stringifyYAML(pipeline, {\n    indent: 2,\n    lineWidth: 120,\n    defaultStringType: \"QUOTE_DOUBLE\",\n    defaultKeyType: \"PLAIN\",\n  });\n}\n\n// =============================================================================\n// CONVERT TO/FROM INTERNAL PIPELINE FORMAT\n// =============================================================================\n\nexport interface InternalPipeline {\n  id: string;\n  name: string;\n  description?: string;\n  schedule?: string;\n  steps: InternalPipelineStep[];\n  metadata?: Record<string, unknown>;\n}\n\nexport interface InternalPipelineStep {\n  id: string;\n  name: string;\n  toolId: string;\n  config?: Record<string, unknown>;\n  timeout?: number;\n  retries?: number;\n  condition?: string;\n  dependsOn?: string[];\n}\n\n/**\n * Convert YAML pipeline to internal format\n */\nexport function yamlToInternal(\n  yaml: PipelineYAML,\n  existingId?: string\n): InternalPipeline {\n  return {\n    id: existingId || generateId(\"pipeline\"),\n    name: yaml.name,\n    description: yaml.description,\n    schedule: yaml.schedule,\n    steps: yaml.steps.map((step) => ({\n      id: step.id || generateId(\"step\"),\n      name: step.name,\n      toolId: step.tool,\n      config: step.config as Record<string, unknown> | undefined,\n      timeout: step.timeout,\n      retries: step.retries,\n      condition: step.condition,\n      dependsOn: step.dependsOn,\n    })),\n    metadata: {\n      trigger: yaml.trigger,\n      env: yaml.env,\n      notifications: yaml.notifications,\n      budget: yaml.budget,\n      yamlVersion: yaml.version,\n    },\n  };\n}\n\n/**\n * Convert internal pipeline to YAML format\n */\nexport function internalToYAML(pipeline: InternalPipeline): PipelineYAML {\n  const metadata = pipeline.metadata || {};\n\n  return {\n    version: \"1.0\",\n    name: pipeline.name,\n    description: pipeline.description,\n    schedule: pipeline.schedule,\n    trigger: metadata.trigger as PipelineYAML[\"trigger\"],\n    env: metadata.env as Record<string, string> | undefined,\n    steps: pipeline.steps.map((step) => ({\n      id: step.id,\n      name: step.name,\n      tool: step.toolId,\n      config: step.config,\n      timeout: step.timeout,\n      retries: step.retries,\n      condition: step.condition,\n      dependsOn: step.dependsOn,\n    })),\n    notifications: metadata.notifications as PipelineYAML[\"notifications\"],\n    budget: metadata.budget as PipelineYAML[\"budget\"],\n  };\n}\n\n// =============================================================================\n// VALIDATION\n// =============================================================================\n\nexport interface ValidationResult {\n  valid: boolean;\n  errors: ValidationError[];\n  warnings: ValidationWarning[];\n}\n\nexport interface ValidationError {\n  path: string;\n  message: string;\n  severity: \"error\";\n}\n\nexport interface ValidationWarning {\n  path: string;\n  message: string;\n  severity: \"warning\";\n}\n\n/**\n * Validate a pipeline YAML with detailed feedback\n */\nexport function validatePipelineYAML(yaml: PipelineYAML): ValidationResult {\n  const errors: ValidationError[] = [];\n  const warnings: ValidationWarning[] = [];\n\n  // Check for unique step IDs\n  const stepIds = new Set<string>();\n  for (const step of yaml.steps) {\n    if (stepIds.has(step.id)) {\n      errors.push({\n        path: `steps.${step.id}`,\n        message: `Duplicate step ID: ${step.id}`,\n        severity: \"error\",\n      });\n    }\n    stepIds.add(step.id);\n  }\n\n  // Check dependsOn references\n  for (const step of yaml.steps) {\n    if (step.dependsOn) {\n      for (const dep of step.dependsOn) {\n        if (!stepIds.has(dep)) {\n          errors.push({\n            path: `steps.${step.id}.dependsOn`,\n            message: `Unknown dependency: ${dep}`,\n            severity: \"error\",\n          });\n        }\n      }\n    }\n  }\n\n  // Check for circular dependencies\n  const circularDeps = detectCircularDependencies(yaml.steps);\n  if (circularDeps.length > 0) {\n    errors.push({\n      path: \"steps\",\n      message: `Circular dependency detected: ${circularDeps.join(\" -> \")}`,\n      severity: \"error\",\n    });\n  }\n\n  // Warn about missing descriptions\n  if (!yaml.description) {\n    warnings.push({\n      path: \"description\",\n      message: \"Pipeline description is recommended\",\n      severity: \"warning\",\n    });\n  }\n\n  // Warn about steps without timeout\n  for (const step of yaml.steps) {\n    if (!step.timeout) {\n      warnings.push({\n        path: `steps.${step.id}.timeout`,\n        message: `Step \"${step.name}\" has no timeout set`,\n        severity: \"warning\",\n      });\n    }\n  }\n\n  // Warn about no budget set\n  if (!yaml.budget) {\n    warnings.push({\n      path: \"budget\",\n      message: \"No budget limits configured\",\n      severity: \"warning\",\n    });\n  }\n\n  return {\n    valid: errors.length === 0,\n    errors,\n    warnings,\n  };\n}\n\n/**\n * Detect circular dependencies in steps\n */\nfunction detectCircularDependencies(steps: PipelineYAMLStep[]): string[] {\n  const graph = new Map<string, string[]>();\n\n  for (const step of steps) {\n    graph.set(step.id, step.dependsOn || []);\n  }\n\n  const visited = new Set<string>();\n  const recursionStack = new Set<string>();\n  const path: string[] = [];\n\n  function dfs(nodeId: string): string[] | null {\n    visited.add(nodeId);\n    recursionStack.add(nodeId);\n    path.push(nodeId);\n\n    const neighbors = graph.get(nodeId) || [];\n    for (const neighbor of neighbors) {\n      if (!visited.has(neighbor)) {\n        const result = dfs(neighbor);\n        if (result) return result;\n      } else if (recursionStack.has(neighbor)) {\n        // Found cycle\n        const cycleStart = path.indexOf(neighbor);\n        return [...path.slice(cycleStart), neighbor];\n      }\n    }\n\n    path.pop();\n    recursionStack.delete(nodeId);\n    return null;\n  }\n\n  for (const step of steps) {\n    if (!visited.has(step.id)) {\n      const cycle = dfs(step.id);\n      if (cycle) return cycle;\n    }\n  }\n\n  return [];\n}\n\n// =============================================================================\n// DIFF GENERATION\n// =============================================================================\n\n/**\n * Generate a human-readable diff between two pipeline YAMLs\n */\nexport function generatePipelineDiff(\n  oldYaml: PipelineYAML | undefined,\n  newYaml: PipelineYAML | undefined\n): string {\n  if (!oldYaml && !newYaml) return \"\";\n  if (!oldYaml) return `+ New pipeline: ${newYaml!.name}`;\n  if (!newYaml) return `- Deleted pipeline: ${oldYaml.name}`;\n\n  const changes: string[] = [];\n\n  // Name change\n  if (oldYaml.name !== newYaml.name) {\n    changes.push(`~ name: \"${oldYaml.name}\" -> \"${newYaml.name}\"`);\n  }\n\n  // Description change\n  if (oldYaml.description !== newYaml.description) {\n    changes.push(`~ description changed`);\n  }\n\n  // Schedule change\n  if (oldYaml.schedule !== newYaml.schedule) {\n    changes.push(\n      `~ schedule: \"${oldYaml.schedule || \"none\"}\" -> \"${newYaml.schedule || \"none\"}\"`\n    );\n  }\n\n  // Steps changes\n  const oldStepIds = new Set(oldYaml.steps.map((s) => s.id));\n  const newStepIds = new Set(newYaml.steps.map((s) => s.id));\n\n  // Added steps\n  for (const step of newYaml.steps) {\n    if (!oldStepIds.has(step.id)) {\n      changes.push(`+ step: ${step.name} (${step.id})`);\n    }\n  }\n\n  // Removed steps\n  for (const step of oldYaml.steps) {\n    if (!newStepIds.has(step.id)) {\n      changes.push(`- step: ${step.name} (${step.id})`);\n    }\n  }\n\n  // Modified steps\n  for (const newStep of newYaml.steps) {\n    const oldStep = oldYaml.steps.find((s) => s.id === newStep.id);\n    if (oldStep) {\n      if (\n        oldStep.name !== newStep.name ||\n        oldStep.tool !== newStep.tool ||\n        JSON.stringify(oldStep.config) !== JSON.stringify(newStep.config)\n      ) {\n        changes.push(`~ step modified: ${newStep.name} (${newStep.id})`);\n      }\n    }\n  }\n\n  return changes.length > 0\n    ? changes.join(\"\\n\")\n    : \"No changes detected\";\n}\n\n// =============================================================================\n// HELPERS\n// =============================================================================\n\nfunction generateId(prefix: string): string {\n  return `${prefix}_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`;\n}\n\n// =============================================================================\n// EXAMPLE YAML TEMPLATES\n// =============================================================================\n\nexport const EXAMPLE_PIPELINES = {\n  basic: `version: \"1.0\"\nname: \"Basic Pipeline\"\ndescription: \"A simple example pipeline\"\n\nsteps:\n  - id: step1\n    name: \"Fetch Data\"\n    tool: http_request\n    config:\n      url: \"https://api.example.com/data\"\n      method: GET\n    timeout: 30000\n\n  - id: step2\n    name: \"Process Data\"\n    tool: transform\n    config:\n      template: \"{{ step1.data | json }}\"\n    dependsOn:\n      - step1\n`,\n\n  scheduled: `version: \"1.0\"\nname: \"Scheduled Report\"\ndescription: \"Daily report generation\"\nschedule: \"0 9 * * *\"  # Every day at 9am\n\ntrigger:\n  events:\n    - schedule\n\nsteps:\n  - id: gather\n    name: \"Gather Metrics\"\n    tool: analytics_query\n    config:\n      query: \"SELECT * FROM metrics WHERE date = TODAY()\"\n    timeout: 60000\n\n  - id: format\n    name: \"Format Report\"\n    tool: template_render\n    config:\n      template: \"report.md\"\n    dependsOn:\n      - gather\n\n  - id: send\n    name: \"Send Email\"\n    tool: email_send\n    config:\n      to: \"team@example.com\"\n      subject: \"Daily Report\"\n    dependsOn:\n      - format\n\nnotifications:\n  onSuccess:\n    - \"https://hooks.slack.com/xxx\"\n  onFailure:\n    - \"https://hooks.slack.com/xxx\"\n\nbudget:\n  maxCostPerRun: 1.00\n  maxDailyCost: 10.00\n`,\n\n  cicd: `version: \"1.0\"\nname: \"CI/CD Pipeline\"\ndescription: \"Build and deploy on push to main\"\n\ntrigger:\n  events:\n    - push\n  branches:\n    - main\n  paths:\n    - \"src/**\"\n    - \"package.json\"\n\nenv:\n  NODE_ENV: production\n  DEPLOY_TARGET: vercel\n\nsteps:\n  - id: test\n    name: \"Run Tests\"\n    tool: shell_exec\n    config:\n      command: \"npm test\"\n    timeout: 300000\n\n  - id: build\n    name: \"Build Project\"\n    tool: shell_exec\n    config:\n      command: \"npm run build\"\n    dependsOn:\n      - test\n    timeout: 300000\n\n  - id: deploy\n    name: \"Deploy\"\n    tool: vercel_deploy\n    config:\n      project: \"my-app\"\n      production: true\n    dependsOn:\n      - build\n    condition: \"steps.build.success\"\n`,\n};\n","/**\n * Git Manager\n *\n * Manages Git repository connections and pipeline synchronization\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport {\n  type GitProvider,\n  type RepoConfig,\n  type CreateRepoConfig,\n  type SyncRecord,\n  type SyncStatus,\n  type GitWebhookEvent,\n  type PipelineYAML,\n  type PipelineChange,\n  type GitManagerConfig,\n  type GitEvents,\n  GitManagerConfigSchema,\n  RepoConfigSchema,\n} from \"./types.js\";\nimport {\n  parsePipelineYAML,\n  stringifyPipelineYAML,\n  validatePipelineYAML,\n  generatePipelineDiff,\n  yamlToInternal,\n  internalToYAML,\n  type InternalPipeline,\n} from \"./yaml-parser.js\";\n\n// =============================================================================\n// GITHUB CLIENT\n// =============================================================================\n\ninterface GitHubFile {\n  name: string;\n  path: string;\n  sha: string;\n  size: number;\n  type: \"file\" | \"dir\";\n  content?: string;\n  encoding?: string;\n}\n\ninterface GitHubCommit {\n  sha: string;\n  message: string;\n  author: {\n    name: string;\n    email: string;\n    date: string;\n  };\n}\n\nclass GitHubClient {\n  private token: string;\n  private baseUrl = \"https://api.github.com\";\n\n  constructor(token: string) {\n    this.token = token;\n  }\n\n  private async request<T>(\n    method: string,\n    path: string,\n    body?: unknown\n  ): Promise<T> {\n    const response = await fetch(`${this.baseUrl}${path}`, {\n      method,\n      headers: {\n        Accept: \"application/vnd.github.v3+json\",\n        Authorization: `Bearer ${this.token}`,\n        \"Content-Type\": \"application/json\",\n      },\n      body: body ? JSON.stringify(body) : undefined,\n    });\n\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`GitHub API error: ${response.status} - ${error}`);\n    }\n\n    return response.json();\n  }\n\n  async getFile(\n    owner: string,\n    repo: string,\n    path: string,\n    ref?: string\n  ): Promise<GitHubFile | null> {\n    try {\n      const query = ref ? `?ref=${ref}` : \"\";\n      return await this.request<GitHubFile>(\n        \"GET\",\n        `/repos/${owner}/${repo}/contents/${path}${query}`\n      );\n    } catch {\n      return null;\n    }\n  }\n\n  async listFiles(\n    owner: string,\n    repo: string,\n    path: string,\n    ref?: string\n  ): Promise<GitHubFile[]> {\n    try {\n      const query = ref ? `?ref=${ref}` : \"\";\n      const result = await this.request<GitHubFile | GitHubFile[]>(\n        \"GET\",\n        `/repos/${owner}/${repo}/contents/${path}${query}`\n      );\n      return Array.isArray(result) ? result : [result];\n    } catch {\n      return [];\n    }\n  }\n\n  async createOrUpdateFile(\n    owner: string,\n    repo: string,\n    path: string,\n    content: string,\n    message: string,\n    sha?: string,\n    branch?: string\n  ): Promise<{ sha: string; commit: GitHubCommit }> {\n    const body: Record<string, unknown> = {\n      message,\n      content: Buffer.from(content).toString(\"base64\"),\n    };\n    if (sha) body.sha = sha;\n    if (branch) body.branch = branch;\n\n    const result = await this.request<{\n      content: { sha: string };\n      commit: GitHubCommit;\n    }>(\"PUT\", `/repos/${owner}/${repo}/contents/${path}`, body);\n\n    return {\n      sha: result.content.sha,\n      commit: result.commit,\n    };\n  }\n\n  async deleteFile(\n    owner: string,\n    repo: string,\n    path: string,\n    sha: string,\n    message: string,\n    branch?: string\n  ): Promise<void> {\n    const body: Record<string, unknown> = { message, sha };\n    if (branch) body.branch = branch;\n\n    await this.request(\"DELETE\", `/repos/${owner}/${repo}/contents/${path}`, body);\n  }\n\n  async getLatestCommit(\n    owner: string,\n    repo: string,\n    branch: string\n  ): Promise<GitHubCommit> {\n    const result = await this.request<{ sha: string; commit: GitHubCommit }>(\n      \"GET\",\n      `/repos/${owner}/${repo}/commits/${branch}`\n    );\n    return { ...result.commit, sha: result.sha };\n  }\n\n  async createWebhook(\n    owner: string,\n    repo: string,\n    webhookUrl: string,\n    secret: string,\n    events: string[] = [\"push\", \"pull_request\"]\n  ): Promise<{ id: number }> {\n    return this.request(\"POST\", `/repos/${owner}/${repo}/hooks`, {\n      name: \"web\",\n      active: true,\n      events,\n      config: {\n        url: webhookUrl,\n        content_type: \"json\",\n        secret,\n      },\n    });\n  }\n\n  async deleteWebhook(\n    owner: string,\n    repo: string,\n    hookId: number\n  ): Promise<void> {\n    await this.request(\"DELETE\", `/repos/${owner}/${repo}/hooks/${hookId}`);\n  }\n}\n\n// =============================================================================\n// GIT MANAGER\n// =============================================================================\n\nexport class GitManager extends EventEmitter<GitEvents> {\n  private config: GitManagerConfig;\n  private repos: Map<string, RepoConfig> = new Map();\n  private clients: Map<string, GitHubClient> = new Map();\n  private syncRecords: Map<string, SyncRecord[]> = new Map();\n  private fileShas: Map<string, string> = new Map(); // path -> sha\n\n  constructor(config: Partial<GitManagerConfig> = {}) {\n    super();\n    this.config = GitManagerConfigSchema.parse(config);\n  }\n\n  // ===========================================================================\n  // REPOSITORY MANAGEMENT\n  // ===========================================================================\n\n  /**\n   * Connect a Git repository\n   */\n  async connectRepo(config: CreateRepoConfig): Promise<RepoConfig> {\n    const repo: RepoConfig = {\n      ...config,\n      id: generateId(\"repo\"),\n      createdAt: new Date().toISOString(),\n      updatedAt: new Date().toISOString(),\n    };\n\n    // Validate connection\n    if (repo.accessToken) {\n      const client = this.getClient(repo);\n      await client.getLatestCommit(repo.owner, repo.repo, repo.branch);\n    }\n\n    this.repos.set(repo.id, repo);\n    this.emit(\"repo:connected\", repo);\n\n    // Initial sync\n    if (repo.syncEnabled) {\n      await this.pullPipelines(repo.id);\n    }\n\n    return repo;\n  }\n\n  /**\n   * Disconnect a repository\n   */\n  async disconnectRepo(repoId: string): Promise<void> {\n    const repo = this.repos.get(repoId);\n    if (!repo) throw new Error(`Repository not found: ${repoId}`);\n\n    this.repos.delete(repoId);\n    this.clients.delete(repoId);\n    this.emit(\"repo:disconnected\", repoId);\n  }\n\n  /**\n   * Get repository by ID\n   */\n  getRepo(repoId: string): RepoConfig | undefined {\n    return this.repos.get(repoId);\n  }\n\n  /**\n   * List all connected repositories\n   */\n  listRepos(): RepoConfig[] {\n    return Array.from(this.repos.values());\n  }\n\n  // ===========================================================================\n  // SYNC OPERATIONS\n  // ===========================================================================\n\n  /**\n   * Pull pipelines from repository\n   */\n  async pullPipelines(repoId: string): Promise<PipelineChange[]> {\n    const repo = this.repos.get(repoId);\n    if (!repo) throw new Error(`Repository not found: ${repoId}`);\n\n    this.emit(\"sync:started\", repoId, \"pull\");\n\n    try {\n      const client = this.getClient(repo);\n      const files = await client.listFiles(repo.owner, repo.repo, repo.path, repo.branch);\n      const changes: PipelineChange[] = [];\n\n      for (const file of files) {\n        if (file.type === \"file\" && (file.name.endsWith(\".yaml\") || file.name.endsWith(\".yml\"))) {\n          const fileData = await client.getFile(\n            repo.owner,\n            repo.repo,\n            file.path,\n            repo.branch\n          );\n\n          if (fileData?.content) {\n            const content = Buffer.from(fileData.content, \"base64\").toString(\"utf-8\");\n            const parseResult = parsePipelineYAML(content);\n\n            if (parseResult.success && parseResult.pipeline) {\n              // Store SHA for future updates\n              this.fileShas.set(file.path, fileData.sha);\n\n              changes.push({\n                pipelineName: parseResult.pipeline.name,\n                filePath: file.path,\n                changeType: \"create\", // TODO: Compare with existing\n                newYaml: parseResult.pipeline,\n              });\n\n              this.emit(\"pipeline:imported\", parseResult.pipeline.name, file.path);\n            }\n          }\n        }\n      }\n\n      // Record sync\n      const record: SyncRecord = {\n        id: generateId(\"sync\"),\n        repoConfigId: repoId,\n        pipelineId: \"multiple\",\n        filePath: repo.path,\n        commitSha: \"latest\",\n        status: \"synced\",\n        direction: \"pull\",\n        message: `Pulled ${changes.length} pipelines`,\n        createdAt: new Date().toISOString(),\n      };\n\n      this.addSyncRecord(repoId, record);\n      this.emit(\"sync:completed\", record);\n\n      return changes;\n    } catch (error) {\n      const err = error instanceof Error ? error : new Error(String(error));\n      this.emit(\"sync:failed\", repoId, err);\n      throw err;\n    }\n  }\n\n  /**\n   * Push a pipeline to repository\n   */\n  async pushPipeline(\n    repoId: string,\n    pipeline: InternalPipeline,\n    commitMessage?: string\n  ): Promise<SyncRecord> {\n    const repo = this.repos.get(repoId);\n    if (!repo) throw new Error(`Repository not found: ${repoId}`);\n\n    this.emit(\"sync:started\", repoId, \"push\");\n\n    try {\n      const client = this.getClient(repo);\n      const yaml = internalToYAML(pipeline);\n\n      // Validate before push\n      const validation = validatePipelineYAML(yaml);\n      if (!validation.valid) {\n        throw new Error(`Invalid pipeline: ${validation.errors.map((e) => e.message).join(\", \")}`);\n      }\n\n      const content = stringifyPipelineYAML(yaml);\n      const fileName = `${pipeline.id}.yaml`;\n      const filePath = `${repo.path}/${fileName}`;\n      const existingSha = this.fileShas.get(filePath);\n\n      const result = await client.createOrUpdateFile(\n        repo.owner,\n        repo.repo,\n        filePath,\n        content,\n        commitMessage || `Update pipeline: ${pipeline.name}`,\n        existingSha,\n        repo.branch\n      );\n\n      // Update SHA\n      this.fileShas.set(filePath, result.sha);\n\n      const record: SyncRecord = {\n        id: generateId(\"sync\"),\n        repoConfigId: repoId,\n        pipelineId: pipeline.id,\n        filePath,\n        commitSha: result.commit.sha,\n        status: \"synced\",\n        direction: \"push\",\n        message: `Pushed pipeline: ${pipeline.name}`,\n        createdAt: new Date().toISOString(),\n      };\n\n      this.addSyncRecord(repoId, record);\n      this.emit(\"sync:completed\", record);\n      this.emit(\"pipeline:exported\", pipeline.id, filePath);\n\n      return record;\n    } catch (error) {\n      const err = error instanceof Error ? error : new Error(String(error));\n      this.emit(\"sync:failed\", repoId, err);\n      throw err;\n    }\n  }\n\n  /**\n   * Delete a pipeline from repository\n   */\n  async deletePipeline(repoId: string, pipelineId: string): Promise<void> {\n    const repo = this.repos.get(repoId);\n    if (!repo) throw new Error(`Repository not found: ${repoId}`);\n\n    const client = this.getClient(repo);\n    const fileName = `${pipelineId}.yaml`;\n    const filePath = `${repo.path}/${fileName}`;\n    const sha = this.fileShas.get(filePath);\n\n    if (!sha) {\n      throw new Error(`Pipeline file not found: ${filePath}`);\n    }\n\n    await client.deleteFile(\n      repo.owner,\n      repo.repo,\n      filePath,\n      sha,\n      `Delete pipeline: ${pipelineId}`,\n      repo.branch\n    );\n\n    this.fileShas.delete(filePath);\n  }\n\n  // ===========================================================================\n  // WEBHOOK HANDLING\n  // ===========================================================================\n\n  /**\n   * Handle incoming webhook from Git provider\n   */\n  async handleWebhook(\n    provider: GitProvider,\n    payload: unknown,\n    signature?: string\n  ): Promise<void> {\n    // Parse webhook event\n    const event = this.parseWebhookPayload(provider, payload);\n    this.emit(\"webhook:received\", event);\n\n    // Find matching repository\n    const repo = Array.from(this.repos.values()).find(\n      (r) =>\n        r.provider === provider &&\n        r.owner === event.repo.owner &&\n        r.repo === event.repo.name\n    );\n\n    if (!repo || !repo.autoSync) return;\n\n    // Handle different event types\n    if (event.event === \"push\" && event.ref === `refs/heads/${repo.branch}`) {\n      // Auto-sync on push to tracked branch\n      await this.pullPipelines(repo.id);\n    }\n  }\n\n  /**\n   * Parse webhook payload into normalized format\n   */\n  private parseWebhookPayload(\n    provider: GitProvider,\n    payload: unknown\n  ): GitWebhookEvent {\n    const p = payload as Record<string, unknown>;\n\n    if (provider === \"github\") {\n      const repo = p.repository as Record<string, unknown>;\n      const sender = p.sender as Record<string, unknown>;\n      const headCommit = p.head_commit as Record<string, unknown> | undefined;\n\n      return {\n        id: generateId(\"webhook\"),\n        provider,\n        event: (p[\"X-GitHub-Event\"] as string) || \"push\",\n        action: p.action as string | undefined,\n        repo: {\n          owner: (repo.owner as Record<string, unknown>)?.login as string || \"\",\n          name: repo.name as string || \"\",\n        },\n        ref: p.ref as string | undefined,\n        commit: headCommit\n          ? {\n              sha: headCommit.id as string,\n              message: headCommit.message as string,\n              author: (headCommit.author as Record<string, unknown>)?.name as string || \"\",\n            }\n          : undefined,\n        sender: {\n          login: sender?.login as string || \"\",\n          avatarUrl: sender?.avatar_url as string | undefined,\n        },\n        receivedAt: new Date().toISOString(),\n      };\n    }\n\n    // Add GitLab, Bitbucket parsing here\n    throw new Error(`Unsupported provider: ${provider}`);\n  }\n\n  /**\n   * Setup webhook for a repository\n   */\n  async setupWebhook(\n    repoId: string,\n    webhookUrl: string\n  ): Promise<{ webhookId: number; secret: string }> {\n    const repo = this.repos.get(repoId);\n    if (!repo) throw new Error(`Repository not found: ${repoId}`);\n\n    const client = this.getClient(repo);\n    const secret = generateSecret();\n\n    const result = await client.createWebhook(\n      repo.owner,\n      repo.repo,\n      webhookUrl,\n      secret\n    );\n\n    // Update repo config with secret\n    repo.webhookSecret = secret;\n    this.repos.set(repoId, repo);\n\n    return { webhookId: result.id, secret };\n  }\n\n  // ===========================================================================\n  // SYNC HISTORY\n  // ===========================================================================\n\n  /**\n   * Get sync history for a repository\n   */\n  getSyncHistory(repoId: string): SyncRecord[] {\n    return this.syncRecords.get(repoId) || [];\n  }\n\n  /**\n   * Get latest sync record\n   */\n  getLatestSync(repoId: string): SyncRecord | undefined {\n    const records = this.syncRecords.get(repoId);\n    return records?.[records.length - 1];\n  }\n\n  private addSyncRecord(repoId: string, record: SyncRecord): void {\n    const records = this.syncRecords.get(repoId) || [];\n    records.push(record);\n    // Keep last 100 records\n    if (records.length > 100) records.shift();\n    this.syncRecords.set(repoId, records);\n  }\n\n  // ===========================================================================\n  // HELPERS\n  // ===========================================================================\n\n  private getClient(repo: RepoConfig): GitHubClient {\n    if (!repo.accessToken) {\n      throw new Error(\"No access token configured for repository\");\n    }\n\n    let client = this.clients.get(repo.id);\n    if (!client) {\n      client = new GitHubClient(repo.accessToken);\n      this.clients.set(repo.id, client);\n    }\n    return client;\n  }\n}\n\n// =============================================================================\n// SINGLETON\n// =============================================================================\n\nlet instance: GitManager | null = null;\n\nexport function getGitManager(config?: Partial<GitManagerConfig>): GitManager {\n  if (!instance) {\n    instance = new GitManager(config);\n  }\n  return instance;\n}\n\nexport function createGitManager(config?: Partial<GitManagerConfig>): GitManager {\n  return new GitManager(config);\n}\n\n// =============================================================================\n// HELPERS\n// =============================================================================\n\nfunction generateId(prefix: string): string {\n  return `${prefix}_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`;\n}\n\nfunction generateSecret(): string {\n  const chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n  let result = \"\";\n  for (let i = 0; i < 32; i++) {\n    result += chars.charAt(Math.floor(Math.random() * chars.length));\n  }\n  return result;\n}\n\nexport default GitManager;\n","/**\n * Chat Integration Types\n * Phase 11B: Slack/Discord Bot\n */\n\nimport { z } from \"zod\";\n\n// ============================================================================\n// Platform Types\n// ============================================================================\n\nexport const ChatPlatformSchema = z.enum([\"slack\", \"discord\", \"telegram\", \"teams\"]);\nexport type ChatPlatform = z.infer<typeof ChatPlatformSchema>;\n\nexport const ConnectionStatusSchema = z.enum([\n  \"connected\",\n  \"disconnected\",\n  \"connecting\",\n  \"error\",\n]);\nexport type ConnectionStatus = z.infer<typeof ConnectionStatusSchema>;\n\n// ============================================================================\n// Credentials\n// ============================================================================\n\nexport const SlackCredentialsSchema = z.object({\n  botToken: z.string().startsWith(\"xoxb-\"),\n  appToken: z.string().startsWith(\"xapp-\").optional(),\n  signingSecret: z.string().optional(),\n  clientId: z.string().optional(),\n  clientSecret: z.string().optional(),\n});\nexport type SlackCredentials = z.infer<typeof SlackCredentialsSchema>;\n\nexport const DiscordCredentialsSchema = z.object({\n  botToken: z.string(),\n  applicationId: z.string(),\n  publicKey: z.string().optional(),\n});\nexport type DiscordCredentials = z.infer<typeof DiscordCredentialsSchema>;\n\nexport const TelegramCredentialsSchema = z.object({\n  botToken: z.string(),\n  webhookSecret: z.string().optional(),\n});\nexport type TelegramCredentials = z.infer<typeof TelegramCredentialsSchema>;\n\nexport const TeamsCredentialsSchema = z.object({\n  appId: z.string(),\n  appPassword: z.string(),\n  tenantId: z.string().optional(),\n});\nexport type TeamsCredentials = z.infer<typeof TeamsCredentialsSchema>;\n\nexport const ChatCredentialsSchema = z.union([\n  z.object({ platform: z.literal(\"slack\"), credentials: SlackCredentialsSchema }),\n  z.object({ platform: z.literal(\"discord\"), credentials: DiscordCredentialsSchema }),\n  z.object({ platform: z.literal(\"telegram\"), credentials: TelegramCredentialsSchema }),\n  z.object({ platform: z.literal(\"teams\"), credentials: TeamsCredentialsSchema }),\n]);\nexport type ChatCredentials = z.infer<typeof ChatCredentialsSchema>;\n\n// ============================================================================\n// Channel & User\n// ============================================================================\n\nexport const ChatChannelSchema = z.object({\n  id: z.string(),\n  platform: ChatPlatformSchema,\n  name: z.string(),\n  type: z.enum([\"channel\", \"dm\", \"group\", \"thread\"]),\n  isPrivate: z.boolean().default(false),\n  memberCount: z.number().optional(),\n  createdAt: z.date().optional(),\n});\nexport type ChatChannel = z.infer<typeof ChatChannelSchema>;\n\nexport const ChatUserSchema = z.object({\n  id: z.string(),\n  platform: ChatPlatformSchema,\n  username: z.string(),\n  displayName: z.string().optional(),\n  email: z.string().email().optional(),\n  avatarUrl: z.string().url().optional(),\n  isBot: z.boolean().default(false),\n  timezone: z.string().optional(),\n});\nexport type ChatUser = z.infer<typeof ChatUserSchema>;\n\n// ============================================================================\n// Messages\n// ============================================================================\n\nexport const MessageAttachmentSchema = z.object({\n  type: z.enum([\"image\", \"file\", \"video\", \"audio\", \"link\"]),\n  url: z.string().url(),\n  name: z.string().optional(),\n  size: z.number().optional(),\n  mimeType: z.string().optional(),\n  thumbnailUrl: z.string().url().optional(),\n});\nexport type MessageAttachment = z.infer<typeof MessageAttachmentSchema>;\n\nexport const MessageBlockSchema = z.object({\n  type: z.enum([\"text\", \"code\", \"quote\", \"divider\", \"header\", \"button\", \"select\"]),\n  content: z.string().optional(),\n  language: z.string().optional(), // For code blocks\n  url: z.string().optional(), // For buttons\n  options: z.array(z.object({ label: z.string(), value: z.string() })).optional(),\n});\nexport type MessageBlock = z.infer<typeof MessageBlockSchema>;\n\nexport const ChatMessageSchema = z.object({\n  id: z.string(),\n  platform: ChatPlatformSchema,\n  channelId: z.string(),\n  userId: z.string(),\n  content: z.string(),\n  blocks: z.array(MessageBlockSchema).optional(),\n  attachments: z.array(MessageAttachmentSchema).optional(),\n  threadId: z.string().optional(),\n  replyToId: z.string().optional(),\n  timestamp: z.date(),\n  editedAt: z.date().optional(),\n  reactions: z.record(z.array(z.string())).optional(), // emoji -> userIds\n});\nexport type ChatMessage = z.infer<typeof ChatMessageSchema>;\n\nexport const SendMessageOptionsSchema = z.object({\n  channelId: z.string(),\n  content: z.string(),\n  blocks: z.array(MessageBlockSchema).optional(),\n  threadId: z.string().optional(),\n  ephemeral: z.boolean().optional(), // Only visible to one user\n  targetUserId: z.string().optional(), // For ephemeral messages\n});\nexport type SendMessageOptions = z.infer<typeof SendMessageOptionsSchema>;\n\n// ============================================================================\n// Commands & Interactions\n// ============================================================================\n\nexport const SlashCommandSchema = z.object({\n  name: z.string().regex(/^[\\w-]+$/),\n  description: z.string().max(100),\n  options: z.array(z.object({\n    name: z.string(),\n    description: z.string(),\n    type: z.enum([\"string\", \"integer\", \"boolean\", \"user\", \"channel\"]),\n    required: z.boolean().default(false),\n    choices: z.array(z.object({ name: z.string(), value: z.string() })).optional(),\n  })).optional(),\n  handler: z.string(), // Pipeline ID to execute\n});\nexport type SlashCommand = z.infer<typeof SlashCommandSchema>;\n\nexport const CommandInvocationSchema = z.object({\n  id: z.string(),\n  command: z.string(),\n  args: z.record(z.unknown()),\n  userId: z.string(),\n  channelId: z.string(),\n  platform: ChatPlatformSchema,\n  timestamp: z.date(),\n  responseUrl: z.string().url().optional(),\n});\nexport type CommandInvocation = z.infer<typeof CommandInvocationSchema>;\n\nexport const ButtonInteractionSchema = z.object({\n  id: z.string(),\n  actionId: z.string(),\n  value: z.string().optional(),\n  userId: z.string(),\n  channelId: z.string(),\n  messageId: z.string(),\n  platform: ChatPlatformSchema,\n  timestamp: z.date(),\n});\nexport type ButtonInteraction = z.infer<typeof ButtonInteractionSchema>;\n\n// ============================================================================\n// Notification Templates\n// ============================================================================\n\nexport const NotificationTypeSchema = z.enum([\n  \"pipeline_started\",\n  \"pipeline_completed\",\n  \"pipeline_failed\",\n  \"step_completed\",\n  \"step_failed\",\n  \"approval_required\",\n  \"budget_warning\",\n  \"budget_exceeded\",\n  \"anomaly_detected\",\n  \"custom\",\n]);\nexport type NotificationType = z.infer<typeof NotificationTypeSchema>;\n\nexport const NotificationTemplateSchema = z.object({\n  id: z.string(),\n  type: NotificationTypeSchema,\n  platform: ChatPlatformSchema,\n  title: z.string(),\n  bodyTemplate: z.string(), // Handlebars-style template\n  color: z.string().optional(), // For embeds/attachments\n  includeDetails: z.boolean().default(true),\n  actions: z.array(z.object({\n    label: z.string(),\n    actionId: z.string(),\n    style: z.enum([\"primary\", \"secondary\", \"danger\"]).optional(),\n  })).optional(),\n});\nexport type NotificationTemplate = z.infer<typeof NotificationTemplateSchema>;\n\nexport const NotificationConfigSchema = z.object({\n  channelId: z.string(),\n  platform: ChatPlatformSchema,\n  enabledTypes: z.array(NotificationTypeSchema),\n  mentionUsers: z.array(z.string()).optional(),\n  mentionRoles: z.array(z.string()).optional(),\n  quietHours: z.object({\n    enabled: z.boolean(),\n    start: z.string(), // HH:mm\n    end: z.string(),\n    timezone: z.string(),\n  }).optional(),\n});\nexport type NotificationConfig = z.infer<typeof NotificationConfigSchema>;\n\n// ============================================================================\n// Bot Configuration\n// ============================================================================\n\nexport const BotConfigSchema = z.object({\n  id: z.string(),\n  platform: ChatPlatformSchema,\n  name: z.string(),\n  status: ConnectionStatusSchema,\n  credentials: z.unknown(), // Platform-specific\n  commands: z.array(SlashCommandSchema).optional(),\n  notifications: z.array(NotificationConfigSchema).optional(),\n  allowedChannels: z.array(z.string()).optional(),\n  adminUsers: z.array(z.string()).optional(),\n  createdAt: z.date(),\n  updatedAt: z.date(),\n});\nexport type BotConfig = z.infer<typeof BotConfigSchema>;\n\nexport const ChatManagerConfigSchema = z.object({\n  bots: z.array(BotConfigSchema).optional(),\n  defaultPlatform: ChatPlatformSchema.optional(),\n  commandPrefix: z.string().default(\"/\"),\n  maxRetries: z.number().default(3),\n  retryDelayMs: z.number().default(1000),\n  rateLimitPerMinute: z.number().default(30),\n});\nexport type ChatManagerConfig = z.infer<typeof ChatManagerConfigSchema>;\n\n// ============================================================================\n// Events\n// ============================================================================\n\nexport type ChatEvents = {\n  // Connection\n  connected: (platform: ChatPlatform) => void;\n  disconnected: (platform: ChatPlatform, reason: string) => void;\n  error: (platform: ChatPlatform, error: Error) => void;\n\n  // Messages\n  messageReceived: (message: ChatMessage) => void;\n  messageSent: (message: ChatMessage) => void;\n  messageEdited: (message: ChatMessage) => void;\n  messageDeleted: (messageId: string, channelId: string) => void;\n\n  // Interactions\n  commandReceived: (invocation: CommandInvocation) => void;\n  buttonClicked: (interaction: ButtonInteraction) => void;\n\n  // Notifications\n  notificationSent: (type: NotificationType, channelId: string) => void;\n  notificationFailed: (type: NotificationType, error: Error) => void;\n};\n\n// ============================================================================\n// Default Templates\n// ============================================================================\n\nexport const DEFAULT_NOTIFICATION_TEMPLATES: NotificationTemplate[] = [\n  {\n    id: \"pipeline_started\",\n    type: \"pipeline_started\",\n    platform: \"slack\",\n    title: \"Pipeline Started\",\n    bodyTemplate: `Pipeline **{{pipelineName}}** has started execution.\n- Execution ID: \\`{{executionId}}\\`\n- Triggered by: {{triggeredBy}}\n- Steps: {{stepCount}}`,\n    color: \"#3498db\",\n    includeDetails: true,\n  },\n  {\n    id: \"pipeline_completed\",\n    type: \"pipeline_completed\",\n    platform: \"slack\",\n    title: \"Pipeline Completed\",\n    bodyTemplate: `Pipeline **{{pipelineName}}** completed successfully!\n- Duration: {{duration}}\n- Cost: {{cost}}\n- Output: {{outputPreview}}`,\n    color: \"#2ecc71\",\n    includeDetails: true,\n    actions: [\n      { label: \"View Results\", actionId: \"view_results\", style: \"primary\" },\n    ],\n  },\n  {\n    id: \"pipeline_failed\",\n    type: \"pipeline_failed\",\n    platform: \"slack\",\n    title: \"Pipeline Failed\",\n    bodyTemplate: `Pipeline **{{pipelineName}}** failed!\n- Error: {{errorMessage}}\n- Failed Step: {{failedStep}}\n- Execution ID: \\`{{executionId}}\\``,\n    color: \"#e74c3c\",\n    includeDetails: true,\n    actions: [\n      { label: \"View Logs\", actionId: \"view_logs\", style: \"primary\" },\n      { label: \"Retry\", actionId: \"retry_pipeline\", style: \"secondary\" },\n    ],\n  },\n  {\n    id: \"approval_required\",\n    type: \"approval_required\",\n    platform: \"slack\",\n    title: \"Approval Required\",\n    bodyTemplate: `Pipeline **{{pipelineName}}** requires approval to continue.\n- Step: {{stepName}}\n- Requested by: {{requestedBy}}\n- Reason: {{reason}}`,\n    color: \"#f39c12\",\n    includeDetails: true,\n    actions: [\n      { label: \"Approve\", actionId: \"approve\", style: \"primary\" },\n      { label: \"Reject\", actionId: \"reject\", style: \"danger\" },\n    ],\n  },\n  {\n    id: \"budget_warning\",\n    type: \"budget_warning\",\n    platform: \"slack\",\n    title: \"Budget Warning\",\n    bodyTemplate: `Budget threshold reached for **{{budgetName}}**\n- Current Spend: {{currentSpend}}\n- Limit: {{limit}}\n- Usage: {{percentUsed}}%`,\n    color: \"#f39c12\",\n    includeDetails: true,\n  },\n  {\n    id: \"anomaly_detected\",\n    type: \"anomaly_detected\",\n    platform: \"slack\",\n    title: \"Anomaly Detected\",\n    bodyTemplate: `Anomaly detected in **{{metricName}}**\n- Type: {{anomalyType}}\n- Severity: {{severity}}\n- Value: {{value}} (expected: {{expected}})`,\n    color: \"#9b59b6\",\n    includeDetails: true,\n    actions: [\n      { label: \"Investigate\", actionId: \"investigate\", style: \"primary\" },\n      { label: \"Dismiss\", actionId: \"dismiss\", style: \"secondary\" },\n    ],\n  },\n];\n","/**\n * Chat Manager\n * Phase 11B: Slack/Discord Bot Integration\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport { randomUUID } from \"crypto\";\nimport {\n  type ChatPlatform,\n  type ConnectionStatus,\n  type ChatCredentials,\n  type ChatChannel,\n  type ChatUser,\n  type ChatMessage,\n  type SendMessageOptions,\n  type SlashCommand,\n  type CommandInvocation,\n  type ButtonInteraction,\n  type NotificationType,\n  type NotificationTemplate,\n  type NotificationConfig,\n  type BotConfig,\n  type ChatManagerConfig,\n  type ChatEvents,\n  DEFAULT_NOTIFICATION_TEMPLATES,\n  ChatManagerConfigSchema,\n} from \"./types.js\";\n\n// ============================================================================\n// Chat Manager Class\n// ============================================================================\n\nexport class ChatManager extends EventEmitter<ChatEvents> {\n  private config: ChatManagerConfig;\n  private bots: Map<string, BotConfig> = new Map();\n  private connections: Map<ChatPlatform, ConnectionStatus> = new Map();\n  private templates: Map<string, NotificationTemplate> = new Map();\n  private commandHandlers: Map<string, (invocation: CommandInvocation) => Promise<void>> = new Map();\n  private messageQueue: SendMessageOptions[] = [];\n  private rateLimitTokens: number;\n  private lastTokenRefill: number;\n\n  constructor(config: Partial<ChatManagerConfig> = {}) {\n    super();\n    this.config = ChatManagerConfigSchema.parse(config);\n    this.rateLimitTokens = this.config.rateLimitPerMinute;\n    this.lastTokenRefill = Date.now();\n\n    // Load default templates\n    for (const template of DEFAULT_NOTIFICATION_TEMPLATES) {\n      this.templates.set(`${template.type}:${template.platform}`, template);\n    }\n\n    // Load bots from config\n    if (this.config.bots) {\n      for (const bot of this.config.bots) {\n        this.bots.set(bot.id, bot);\n      }\n    }\n  }\n\n  // ============================================================================\n  // Bot Management\n  // ============================================================================\n\n  /**\n   * Connect a bot to a platform\n   */\n  async connectBot(credentials: ChatCredentials): Promise<BotConfig> {\n    const { platform } = credentials;\n\n    // Check if already connected\n    if (this.connections.get(platform) === \"connected\") {\n      throw new Error(`Already connected to ${platform}`);\n    }\n\n    this.connections.set(platform, \"connecting\");\n\n    try {\n      // Platform-specific connection logic\n      const bot = await this.initializePlatformBot(credentials);\n\n      this.bots.set(bot.id, bot);\n      this.connections.set(platform, \"connected\");\n\n      this.emit(\"connected\", platform);\n\n      return bot;\n    } catch (error) {\n      this.connections.set(platform, \"error\");\n      this.emit(\"error\", platform, error instanceof Error ? error : new Error(String(error)));\n      throw error;\n    }\n  }\n\n  /**\n   * Disconnect a bot\n   */\n  async disconnectBot(botId: string): Promise<void> {\n    const bot = this.bots.get(botId);\n    if (!bot) {\n      throw new Error(`Bot not found: ${botId}`);\n    }\n\n    // Platform-specific disconnect logic would go here\n    this.bots.delete(botId);\n    this.connections.set(bot.platform, \"disconnected\");\n\n    this.emit(\"disconnected\", bot.platform, \"Manual disconnect\");\n  }\n\n  /**\n   * Get bot status\n   */\n  getBotStatus(botId: string): BotConfig | undefined {\n    return this.bots.get(botId);\n  }\n\n  /**\n   * Get all connected platforms\n   */\n  getConnectedPlatforms(): ChatPlatform[] {\n    const connected: ChatPlatform[] = [];\n    for (const [platform, status] of this.connections) {\n      if (status === \"connected\") {\n        connected.push(platform);\n      }\n    }\n    return connected;\n  }\n\n  // ============================================================================\n  // Messaging\n  // ============================================================================\n\n  /**\n   * Send a message to a channel\n   */\n  async sendMessage(options: SendMessageOptions, platform?: ChatPlatform): Promise<ChatMessage> {\n    const targetPlatform = platform || this.config.defaultPlatform;\n    if (!targetPlatform) {\n      throw new Error(\"No platform specified and no default platform configured\");\n    }\n\n    // Check rate limit\n    await this.checkRateLimit();\n\n    const message: ChatMessage = {\n      id: randomUUID(),\n      platform: targetPlatform,\n      channelId: options.channelId,\n      userId: \"bot\",\n      content: options.content,\n      blocks: options.blocks,\n      threadId: options.threadId,\n      timestamp: new Date(),\n    };\n\n    // Platform-specific send logic would go here\n    await this.sendPlatformMessage(targetPlatform, options);\n\n    this.emit(\"messageSent\", message);\n\n    return message;\n  }\n\n  /**\n   * Send a notification\n   */\n  async sendNotification(\n    type: NotificationType,\n    data: Record<string, unknown>,\n    config?: NotificationConfig\n  ): Promise<void> {\n    // Find notification configs for this type\n    const configs = config\n      ? [config]\n      : Array.from(this.bots.values())\n          .flatMap((bot) => bot.notifications || [])\n          .filter((n) => n.enabledTypes.includes(type));\n\n    if (configs.length === 0) {\n      console.warn(`No notification config found for type: ${type}`);\n      return;\n    }\n\n    for (const notificationConfig of configs) {\n      try {\n        // Check quiet hours\n        if (this.isInQuietHours(notificationConfig)) {\n          continue;\n        }\n\n        // Get template\n        const templateKey = `${type}:${notificationConfig.platform}`;\n        const template = this.templates.get(templateKey);\n        if (!template) {\n          console.warn(`No template found for: ${templateKey}`);\n          continue;\n        }\n\n        // Render message\n        const content = this.renderTemplate(template.bodyTemplate, data);\n        const blocks = this.buildNotificationBlocks(template, data);\n\n        // Build mentions\n        const mentions = this.buildMentions(notificationConfig);\n        const finalContent = mentions ? `${mentions}\\n${content}` : content;\n\n        // Send\n        await this.sendMessage(\n          {\n            channelId: notificationConfig.channelId,\n            content: finalContent,\n            blocks,\n          },\n          notificationConfig.platform\n        );\n\n        this.emit(\"notificationSent\", type, notificationConfig.channelId);\n      } catch (error) {\n        this.emit(\n          \"notificationFailed\",\n          type,\n          error instanceof Error ? error : new Error(String(error))\n        );\n      }\n    }\n  }\n\n  // ============================================================================\n  // Commands\n  // ============================================================================\n\n  /**\n   * Register a slash command\n   */\n  registerCommand(\n    command: SlashCommand,\n    handler: (invocation: CommandInvocation) => Promise<void>\n  ): void {\n    this.commandHandlers.set(command.name, handler);\n\n    // Register with platforms\n    for (const bot of this.bots.values()) {\n      if (!bot.commands) {\n        bot.commands = [];\n      }\n      bot.commands.push(command);\n    }\n  }\n\n  /**\n   * Handle incoming command\n   */\n  async handleCommand(invocation: CommandInvocation): Promise<void> {\n    this.emit(\"commandReceived\", invocation);\n\n    const handler = this.commandHandlers.get(invocation.command);\n    if (!handler) {\n      await this.sendMessage(\n        {\n          channelId: invocation.channelId,\n          content: `Unknown command: ${invocation.command}`,\n        },\n        invocation.platform\n      );\n      return;\n    }\n\n    try {\n      await handler(invocation);\n    } catch (error) {\n      await this.sendMessage(\n        {\n          channelId: invocation.channelId,\n          content: `Error executing command: ${error instanceof Error ? error.message : \"Unknown error\"}`,\n        },\n        invocation.platform\n      );\n    }\n  }\n\n  /**\n   * Handle button interaction\n   */\n  async handleButtonClick(interaction: ButtonInteraction): Promise<void> {\n    this.emit(\"buttonClicked\", interaction);\n\n    // Route to appropriate handler based on actionId\n    switch (interaction.actionId) {\n      case \"approve\":\n        await this.handleApprovalAction(interaction, true);\n        break;\n      case \"reject\":\n        await this.handleApprovalAction(interaction, false);\n        break;\n      case \"view_results\":\n      case \"view_logs\":\n        await this.handleViewAction(interaction);\n        break;\n      case \"retry_pipeline\":\n        await this.handleRetryAction(interaction);\n        break;\n      case \"investigate\":\n        await this.handleInvestigateAction(interaction);\n        break;\n      case \"dismiss\":\n        await this.handleDismissAction(interaction);\n        break;\n      default:\n        console.warn(`Unknown action: ${interaction.actionId}`);\n    }\n  }\n\n  // ============================================================================\n  // Templates\n  // ============================================================================\n\n  /**\n   * Add or update a notification template\n   */\n  setTemplate(template: NotificationTemplate): void {\n    const key = `${template.type}:${template.platform}`;\n    this.templates.set(key, template);\n  }\n\n  /**\n   * Get template\n   */\n  getTemplate(type: NotificationType, platform: ChatPlatform): NotificationTemplate | undefined {\n    return this.templates.get(`${type}:${platform}`);\n  }\n\n  // ============================================================================\n  // Pipeline Integration\n  // ============================================================================\n\n  /**\n   * Register default pipeline commands\n   */\n  registerPipelineCommands(): void {\n    // /pipeline list\n    this.registerCommand(\n      {\n        name: \"pipeline\",\n        description: \"Manage pipelines\",\n        options: [\n          {\n            name: \"action\",\n            description: \"Action to perform\",\n            type: \"string\",\n            required: true,\n            choices: [\n              { name: \"list\", value: \"list\" },\n              { name: \"run\", value: \"run\" },\n              { name: \"status\", value: \"status\" },\n              { name: \"stop\", value: \"stop\" },\n            ],\n          },\n          {\n            name: \"pipeline_id\",\n            description: \"Pipeline ID\",\n            type: \"string\",\n            required: false,\n          },\n        ],\n        handler: \"pipeline_command\",\n      },\n      async (invocation) => {\n        const action = invocation.args.action as string;\n        const pipelineId = invocation.args.pipeline_id as string | undefined;\n\n        switch (action) {\n          case \"list\":\n            await this.sendMessage(\n              {\n                channelId: invocation.channelId,\n                content: \"Available pipelines:\\n- content-generation\\n- data-extraction\\n- reporting\",\n              },\n              invocation.platform\n            );\n            break;\n          case \"run\":\n            if (!pipelineId) {\n              await this.sendMessage(\n                {\n                  channelId: invocation.channelId,\n                  content: \"Please specify a pipeline ID: `/pipeline run --pipeline_id <id>`\",\n                },\n                invocation.platform\n              );\n              return;\n            }\n            await this.sendMessage(\n              {\n                channelId: invocation.channelId,\n                content: `Starting pipeline: ${pipelineId}...`,\n              },\n              invocation.platform\n            );\n            // Would trigger actual pipeline execution here\n            break;\n          case \"status\":\n            await this.sendMessage(\n              {\n                channelId: invocation.channelId,\n                content: pipelineId\n                  ? `Pipeline ${pipelineId} status: running`\n                  : \"All pipelines: 3 running, 2 idle\",\n              },\n              invocation.platform\n            );\n            break;\n          case \"stop\":\n            if (!pipelineId) {\n              await this.sendMessage(\n                {\n                  channelId: invocation.channelId,\n                  content: \"Please specify a pipeline ID to stop\",\n                },\n                invocation.platform\n              );\n              return;\n            }\n            await this.sendMessage(\n              {\n                channelId: invocation.channelId,\n                content: `Stopping pipeline: ${pipelineId}`,\n              },\n              invocation.platform\n            );\n            break;\n        }\n      }\n    );\n\n    // /budget\n    this.registerCommand(\n      {\n        name: \"budget\",\n        description: \"Check budget status\",\n        options: [],\n        handler: \"budget_command\",\n      },\n      async (invocation) => {\n        await this.sendMessage(\n          {\n            channelId: invocation.channelId,\n            content: `Budget Status:\\n- Daily: $45.20 / $100 (45%)\\n- Monthly: $890 / $2000 (44.5%)\\n- Per-pipeline avg: $2.30`,\n            blocks: [\n              { type: \"header\", content: \"Budget Overview\" },\n              { type: \"text\", content: \"Daily spend: $45.20 / $100\" },\n              { type: \"text\", content: \"Monthly spend: $890 / $2000\" },\n              { type: \"divider\" },\n              { type: \"text\", content: \"All budgets are within limits.\" },\n            ],\n          },\n          invocation.platform\n        );\n      }\n    );\n\n    // /help\n    this.registerCommand(\n      {\n        name: \"help\",\n        description: \"Show available commands\",\n        options: [],\n        handler: \"help_command\",\n      },\n      async (invocation) => {\n        const commands = Array.from(this.commandHandlers.keys());\n        await this.sendMessage(\n          {\n            channelId: invocation.channelId,\n            content: `Available commands:\\n${commands.map((c) => `- /${c}`).join(\"\\n\")}`,\n          },\n          invocation.platform\n        );\n      }\n    );\n  }\n\n  // ============================================================================\n  // Private Methods\n  // ============================================================================\n\n  private async initializePlatformBot(credentials: ChatCredentials): Promise<BotConfig> {\n    // Platform-specific initialization would go here\n    // This is a mock implementation\n    return {\n      id: randomUUID(),\n      platform: credentials.platform,\n      name: `${credentials.platform}-bot`,\n      status: \"connected\",\n      credentials: credentials.credentials,\n      commands: [],\n      notifications: [],\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n  }\n\n  private async sendPlatformMessage(\n    platform: ChatPlatform,\n    options: SendMessageOptions\n  ): Promise<void> {\n    // Platform-specific message sending would go here\n    // This is where you'd integrate with actual SDKs:\n    // - @slack/web-api for Slack\n    // - discord.js for Discord\n    // - node-telegram-bot-api for Telegram\n    // - @microsoft/bot-framework for Teams\n    console.log(`[${platform}] Sending to ${options.channelId}: ${options.content}`);\n  }\n\n  private async checkRateLimit(): Promise<void> {\n    const now = Date.now();\n    const elapsed = now - this.lastTokenRefill;\n\n    // Refill tokens every minute\n    if (elapsed >= 60000) {\n      this.rateLimitTokens = this.config.rateLimitPerMinute;\n      this.lastTokenRefill = now;\n    }\n\n    if (this.rateLimitTokens <= 0) {\n      const waitTime = 60000 - elapsed;\n      await new Promise((resolve) => setTimeout(resolve, waitTime));\n      this.rateLimitTokens = this.config.rateLimitPerMinute;\n      this.lastTokenRefill = Date.now();\n    }\n\n    this.rateLimitTokens--;\n  }\n\n  private isInQuietHours(config: NotificationConfig): boolean {\n    if (!config.quietHours?.enabled) {\n      return false;\n    }\n\n    const now = new Date();\n    const [startHour, startMin] = config.quietHours.start.split(\":\").map(Number);\n    const [endHour, endMin] = config.quietHours.end.split(\":\").map(Number);\n\n    const currentMinutes = now.getHours() * 60 + now.getMinutes();\n    const startMinutes = startHour * 60 + startMin;\n    const endMinutes = endHour * 60 + endMin;\n\n    if (startMinutes <= endMinutes) {\n      return currentMinutes >= startMinutes && currentMinutes < endMinutes;\n    } else {\n      // Quiet hours span midnight\n      return currentMinutes >= startMinutes || currentMinutes < endMinutes;\n    }\n  }\n\n  private renderTemplate(template: string, data: Record<string, unknown>): string {\n    return template.replace(/\\{\\{(\\w+)\\}\\}/g, (_, key) => {\n      const value = data[key];\n      return value !== undefined ? String(value) : `{{${key}}}`;\n    });\n  }\n\n  private buildNotificationBlocks(\n    template: NotificationTemplate,\n    data: Record<string, unknown>\n  ): { type: string; content?: string; url?: string }[] {\n    const blocks: { type: string; content?: string; url?: string }[] = [\n      { type: \"header\", content: template.title },\n      { type: \"text\", content: this.renderTemplate(template.bodyTemplate, data) },\n    ];\n\n    if (template.actions && template.actions.length > 0) {\n      blocks.push({ type: \"divider\" });\n      for (const action of template.actions) {\n        blocks.push({\n          type: \"button\",\n          content: action.label,\n          url: action.actionId,\n        });\n      }\n    }\n\n    return blocks;\n  }\n\n  private buildMentions(config: NotificationConfig): string {\n    const mentions: string[] = [];\n\n    if (config.mentionUsers) {\n      mentions.push(...config.mentionUsers.map((u) => `<@${u}>`));\n    }\n\n    if (config.mentionRoles) {\n      mentions.push(...config.mentionRoles.map((r) => `<@&${r}>`));\n    }\n\n    return mentions.join(\" \");\n  }\n\n  // Action handlers\n  private async handleApprovalAction(\n    interaction: ButtonInteraction,\n    approved: boolean\n  ): Promise<void> {\n    await this.sendMessage(\n      {\n        channelId: interaction.channelId,\n        content: approved\n          ? `Approved by <@${interaction.userId}>`\n          : `Rejected by <@${interaction.userId}>`,\n        threadId: interaction.messageId,\n      },\n      interaction.platform\n    );\n  }\n\n  private async handleViewAction(interaction: ButtonInteraction): Promise<void> {\n    await this.sendMessage(\n      {\n        channelId: interaction.channelId,\n        content: `View details: https://dashboard.example.com/execution/${interaction.value}`,\n        threadId: interaction.messageId,\n      },\n      interaction.platform\n    );\n  }\n\n  private async handleRetryAction(interaction: ButtonInteraction): Promise<void> {\n    await this.sendMessage(\n      {\n        channelId: interaction.channelId,\n        content: `Retrying pipeline... Started by <@${interaction.userId}>`,\n        threadId: interaction.messageId,\n      },\n      interaction.platform\n    );\n  }\n\n  private async handleInvestigateAction(interaction: ButtonInteraction): Promise<void> {\n    await this.sendMessage(\n      {\n        channelId: interaction.channelId,\n        content: `Creating investigation ticket for <@${interaction.userId}>...`,\n        threadId: interaction.messageId,\n      },\n      interaction.platform\n    );\n  }\n\n  private async handleDismissAction(interaction: ButtonInteraction): Promise<void> {\n    await this.sendMessage(\n      {\n        channelId: interaction.channelId,\n        content: `Dismissed by <@${interaction.userId}>`,\n        threadId: interaction.messageId,\n      },\n      interaction.platform\n    );\n  }\n\n  /**\n   * Get summary of chat manager state\n   */\n  getSummary(): {\n    connectedPlatforms: ChatPlatform[];\n    totalBots: number;\n    registeredCommands: number;\n    templatesCount: number;\n  } {\n    return {\n      connectedPlatforms: this.getConnectedPlatforms(),\n      totalBots: this.bots.size,\n      registeredCommands: this.commandHandlers.size,\n      templatesCount: this.templates.size,\n    };\n  }\n}\n\n// ============================================================================\n// Singleton & Factory\n// ============================================================================\n\nlet chatManagerInstance: ChatManager | null = null;\n\nexport function getChatManager(): ChatManager {\n  if (!chatManagerInstance) {\n    chatManagerInstance = new ChatManager();\n  }\n  return chatManagerInstance;\n}\n\nexport function createChatManager(config: Partial<ChatManagerConfig> = {}): ChatManager {\n  return new ChatManager(config);\n}\n","/**\n * Terraform Provider Types\n * Phase 11C: Infrastructure as Code Integration\n */\n\nimport { z } from \"zod\";\n\n// ============================================================================\n// Resource Types\n// ============================================================================\n\nexport const TerraformResourceTypeSchema = z.enum([\n  \"integrationhub_pipeline\",\n  \"integrationhub_schedule\",\n  \"integrationhub_webhook\",\n  \"integrationhub_budget\",\n  \"integrationhub_notification\",\n  \"integrationhub_plugin\",\n]);\nexport type TerraformResourceType = z.infer<typeof TerraformResourceTypeSchema>;\n\n// ============================================================================\n// Provider Configuration\n// ============================================================================\n\nexport const ProviderConfigSchema = z.object({\n  apiKey: z.string(),\n  baseUrl: z.string().url().default(\"https://api.integrationhub.io\"),\n  organizationId: z.string().optional(),\n  timeout: z.number().default(30),\n  maxRetries: z.number().default(3),\n});\nexport type ProviderConfig = z.infer<typeof ProviderConfigSchema>;\n\n// ============================================================================\n// Pipeline Resource\n// ============================================================================\n\nexport const PipelineStepResourceSchema = z.object({\n  name: z.string(),\n  type: z.enum([\"llm\", \"transform\", \"condition\", \"parallel\", \"loop\"]),\n  config: z.record(z.unknown()).optional(),\n  dependsOn: z.array(z.string()).optional(),\n  timeout: z.number().optional(),\n  retries: z.number().optional(),\n});\nexport type PipelineStepResource = z.infer<typeof PipelineStepResourceSchema>;\n\nexport const PipelineResourceSchema = z.object({\n  name: z.string(),\n  description: z.string().optional(),\n  steps: z.array(PipelineStepResourceSchema),\n  variables: z.record(z.string()).optional(),\n  metadata: z.record(z.string()).optional(),\n  maxConcurrency: z.number().optional(),\n  timeoutMinutes: z.number().optional(),\n});\nexport type PipelineResource = z.infer<typeof PipelineResourceSchema>;\n\n// ============================================================================\n// Schedule Resource\n// ============================================================================\n\nexport const ScheduleResourceSchema = z.object({\n  pipelineId: z.string(),\n  name: z.string(),\n  cronExpression: z.string(),\n  timezone: z.string().default(\"UTC\"),\n  enabled: z.boolean().default(true),\n  inputs: z.record(z.unknown()).optional(),\n  notifications: z.object({\n    onSuccess: z.array(z.string()).optional(),\n    onFailure: z.array(z.string()).optional(),\n  }).optional(),\n});\nexport type ScheduleResource = z.infer<typeof ScheduleResourceSchema>;\n\n// ============================================================================\n// Webhook Resource\n// ============================================================================\n\nexport const WebhookResourceSchema = z.object({\n  name: z.string(),\n  url: z.string().url(),\n  events: z.array(z.string()),\n  secret: z.string().optional(),\n  enabled: z.boolean().default(true),\n  headers: z.record(z.string()).optional(),\n  retryPolicy: z.object({\n    maxRetries: z.number(),\n    backoffMs: z.number(),\n  }).optional(),\n});\nexport type WebhookResource = z.infer<typeof WebhookResourceSchema>;\n\n// ============================================================================\n// Budget Resource\n// ============================================================================\n\nexport const BudgetResourceSchema = z.object({\n  name: z.string(),\n  type: z.enum([\"daily\", \"weekly\", \"monthly\", \"pipeline\"]),\n  limit: z.number(),\n  currency: z.string().default(\"USD\"),\n  pipelineId: z.string().optional(),\n  alertThresholds: z.array(z.number()).optional(), // e.g., [50, 75, 90]\n  actions: z.object({\n    onThreshold: z.enum([\"notify\", \"throttle\", \"pause\"]).optional(),\n    onExceeded: z.enum([\"notify\", \"pause\", \"block\"]).optional(),\n  }).optional(),\n});\nexport type BudgetResource = z.infer<typeof BudgetResourceSchema>;\n\n// ============================================================================\n// Notification Resource\n// ============================================================================\n\nexport const NotificationResourceSchema = z.object({\n  name: z.string(),\n  type: z.enum([\"slack\", \"discord\", \"email\", \"webhook\", \"pagerduty\"]),\n  config: z.object({\n    channel: z.string().optional(),\n    url: z.string().optional(),\n    emails: z.array(z.string()).optional(),\n    integrationKey: z.string().optional(),\n  }),\n  events: z.array(z.string()),\n  filters: z.object({\n    severity: z.array(z.string()).optional(),\n    pipelines: z.array(z.string()).optional(),\n  }).optional(),\n});\nexport type NotificationResource = z.infer<typeof NotificationResourceSchema>;\n\n// ============================================================================\n// Plugin Resource\n// ============================================================================\n\nexport const PluginResourceSchema = z.object({\n  name: z.string(),\n  version: z.string(),\n  enabled: z.boolean().default(true),\n  config: z.record(z.unknown()).optional(),\n  permissions: z.array(z.string()).optional(),\n});\nexport type PluginResource = z.infer<typeof PluginResourceSchema>;\n\n// ============================================================================\n// State Management\n// ============================================================================\n\nexport const ResourceStateSchema = z.object({\n  id: z.string(),\n  type: TerraformResourceTypeSchema,\n  name: z.string(),\n  attributes: z.record(z.unknown()),\n  meta: z.object({\n    createdAt: z.string(),\n    updatedAt: z.string(),\n    version: z.number(),\n    checksum: z.string(),\n  }),\n  dependencies: z.array(z.string()).optional(),\n});\nexport type ResourceState = z.infer<typeof ResourceStateSchema>;\n\nexport const TerraformStateSchema = z.object({\n  version: z.number().default(1),\n  serial: z.number(),\n  lineage: z.string(),\n  resources: z.array(ResourceStateSchema),\n  outputs: z.record(z.object({\n    value: z.unknown(),\n    type: z.string(),\n    sensitive: z.boolean().optional(),\n  })).optional(),\n});\nexport type TerraformState = z.infer<typeof TerraformStateSchema>;\n\n// ============================================================================\n// Plan & Apply\n// ============================================================================\n\nexport const ResourceChangeTypeSchema = z.enum([\n  \"create\",\n  \"update\",\n  \"delete\",\n  \"replace\",\n  \"no-op\",\n]);\nexport type ResourceChangeType = z.infer<typeof ResourceChangeTypeSchema>;\n\nexport const ResourceChangeSchema = z.object({\n  type: TerraformResourceTypeSchema,\n  name: z.string(),\n  action: ResourceChangeTypeSchema,\n  before: z.record(z.unknown()).optional(),\n  after: z.record(z.unknown()).optional(),\n  diff: z.array(z.object({\n    path: z.string(),\n    oldValue: z.unknown(),\n    newValue: z.unknown(),\n  })).optional(),\n});\nexport type ResourceChange = z.infer<typeof ResourceChangeSchema>;\n\nexport const TerraformPlanSchema = z.object({\n  version: z.number(),\n  timestamp: z.string(),\n  changes: z.array(ResourceChangeSchema),\n  summary: z.object({\n    toCreate: z.number(),\n    toUpdate: z.number(),\n    toDelete: z.number(),\n    toReplace: z.number(),\n    unchanged: z.number(),\n  }),\n});\nexport type TerraformPlan = z.infer<typeof TerraformPlanSchema>;\n\nexport const ApplyResultSchema = z.object({\n  success: z.boolean(),\n  resourceId: z.string().optional(),\n  error: z.string().optional(),\n  duration: z.number(),\n});\nexport type ApplyResult = z.infer<typeof ApplyResultSchema>;\n\nexport const TerraformApplyResultSchema = z.object({\n  success: z.boolean(),\n  results: z.array(z.object({\n    resource: z.string(),\n    action: ResourceChangeTypeSchema,\n    result: ApplyResultSchema,\n  })),\n  summary: z.object({\n    created: z.number(),\n    updated: z.number(),\n    deleted: z.number(),\n    failed: z.number(),\n  }),\n  duration: z.number(),\n});\nexport type TerraformApplyResult = z.infer<typeof TerraformApplyResultSchema>;\n\n// ============================================================================\n// HCL Configuration\n// ============================================================================\n\nexport const HCLBlockSchema = z.object({\n  type: z.string(),\n  labels: z.array(z.string()),\n  attributes: z.record(z.unknown()),\n  blocks: z.array(z.lazy(() => HCLBlockSchema)).optional(),\n});\nexport type HCLBlock = z.infer<typeof HCLBlockSchema>;\n\nexport const HCLConfigSchema = z.object({\n  terraform: z.object({\n    requiredProviders: z.record(z.object({\n      source: z.string(),\n      version: z.string(),\n    })).optional(),\n  }).optional(),\n  provider: z.record(z.record(z.unknown())).optional(),\n  resources: z.array(HCLBlockSchema).optional(),\n  data: z.array(HCLBlockSchema).optional(),\n  outputs: z.record(z.object({\n    value: z.string(),\n    description: z.string().optional(),\n    sensitive: z.boolean().optional(),\n  })).optional(),\n  variables: z.record(z.object({\n    type: z.string().optional(),\n    default: z.unknown().optional(),\n    description: z.string().optional(),\n    sensitive: z.boolean().optional(),\n    validation: z.object({\n      condition: z.string(),\n      errorMessage: z.string(),\n    }).optional(),\n  })).optional(),\n});\nexport type HCLConfig = z.infer<typeof HCLConfigSchema>;\n\n// ============================================================================\n// Provider Manager Config\n// ============================================================================\n\nexport const TerraformManagerConfigSchema = z.object({\n  providerVersion: z.string().default(\"1.0.0\"),\n  stateBackend: z.enum([\"local\", \"s3\", \"gcs\", \"azure\", \"http\"]).default(\"local\"),\n  stateConfig: z.record(z.unknown()).optional(),\n  autoApprove: z.boolean().default(false),\n  parallelism: z.number().default(10),\n  refreshOnPlan: z.boolean().default(true),\n});\nexport type TerraformManagerConfig = z.infer<typeof TerraformManagerConfigSchema>;\n\n// ============================================================================\n// Events\n// ============================================================================\n\nexport type TerraformEvents = {\n  // Lifecycle\n  planStarted: () => void;\n  planCompleted: (plan: TerraformPlan) => void;\n  applyStarted: (plan: TerraformPlan) => void;\n  applyCompleted: (result: TerraformApplyResult) => void;\n\n  // Resources\n  resourceCreating: (type: TerraformResourceType, name: string) => void;\n  resourceCreated: (type: TerraformResourceType, name: string, id: string) => void;\n  resourceUpdating: (type: TerraformResourceType, name: string) => void;\n  resourceUpdated: (type: TerraformResourceType, name: string) => void;\n  resourceDeleting: (type: TerraformResourceType, name: string) => void;\n  resourceDeleted: (type: TerraformResourceType, name: string) => void;\n\n  // Errors\n  error: (error: Error) => void;\n  resourceError: (type: TerraformResourceType, name: string, error: Error) => void;\n\n  // State\n  stateRefreshed: () => void;\n  stateSaved: () => void;\n};\n\n// ============================================================================\n// Example Configurations\n// ============================================================================\n\nexport const EXAMPLE_TERRAFORM_CONFIG = `\nterraform {\n  required_providers {\n    integrationhub = {\n      source  = \"gicm/integrationhub\"\n      version = \"~> 1.0\"\n    }\n  }\n}\n\nprovider \"integrationhub\" {\n  api_key         = var.api_key\n  organization_id = var.organization_id\n}\n\nvariable \"api_key\" {\n  type        = string\n  description = \"Integration Hub API key\"\n  sensitive   = true\n}\n\nvariable \"organization_id\" {\n  type        = string\n  description = \"Organization ID\"\n}\n\nresource \"integrationhub_pipeline\" \"content_generator\" {\n  name        = \"content-generator\"\n  description = \"Generates blog content from topics\"\n\n  step {\n    name = \"research\"\n    type = \"llm\"\n    config = {\n      model  = \"claude-3-sonnet\"\n      prompt = \"Research the topic: \\${var.topic}\"\n    }\n  }\n\n  step {\n    name       = \"write\"\n    type       = \"llm\"\n    depends_on = [\"research\"]\n    config = {\n      model  = \"claude-3-opus\"\n      prompt = \"Write a blog post based on: \\${step.research.output}\"\n    }\n  }\n\n  step {\n    name       = \"review\"\n    type       = \"llm\"\n    depends_on = [\"write\"]\n    config = {\n      model  = \"claude-3-haiku\"\n      prompt = \"Review and suggest improvements for: \\${step.write.output}\"\n    }\n  }\n\n  variables = {\n    topic = \"AI in Healthcare\"\n  }\n\n  max_concurrency = 1\n  timeout_minutes = 30\n}\n\nresource \"integrationhub_schedule\" \"daily_content\" {\n  pipeline_id     = integrationhub_pipeline.content_generator.id\n  name            = \"daily-content-schedule\"\n  cron_expression = \"0 9 * * 1-5\"\n  timezone        = \"America/New_York\"\n  enabled         = true\n\n  inputs = {\n    topic = \"Daily AI News\"\n  }\n}\n\nresource \"integrationhub_budget\" \"monthly_limit\" {\n  name     = \"monthly-ai-budget\"\n  type     = \"monthly\"\n  limit    = 500\n  currency = \"USD\"\n\n  alert_thresholds = [50, 75, 90]\n\n  actions {\n    on_threshold = \"notify\"\n    on_exceeded  = \"pause\"\n  }\n}\n\nresource \"integrationhub_webhook\" \"pipeline_events\" {\n  name   = \"pipeline-notifications\"\n  url    = \"https://hooks.slack.com/services/xxx\"\n  events = [\"pipeline.completed\", \"pipeline.failed\"]\n\n  headers = {\n    Content-Type = \"application/json\"\n  }\n\n  retry_policy {\n    max_retries = 3\n    backoff_ms  = 1000\n  }\n}\n\noutput \"pipeline_id\" {\n  value       = integrationhub_pipeline.content_generator.id\n  description = \"The ID of the content generator pipeline\"\n}\n\noutput \"schedule_id\" {\n  value       = integrationhub_schedule.daily_content.id\n  description = \"The ID of the daily content schedule\"\n}\n`;\n","/**\n * Terraform Manager\n * Phase 11C: Infrastructure as Code Integration\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport { createHash, randomUUID } from \"crypto\";\nimport {\n  type TerraformResourceType,\n  type ProviderConfig,\n  type PipelineResource,\n  type ScheduleResource,\n  type WebhookResource,\n  type BudgetResource,\n  type NotificationResource,\n  type PluginResource,\n  type ResourceState,\n  type TerraformState,\n  type ResourceChange,\n  type ResourceChangeType,\n  type TerraformPlan,\n  type TerraformApplyResult,\n  type HCLConfig,\n  type TerraformManagerConfig,\n  type TerraformEvents,\n  TerraformManagerConfigSchema,\n} from \"./types.js\";\n\n// ============================================================================\n// Type Aliases for Resources\n// ============================================================================\n\ntype ResourceData =\n  | PipelineResource\n  | ScheduleResource\n  | WebhookResource\n  | BudgetResource\n  | NotificationResource\n  | PluginResource;\n\n// ============================================================================\n// Terraform Manager Class\n// ============================================================================\n\nexport class TerraformManager extends EventEmitter<TerraformEvents> {\n  private config: TerraformManagerConfig;\n  private providerConfig: ProviderConfig | null = null;\n  private state: TerraformState;\n  private desiredState: Map<string, { type: TerraformResourceType; data: ResourceData }> = new Map();\n\n  constructor(config: Partial<TerraformManagerConfig> = {}) {\n    super();\n    this.config = TerraformManagerConfigSchema.parse(config);\n\n    // Initialize empty state\n    this.state = {\n      version: 1,\n      serial: 0,\n      lineage: randomUUID(),\n      resources: [],\n      outputs: {},\n    };\n  }\n\n  // ============================================================================\n  // Provider Configuration\n  // ============================================================================\n\n  /**\n   * Configure the provider\n   */\n  configureProvider(config: ProviderConfig): void {\n    this.providerConfig = config;\n  }\n\n  /**\n   * Validate provider is configured\n   */\n  private ensureProvider(): void {\n    if (!this.providerConfig) {\n      throw new Error(\"Provider not configured. Call configureProvider() first.\");\n    }\n  }\n\n  // ============================================================================\n  // Resource Definition\n  // ============================================================================\n\n  /**\n   * Define a pipeline resource\n   */\n  definePipeline(name: string, resource: PipelineResource): void {\n    this.desiredState.set(`integrationhub_pipeline.${name}`, {\n      type: \"integrationhub_pipeline\",\n      data: resource,\n    });\n  }\n\n  /**\n   * Define a schedule resource\n   */\n  defineSchedule(name: string, resource: ScheduleResource): void {\n    this.desiredState.set(`integrationhub_schedule.${name}`, {\n      type: \"integrationhub_schedule\",\n      data: resource,\n    });\n  }\n\n  /**\n   * Define a webhook resource\n   */\n  defineWebhook(name: string, resource: WebhookResource): void {\n    this.desiredState.set(`integrationhub_webhook.${name}`, {\n      type: \"integrationhub_webhook\",\n      data: resource,\n    });\n  }\n\n  /**\n   * Define a budget resource\n   */\n  defineBudget(name: string, resource: BudgetResource): void {\n    this.desiredState.set(`integrationhub_budget.${name}`, {\n      type: \"integrationhub_budget\",\n      data: resource,\n    });\n  }\n\n  /**\n   * Define a notification resource\n   */\n  defineNotification(name: string, resource: NotificationResource): void {\n    this.desiredState.set(`integrationhub_notification.${name}`, {\n      type: \"integrationhub_notification\",\n      data: resource,\n    });\n  }\n\n  /**\n   * Define a plugin resource\n   */\n  definePlugin(name: string, resource: PluginResource): void {\n    this.desiredState.set(`integrationhub_plugin.${name}`, {\n      type: \"integrationhub_plugin\",\n      data: resource,\n    });\n  }\n\n  // ============================================================================\n  // Plan\n  // ============================================================================\n\n  /**\n   * Generate a plan showing changes\n   */\n  async plan(): Promise<TerraformPlan> {\n    this.ensureProvider();\n    this.emit(\"planStarted\");\n\n    const changes: ResourceChange[] = [];\n    const currentResources = new Map(\n      this.state.resources.map((r) => [`${r.type}.${r.name}`, r])\n    );\n\n    // Refresh state if configured\n    if (this.config.refreshOnPlan) {\n      await this.refresh();\n    }\n\n    // Check for creates and updates\n    for (const [key, desired] of this.desiredState) {\n      const current = currentResources.get(key);\n\n      if (!current) {\n        // Create\n        changes.push({\n          type: desired.type,\n          name: key.split(\".\")[1],\n          action: \"create\",\n          after: desired.data as Record<string, unknown>,\n        });\n      } else {\n        // Check for updates\n        const diff = this.calculateDiff(\n          current.attributes as Record<string, unknown>,\n          desired.data as Record<string, unknown>\n        );\n        if (diff.length > 0) {\n          changes.push({\n            type: desired.type,\n            name: key.split(\".\")[1],\n            action: \"update\",\n            before: current.attributes as Record<string, unknown>,\n            after: desired.data as Record<string, unknown>,\n            diff,\n          });\n        } else {\n          changes.push({\n            type: desired.type,\n            name: key.split(\".\")[1],\n            action: \"no-op\",\n          });\n        }\n      }\n\n      currentResources.delete(key);\n    }\n\n    // Check for deletes (resources in state but not in desired)\n    for (const [key, current] of currentResources) {\n      changes.push({\n        type: current.type,\n        name: current.name,\n        action: \"delete\",\n        before: current.attributes as Record<string, unknown>,\n      });\n    }\n\n    const plan: TerraformPlan = {\n      version: 1,\n      timestamp: new Date().toISOString(),\n      changes,\n      summary: {\n        toCreate: changes.filter((c) => c.action === \"create\").length,\n        toUpdate: changes.filter((c) => c.action === \"update\").length,\n        toDelete: changes.filter((c) => c.action === \"delete\").length,\n        toReplace: changes.filter((c) => c.action === \"replace\").length,\n        unchanged: changes.filter((c) => c.action === \"no-op\").length,\n      },\n    };\n\n    this.emit(\"planCompleted\", plan);\n    return plan;\n  }\n\n  // ============================================================================\n  // Apply\n  // ============================================================================\n\n  /**\n   * Apply changes from a plan\n   */\n  async apply(plan?: TerraformPlan): Promise<TerraformApplyResult> {\n    this.ensureProvider();\n\n    // Generate plan if not provided\n    const executionPlan = plan || (await this.plan());\n    this.emit(\"applyStarted\", executionPlan);\n\n    const startTime = Date.now();\n    const results: TerraformApplyResult[\"results\"] = [];\n\n    let created = 0;\n    let updated = 0;\n    let deleted = 0;\n    let failed = 0;\n\n    // Group changes by action for ordering (deletes first, then creates, then updates)\n    const deletes = executionPlan.changes.filter((c) => c.action === \"delete\");\n    const creates = executionPlan.changes.filter((c) => c.action === \"create\");\n    const updates = executionPlan.changes.filter((c) => c.action === \"update\");\n    const replaces = executionPlan.changes.filter((c) => c.action === \"replace\");\n\n    // Process deletes first\n    for (const change of deletes) {\n      const result = await this.applyDelete(change);\n      results.push({ resource: `${change.type}.${change.name}`, action: \"delete\", result });\n      if (result.success) {\n        deleted++;\n      } else {\n        failed++;\n      }\n    }\n\n    // Process creates\n    for (const change of creates) {\n      const result = await this.applyCreate(change);\n      results.push({ resource: `${change.type}.${change.name}`, action: \"create\", result });\n      if (result.success) {\n        created++;\n      } else {\n        failed++;\n      }\n    }\n\n    // Process updates\n    for (const change of updates) {\n      const result = await this.applyUpdate(change);\n      results.push({ resource: `${change.type}.${change.name}`, action: \"update\", result });\n      if (result.success) {\n        updated++;\n      } else {\n        failed++;\n      }\n    }\n\n    // Process replaces (delete then create)\n    for (const change of replaces) {\n      const deleteResult = await this.applyDelete(change);\n      if (deleteResult.success) {\n        const createResult = await this.applyCreate(change);\n        results.push({ resource: `${change.type}.${change.name}`, action: \"replace\", result: createResult });\n        if (createResult.success) {\n          created++;\n          deleted++;\n        } else {\n          failed++;\n        }\n      } else {\n        results.push({ resource: `${change.type}.${change.name}`, action: \"replace\", result: deleteResult });\n        failed++;\n      }\n    }\n\n    // Save state\n    await this.saveState();\n\n    const applyResult: TerraformApplyResult = {\n      success: failed === 0,\n      results,\n      summary: { created, updated, deleted, failed },\n      duration: Date.now() - startTime,\n    };\n\n    this.emit(\"applyCompleted\", applyResult);\n    return applyResult;\n  }\n\n  // ============================================================================\n  // State Management\n  // ============================================================================\n\n  /**\n   * Refresh state from remote\n   */\n  async refresh(): Promise<void> {\n    this.ensureProvider();\n\n    // In a real implementation, this would fetch current state from the API\n    // For now, we just emit the event\n    this.emit(\"stateRefreshed\");\n  }\n\n  /**\n   * Import an existing resource into state\n   */\n  async import(\n    type: TerraformResourceType,\n    name: string,\n    resourceId: string\n  ): Promise<ResourceState> {\n    this.ensureProvider();\n\n    // Fetch resource from API\n    const attributes = await this.fetchResource(type, resourceId);\n\n    const resource: ResourceState = {\n      id: resourceId,\n      type,\n      name,\n      attributes,\n      meta: {\n        createdAt: new Date().toISOString(),\n        updatedAt: new Date().toISOString(),\n        version: 1,\n        checksum: this.calculateChecksum(attributes),\n      },\n    };\n\n    this.state.resources.push(resource);\n    this.state.serial++;\n\n    await this.saveState();\n\n    return resource;\n  }\n\n  /**\n   * Remove a resource from state (without deleting it)\n   */\n  removeFromState(type: TerraformResourceType, name: string): boolean {\n    const key = `${type}.${name}`;\n    const index = this.state.resources.findIndex(\n      (r) => `${r.type}.${r.name}` === key\n    );\n\n    if (index >= 0) {\n      this.state.resources.splice(index, 1);\n      this.state.serial++;\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Get current state\n   */\n  getState(): TerraformState {\n    return { ...this.state };\n  }\n\n  /**\n   * Load state from storage\n   */\n  async loadState(state: TerraformState): Promise<void> {\n    this.state = state;\n  }\n\n  // ============================================================================\n  // HCL Parsing & Generation\n  // ============================================================================\n\n  /**\n   * Parse HCL configuration\n   */\n  parseHCL(hclContent: string): HCLConfig {\n    // Simplified HCL parsing - in reality would use a proper HCL parser\n    const config: HCLConfig = {\n      resources: [],\n      variables: {},\n      outputs: {},\n    };\n\n    // Parse terraform block\n    const terraformMatch = hclContent.match(/terraform\\s*\\{[\\s\\S]*?required_providers\\s*\\{([\\s\\S]*?)\\}/);\n    if (terraformMatch) {\n      config.terraform = { requiredProviders: {} };\n    }\n\n    // Parse resources\n    const resourceRegex = /resource\\s+\"(\\w+)\"\\s+\"(\\w+)\"\\s*\\{([\\s\\S]*?)\\n\\}/g;\n    let match;\n    while ((match = resourceRegex.exec(hclContent)) !== null) {\n      const [, type, name, body] = match;\n      config.resources?.push({\n        type: \"resource\",\n        labels: [type, name],\n        attributes: this.parseHCLAttributes(body),\n      });\n    }\n\n    // Parse variables\n    const variableRegex = /variable\\s+\"(\\w+)\"\\s*\\{([\\s\\S]*?)\\n\\}/g;\n    while ((match = variableRegex.exec(hclContent)) !== null) {\n      const [, name, body] = match;\n      const attrs = this.parseHCLAttributes(body);\n      config.variables![name] = {\n        type: attrs.type as string,\n        default: attrs.default,\n        description: attrs.description as string,\n        sensitive: attrs.sensitive as boolean,\n      };\n    }\n\n    // Parse outputs\n    const outputRegex = /output\\s+\"(\\w+)\"\\s*\\{([\\s\\S]*?)\\n\\}/g;\n    while ((match = outputRegex.exec(hclContent)) !== null) {\n      const [, name, body] = match;\n      const attrs = this.parseHCLAttributes(body);\n      config.outputs![name] = {\n        value: attrs.value as string,\n        description: attrs.description as string,\n        sensitive: attrs.sensitive as boolean,\n      };\n    }\n\n    return config;\n  }\n\n  /**\n   * Generate HCL from resources\n   */\n  generateHCL(): string {\n    const lines: string[] = [];\n\n    // Terraform block\n    lines.push('terraform {');\n    lines.push('  required_providers {');\n    lines.push('    integrationhub = {');\n    lines.push('      source  = \"gicm/integrationhub\"');\n    lines.push(`      version = \"~> ${this.config.providerVersion}\"`);\n    lines.push('    }');\n    lines.push('  }');\n    lines.push('}');\n    lines.push('');\n\n    // Provider block\n    lines.push('provider \"integrationhub\" {');\n    if (this.providerConfig) {\n      lines.push(`  api_key = var.api_key`);\n      if (this.providerConfig.organizationId) {\n        lines.push(`  organization_id = \"${this.providerConfig.organizationId}\"`);\n      }\n    }\n    lines.push('}');\n    lines.push('');\n\n    // Resources\n    for (const [key, { type, data }] of this.desiredState) {\n      const name = key.split(\".\")[1];\n      lines.push(`resource \"${type}\" \"${name}\" {`);\n      lines.push(this.attributesToHCL(data as Record<string, unknown>, 2));\n      lines.push('}');\n      lines.push('');\n    }\n\n    return lines.join('\\n');\n  }\n\n  // ============================================================================\n  // Validation\n  // ============================================================================\n\n  /**\n   * Validate configuration\n   */\n  validate(): { valid: boolean; errors: string[] } {\n    const errors: string[] = [];\n\n    // Check provider\n    if (!this.providerConfig) {\n      errors.push(\"Provider not configured\");\n    }\n\n    // Check for duplicate names\n    const names = new Set<string>();\n    for (const key of this.desiredState.keys()) {\n      if (names.has(key)) {\n        errors.push(`Duplicate resource: ${key}`);\n      }\n      names.add(key);\n    }\n\n    // Validate resource references\n    for (const [key, { type, data }] of this.desiredState) {\n      if (type === \"integrationhub_schedule\") {\n        const schedule = data as ScheduleResource;\n        const pipelineKey = `integrationhub_pipeline.${schedule.pipelineId}`;\n        if (!this.desiredState.has(pipelineKey) && !this.state.resources.find(r => r.id === schedule.pipelineId)) {\n          errors.push(`Schedule ${key} references unknown pipeline: ${schedule.pipelineId}`);\n        }\n      }\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n    };\n  }\n\n  // ============================================================================\n  // Private Methods\n  // ============================================================================\n\n  private async applyCreate(change: ResourceChange): Promise<{ success: boolean; resourceId?: string; error?: string; duration: number }> {\n    const startTime = Date.now();\n    const resourceKey = `${change.type}.${change.name}`;\n\n    this.emit(\"resourceCreating\", change.type, change.name);\n\n    try {\n      // In reality, this would call the API\n      const resourceId = randomUUID();\n\n      // Add to state\n      const resource: ResourceState = {\n        id: resourceId,\n        type: change.type,\n        name: change.name,\n        attributes: change.after || {},\n        meta: {\n          createdAt: new Date().toISOString(),\n          updatedAt: new Date().toISOString(),\n          version: 1,\n          checksum: this.calculateChecksum(change.after || {}),\n        },\n      };\n\n      this.state.resources.push(resource);\n      this.state.serial++;\n\n      this.emit(\"resourceCreated\", change.type, change.name, resourceId);\n\n      return {\n        success: true,\n        resourceId,\n        duration: Date.now() - startTime,\n      };\n    } catch (error) {\n      this.emit(\"resourceError\", change.type, change.name, error instanceof Error ? error : new Error(String(error)));\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n        duration: Date.now() - startTime,\n      };\n    }\n  }\n\n  private async applyUpdate(change: ResourceChange): Promise<{ success: boolean; error?: string; duration: number }> {\n    const startTime = Date.now();\n\n    this.emit(\"resourceUpdating\", change.type, change.name);\n\n    try {\n      // Find and update in state\n      const index = this.state.resources.findIndex(\n        (r) => r.type === change.type && r.name === change.name\n      );\n\n      if (index >= 0) {\n        this.state.resources[index].attributes = change.after || {};\n        this.state.resources[index].meta.updatedAt = new Date().toISOString();\n        this.state.resources[index].meta.version++;\n        this.state.resources[index].meta.checksum = this.calculateChecksum(change.after || {});\n        this.state.serial++;\n      }\n\n      this.emit(\"resourceUpdated\", change.type, change.name);\n\n      return {\n        success: true,\n        duration: Date.now() - startTime,\n      };\n    } catch (error) {\n      this.emit(\"resourceError\", change.type, change.name, error instanceof Error ? error : new Error(String(error)));\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n        duration: Date.now() - startTime,\n      };\n    }\n  }\n\n  private async applyDelete(change: ResourceChange): Promise<{ success: boolean; error?: string; duration: number }> {\n    const startTime = Date.now();\n\n    this.emit(\"resourceDeleting\", change.type, change.name);\n\n    try {\n      // Remove from state\n      const index = this.state.resources.findIndex(\n        (r) => r.type === change.type && r.name === change.name\n      );\n\n      if (index >= 0) {\n        this.state.resources.splice(index, 1);\n        this.state.serial++;\n      }\n\n      this.emit(\"resourceDeleted\", change.type, change.name);\n\n      return {\n        success: true,\n        duration: Date.now() - startTime,\n      };\n    } catch (error) {\n      this.emit(\"resourceError\", change.type, change.name, error instanceof Error ? error : new Error(String(error)));\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n        duration: Date.now() - startTime,\n      };\n    }\n  }\n\n  private async saveState(): Promise<void> {\n    // In reality, this would persist state to configured backend\n    this.emit(\"stateSaved\");\n  }\n\n  private async fetchResource(type: TerraformResourceType, id: string): Promise<Record<string, unknown>> {\n    // In reality, this would fetch from API\n    return { id };\n  }\n\n  private calculateDiff(\n    before: Record<string, unknown>,\n    after: Record<string, unknown>\n  ): { path: string; oldValue: unknown; newValue: unknown }[] {\n    const diff: { path: string; oldValue: unknown; newValue: unknown }[] = [];\n\n    const allKeys = new Set([...Object.keys(before), ...Object.keys(after)]);\n\n    for (const key of allKeys) {\n      const oldValue = before[key];\n      const newValue = after[key];\n\n      if (JSON.stringify(oldValue) !== JSON.stringify(newValue)) {\n        diff.push({ path: key, oldValue, newValue });\n      }\n    }\n\n    return diff;\n  }\n\n  private calculateChecksum(data: Record<string, unknown>): string {\n    return createHash(\"sha256\").update(JSON.stringify(data)).digest(\"hex\").slice(0, 16);\n  }\n\n  private parseHCLAttributes(body: string): Record<string, unknown> {\n    const attributes: Record<string, unknown> = {};\n    const attrRegex = /(\\w+)\\s*=\\s*(\".*?\"|[^\\n]+)/g;\n    let match;\n\n    while ((match = attrRegex.exec(body)) !== null) {\n      const [, key, value] = match;\n      let parsedValue: unknown = value.trim();\n\n      // Remove quotes from strings\n      if (typeof parsedValue === \"string\" && parsedValue.startsWith('\"') && parsedValue.endsWith('\"')) {\n        parsedValue = parsedValue.slice(1, -1);\n      }\n      // Parse booleans\n      else if (parsedValue === \"true\") {\n        parsedValue = true;\n      } else if (parsedValue === \"false\") {\n        parsedValue = false;\n      }\n      // Parse numbers\n      else if (!isNaN(Number(parsedValue))) {\n        parsedValue = Number(parsedValue);\n      }\n\n      attributes[key] = parsedValue;\n    }\n\n    return attributes;\n  }\n\n  private attributesToHCL(attrs: Record<string, unknown>, indent: number): string {\n    const spaces = \" \".repeat(indent);\n    const lines: string[] = [];\n\n    for (const [key, value] of Object.entries(attrs)) {\n      if (value === undefined || value === null) continue;\n\n      if (typeof value === \"string\") {\n        lines.push(`${spaces}${key} = \"${value}\"`);\n      } else if (typeof value === \"number\" || typeof value === \"boolean\") {\n        lines.push(`${spaces}${key} = ${value}`);\n      } else if (Array.isArray(value)) {\n        lines.push(`${spaces}${key} = ${JSON.stringify(value)}`);\n      } else if (typeof value === \"object\") {\n        lines.push(`${spaces}${key} {`);\n        lines.push(this.attributesToHCL(value as Record<string, unknown>, indent + 2));\n        lines.push(`${spaces}}`);\n      }\n    }\n\n    return lines.join(\"\\n\");\n  }\n\n  /**\n   * Get summary of terraform manager state\n   */\n  getSummary(): {\n    resourceCount: number;\n    desiredResourceCount: number;\n    stateSerial: number;\n    providerConfigured: boolean;\n  } {\n    return {\n      resourceCount: this.state.resources.length,\n      desiredResourceCount: this.desiredState.size,\n      stateSerial: this.state.serial,\n      providerConfigured: this.providerConfig !== null,\n    };\n  }\n}\n\n// ============================================================================\n// Singleton & Factory\n// ============================================================================\n\nlet terraformManagerInstance: TerraformManager | null = null;\n\nexport function getTerraformManager(): TerraformManager {\n  if (!terraformManagerInstance) {\n    terraformManagerInstance = new TerraformManager();\n  }\n  return terraformManagerInstance;\n}\n\nexport function createTerraformManager(config: Partial<TerraformManagerConfig> = {}): TerraformManager {\n  return new TerraformManager(config);\n}\n","/**\n * VS Code Extension Types\n * Phase 11D: IDE Integration\n */\n\nimport { z } from \"zod\";\n\n// ============================================================================\n// Extension State\n// ============================================================================\n\nexport const ExtensionStateSchema = z.enum([\n  \"inactive\",\n  \"activating\",\n  \"active\",\n  \"error\",\n]);\nexport type ExtensionState = z.infer<typeof ExtensionStateSchema>;\n\n// ============================================================================\n// Configuration\n// ============================================================================\n\nexport const ExtensionConfigSchema = z.object({\n  apiKey: z.string().optional(),\n  baseUrl: z.string().url().default(\"https://api.integrationhub.io\"),\n  organizationId: z.string().optional(),\n  autoRefresh: z.boolean().default(true),\n  refreshIntervalMs: z.number().default(30000),\n  showNotifications: z.boolean().default(true),\n  showStatusBar: z.boolean().default(true),\n  defaultEditor: z.enum([\"yaml\", \"visual\"]).default(\"visual\"),\n  telemetry: z.boolean().default(true),\n});\nexport type ExtensionConfig = z.infer<typeof ExtensionConfigSchema>;\n\n// ============================================================================\n// Tree View Items\n// ============================================================================\n\nexport const TreeItemTypeSchema = z.enum([\n  \"pipeline\",\n  \"schedule\",\n  \"execution\",\n  \"step\",\n  \"budget\",\n  \"webhook\",\n  \"notification\",\n  \"folder\",\n]);\nexport type TreeItemType = z.infer<typeof TreeItemTypeSchema>;\n\nexport const TreeItemStateSchema = z.enum([\n  \"default\",\n  \"running\",\n  \"success\",\n  \"error\",\n  \"warning\",\n  \"disabled\",\n]);\nexport type TreeItemState = z.infer<typeof TreeItemStateSchema>;\n\nexport const TreeItemSchema = z.object({\n  id: z.string(),\n  type: TreeItemTypeSchema,\n  label: z.string(),\n  description: z.string().optional(),\n  tooltip: z.string().optional(),\n  state: TreeItemStateSchema.default(\"default\"),\n  icon: z.string().optional(),\n  contextValue: z.string().optional(),\n  children: z.array(z.lazy(() => TreeItemSchema)).optional(),\n  command: z.object({\n    command: z.string(),\n    title: z.string(),\n    arguments: z.array(z.unknown()).optional(),\n  }).optional(),\n});\nexport type TreeItem = z.infer<typeof TreeItemSchema>;\n\n// ============================================================================\n// Editor\n// ============================================================================\n\nexport const EditorTypeSchema = z.enum([\n  \"pipeline\",\n  \"schedule\",\n  \"config\",\n  \"execution\",\n]);\nexport type EditorType = z.infer<typeof EditorTypeSchema>;\n\nexport const EditorStateSchema = z.object({\n  type: EditorTypeSchema,\n  resourceId: z.string().optional(),\n  isDirty: z.boolean().default(false),\n  content: z.string(),\n  cursor: z.object({\n    line: z.number(),\n    column: z.number(),\n  }).optional(),\n  selection: z.object({\n    start: z.object({ line: z.number(), column: z.number() }),\n    end: z.object({ line: z.number(), column: z.number() }),\n  }).optional(),\n});\nexport type EditorState = z.infer<typeof EditorStateSchema>;\n\n// ============================================================================\n// Diagnostics\n// ============================================================================\n\nexport const DiagnosticSeveritySchema = z.enum([\n  \"error\",\n  \"warning\",\n  \"info\",\n  \"hint\",\n]);\nexport type DiagnosticSeverity = z.infer<typeof DiagnosticSeveritySchema>;\n\nexport const DiagnosticSchema = z.object({\n  severity: DiagnosticSeveritySchema,\n  message: z.string(),\n  source: z.string().default(\"Integration Hub\"),\n  code: z.string().optional(),\n  range: z.object({\n    startLine: z.number(),\n    startColumn: z.number(),\n    endLine: z.number(),\n    endColumn: z.number(),\n  }),\n  relatedInformation: z.array(z.object({\n    location: z.object({\n      uri: z.string(),\n      range: z.object({\n        startLine: z.number(),\n        startColumn: z.number(),\n        endLine: z.number(),\n        endColumn: z.number(),\n      }),\n    }),\n    message: z.string(),\n  })).optional(),\n});\nexport type Diagnostic = z.infer<typeof DiagnosticSchema>;\n\n// ============================================================================\n// Commands\n// ============================================================================\n\nexport const CommandSchema = z.object({\n  command: z.string(),\n  title: z.string(),\n  category: z.string().default(\"Integration Hub\"),\n  icon: z.string().optional(),\n  enablement: z.string().optional(),\n  keybinding: z.object({\n    key: z.string(),\n    mac: z.string().optional(),\n    when: z.string().optional(),\n  }).optional(),\n});\nexport type Command = z.infer<typeof CommandSchema>;\n\n// ============================================================================\n// Status Bar\n// ============================================================================\n\nexport const StatusBarItemSchema = z.object({\n  id: z.string(),\n  text: z.string(),\n  tooltip: z.string().optional(),\n  command: z.string().optional(),\n  color: z.string().optional(),\n  backgroundColor: z.string().optional(),\n  priority: z.number().default(0),\n  alignment: z.enum([\"left\", \"right\"]).default(\"left\"),\n});\nexport type StatusBarItem = z.infer<typeof StatusBarItemSchema>;\n\n// ============================================================================\n// Quick Pick\n// ============================================================================\n\nexport const QuickPickItemSchema = z.object({\n  label: z.string(),\n  description: z.string().optional(),\n  detail: z.string().optional(),\n  picked: z.boolean().optional(),\n  alwaysShow: z.boolean().optional(),\n  iconPath: z.string().optional(),\n  buttons: z.array(z.object({\n    iconPath: z.string(),\n    tooltip: z.string(),\n  })).optional(),\n});\nexport type QuickPickItem = z.infer<typeof QuickPickItemSchema>;\n\n// ============================================================================\n// Notifications\n// ============================================================================\n\nexport const NotificationTypeSchema = z.enum([\n  \"info\",\n  \"warning\",\n  \"error\",\n]);\nexport type VSCodeNotificationType = z.infer<typeof NotificationTypeSchema>;\n\nexport const NotificationActionSchema = z.object({\n  title: z.string(),\n  isCloseAffordance: z.boolean().optional(),\n  command: z.string().optional(),\n});\nexport type NotificationAction = z.infer<typeof NotificationActionSchema>;\n\nexport const VSCodeNotificationSchema = z.object({\n  type: NotificationTypeSchema,\n  message: z.string(),\n  actions: z.array(NotificationActionSchema).optional(),\n  modal: z.boolean().optional(),\n});\nexport type VSCodeNotification = z.infer<typeof VSCodeNotificationSchema>;\n\n// ============================================================================\n// Webview\n// ============================================================================\n\nexport const WebviewTypeSchema = z.enum([\n  \"pipelineVisualEditor\",\n  \"executionViewer\",\n  \"dashboardPanel\",\n  \"settingsEditor\",\n  \"welcomePanel\",\n]);\nexport type WebviewType = z.infer<typeof WebviewTypeSchema>;\n\nexport const WebviewMessageSchema = z.object({\n  type: z.string(),\n  payload: z.unknown(),\n});\nexport type WebviewMessage = z.infer<typeof WebviewMessageSchema>;\n\nexport const WebviewStateSchema = z.object({\n  type: WebviewTypeSchema,\n  title: z.string(),\n  resourceId: z.string().optional(),\n  state: z.record(z.unknown()),\n});\nexport type WebviewState = z.infer<typeof WebviewStateSchema>;\n\n// ============================================================================\n// Completion\n// ============================================================================\n\nexport const CompletionItemKindSchema = z.enum([\n  \"text\",\n  \"method\",\n  \"function\",\n  \"constructor\",\n  \"field\",\n  \"variable\",\n  \"class\",\n  \"interface\",\n  \"module\",\n  \"property\",\n  \"keyword\",\n  \"snippet\",\n  \"value\",\n  \"constant\",\n  \"enum\",\n  \"folder\",\n  \"file\",\n]);\nexport type CompletionItemKind = z.infer<typeof CompletionItemKindSchema>;\n\nexport const CompletionItemSchema = z.object({\n  label: z.string(),\n  kind: CompletionItemKindSchema,\n  detail: z.string().optional(),\n  documentation: z.string().optional(),\n  insertText: z.string().optional(),\n  insertTextRules: z.number().optional(),\n  sortText: z.string().optional(),\n  filterText: z.string().optional(),\n  preselect: z.boolean().optional(),\n  commitCharacters: z.array(z.string()).optional(),\n  additionalTextEdits: z.array(z.object({\n    range: z.object({\n      startLine: z.number(),\n      startColumn: z.number(),\n      endLine: z.number(),\n      endColumn: z.number(),\n    }),\n    newText: z.string(),\n  })).optional(),\n});\nexport type CompletionItem = z.infer<typeof CompletionItemSchema>;\n\n// ============================================================================\n// Hover\n// ============================================================================\n\nexport const HoverContentSchema = z.object({\n  contents: z.array(z.union([\n    z.string(),\n    z.object({\n      language: z.string(),\n      value: z.string(),\n    }),\n  ])),\n  range: z.object({\n    startLine: z.number(),\n    startColumn: z.number(),\n    endLine: z.number(),\n    endColumn: z.number(),\n  }).optional(),\n});\nexport type HoverContent = z.infer<typeof HoverContentSchema>;\n\n// ============================================================================\n// Code Actions\n// ============================================================================\n\nexport const CodeActionKindSchema = z.enum([\n  \"quickFix\",\n  \"refactor\",\n  \"refactor.extract\",\n  \"refactor.inline\",\n  \"refactor.rewrite\",\n  \"source\",\n  \"source.organizeImports\",\n  \"source.fixAll\",\n]);\nexport type CodeActionKind = z.infer<typeof CodeActionKindSchema>;\n\nexport const CodeActionSchema = z.object({\n  title: z.string(),\n  kind: CodeActionKindSchema,\n  diagnostics: z.array(DiagnosticSchema).optional(),\n  isPreferred: z.boolean().optional(),\n  disabled: z.object({ reason: z.string() }).optional(),\n  edit: z.object({\n    changes: z.record(z.array(z.object({\n      range: z.object({\n        startLine: z.number(),\n        startColumn: z.number(),\n        endLine: z.number(),\n        endColumn: z.number(),\n      }),\n      newText: z.string(),\n    }))),\n  }).optional(),\n  command: z.object({\n    command: z.string(),\n    title: z.string(),\n    arguments: z.array(z.unknown()).optional(),\n  }).optional(),\n});\nexport type CodeAction = z.infer<typeof CodeActionSchema>;\n\n// ============================================================================\n// Extension Manager Config\n// ============================================================================\n\nexport const VSCodeManagerConfigSchema = z.object({\n  extensionId: z.string().default(\"gicm.integration-hub\"),\n  version: z.string().default(\"1.0.0\"),\n  displayName: z.string().default(\"Integration Hub\"),\n  description: z.string().default(\"AI-powered pipeline orchestration\"),\n  enableDebugLogging: z.boolean().default(false),\n});\nexport type VSCodeManagerConfig = z.infer<typeof VSCodeManagerConfigSchema>;\n\n// ============================================================================\n// Events\n// ============================================================================\n\nexport type VSCodeEvents = {\n  // Lifecycle\n  activated: () => void;\n  deactivated: () => void;\n  configChanged: (config: ExtensionConfig) => void;\n\n  // Editor\n  editorOpened: (type: EditorType, resourceId?: string) => void;\n  editorClosed: (type: EditorType, resourceId?: string) => void;\n  editorSaved: (type: EditorType, resourceId?: string, content: string) => void;\n\n  // Tree View\n  treeItemSelected: (item: TreeItem) => void;\n  treeItemExpanded: (item: TreeItem) => void;\n  treeRefreshed: () => void;\n\n  // Commands\n  commandExecuted: (command: string, args?: unknown[]) => void;\n\n  // Webview\n  webviewOpened: (type: WebviewType) => void;\n  webviewClosed: (type: WebviewType) => void;\n  webviewMessage: (type: WebviewType, message: WebviewMessage) => void;\n\n  // Errors\n  error: (error: Error) => void;\n};\n\n// ============================================================================\n// Default Commands\n// ============================================================================\n\nexport const DEFAULT_COMMANDS: Command[] = [\n  {\n    command: \"integrationHub.createPipeline\",\n    title: \"Create Pipeline\",\n    category: \"Integration Hub\",\n    icon: \"$(add)\",\n    keybinding: { key: \"ctrl+shift+p\", mac: \"cmd+shift+p\", when: \"editorFocus\" },\n  },\n  {\n    command: \"integrationHub.runPipeline\",\n    title: \"Run Pipeline\",\n    category: \"Integration Hub\",\n    icon: \"$(play)\",\n    keybinding: { key: \"ctrl+shift+r\", mac: \"cmd+shift+r\" },\n  },\n  {\n    command: \"integrationHub.stopPipeline\",\n    title: \"Stop Pipeline\",\n    category: \"Integration Hub\",\n    icon: \"$(debug-stop)\",\n  },\n  {\n    command: \"integrationHub.openPipeline\",\n    title: \"Open Pipeline\",\n    category: \"Integration Hub\",\n    icon: \"$(file-code)\",\n  },\n  {\n    command: \"integrationHub.deletePipeline\",\n    title: \"Delete Pipeline\",\n    category: \"Integration Hub\",\n    icon: \"$(trash)\",\n  },\n  {\n    command: \"integrationHub.refreshTree\",\n    title: \"Refresh\",\n    category: \"Integration Hub\",\n    icon: \"$(refresh)\",\n  },\n  {\n    command: \"integrationHub.openSettings\",\n    title: \"Open Settings\",\n    category: \"Integration Hub\",\n    icon: \"$(gear)\",\n  },\n  {\n    command: \"integrationHub.openDashboard\",\n    title: \"Open Dashboard\",\n    category: \"Integration Hub\",\n    icon: \"$(dashboard)\",\n  },\n  {\n    command: \"integrationHub.viewExecution\",\n    title: \"View Execution\",\n    category: \"Integration Hub\",\n    icon: \"$(list-tree)\",\n  },\n  {\n    command: \"integrationHub.createSchedule\",\n    title: \"Create Schedule\",\n    category: \"Integration Hub\",\n    icon: \"$(calendar)\",\n  },\n  {\n    command: \"integrationHub.validatePipeline\",\n    title: \"Validate Pipeline\",\n    category: \"Integration Hub\",\n    icon: \"$(check)\",\n  },\n  {\n    command: \"integrationHub.formatDocument\",\n    title: \"Format Pipeline Document\",\n    category: \"Integration Hub\",\n    icon: \"$(symbol-misc)\",\n  },\n];\n\n// ============================================================================\n// Pipeline YAML Snippets\n// ============================================================================\n\nexport const PIPELINE_SNIPPETS: CompletionItem[] = [\n  {\n    label: \"pipeline\",\n    kind: \"snippet\",\n    detail: \"Create a new pipeline\",\n    documentation: \"Creates a new pipeline configuration with basic structure\",\n    insertText: `name: \\${1:my-pipeline}\ndescription: \\${2:Pipeline description}\nversion: 1\n\nsteps:\n  - name: \\${3:step-name}\n    type: \\${4|llm,transform,condition,parallel,loop|}\n    config:\n      \\${5:# configuration}\n`,\n  },\n  {\n    label: \"step-llm\",\n    kind: \"snippet\",\n    detail: \"Add an LLM step\",\n    documentation: \"Creates an LLM step for AI processing\",\n    insertText: `- name: \\${1:llm-step}\n  type: llm\n  config:\n    model: \\${2|claude-3-sonnet,claude-3-opus,claude-3-haiku,gpt-4,gpt-4-turbo|}\n    prompt: |\n      \\${3:Your prompt here}\n    temperature: \\${4:0.7}\n    max_tokens: \\${5:1000}\n`,\n  },\n  {\n    label: \"step-transform\",\n    kind: \"snippet\",\n    detail: \"Add a transform step\",\n    documentation: \"Creates a data transformation step\",\n    insertText: `- name: \\${1:transform-step}\n  type: transform\n  config:\n    operation: \\${2|map,filter,reduce,flatten,merge|}\n    input: \\${3:\\\\$\\\\{previous.output\\\\}}\n    expression: |\n      \\${4:// transformation logic}\n`,\n  },\n  {\n    label: \"step-condition\",\n    kind: \"snippet\",\n    detail: \"Add a conditional step\",\n    documentation: \"Creates a conditional branching step\",\n    insertText: `- name: \\${1:condition-step}\n  type: condition\n  config:\n    condition: \\${2:\\\\$\\\\{previous.output.score > 0.5\\\\}}\n    then: \\${3:step-if-true}\n    else: \\${4:step-if-false}\n`,\n  },\n  {\n    label: \"step-parallel\",\n    kind: \"snippet\",\n    detail: \"Add parallel execution\",\n    documentation: \"Creates parallel step execution\",\n    insertText: `- name: \\${1:parallel-step}\n  type: parallel\n  config:\n    branches:\n      - \\${2:branch-a}\n      - \\${3:branch-b}\n    wait_all: true\n`,\n  },\n  {\n    label: \"step-loop\",\n    kind: \"snippet\",\n    detail: \"Add a loop step\",\n    documentation: \"Creates a loop/iteration step\",\n    insertText: `- name: \\${1:loop-step}\n  type: loop\n  config:\n    items: \\${2:\\\\$\\\\{input.items\\\\}}\n    step: \\${3:process-item}\n    max_iterations: \\${4:100}\n    parallel: \\${5:false}\n`,\n  },\n  {\n    label: \"schedule\",\n    kind: \"snippet\",\n    detail: \"Add a schedule\",\n    documentation: \"Creates a schedule configuration\",\n    insertText: `schedule:\n  cron: \"\\${1:0 9 * * 1-5}\"\n  timezone: \\${2:UTC}\n  enabled: true\n`,\n  },\n  {\n    label: \"budget\",\n    kind: \"snippet\",\n    detail: \"Add budget limits\",\n    documentation: \"Creates budget configuration\",\n    insertText: `budget:\n  daily_limit: \\${1:100}\n  monthly_limit: \\${2:2000}\n  alert_thresholds:\n    - 50\n    - 75\n    - 90\n`,\n  },\n];\n","/**\n * VS Code Extension Manager\n * Phase 11D: IDE Integration\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport { randomUUID } from \"crypto\";\nimport {\n  type ExtensionState,\n  type ExtensionConfig,\n  type TreeItem,\n  type TreeItemType,\n  type TreeItemState,\n  type EditorType,\n  type EditorState,\n  type Diagnostic,\n  type DiagnosticSeverity,\n  type Command,\n  type StatusBarItem,\n  type QuickPickItem,\n  type VSCodeNotification,\n  type WebviewType,\n  type WebviewMessage,\n  type WebviewState,\n  type CompletionItem,\n  type HoverContent,\n  type CodeAction,\n  type VSCodeManagerConfig,\n  type VSCodeEvents,\n  VSCodeManagerConfigSchema,\n  ExtensionConfigSchema,\n  DEFAULT_COMMANDS,\n  PIPELINE_SNIPPETS,\n} from \"./types.js\";\n\n// ============================================================================\n// VS Code Extension Manager Class\n// ============================================================================\n\nexport class VSCodeManager extends EventEmitter<VSCodeEvents> {\n  private managerConfig: VSCodeManagerConfig;\n  private extensionConfig: ExtensionConfig;\n  private state: ExtensionState = \"inactive\";\n  private treeData: Map<string, TreeItem[]> = new Map();\n  private editors: Map<string, EditorState> = new Map();\n  private diagnostics: Map<string, Diagnostic[]> = new Map();\n  private webviews: Map<string, WebviewState> = new Map();\n  private statusBarItems: Map<string, StatusBarItem> = new Map();\n  private refreshInterval: NodeJS.Timeout | null = null;\n\n  constructor(config: Partial<VSCodeManagerConfig> = {}) {\n    super();\n    this.managerConfig = VSCodeManagerConfigSchema.parse(config);\n    this.extensionConfig = ExtensionConfigSchema.parse({});\n  }\n\n  // ============================================================================\n  // Lifecycle\n  // ============================================================================\n\n  /**\n   * Activate the extension\n   */\n  async activate(): Promise<void> {\n    if (this.state === \"active\") {\n      return;\n    }\n\n    this.state = \"activating\";\n\n    try {\n      // Initialize components\n      await this.initializeTreeViews();\n      await this.initializeStatusBar();\n      await this.registerCommands();\n      await this.registerLanguageFeatures();\n\n      // Start auto-refresh if configured\n      if (this.extensionConfig.autoRefresh) {\n        this.startAutoRefresh();\n      }\n\n      this.state = \"active\";\n      this.emit(\"activated\");\n    } catch (error) {\n      this.state = \"error\";\n      this.emit(\"error\", error instanceof Error ? error : new Error(String(error)));\n      throw error;\n    }\n  }\n\n  /**\n   * Deactivate the extension\n   */\n  async deactivate(): Promise<void> {\n    if (this.state !== \"active\") {\n      return;\n    }\n\n    // Stop auto-refresh\n    this.stopAutoRefresh();\n\n    // Close all editors\n    for (const [id] of this.editors) {\n      await this.closeEditor(id);\n    }\n\n    // Close all webviews\n    for (const [id] of this.webviews) {\n      await this.closeWebview(id);\n    }\n\n    // Clear status bar\n    this.statusBarItems.clear();\n\n    this.state = \"inactive\";\n    this.emit(\"deactivated\");\n  }\n\n  /**\n   * Update configuration\n   */\n  updateConfig(config: Partial<ExtensionConfig>): void {\n    const oldConfig = this.extensionConfig;\n    this.extensionConfig = ExtensionConfigSchema.parse({\n      ...this.extensionConfig,\n      ...config,\n    });\n\n    // Handle config changes\n    if (this.extensionConfig.autoRefresh !== oldConfig.autoRefresh) {\n      if (this.extensionConfig.autoRefresh) {\n        this.startAutoRefresh();\n      } else {\n        this.stopAutoRefresh();\n      }\n    }\n\n    this.emit(\"configChanged\", this.extensionConfig);\n  }\n\n  // ============================================================================\n  // Tree Views\n  // ============================================================================\n\n  /**\n   * Get tree items for a view\n   */\n  getTreeItems(viewId: string): TreeItem[] {\n    return this.treeData.get(viewId) || [];\n  }\n\n  /**\n   * Refresh tree view\n   */\n  async refreshTreeView(viewId?: string): Promise<void> {\n    if (viewId) {\n      await this.loadTreeData(viewId);\n    } else {\n      // Refresh all tree views\n      for (const id of this.treeData.keys()) {\n        await this.loadTreeData(id);\n      }\n    }\n    this.emit(\"treeRefreshed\");\n  }\n\n  /**\n   * Select tree item\n   */\n  selectTreeItem(item: TreeItem): void {\n    this.emit(\"treeItemSelected\", item);\n\n    // Execute command if defined\n    if (item.command) {\n      this.executeCommand(item.command.command, item.command.arguments);\n    }\n  }\n\n  /**\n   * Expand tree item\n   */\n  expandTreeItem(item: TreeItem): void {\n    this.emit(\"treeItemExpanded\", item);\n  }\n\n  // ============================================================================\n  // Editors\n  // ============================================================================\n\n  /**\n   * Open an editor\n   */\n  async openEditor(type: EditorType, resourceId?: string): Promise<string> {\n    const editorId = resourceId ? `${type}:${resourceId}` : `${type}:new-${randomUUID()}`;\n\n    // Fetch content\n    const content = await this.fetchEditorContent(type, resourceId);\n\n    const editorState: EditorState = {\n      type,\n      resourceId,\n      isDirty: false,\n      content,\n    };\n\n    this.editors.set(editorId, editorState);\n    this.emit(\"editorOpened\", type, resourceId);\n\n    return editorId;\n  }\n\n  /**\n   * Close an editor\n   */\n  async closeEditor(editorId: string): Promise<void> {\n    const editor = this.editors.get(editorId);\n    if (!editor) {\n      return;\n    }\n\n    // Check for unsaved changes\n    if (editor.isDirty) {\n      // In real VS Code, would prompt user\n      console.warn(`Editor ${editorId} has unsaved changes`);\n    }\n\n    this.editors.delete(editorId);\n    this.emit(\"editorClosed\", editor.type, editor.resourceId);\n  }\n\n  /**\n   * Save editor content\n   */\n  async saveEditor(editorId: string): Promise<void> {\n    const editor = this.editors.get(editorId);\n    if (!editor) {\n      throw new Error(`Editor not found: ${editorId}`);\n    }\n\n    // Validate before saving\n    const diagnostics = await this.validateContent(editor.content, editor.type);\n    const hasErrors = diagnostics.some((d) => d.severity === \"error\");\n\n    if (hasErrors) {\n      throw new Error(\"Cannot save: document has errors\");\n    }\n\n    // Save to API\n    await this.saveEditorContent(editor);\n\n    editor.isDirty = false;\n    this.emit(\"editorSaved\", editor.type, editor.resourceId, editor.content);\n  }\n\n  /**\n   * Update editor content\n   */\n  updateEditorContent(editorId: string, content: string): void {\n    const editor = this.editors.get(editorId);\n    if (!editor) {\n      return;\n    }\n\n    editor.content = content;\n    editor.isDirty = true;\n\n    // Re-validate\n    this.validateContent(content, editor.type).then((diagnostics) => {\n      this.diagnostics.set(editorId, diagnostics);\n    });\n  }\n\n  // ============================================================================\n  // Diagnostics\n  // ============================================================================\n\n  /**\n   * Get diagnostics for an editor\n   */\n  getDiagnostics(editorId: string): Diagnostic[] {\n    return this.diagnostics.get(editorId) || [];\n  }\n\n  /**\n   * Validate content and return diagnostics\n   */\n  async validateContent(content: string, type: EditorType): Promise<Diagnostic[]> {\n    const diagnostics: Diagnostic[] = [];\n\n    if (type === \"pipeline\") {\n      // Validate YAML structure\n      try {\n        // Would use yaml parser here\n        if (!content.includes(\"name:\")) {\n          diagnostics.push({\n            severity: \"error\",\n            message: \"Pipeline must have a name\",\n            source: \"Integration Hub\",\n            range: { startLine: 1, startColumn: 1, endLine: 1, endColumn: 1 },\n          });\n        }\n\n        if (!content.includes(\"steps:\")) {\n          diagnostics.push({\n            severity: \"error\",\n            message: \"Pipeline must have at least one step\",\n            source: \"Integration Hub\",\n            range: { startLine: 1, startColumn: 1, endLine: 1, endColumn: 1 },\n          });\n        }\n\n        // Check for deprecated features\n        if (content.includes(\"api_key:\")) {\n          diagnostics.push({\n            severity: \"warning\",\n            message: \"api_key should be defined in environment variables, not in pipeline\",\n            source: \"Integration Hub\",\n            code: \"deprecated-api-key\",\n            range: { startLine: 1, startColumn: 1, endLine: 1, endColumn: 1 },\n          });\n        }\n      } catch {\n        diagnostics.push({\n          severity: \"error\",\n          message: \"Invalid YAML syntax\",\n          source: \"Integration Hub\",\n          range: { startLine: 1, startColumn: 1, endLine: 1, endColumn: 1 },\n        });\n      }\n    }\n\n    return diagnostics;\n  }\n\n  // ============================================================================\n  // Commands\n  // ============================================================================\n\n  /**\n   * Get available commands\n   */\n  getCommands(): Command[] {\n    return DEFAULT_COMMANDS;\n  }\n\n  /**\n   * Execute a command\n   */\n  async executeCommand(command: string, args?: unknown[]): Promise<unknown> {\n    this.emit(\"commandExecuted\", command, args);\n\n    switch (command) {\n      case \"integrationHub.createPipeline\":\n        return this.openEditor(\"pipeline\");\n\n      case \"integrationHub.runPipeline\":\n        return this.runPipeline(args?.[0] as string);\n\n      case \"integrationHub.stopPipeline\":\n        return this.stopPipeline(args?.[0] as string);\n\n      case \"integrationHub.openPipeline\":\n        return this.openEditor(\"pipeline\", args?.[0] as string);\n\n      case \"integrationHub.deletePipeline\":\n        return this.deletePipeline(args?.[0] as string);\n\n      case \"integrationHub.refreshTree\":\n        return this.refreshTreeView();\n\n      case \"integrationHub.openSettings\":\n        return this.openWebview(\"settingsEditor\");\n\n      case \"integrationHub.openDashboard\":\n        return this.openWebview(\"dashboardPanel\");\n\n      case \"integrationHub.viewExecution\":\n        return this.openWebview(\"executionViewer\", args?.[0] as string);\n\n      case \"integrationHub.createSchedule\":\n        return this.openEditor(\"schedule\");\n\n      case \"integrationHub.validatePipeline\":\n        return this.validateCurrentEditor();\n\n      case \"integrationHub.formatDocument\":\n        return this.formatCurrentDocument();\n\n      default:\n        console.warn(`Unknown command: ${command}`);\n        return undefined;\n    }\n  }\n\n  // ============================================================================\n  // Status Bar\n  // ============================================================================\n\n  /**\n   * Update status bar item\n   */\n  updateStatusBarItem(item: StatusBarItem): void {\n    this.statusBarItems.set(item.id, item);\n  }\n\n  /**\n   * Get status bar items\n   */\n  getStatusBarItems(): StatusBarItem[] {\n    return Array.from(this.statusBarItems.values()).sort((a, b) => b.priority - a.priority);\n  }\n\n  // ============================================================================\n  // Quick Pick\n  // ============================================================================\n\n  /**\n   * Show quick pick\n   */\n  async showQuickPick(\n    items: QuickPickItem[],\n    options?: { title?: string; placeholder?: string; canPickMany?: boolean }\n  ): Promise<QuickPickItem | QuickPickItem[] | undefined> {\n    // In real VS Code, would show UI\n    // This is a mock implementation\n    if (items.length === 0) {\n      return undefined;\n    }\n\n    return options?.canPickMany ? items : items[0];\n  }\n\n  // ============================================================================\n  // Notifications\n  // ============================================================================\n\n  /**\n   * Show notification\n   */\n  async showNotification(notification: VSCodeNotification): Promise<string | undefined> {\n    if (!this.extensionConfig.showNotifications) {\n      return undefined;\n    }\n\n    // In real VS Code, would show notification\n    console.log(`[${notification.type.toUpperCase()}] ${notification.message}`);\n\n    // Return first action title if any\n    return notification.actions?.[0]?.title;\n  }\n\n  // ============================================================================\n  // Webviews\n  // ============================================================================\n\n  /**\n   * Open a webview\n   */\n  async openWebview(type: WebviewType, resourceId?: string): Promise<string> {\n    const webviewId = resourceId ? `${type}:${resourceId}` : `${type}:${randomUUID()}`;\n\n    const webviewState: WebviewState = {\n      type,\n      title: this.getWebviewTitle(type),\n      resourceId,\n      state: {},\n    };\n\n    this.webviews.set(webviewId, webviewState);\n    this.emit(\"webviewOpened\", type);\n\n    return webviewId;\n  }\n\n  /**\n   * Close a webview\n   */\n  async closeWebview(webviewId: string): Promise<void> {\n    const webview = this.webviews.get(webviewId);\n    if (!webview) {\n      return;\n    }\n\n    this.webviews.delete(webviewId);\n    this.emit(\"webviewClosed\", webview.type);\n  }\n\n  /**\n   * Send message to webview\n   */\n  postMessageToWebview(webviewId: string, message: WebviewMessage): void {\n    const webview = this.webviews.get(webviewId);\n    if (!webview) {\n      return;\n    }\n\n    this.emit(\"webviewMessage\", webview.type, message);\n  }\n\n  /**\n   * Handle message from webview\n   */\n  handleWebviewMessage(webviewId: string, message: WebviewMessage): void {\n    const webview = this.webviews.get(webviewId);\n    if (!webview) {\n      return;\n    }\n\n    // Route message based on type\n    switch (message.type) {\n      case \"save\":\n        this.handleWebviewSave(webview, message.payload);\n        break;\n      case \"execute\":\n        this.handleWebviewExecute(webview, message.payload);\n        break;\n      case \"navigate\":\n        this.handleWebviewNavigate(webview, message.payload);\n        break;\n      default:\n        this.emit(\"webviewMessage\", webview.type, message);\n    }\n  }\n\n  // ============================================================================\n  // Language Features\n  // ============================================================================\n\n  /**\n   * Get completions\n   */\n  getCompletions(\n    _content: string,\n    _position: { line: number; column: number }\n  ): CompletionItem[] {\n    // Return pipeline snippets for now\n    return PIPELINE_SNIPPETS;\n  }\n\n  /**\n   * Get hover information\n   */\n  getHover(\n    content: string,\n    position: { line: number; column: number }\n  ): HoverContent | undefined {\n    // Simple implementation - would be more sophisticated in real extension\n    const lines = content.split(\"\\n\");\n    const line = lines[position.line - 1] || \"\";\n\n    // Check for known keywords\n    if (line.includes(\"type: llm\")) {\n      return {\n        contents: [\n          { language: \"markdown\", value: \"**LLM Step**\" },\n          \"Executes an AI model to process input and generate output.\",\n          \"**Available models:** claude-3-opus, claude-3-sonnet, gpt-4, etc.\",\n        ],\n      };\n    }\n\n    if (line.includes(\"type: transform\")) {\n      return {\n        contents: [\n          { language: \"markdown\", value: \"**Transform Step**\" },\n          \"Transforms data using JavaScript expressions or built-in operations.\",\n        ],\n      };\n    }\n\n    return undefined;\n  }\n\n  /**\n   * Get code actions\n   */\n  getCodeActions(editorId: string): CodeAction[] {\n    const diagnostics = this.getDiagnostics(editorId);\n    const actions: CodeAction[] = [];\n\n    for (const diagnostic of diagnostics) {\n      if (diagnostic.code === \"deprecated-api-key\") {\n        actions.push({\n          title: \"Move API key to environment variables\",\n          kind: \"quickFix\",\n          diagnostics: [diagnostic],\n          isPreferred: true,\n        });\n      }\n\n      if (diagnostic.message.includes(\"must have a name\")) {\n        actions.push({\n          title: \"Add pipeline name\",\n          kind: \"quickFix\",\n          diagnostics: [diagnostic],\n          edit: {\n            changes: {\n              [editorId]: [\n                {\n                  range: { startLine: 1, startColumn: 1, endLine: 1, endColumn: 1 },\n                  newText: \"name: my-pipeline\\n\",\n                },\n              ],\n            },\n          },\n        });\n      }\n    }\n\n    return actions;\n  }\n\n  // ============================================================================\n  // Private Methods\n  // ============================================================================\n\n  private async initializeTreeViews(): Promise<void> {\n    // Initialize pipelines tree\n    this.treeData.set(\"pipelines\", []);\n    await this.loadTreeData(\"pipelines\");\n\n    // Initialize schedules tree\n    this.treeData.set(\"schedules\", []);\n    await this.loadTreeData(\"schedules\");\n\n    // Initialize executions tree\n    this.treeData.set(\"executions\", []);\n    await this.loadTreeData(\"executions\");\n  }\n\n  private async loadTreeData(viewId: string): Promise<void> {\n    // In reality, would fetch from API\n    const items: TreeItem[] = [];\n\n    switch (viewId) {\n      case \"pipelines\":\n        items.push(\n          this.createTreeItem(\"pipeline\", \"content-generator\", \"Content Generator\", \"running\"),\n          this.createTreeItem(\"pipeline\", \"data-extraction\", \"Data Extraction\", \"default\"),\n          this.createTreeItem(\"pipeline\", \"reporting\", \"Reporting Pipeline\", \"success\")\n        );\n        break;\n\n      case \"schedules\":\n        items.push(\n          this.createTreeItem(\"schedule\", \"daily-content\", \"Daily Content (9am)\", \"default\"),\n          this.createTreeItem(\"schedule\", \"weekly-report\", \"Weekly Report (Mon)\", \"default\")\n        );\n        break;\n\n      case \"executions\":\n        items.push(\n          this.createTreeItem(\"execution\", \"exec-1\", \"content-generator #123\", \"running\"),\n          this.createTreeItem(\"execution\", \"exec-2\", \"data-extraction #456\", \"success\"),\n          this.createTreeItem(\"execution\", \"exec-3\", \"reporting #789\", \"error\")\n        );\n        break;\n    }\n\n    this.treeData.set(viewId, items);\n  }\n\n  private createTreeItem(\n    type: TreeItemType,\n    id: string,\n    label: string,\n    state: TreeItemState\n  ): TreeItem {\n    return {\n      id,\n      type,\n      label,\n      state,\n      contextValue: type,\n      command: {\n        command: `integrationHub.open${type.charAt(0).toUpperCase() + type.slice(1)}`,\n        title: `Open ${type}`,\n        arguments: [id],\n      },\n    };\n  }\n\n  private async initializeStatusBar(): Promise<void> {\n    if (!this.extensionConfig.showStatusBar) {\n      return;\n    }\n\n    this.updateStatusBarItem({\n      id: \"status\",\n      text: \"$(cloud) Integration Hub\",\n      tooltip: \"Integration Hub: Connected\",\n      command: \"integrationHub.openDashboard\",\n      priority: 100,\n      alignment: \"left\",\n    });\n\n    this.updateStatusBarItem({\n      id: \"budget\",\n      text: \"$(credit-card) $45.20\",\n      tooltip: \"Today's spend: $45.20 / $100\",\n      command: \"integrationHub.openSettings\",\n      priority: 99,\n      alignment: \"left\",\n    });\n  }\n\n  private async registerCommands(): Promise<void> {\n    // Commands are registered via getCommands()\n    // In real VS Code, would register with vscode.commands.registerCommand\n  }\n\n  private async registerLanguageFeatures(): Promise<void> {\n    // In real VS Code, would register:\n    // - CompletionItemProvider\n    // - HoverProvider\n    // - CodeActionProvider\n    // - DocumentFormattingEditProvider\n    // - etc.\n  }\n\n  private startAutoRefresh(): void {\n    if (this.refreshInterval) {\n      return;\n    }\n\n    this.refreshInterval = setInterval(async () => {\n      await this.refreshTreeView();\n    }, this.extensionConfig.refreshIntervalMs);\n  }\n\n  private stopAutoRefresh(): void {\n    if (this.refreshInterval) {\n      clearInterval(this.refreshInterval);\n      this.refreshInterval = null;\n    }\n  }\n\n  private async fetchEditorContent(type: EditorType, resourceId?: string): Promise<string> {\n    // In reality, would fetch from API\n    if (!resourceId) {\n      // Return template for new documents\n      switch (type) {\n        case \"pipeline\":\n          return `name: new-pipeline\ndescription: A new pipeline\n\nsteps:\n  - name: step-1\n    type: llm\n    config:\n      model: claude-3-sonnet\n      prompt: \"Your prompt here\"\n`;\n        case \"schedule\":\n          return `pipeline_id: \"\"\nname: new-schedule\ncron_expression: \"0 9 * * 1-5\"\ntimezone: UTC\nenabled: true\n`;\n        default:\n          return \"\";\n      }\n    }\n\n    // Return mock content for existing resource\n    return `name: ${resourceId}\ndescription: Loaded from API\n\nsteps:\n  - name: example-step\n    type: llm\n    config:\n      model: claude-3-sonnet\n      prompt: \"Process the input\"\n`;\n  }\n\n  private async saveEditorContent(_editor: EditorState): Promise<void> {\n    // In reality, would save to API\n  }\n\n  private async runPipeline(pipelineId: string): Promise<void> {\n    await this.showNotification({\n      type: \"info\",\n      message: `Starting pipeline: ${pipelineId}`,\n    });\n  }\n\n  private async stopPipeline(pipelineId: string): Promise<void> {\n    await this.showNotification({\n      type: \"info\",\n      message: `Stopping pipeline: ${pipelineId}`,\n    });\n  }\n\n  private async deletePipeline(pipelineId: string): Promise<void> {\n    await this.showNotification({\n      type: \"warning\",\n      message: `Deleted pipeline: ${pipelineId}`,\n    });\n    await this.refreshTreeView(\"pipelines\");\n  }\n\n  private async validateCurrentEditor(): Promise<void> {\n    // Would validate currently active editor\n    await this.showNotification({\n      type: \"info\",\n      message: \"Pipeline validation passed\",\n    });\n  }\n\n  private async formatCurrentDocument(): Promise<void> {\n    // Would format currently active document\n    await this.showNotification({\n      type: \"info\",\n      message: \"Document formatted\",\n    });\n  }\n\n  private getWebviewTitle(type: WebviewType): string {\n    const titles: Record<WebviewType, string> = {\n      pipelineVisualEditor: \"Pipeline Editor\",\n      executionViewer: \"Execution Details\",\n      dashboardPanel: \"Integration Hub Dashboard\",\n      settingsEditor: \"Settings\",\n      welcomePanel: \"Welcome to Integration Hub\",\n    };\n    return titles[type];\n  }\n\n  private handleWebviewSave(_webview: WebviewState, _payload: unknown): void {\n    // Handle save from webview\n  }\n\n  private handleWebviewExecute(_webview: WebviewState, _payload: unknown): void {\n    // Handle execute from webview\n  }\n\n  private handleWebviewNavigate(_webview: WebviewState, _payload: unknown): void {\n    // Handle navigation from webview\n  }\n\n  /**\n   * Get summary of extension state\n   */\n  getSummary(): {\n    state: ExtensionState;\n    openEditors: number;\n    openWebviews: number;\n    registeredCommands: number;\n    autoRefreshEnabled: boolean;\n  } {\n    return {\n      state: this.state,\n      openEditors: this.editors.size,\n      openWebviews: this.webviews.size,\n      registeredCommands: DEFAULT_COMMANDS.length,\n      autoRefreshEnabled: this.extensionConfig.autoRefresh,\n    };\n  }\n}\n\n// ============================================================================\n// Singleton & Factory\n// ============================================================================\n\nlet vscodeManagerInstance: VSCodeManager | null = null;\n\nexport function getVSCodeManager(): VSCodeManager {\n  if (!vscodeManagerInstance) {\n    vscodeManagerInstance = new VSCodeManager();\n  }\n  return vscodeManagerInstance;\n}\n\nexport function createVSCodeManager(config: Partial<VSCodeManagerConfig> = {}): VSCodeManager {\n  return new VSCodeManager(config);\n}\n","/**\n * High Availability Types\n * Phase 12A: Multi-Region Support\n */\n\nimport { z } from \"zod\";\n\n// =============================================================================\n// REGION CONFIGURATION\n// =============================================================================\n\nexport const RegionSchema = z.enum([\n  \"us-east-1\",\n  \"us-west-2\",\n  \"eu-west-1\",\n  \"eu-central-1\",\n  \"ap-southeast-1\",\n  \"ap-northeast-1\",\n]);\nexport type Region = z.infer<typeof RegionSchema>;\n\nexport const RegionStatusSchema = z.enum([\n  \"active\",\n  \"standby\",\n  \"degraded\",\n  \"offline\",\n  \"draining\",\n]);\nexport type RegionStatus = z.infer<typeof RegionStatusSchema>;\n\nexport const RegionConfigSchema = z.object({\n  id: z.string(),\n  region: RegionSchema,\n  endpoint: z.string().url(),\n  status: RegionStatusSchema,\n  isPrimary: z.boolean(),\n  weight: z.number().min(0).max(100).default(100),\n  healthEndpoint: z.string().optional(),\n  metadata: z.record(z.unknown()).optional(),\n});\nexport type RegionConfig = z.infer<typeof RegionConfigSchema>;\n\n// =============================================================================\n// HEALTH CHECK\n// =============================================================================\n\nexport const HealthCheckTypeSchema = z.enum([\n  \"http\",\n  \"tcp\",\n  \"grpc\",\n  \"custom\",\n]);\nexport type HealthCheckType = z.infer<typeof HealthCheckTypeSchema>;\n\nexport const HealthCheckResultSchema = z.object({\n  region: RegionSchema,\n  healthy: z.boolean(),\n  latencyMs: z.number(),\n  statusCode: z.number().optional(),\n  message: z.string().optional(),\n  checkedAt: z.string(),\n  consecutiveFailures: z.number().default(0),\n  lastSuccessAt: z.string().optional(),\n  lastFailureAt: z.string().optional(),\n});\nexport type HealthCheckResult = z.infer<typeof HealthCheckResultSchema>;\n\nexport const HealthCheckConfigSchema = z.object({\n  type: HealthCheckTypeSchema,\n  intervalMs: z.number().default(30000),\n  timeoutMs: z.number().default(5000),\n  unhealthyThreshold: z.number().default(3),\n  healthyThreshold: z.number().default(2),\n  path: z.string().default(\"/health\"),\n  expectedStatus: z.number().default(200),\n});\nexport type HealthCheckConfig = z.infer<typeof HealthCheckConfigSchema>;\n\n// =============================================================================\n// LOAD BALANCING\n// =============================================================================\n\nexport const LoadBalanceStrategySchema = z.enum([\n  \"round-robin\",\n  \"weighted\",\n  \"least-connections\",\n  \"latency-based\",\n  \"geo-proximity\",\n  \"failover\",\n]);\nexport type LoadBalanceStrategy = z.infer<typeof LoadBalanceStrategySchema>;\n\nexport const RouteDecisionSchema = z.object({\n  region: RegionSchema,\n  endpoint: z.string(),\n  reason: z.string(),\n  fallbackRegions: z.array(RegionSchema),\n  metadata: z.record(z.unknown()).optional(),\n});\nexport type RouteDecision = z.infer<typeof RouteDecisionSchema>;\n\n// =============================================================================\n// FAILOVER\n// =============================================================================\n\nexport const FailoverModeSchema = z.enum([\n  \"automatic\",\n  \"manual\",\n  \"semi-automatic\",\n]);\nexport type FailoverMode = z.infer<typeof FailoverModeSchema>;\n\nexport const FailoverEventSchema = z.object({\n  id: z.string(),\n  fromRegion: RegionSchema,\n  toRegion: RegionSchema,\n  reason: z.string(),\n  triggeredBy: z.enum([\"health-check\", \"manual\", \"scheduled\", \"capacity\"]),\n  startedAt: z.string(),\n  completedAt: z.string().optional(),\n  status: z.enum([\"in-progress\", \"completed\", \"failed\", \"rolled-back\"]),\n  affectedPipelines: z.number().default(0),\n  metadata: z.record(z.unknown()).optional(),\n});\nexport type FailoverEvent = z.infer<typeof FailoverEventSchema>;\n\nexport const FailoverConfigSchema = z.object({\n  mode: FailoverModeSchema.default(\"automatic\"),\n  triggerThreshold: z.number().default(3),\n  cooldownMs: z.number().default(300000),\n  maxFailoversPerHour: z.number().default(3),\n  notifyOnFailover: z.boolean().default(true),\n  requireApproval: z.boolean().default(false),\n  rollbackOnFailure: z.boolean().default(true),\n});\nexport type FailoverConfig = z.infer<typeof FailoverConfigSchema>;\n\n// =============================================================================\n// REPLICATION\n// =============================================================================\n\nexport const ReplicationModeSchema = z.enum([\n  \"sync\",\n  \"async\",\n  \"semi-sync\",\n]);\nexport type ReplicationMode = z.infer<typeof ReplicationModeSchema>;\n\nexport const ReplicationStatusSchema = z.object({\n  sourceRegion: RegionSchema,\n  targetRegion: RegionSchema,\n  mode: ReplicationModeSchema,\n  lagMs: z.number(),\n  bytesReplicated: z.number(),\n  lastReplicatedAt: z.string(),\n  healthy: z.boolean(),\n  error: z.string().optional(),\n});\nexport type ReplicationStatus = z.infer<typeof ReplicationStatusSchema>;\n\nexport const ReplicationConfigSchema = z.object({\n  mode: ReplicationModeSchema.default(\"async\"),\n  targetRegions: z.array(RegionSchema),\n  maxLagMs: z.number().default(5000),\n  batchSize: z.number().default(100),\n  retryAttempts: z.number().default(3),\n  conflictResolution: z.enum([\"last-write-wins\", \"merge\", \"manual\"]).default(\"last-write-wins\"),\n});\nexport type ReplicationConfig = z.infer<typeof ReplicationConfigSchema>;\n\n// =============================================================================\n// SESSION AFFINITY\n// =============================================================================\n\nexport const SessionAffinitySchema = z.object({\n  enabled: z.boolean().default(false),\n  ttlMs: z.number().default(3600000),\n  cookieName: z.string().default(\"gicm_region\"),\n  strategy: z.enum([\"cookie\", \"ip-hash\", \"header\"]).default(\"cookie\"),\n});\nexport type SessionAffinity = z.infer<typeof SessionAffinitySchema>;\n\n// =============================================================================\n// HA MANAGER CONFIGURATION\n// =============================================================================\n\nexport const HAManagerConfigSchema = z.object({\n  regions: z.array(RegionConfigSchema),\n  healthCheck: HealthCheckConfigSchema.optional(),\n  loadBalancing: z.object({\n    strategy: LoadBalanceStrategySchema.default(\"weighted\"),\n    stickySession: SessionAffinitySchema.optional(),\n  }).optional(),\n  failover: FailoverConfigSchema.optional(),\n  replication: ReplicationConfigSchema.optional(),\n  monitoring: z.object({\n    enabled: z.boolean().default(true),\n    metricsIntervalMs: z.number().default(60000),\n    alertThresholds: z.object({\n      latencyMs: z.number().default(500),\n      errorRate: z.number().default(0.05),\n      availabilityPercent: z.number().default(99.9),\n    }).optional(),\n  }).optional(),\n});\nexport type HAManagerConfig = z.infer<typeof HAManagerConfigSchema>;\n\n// =============================================================================\n// HA STATE\n// =============================================================================\n\nexport const HAStateSchema = z.object({\n  primaryRegion: RegionSchema,\n  activeRegions: z.array(RegionSchema),\n  regionHealth: z.record(RegionSchema, HealthCheckResultSchema),\n  replicationStatus: z.array(ReplicationStatusSchema),\n  lastFailover: FailoverEventSchema.optional(),\n  failoverCount24h: z.number().default(0),\n  globalLatencyMs: z.number(),\n  globalAvailability: z.number(),\n  lastUpdated: z.string(),\n});\nexport type HAState = z.infer<typeof HAStateSchema>;\n\n// =============================================================================\n// HA EVENTS\n// =============================================================================\n\nexport interface HAEvents {\n  \"health:checked\": (results: HealthCheckResult[]) => void;\n  \"health:degraded\": (region: Region, result: HealthCheckResult) => void;\n  \"health:recovered\": (region: Region, result: HealthCheckResult) => void;\n  \"failover:started\": (event: FailoverEvent) => void;\n  \"failover:completed\": (event: FailoverEvent) => void;\n  \"failover:failed\": (event: FailoverEvent, error: Error) => void;\n  \"replication:lag\": (status: ReplicationStatus) => void;\n  \"region:added\": (config: RegionConfig) => void;\n  \"region:removed\": (region: Region) => void;\n  \"region:status_changed\": (region: Region, oldStatus: RegionStatus, newStatus: RegionStatus) => void;\n}\n\n// =============================================================================\n// CONSTANTS\n// =============================================================================\n\nexport const REGION_DISPLAY_NAMES: Record<Region, string> = {\n  \"us-east-1\": \"US East (N. Virginia)\",\n  \"us-west-2\": \"US West (Oregon)\",\n  \"eu-west-1\": \"EU (Ireland)\",\n  \"eu-central-1\": \"EU (Frankfurt)\",\n  \"ap-southeast-1\": \"Asia Pacific (Singapore)\",\n  \"ap-northeast-1\": \"Asia Pacific (Tokyo)\",\n};\n\nexport const DEFAULT_HEALTH_CHECK_CONFIG: HealthCheckConfig = {\n  type: \"http\",\n  intervalMs: 30000,\n  timeoutMs: 5000,\n  unhealthyThreshold: 3,\n  healthyThreshold: 2,\n  path: \"/health\",\n  expectedStatus: 200,\n};\n\nexport const DEFAULT_FAILOVER_CONFIG: FailoverConfig = {\n  mode: \"automatic\",\n  triggerThreshold: 3,\n  cooldownMs: 300000,\n  maxFailoversPerHour: 3,\n  notifyOnFailover: true,\n  requireApproval: false,\n  rollbackOnFailure: true,\n};\n","/**\n * Health Checker\n * Phase 12A: Multi-Region Health Monitoring\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport type {\n  Region,\n  RegionConfig,\n  HealthCheckConfig,\n  HealthCheckResult,\n  HAEvents,\n} from \"./types.js\";\nimport { DEFAULT_HEALTH_CHECK_CONFIG } from \"./types.js\";\n\n// =============================================================================\n// HEALTH CHECKER\n// =============================================================================\n\nexport class HealthChecker extends EventEmitter<HAEvents> {\n  private config: HealthCheckConfig;\n  private regions: Map<Region, RegionConfig> = new Map();\n  private results: Map<Region, HealthCheckResult> = new Map();\n  private checkInterval: NodeJS.Timeout | null = null;\n  private consecutiveFailures: Map<Region, number> = new Map();\n  private consecutiveSuccesses: Map<Region, number> = new Map();\n\n  constructor(config: Partial<HealthCheckConfig> = {}) {\n    super();\n    this.config = { ...DEFAULT_HEALTH_CHECK_CONFIG, ...config };\n  }\n\n  // ===========================================================================\n  // REGION MANAGEMENT\n  // ===========================================================================\n\n  addRegion(regionConfig: RegionConfig): void {\n    this.regions.set(regionConfig.region, regionConfig);\n    this.consecutiveFailures.set(regionConfig.region, 0);\n    this.consecutiveSuccesses.set(regionConfig.region, 0);\n    console.log(`[HA] Added region for health checks: ${regionConfig.region}`);\n  }\n\n  removeRegion(region: Region): void {\n    this.regions.delete(region);\n    this.results.delete(region);\n    this.consecutiveFailures.delete(region);\n    this.consecutiveSuccesses.delete(region);\n    console.log(`[HA] Removed region from health checks: ${region}`);\n  }\n\n  // ===========================================================================\n  // HEALTH CHECK EXECUTION\n  // ===========================================================================\n\n  async checkRegion(region: Region): Promise<HealthCheckResult> {\n    const regionConfig = this.regions.get(region);\n    if (!regionConfig) {\n      throw new Error(`Region not configured: ${region}`);\n    }\n\n    const startTime = Date.now();\n    let healthy = false;\n    let statusCode: number | undefined;\n    let message: string | undefined;\n\n    try {\n      const healthEndpoint = regionConfig.healthEndpoint ||\n        `${regionConfig.endpoint}${this.config.path}`;\n\n      const controller = new AbortController();\n      const timeout = setTimeout(() => controller.abort(), this.config.timeoutMs);\n\n      try {\n        const response = await fetch(healthEndpoint, {\n          method: \"GET\",\n          signal: controller.signal,\n          headers: {\n            \"User-Agent\": \"gICM-HealthChecker/1.0\",\n            \"Accept\": \"application/json\",\n          },\n        });\n\n        clearTimeout(timeout);\n        statusCode = response.status;\n        healthy = response.status === this.config.expectedStatus;\n\n        if (!healthy) {\n          const body = await response.text().catch(() => \"\");\n          message = `Unexpected status: ${response.status}. ${body.slice(0, 100)}`;\n        }\n      } catch (fetchError) {\n        clearTimeout(timeout);\n        if (fetchError instanceof Error) {\n          if (fetchError.name === \"AbortError\") {\n            message = `Timeout after ${this.config.timeoutMs}ms`;\n          } else {\n            message = fetchError.message;\n          }\n        }\n      }\n    } catch (error) {\n      message = error instanceof Error ? error.message : \"Unknown error\";\n    }\n\n    const latencyMs = Date.now() - startTime;\n    const prevResult = this.results.get(region);\n    const prevFailures = this.consecutiveFailures.get(region) || 0;\n\n    // Update consecutive counters\n    if (healthy) {\n      this.consecutiveFailures.set(region, 0);\n      this.consecutiveSuccesses.set(region, (this.consecutiveSuccesses.get(region) || 0) + 1);\n    } else {\n      this.consecutiveSuccesses.set(region, 0);\n      this.consecutiveFailures.set(region, prevFailures + 1);\n    }\n\n    const result: HealthCheckResult = {\n      region,\n      healthy,\n      latencyMs,\n      statusCode,\n      message,\n      checkedAt: new Date().toISOString(),\n      consecutiveFailures: this.consecutiveFailures.get(region) || 0,\n      lastSuccessAt: healthy ? new Date().toISOString() : prevResult?.lastSuccessAt,\n      lastFailureAt: !healthy ? new Date().toISOString() : prevResult?.lastFailureAt,\n    };\n\n    this.results.set(region, result);\n\n    // Emit events for state transitions\n    if (prevResult?.healthy && !healthy) {\n      // Region became unhealthy\n      if (result.consecutiveFailures >= this.config.unhealthyThreshold) {\n        this.emit(\"health:degraded\", region, result);\n        console.log(`[HA] Region ${region} is DEGRADED (${result.consecutiveFailures} failures)`);\n      }\n    } else if (!prevResult?.healthy && healthy) {\n      // Region recovered\n      const successes = this.consecutiveSuccesses.get(region) || 0;\n      if (successes >= this.config.healthyThreshold) {\n        this.emit(\"health:recovered\", region, result);\n        console.log(`[HA] Region ${region} RECOVERED`);\n      }\n    }\n\n    return result;\n  }\n\n  async checkAllRegions(): Promise<HealthCheckResult[]> {\n    const regions = Array.from(this.regions.keys());\n    const results = await Promise.all(\n      regions.map(region => this.checkRegion(region).catch(error => ({\n        region,\n        healthy: false,\n        latencyMs: 0,\n        checkedAt: new Date().toISOString(),\n        consecutiveFailures: (this.consecutiveFailures.get(region) || 0) + 1,\n        message: error instanceof Error ? error.message : \"Check failed\",\n      } as HealthCheckResult)))\n    );\n\n    this.emit(\"health:checked\", results);\n    return results;\n  }\n\n  // ===========================================================================\n  // CONTINUOUS MONITORING\n  // ===========================================================================\n\n  start(): void {\n    if (this.checkInterval) {\n      console.log(\"[HA] Health checker already running\");\n      return;\n    }\n\n    console.log(`[HA] Starting health checker (interval: ${this.config.intervalMs}ms)`);\n\n    // Initial check\n    this.checkAllRegions().catch(err => {\n      console.error(\"[HA] Initial health check failed:\", err);\n    });\n\n    // Continuous checks\n    this.checkInterval = setInterval(() => {\n      this.checkAllRegions().catch(err => {\n        console.error(\"[HA] Health check failed:\", err);\n      });\n    }, this.config.intervalMs);\n  }\n\n  stop(): void {\n    if (this.checkInterval) {\n      clearInterval(this.checkInterval);\n      this.checkInterval = null;\n      console.log(\"[HA] Health checker stopped\");\n    }\n  }\n\n  // ===========================================================================\n  // GETTERS\n  // ===========================================================================\n\n  getResult(region: Region): HealthCheckResult | undefined {\n    return this.results.get(region);\n  }\n\n  getAllResults(): Map<Region, HealthCheckResult> {\n    return new Map(this.results);\n  }\n\n  getHealthyRegions(): Region[] {\n    return Array.from(this.results.entries())\n      .filter(([_, result]) => result.healthy)\n      .map(([region]) => region);\n  }\n\n  getUnhealthyRegions(): Region[] {\n    return Array.from(this.results.entries())\n      .filter(([_, result]) => !result.healthy)\n      .map(([region]) => region);\n  }\n\n  isRegionHealthy(region: Region): boolean {\n    const result = this.results.get(region);\n    return result?.healthy ?? false;\n  }\n\n  getAverageLatency(): number {\n    const results = Array.from(this.results.values()).filter(r => r.healthy);\n    if (results.length === 0) return 0;\n    return results.reduce((sum, r) => sum + r.latencyMs, 0) / results.length;\n  }\n\n  getGlobalAvailability(): number {\n    const total = this.results.size;\n    if (total === 0) return 100;\n    const healthy = this.getHealthyRegions().length;\n    return (healthy / total) * 100;\n  }\n}\n\n// =============================================================================\n// SINGLETON\n// =============================================================================\n\nlet healthCheckerInstance: HealthChecker | null = null;\n\nexport function getHealthChecker(): HealthChecker {\n  if (!healthCheckerInstance) {\n    healthCheckerInstance = new HealthChecker();\n  }\n  return healthCheckerInstance;\n}\n\nexport function createHealthChecker(config?: Partial<HealthCheckConfig>): HealthChecker {\n  healthCheckerInstance = new HealthChecker(config);\n  return healthCheckerInstance;\n}\n","/**\n * Load Balancer\n * Phase 12A: Multi-Region Traffic Distribution\n */\n\nimport type {\n  Region,\n  RegionConfig,\n  LoadBalanceStrategy,\n  RouteDecision,\n  SessionAffinity,\n  HealthCheckResult,\n} from \"./types.js\";\n\n// =============================================================================\n// LOAD BALANCER\n// =============================================================================\n\nexport class LoadBalancer {\n  private strategy: LoadBalanceStrategy;\n  private regions: Map<Region, RegionConfig> = new Map();\n  private healthResults: Map<Region, HealthCheckResult> = new Map();\n  private roundRobinIndex: number = 0;\n  private connectionCounts: Map<Region, number> = new Map();\n  private sessionAffinity: SessionAffinity | null = null;\n  private sessionMap: Map<string, Region> = new Map();\n\n  constructor(strategy: LoadBalanceStrategy = \"weighted\") {\n    this.strategy = strategy;\n  }\n\n  // ===========================================================================\n  // CONFIGURATION\n  // ===========================================================================\n\n  setStrategy(strategy: LoadBalanceStrategy): void {\n    this.strategy = strategy;\n    console.log(`[LB] Strategy set to: ${strategy}`);\n  }\n\n  setSessionAffinity(affinity: SessionAffinity | null): void {\n    this.sessionAffinity = affinity;\n    if (affinity?.enabled) {\n      console.log(`[LB] Session affinity enabled (TTL: ${affinity.ttlMs}ms)`);\n    }\n  }\n\n  addRegion(config: RegionConfig): void {\n    this.regions.set(config.region, config);\n    this.connectionCounts.set(config.region, 0);\n  }\n\n  removeRegion(region: Region): void {\n    this.regions.delete(region);\n    this.connectionCounts.delete(region);\n  }\n\n  updateHealth(region: Region, result: HealthCheckResult): void {\n    this.healthResults.set(region, result);\n  }\n\n  // ===========================================================================\n  // ROUTING DECISION\n  // ===========================================================================\n\n  route(options?: {\n    clientIp?: string;\n    sessionId?: string;\n    preferredRegion?: Region;\n    excludeRegions?: Region[];\n  }): RouteDecision | null {\n    const availableRegions = this.getAvailableRegions(options?.excludeRegions);\n\n    if (availableRegions.length === 0) {\n      console.warn(\"[LB] No available regions for routing\");\n      return null;\n    }\n\n    // Check session affinity first\n    if (this.sessionAffinity?.enabled && options?.sessionId) {\n      const sessionRegion = this.sessionMap.get(options.sessionId);\n      if (sessionRegion && availableRegions.includes(sessionRegion)) {\n        const config = this.regions.get(sessionRegion)!;\n        return {\n          region: sessionRegion,\n          endpoint: config.endpoint,\n          reason: \"session_affinity\",\n          fallbackRegions: this.getFallbackRegions(sessionRegion, availableRegions),\n        };\n      }\n    }\n\n    // Check preferred region\n    if (options?.preferredRegion && availableRegions.includes(options.preferredRegion)) {\n      const config = this.regions.get(options.preferredRegion)!;\n      return {\n        region: options.preferredRegion,\n        endpoint: config.endpoint,\n        reason: \"preferred\",\n        fallbackRegions: this.getFallbackRegions(options.preferredRegion, availableRegions),\n      };\n    }\n\n    // Apply load balancing strategy\n    let selectedRegion: Region;\n    let reason: string;\n\n    switch (this.strategy) {\n      case \"round-robin\":\n        selectedRegion = this.selectRoundRobin(availableRegions);\n        reason = \"round_robin\";\n        break;\n\n      case \"weighted\":\n        selectedRegion = this.selectWeighted(availableRegions);\n        reason = \"weighted\";\n        break;\n\n      case \"least-connections\":\n        selectedRegion = this.selectLeastConnections(availableRegions);\n        reason = \"least_connections\";\n        break;\n\n      case \"latency-based\":\n        selectedRegion = this.selectLatencyBased(availableRegions);\n        reason = \"latency_based\";\n        break;\n\n      case \"geo-proximity\":\n        selectedRegion = this.selectGeoProximity(availableRegions, options?.clientIp);\n        reason = \"geo_proximity\";\n        break;\n\n      case \"failover\":\n        selectedRegion = this.selectFailover(availableRegions);\n        reason = \"failover\";\n        break;\n\n      default:\n        selectedRegion = availableRegions[0];\n        reason = \"default\";\n    }\n\n    // Store session affinity\n    if (this.sessionAffinity?.enabled && options?.sessionId) {\n      this.sessionMap.set(options.sessionId, selectedRegion);\n      // Set TTL cleanup\n      setTimeout(() => {\n        this.sessionMap.delete(options.sessionId!);\n      }, this.sessionAffinity.ttlMs);\n    }\n\n    const config = this.regions.get(selectedRegion)!;\n    return {\n      region: selectedRegion,\n      endpoint: config.endpoint,\n      reason,\n      fallbackRegions: this.getFallbackRegions(selectedRegion, availableRegions),\n    };\n  }\n\n  // ===========================================================================\n  // STRATEGY IMPLEMENTATIONS\n  // ===========================================================================\n\n  private selectRoundRobin(regions: Region[]): Region {\n    const region = regions[this.roundRobinIndex % regions.length];\n    this.roundRobinIndex++;\n    return region;\n  }\n\n  private selectWeighted(regions: Region[]): Region {\n    const totalWeight = regions.reduce((sum, r) => {\n      const config = this.regions.get(r);\n      return sum + (config?.weight ?? 100);\n    }, 0);\n\n    let random = Math.random() * totalWeight;\n\n    for (const region of regions) {\n      const config = this.regions.get(region);\n      const weight = config?.weight ?? 100;\n      random -= weight;\n      if (random <= 0) {\n        return region;\n      }\n    }\n\n    return regions[0];\n  }\n\n  private selectLeastConnections(regions: Region[]): Region {\n    let minConnections = Infinity;\n    let selectedRegion = regions[0];\n\n    for (const region of regions) {\n      const connections = this.connectionCounts.get(region) ?? 0;\n      if (connections < minConnections) {\n        minConnections = connections;\n        selectedRegion = region;\n      }\n    }\n\n    return selectedRegion;\n  }\n\n  private selectLatencyBased(regions: Region[]): Region {\n    let minLatency = Infinity;\n    let selectedRegion = regions[0];\n\n    for (const region of regions) {\n      const health = this.healthResults.get(region);\n      const latency = health?.latencyMs ?? Infinity;\n      if (latency < minLatency) {\n        minLatency = latency;\n        selectedRegion = region;\n      }\n    }\n\n    return selectedRegion;\n  }\n\n  private selectGeoProximity(regions: Region[], clientIp?: string): Region {\n    // Simple geo-proximity based on region prefixes\n    // In production, use IP geolocation service\n    if (!clientIp) {\n      return this.selectLatencyBased(regions);\n    }\n\n    // Mock geo-based selection (in production, use MaxMind GeoIP or similar)\n    const geoHints: Record<string, Region[]> = {\n      \"10.\": [\"us-east-1\", \"us-west-2\"],\n      \"172.\": [\"eu-west-1\", \"eu-central-1\"],\n      \"192.168.\": [\"ap-southeast-1\", \"ap-northeast-1\"],\n    };\n\n    for (const [prefix, preferredRegions] of Object.entries(geoHints)) {\n      if (clientIp.startsWith(prefix)) {\n        const match = preferredRegions.find(r => regions.includes(r as Region));\n        if (match) return match as Region;\n      }\n    }\n\n    return this.selectLatencyBased(regions);\n  }\n\n  private selectFailover(regions: Region[]): Region {\n    // Prefer primary region, failover to standby in order\n    const primary = Array.from(this.regions.values())\n      .filter(r => r.isPrimary && regions.includes(r.region))\n      .sort((a, b) => b.weight - a.weight);\n\n    if (primary.length > 0) {\n      return primary[0].region;\n    }\n\n    // Fall back to highest weight standby\n    const standby = Array.from(this.regions.values())\n      .filter(r => regions.includes(r.region))\n      .sort((a, b) => b.weight - a.weight);\n\n    return standby[0]?.region ?? regions[0];\n  }\n\n  // ===========================================================================\n  // HELPERS\n  // ===========================================================================\n\n  private getAvailableRegions(excludeRegions?: Region[]): Region[] {\n    const exclude = new Set(excludeRegions ?? []);\n\n    return Array.from(this.regions.values())\n      .filter(config => {\n        // Exclude specified regions\n        if (exclude.has(config.region)) return false;\n\n        // Exclude offline/draining regions\n        if (config.status === \"offline\" || config.status === \"draining\") return false;\n\n        // Check health\n        const health = this.healthResults.get(config.region);\n        if (health && !health.healthy) return false;\n\n        return true;\n      })\n      .map(config => config.region);\n  }\n\n  private getFallbackRegions(selected: Region, available: Region[]): Region[] {\n    return available\n      .filter(r => r !== selected)\n      .sort((a, b) => {\n        const healthA = this.healthResults.get(a);\n        const healthB = this.healthResults.get(b);\n        return (healthA?.latencyMs ?? Infinity) - (healthB?.latencyMs ?? Infinity);\n      })\n      .slice(0, 2);\n  }\n\n  // ===========================================================================\n  // CONNECTION TRACKING\n  // ===========================================================================\n\n  incrementConnections(region: Region): void {\n    const current = this.connectionCounts.get(region) ?? 0;\n    this.connectionCounts.set(region, current + 1);\n  }\n\n  decrementConnections(region: Region): void {\n    const current = this.connectionCounts.get(region) ?? 0;\n    this.connectionCounts.set(region, Math.max(0, current - 1));\n  }\n\n  getConnectionCount(region: Region): number {\n    return this.connectionCounts.get(region) ?? 0;\n  }\n\n  // ===========================================================================\n  // STATS\n  // ===========================================================================\n\n  getStats(): {\n    strategy: LoadBalanceStrategy;\n    regionCount: number;\n    availableCount: number;\n    connectionsByRegion: Record<string, number>;\n    sessionCount: number;\n  } {\n    return {\n      strategy: this.strategy,\n      regionCount: this.regions.size,\n      availableCount: this.getAvailableRegions().length,\n      connectionsByRegion: Object.fromEntries(this.connectionCounts),\n      sessionCount: this.sessionMap.size,\n    };\n  }\n}\n\n// =============================================================================\n// SINGLETON\n// =============================================================================\n\nlet loadBalancerInstance: LoadBalancer | null = null;\n\nexport function getLoadBalancer(): LoadBalancer {\n  if (!loadBalancerInstance) {\n    loadBalancerInstance = new LoadBalancer();\n  }\n  return loadBalancerInstance;\n}\n\nexport function createLoadBalancer(strategy?: LoadBalanceStrategy): LoadBalancer {\n  loadBalancerInstance = new LoadBalancer(strategy);\n  return loadBalancerInstance;\n}\n","/**\n * Failover Manager\n * Phase 12A: Automatic Region Failover\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport type {\n  Region,\n  RegionConfig,\n  FailoverConfig,\n  FailoverEvent,\n  HealthCheckResult,\n  HAEvents,\n} from \"./types.js\";\nimport { DEFAULT_FAILOVER_CONFIG } from \"./types.js\";\n\n// =============================================================================\n// FAILOVER MANAGER\n// =============================================================================\n\nexport class FailoverManager extends EventEmitter<HAEvents> {\n  private config: FailoverConfig;\n  private regions: Map<Region, RegionConfig> = new Map();\n  private primaryRegion: Region | null = null;\n  private failoverHistory: FailoverEvent[] = [];\n  private lastFailoverTime: number = 0;\n  private pendingApprovals: Map<string, FailoverEvent> = new Map();\n  private failureCounts: Map<Region, number> = new Map();\n\n  constructor(config: Partial<FailoverConfig> = {}) {\n    super();\n    this.config = { ...DEFAULT_FAILOVER_CONFIG, ...config };\n  }\n\n  // ===========================================================================\n  // CONFIGURATION\n  // ===========================================================================\n\n  setConfig(config: Partial<FailoverConfig>): void {\n    this.config = { ...this.config, ...config };\n    console.log(\"[FAILOVER] Configuration updated\");\n  }\n\n  addRegion(regionConfig: RegionConfig): void {\n    this.regions.set(regionConfig.region, regionConfig);\n    this.failureCounts.set(regionConfig.region, 0);\n\n    if (regionConfig.isPrimary) {\n      this.primaryRegion = regionConfig.region;\n      console.log(`[FAILOVER] Primary region set: ${regionConfig.region}`);\n    }\n  }\n\n  removeRegion(region: Region): void {\n    const config = this.regions.get(region);\n    this.regions.delete(region);\n    this.failureCounts.delete(region);\n\n    if (config?.isPrimary && this.primaryRegion === region) {\n      // Auto-elect new primary\n      const candidates = Array.from(this.regions.values())\n        .filter(r => r.status === \"active\" || r.status === \"standby\")\n        .sort((a, b) => b.weight - a.weight);\n\n      if (candidates.length > 0) {\n        this.primaryRegion = candidates[0].region;\n        candidates[0].isPrimary = true;\n        console.log(`[FAILOVER] New primary elected: ${this.primaryRegion}`);\n      } else {\n        this.primaryRegion = null;\n        console.warn(\"[FAILOVER] No eligible primary region available\");\n      }\n    }\n  }\n\n  // ===========================================================================\n  // HEALTH MONITORING\n  // ===========================================================================\n\n  onHealthCheckResult(region: Region, result: HealthCheckResult): void {\n    if (result.healthy) {\n      // Reset failure count\n      this.failureCounts.set(region, 0);\n    } else {\n      // Increment failure count\n      const current = this.failureCounts.get(region) ?? 0;\n      const newCount = current + 1;\n      this.failureCounts.set(region, newCount);\n\n      console.log(`[FAILOVER] ${region} failure count: ${newCount}/${this.config.triggerThreshold}`);\n\n      // Check if failover should be triggered\n      if (newCount >= this.config.triggerThreshold && region === this.primaryRegion) {\n        this.evaluateFailover(region, \"health-check\");\n      }\n    }\n  }\n\n  // ===========================================================================\n  // FAILOVER EXECUTION\n  // ===========================================================================\n\n  async evaluateFailover(\n    fromRegion: Region,\n    triggeredBy: FailoverEvent[\"triggeredBy\"]\n  ): Promise<FailoverEvent | null> {\n    // Check cooldown\n    const now = Date.now();\n    if (now - this.lastFailoverTime < this.config.cooldownMs) {\n      console.log(`[FAILOVER] Cooldown active, skipping failover evaluation`);\n      return null;\n    }\n\n    // Check max failovers per hour\n    const recentFailovers = this.failoverHistory.filter(\n      f => now - new Date(f.startedAt).getTime() < 3600000\n    );\n    if (recentFailovers.length >= this.config.maxFailoversPerHour) {\n      console.warn(`[FAILOVER] Max failovers per hour (${this.config.maxFailoversPerHour}) reached`);\n      return null;\n    }\n\n    // Find target region\n    const targetRegion = this.selectFailoverTarget(fromRegion);\n    if (!targetRegion) {\n      console.error(\"[FAILOVER] No eligible failover target found\");\n      return null;\n    }\n\n    // Create failover event\n    const event: FailoverEvent = {\n      id: `fo_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`,\n      fromRegion,\n      toRegion: targetRegion,\n      reason: `${triggeredBy}: Region ${fromRegion} became unhealthy`,\n      triggeredBy,\n      startedAt: new Date().toISOString(),\n      status: \"in-progress\",\n      affectedPipelines: 0,\n    };\n\n    // Check if approval required\n    if (this.config.requireApproval && this.config.mode !== \"automatic\") {\n      event.status = \"in-progress\";\n      this.pendingApprovals.set(event.id, event);\n      console.log(`[FAILOVER] Awaiting approval for failover: ${event.id}`);\n\n      if (this.config.notifyOnFailover) {\n        this.emit(\"failover:started\", event);\n      }\n\n      return event;\n    }\n\n    // Execute failover\n    return this.executeFailover(event);\n  }\n\n  async executeFailover(event: FailoverEvent): Promise<FailoverEvent> {\n    console.log(`[FAILOVER] Executing failover: ${event.fromRegion} -> ${event.toRegion}`);\n\n    this.emit(\"failover:started\", event);\n\n    try {\n      // Update region statuses\n      const fromConfig = this.regions.get(event.fromRegion);\n      const toConfig = this.regions.get(event.toRegion);\n\n      if (fromConfig) {\n        fromConfig.status = \"standby\";\n        fromConfig.isPrimary = false;\n      }\n\n      if (toConfig) {\n        toConfig.status = \"active\";\n        toConfig.isPrimary = true;\n        this.primaryRegion = event.toRegion;\n      }\n\n      // Update region status events\n      if (fromConfig) {\n        this.emit(\"region:status_changed\", event.fromRegion, \"active\", \"standby\");\n      }\n      if (toConfig) {\n        this.emit(\"region:status_changed\", event.toRegion, toConfig.status, \"active\");\n      }\n\n      // Mark as completed\n      event.status = \"completed\";\n      event.completedAt = new Date().toISOString();\n\n      // Update tracking\n      this.lastFailoverTime = Date.now();\n      this.failoverHistory.push(event);\n      this.pendingApprovals.delete(event.id);\n\n      console.log(`[FAILOVER] Completed: ${event.toRegion} is now primary`);\n      this.emit(\"failover:completed\", event);\n\n      return event;\n    } catch (error) {\n      event.status = \"failed\";\n      event.completedAt = new Date().toISOString();\n\n      console.error(\"[FAILOVER] Failed:\", error);\n\n      // Attempt rollback if configured\n      if (this.config.rollbackOnFailure) {\n        await this.rollbackFailover(event);\n      }\n\n      this.emit(\"failover:failed\", event, error instanceof Error ? error : new Error(String(error)));\n      return event;\n    }\n  }\n\n  async rollbackFailover(event: FailoverEvent): Promise<void> {\n    console.log(`[FAILOVER] Rolling back failover ${event.id}`);\n\n    const fromConfig = this.regions.get(event.fromRegion);\n    const toConfig = this.regions.get(event.toRegion);\n\n    // Restore original state\n    if (fromConfig) {\n      fromConfig.status = \"active\";\n      fromConfig.isPrimary = true;\n      this.primaryRegion = event.fromRegion;\n    }\n\n    if (toConfig) {\n      toConfig.status = \"standby\";\n      toConfig.isPrimary = false;\n    }\n\n    event.status = \"rolled-back\";\n    event.completedAt = new Date().toISOString();\n\n    console.log(`[FAILOVER] Rollback completed, ${event.fromRegion} restored as primary`);\n  }\n\n  // ===========================================================================\n  // APPROVAL WORKFLOW\n  // ===========================================================================\n\n  approveFailover(failoverId: string): FailoverEvent | null {\n    const event = this.pendingApprovals.get(failoverId);\n    if (!event) {\n      console.warn(`[FAILOVER] Approval not found: ${failoverId}`);\n      return null;\n    }\n\n    // Execute the failover\n    this.executeFailover(event).catch(err => {\n      console.error(\"[FAILOVER] Approved failover execution failed:\", err);\n    });\n\n    return event;\n  }\n\n  rejectFailover(failoverId: string, reason?: string): FailoverEvent | null {\n    const event = this.pendingApprovals.get(failoverId);\n    if (!event) {\n      console.warn(`[FAILOVER] Approval not found: ${failoverId}`);\n      return null;\n    }\n\n    event.status = \"failed\";\n    event.completedAt = new Date().toISOString();\n    event.metadata = { ...event.metadata, rejectionReason: reason };\n\n    this.pendingApprovals.delete(failoverId);\n    this.failoverHistory.push(event);\n\n    console.log(`[FAILOVER] Rejected: ${failoverId}. Reason: ${reason || \"No reason provided\"}`);\n\n    return event;\n  }\n\n  // ===========================================================================\n  // MANUAL FAILOVER\n  // ===========================================================================\n\n  async manualFailover(toRegion: Region, reason?: string): Promise<FailoverEvent | null> {\n    if (!this.primaryRegion) {\n      console.error(\"[FAILOVER] No primary region to failover from\");\n      return null;\n    }\n\n    if (toRegion === this.primaryRegion) {\n      console.warn(\"[FAILOVER] Target region is already primary\");\n      return null;\n    }\n\n    const targetConfig = this.regions.get(toRegion);\n    if (!targetConfig) {\n      console.error(`[FAILOVER] Target region not configured: ${toRegion}`);\n      return null;\n    }\n\n    const event: FailoverEvent = {\n      id: `fo_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`,\n      fromRegion: this.primaryRegion,\n      toRegion,\n      reason: reason || \"Manual failover\",\n      triggeredBy: \"manual\",\n      startedAt: new Date().toISOString(),\n      status: \"in-progress\",\n      affectedPipelines: 0,\n    };\n\n    return this.executeFailover(event);\n  }\n\n  // ===========================================================================\n  // TARGET SELECTION\n  // ===========================================================================\n\n  private selectFailoverTarget(excludeRegion: Region): Region | null {\n    const candidates = Array.from(this.regions.values())\n      .filter(r => {\n        if (r.region === excludeRegion) return false;\n        if (r.status === \"offline\" || r.status === \"draining\") return false;\n        // Don't select regions that are also failing\n        const failures = this.failureCounts.get(r.region) ?? 0;\n        if (failures >= this.config.triggerThreshold) return false;\n        return true;\n      })\n      .sort((a, b) => b.weight - a.weight);\n\n    return candidates[0]?.region ?? null;\n  }\n\n  // ===========================================================================\n  // GETTERS\n  // ===========================================================================\n\n  getPrimaryRegion(): Region | null {\n    return this.primaryRegion;\n  }\n\n  getFailoverHistory(limit: number = 10): FailoverEvent[] {\n    return this.failoverHistory.slice(-limit);\n  }\n\n  getPendingApprovals(): FailoverEvent[] {\n    return Array.from(this.pendingApprovals.values());\n  }\n\n  getFailoverCount24h(): number {\n    const now = Date.now();\n    return this.failoverHistory.filter(\n      f => now - new Date(f.startedAt).getTime() < 86400000\n    ).length;\n  }\n\n  getConfig(): FailoverConfig {\n    return { ...this.config };\n  }\n\n  getStats(): {\n    primaryRegion: Region | null;\n    failoverCount24h: number;\n    lastFailover: FailoverEvent | null;\n    pendingApprovals: number;\n    cooldownActive: boolean;\n    cooldownRemainingMs: number;\n  } {\n    const now = Date.now();\n    const cooldownRemaining = Math.max(0, this.config.cooldownMs - (now - this.lastFailoverTime));\n\n    return {\n      primaryRegion: this.primaryRegion,\n      failoverCount24h: this.getFailoverCount24h(),\n      lastFailover: this.failoverHistory[this.failoverHistory.length - 1] ?? null,\n      pendingApprovals: this.pendingApprovals.size,\n      cooldownActive: cooldownRemaining > 0,\n      cooldownRemainingMs: cooldownRemaining,\n    };\n  }\n}\n\n// =============================================================================\n// SINGLETON\n// =============================================================================\n\nlet failoverManagerInstance: FailoverManager | null = null;\n\nexport function getFailoverManager(): FailoverManager {\n  if (!failoverManagerInstance) {\n    failoverManagerInstance = new FailoverManager();\n  }\n  return failoverManagerInstance;\n}\n\nexport function createFailoverManager(config?: Partial<FailoverConfig>): FailoverManager {\n  failoverManagerInstance = new FailoverManager(config);\n  return failoverManagerInstance;\n}\n","/**\n * High Availability Manager\n * Phase 12A: Unified HA Orchestration\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport type {\n  Region,\n  RegionConfig,\n  RegionStatus,\n  HAManagerConfig,\n  HAState,\n  HAEvents,\n  HealthCheckResult,\n  ReplicationStatus,\n  FailoverEvent,\n} from \"./types.js\";\nimport { HealthChecker, createHealthChecker } from \"./health-checker.js\";\nimport { LoadBalancer, createLoadBalancer } from \"./load-balancer.js\";\nimport { FailoverManager, createFailoverManager } from \"./failover-manager.js\";\n\n// =============================================================================\n// HA MANAGER\n// =============================================================================\n\nexport class HAManager extends EventEmitter<HAEvents> {\n  private config: HAManagerConfig;\n  private healthChecker: HealthChecker;\n  private loadBalancer: LoadBalancer;\n  private failoverManager: FailoverManager;\n  private replicationStatus: Map<string, ReplicationStatus> = new Map();\n  private metricsInterval: NodeJS.Timeout | null = null;\n  private started: boolean = false;\n\n  constructor(config: HAManagerConfig) {\n    super();\n    this.config = config;\n\n    // Initialize components\n    this.healthChecker = createHealthChecker(config.healthCheck);\n    this.loadBalancer = createLoadBalancer(config.loadBalancing?.strategy);\n    this.failoverManager = createFailoverManager(config.failover);\n\n    if (config.loadBalancing?.stickySession) {\n      this.loadBalancer.setSessionAffinity(config.loadBalancing.stickySession);\n    }\n\n    // Wire up event handlers\n    this.setupEventHandlers();\n\n    // Add configured regions\n    for (const regionConfig of config.regions) {\n      this.addRegion(regionConfig);\n    }\n  }\n\n  // ===========================================================================\n  // SETUP\n  // ===========================================================================\n\n  private setupEventHandlers(): void {\n    // Forward health check events\n    this.healthChecker.on(\"health:checked\", (results) => {\n      this.emit(\"health:checked\", results);\n\n      // Update load balancer with health results\n      for (const result of results) {\n        this.loadBalancer.updateHealth(result.region, result);\n        this.failoverManager.onHealthCheckResult(result.region, result);\n      }\n    });\n\n    this.healthChecker.on(\"health:degraded\", (region, result) => {\n      this.emit(\"health:degraded\", region, result);\n      this.updateRegionStatus(region, \"degraded\");\n    });\n\n    this.healthChecker.on(\"health:recovered\", (region, result) => {\n      this.emit(\"health:recovered\", region, result);\n      this.updateRegionStatus(region, \"active\");\n    });\n\n    // Forward failover events\n    this.failoverManager.on(\"failover:started\", (event) => {\n      this.emit(\"failover:started\", event);\n    });\n\n    this.failoverManager.on(\"failover:completed\", (event) => {\n      this.emit(\"failover:completed\", event);\n    });\n\n    this.failoverManager.on(\"failover:failed\", (event, error) => {\n      this.emit(\"failover:failed\", event, error);\n    });\n\n    this.failoverManager.on(\"region:status_changed\", (region, oldStatus, newStatus) => {\n      this.emit(\"region:status_changed\", region, oldStatus, newStatus);\n    });\n  }\n\n  // ===========================================================================\n  // REGION MANAGEMENT\n  // ===========================================================================\n\n  addRegion(regionConfig: RegionConfig): void {\n    this.healthChecker.addRegion(regionConfig);\n    this.loadBalancer.addRegion(regionConfig);\n    this.failoverManager.addRegion(regionConfig);\n\n    this.emit(\"region:added\", regionConfig);\n    console.log(`[HA] Region added: ${regionConfig.region} (${regionConfig.status})`);\n  }\n\n  removeRegion(region: Region): void {\n    this.healthChecker.removeRegion(region);\n    this.loadBalancer.removeRegion(region);\n    this.failoverManager.removeRegion(region);\n\n    this.emit(\"region:removed\", region);\n    console.log(`[HA] Region removed: ${region}`);\n  }\n\n  updateRegionStatus(region: Region, status: RegionStatus): void {\n    const regionConfig = this.config.regions.find(r => r.region === region);\n    if (regionConfig) {\n      const oldStatus = regionConfig.status;\n      regionConfig.status = status;\n      this.emit(\"region:status_changed\", region, oldStatus, status);\n    }\n  }\n\n  // ===========================================================================\n  // ROUTING\n  // ===========================================================================\n\n  route(options?: {\n    clientIp?: string;\n    sessionId?: string;\n    preferredRegion?: Region;\n    excludeRegions?: Region[];\n  }) {\n    return this.loadBalancer.route(options);\n  }\n\n  // ===========================================================================\n  // FAILOVER\n  // ===========================================================================\n\n  async triggerFailover(toRegion: Region, reason?: string): Promise<FailoverEvent | null> {\n    return this.failoverManager.manualFailover(toRegion, reason);\n  }\n\n  approveFailover(failoverId: string): FailoverEvent | null {\n    return this.failoverManager.approveFailover(failoverId);\n  }\n\n  rejectFailover(failoverId: string, reason?: string): FailoverEvent | null {\n    return this.failoverManager.rejectFailover(failoverId, reason);\n  }\n\n  // ===========================================================================\n  // REPLICATION STATUS\n  // ===========================================================================\n\n  updateReplicationStatus(status: ReplicationStatus): void {\n    const key = `${status.sourceRegion}->${status.targetRegion}`;\n    this.replicationStatus.set(key, status);\n\n    // Check for replication lag\n    const maxLag = this.config.replication?.maxLagMs ?? 5000;\n    if (status.lagMs > maxLag) {\n      this.emit(\"replication:lag\", status);\n      console.warn(`[HA] Replication lag detected: ${status.sourceRegion} -> ${status.targetRegion} (${status.lagMs}ms)`);\n    }\n  }\n\n  getReplicationStatus(): ReplicationStatus[] {\n    return Array.from(this.replicationStatus.values());\n  }\n\n  // ===========================================================================\n  // LIFECYCLE\n  // ===========================================================================\n\n  start(): void {\n    if (this.started) {\n      console.log(\"[HA] Manager already started\");\n      return;\n    }\n\n    console.log(\"[HA] Starting High Availability Manager\");\n    this.started = true;\n\n    // Start health checks\n    this.healthChecker.start();\n\n    // Start metrics collection if enabled\n    if (this.config.monitoring?.enabled) {\n      this.startMetricsCollection();\n    }\n  }\n\n  stop(): void {\n    if (!this.started) {\n      return;\n    }\n\n    console.log(\"[HA] Stopping High Availability Manager\");\n    this.started = false;\n\n    this.healthChecker.stop();\n    this.stopMetricsCollection();\n  }\n\n  private startMetricsCollection(): void {\n    const interval = this.config.monitoring?.metricsIntervalMs ?? 60000;\n\n    this.metricsInterval = setInterval(() => {\n      const state = this.getState();\n\n      // Check alert thresholds\n      const thresholds = this.config.monitoring?.alertThresholds;\n      if (thresholds) {\n        if (state.globalLatencyMs > thresholds.latencyMs) {\n          console.warn(`[HA] Alert: Global latency (${state.globalLatencyMs}ms) exceeds threshold (${thresholds.latencyMs}ms)`);\n        }\n        if (state.globalAvailability < thresholds.availabilityPercent) {\n          console.warn(`[HA] Alert: Availability (${state.globalAvailability}%) below threshold (${thresholds.availabilityPercent}%)`);\n        }\n      }\n    }, interval);\n  }\n\n  private stopMetricsCollection(): void {\n    if (this.metricsInterval) {\n      clearInterval(this.metricsInterval);\n      this.metricsInterval = null;\n    }\n  }\n\n  // ===========================================================================\n  // STATE\n  // ===========================================================================\n\n  getState(): HAState {\n    const healthResults = this.healthChecker.getAllResults();\n    const regionHealth: Record<Region, HealthCheckResult> = {};\n\n    for (const [region, result] of healthResults) {\n      regionHealth[region] = result;\n    }\n\n    return {\n      primaryRegion: this.failoverManager.getPrimaryRegion() ?? (\"us-east-1\" as Region),\n      activeRegions: this.healthChecker.getHealthyRegions(),\n      regionHealth: regionHealth as any,\n      replicationStatus: this.getReplicationStatus(),\n      lastFailover: this.failoverManager.getFailoverHistory(1)[0],\n      failoverCount24h: this.failoverManager.getFailoverCount24h(),\n      globalLatencyMs: this.healthChecker.getAverageLatency(),\n      globalAvailability: this.healthChecker.getGlobalAvailability(),\n      lastUpdated: new Date().toISOString(),\n    };\n  }\n\n  getConfig(): HAManagerConfig {\n    return { ...this.config };\n  }\n\n  isStarted(): boolean {\n    return this.started;\n  }\n\n  // ===========================================================================\n  // COMPONENT ACCESS\n  // ===========================================================================\n\n  getHealthChecker(): HealthChecker {\n    return this.healthChecker;\n  }\n\n  getLoadBalancer(): LoadBalancer {\n    return this.loadBalancer;\n  }\n\n  getFailoverManager(): FailoverManager {\n    return this.failoverManager;\n  }\n}\n\n// =============================================================================\n// SINGLETON\n// =============================================================================\n\nlet haManagerInstance: HAManager | null = null;\n\nexport function getHAManager(): HAManager | null {\n  return haManagerInstance;\n}\n\nexport function createHAManager(config: HAManagerConfig): HAManager {\n  haManagerInstance = new HAManager(config);\n  return haManagerInstance;\n}\n\n// =============================================================================\n// DEFAULT CONFIGURATION\n// =============================================================================\n\nexport const DEFAULT_HA_CONFIG: HAManagerConfig = {\n  regions: [\n    {\n      id: \"primary\",\n      region: \"us-east-1\",\n      endpoint: \"https://api-us-east.gicm.io\",\n      status: \"active\",\n      isPrimary: true,\n      weight: 100,\n    },\n    {\n      id: \"secondary\",\n      region: \"eu-west-1\",\n      endpoint: \"https://api-eu-west.gicm.io\",\n      status: \"standby\",\n      isPrimary: false,\n      weight: 80,\n    },\n    {\n      id: \"tertiary\",\n      region: \"ap-northeast-1\",\n      endpoint: \"https://api-ap-northeast.gicm.io\",\n      status: \"standby\",\n      isPrimary: false,\n      weight: 60,\n    },\n  ],\n  healthCheck: {\n    type: \"http\",\n    intervalMs: 30000,\n    timeoutMs: 5000,\n    unhealthyThreshold: 3,\n    healthyThreshold: 2,\n    path: \"/health\",\n    expectedStatus: 200,\n  },\n  loadBalancing: {\n    strategy: \"weighted\",\n    stickySession: {\n      enabled: true,\n      ttlMs: 3600000,\n      cookieName: \"gicm_region\",\n      strategy: \"cookie\",\n    },\n  },\n  failover: {\n    mode: \"automatic\",\n    triggerThreshold: 3,\n    cooldownMs: 300000,\n    maxFailoversPerHour: 3,\n    notifyOnFailover: true,\n    requireApproval: false,\n    rollbackOnFailure: true,\n  },\n  replication: {\n    mode: \"async\",\n    targetRegions: [\"eu-west-1\", \"ap-northeast-1\"],\n    maxLagMs: 5000,\n    batchSize: 100,\n    retryAttempts: 3,\n    conflictResolution: \"last-write-wins\",\n  },\n  monitoring: {\n    enabled: true,\n    metricsIntervalMs: 60000,\n    alertThresholds: {\n      latencyMs: 500,\n      errorRate: 0.05,\n      availabilityPercent: 99.9,\n    },\n  },\n};\n","/**\n * Disaster Recovery Types\n * Phase 12B: Backup & Restore\n */\n\nimport { z } from \"zod\";\n\n// =============================================================================\n// BACKUP TYPES\n// =============================================================================\n\nexport const BackupTypeSchema = z.enum([\n  \"full\",\n  \"incremental\",\n  \"differential\",\n  \"snapshot\",\n]);\nexport type BackupType = z.infer<typeof BackupTypeSchema>;\n\nexport const BackupStatusSchema = z.enum([\n  \"pending\",\n  \"in_progress\",\n  \"completed\",\n  \"failed\",\n  \"cancelled\",\n  \"expired\",\n]);\nexport type BackupStatus = z.infer<typeof BackupStatusSchema>;\n\nexport const BackupStorageSchema = z.enum([\n  \"local\",\n  \"s3\",\n  \"gcs\",\n  \"azure\",\n  \"r2\",\n]);\nexport type BackupStorage = z.infer<typeof BackupStorageSchema>;\n\n// =============================================================================\n// BACKUP CONFIGURATION\n// =============================================================================\n\nexport const BackupScheduleSchema = z.object({\n  enabled: z.boolean().default(true),\n  cron: z.string().default(\"0 2 * * *\"), // Daily at 2 AM\n  type: BackupTypeSchema.default(\"incremental\"),\n  retentionDays: z.number().default(30),\n  maxBackups: z.number().default(100),\n});\nexport type BackupSchedule = z.infer<typeof BackupScheduleSchema>;\n\nexport const StorageConfigSchema = z.object({\n  type: BackupStorageSchema,\n  bucket: z.string().optional(),\n  region: z.string().optional(),\n  path: z.string().default(\"/backups\"),\n  accessKey: z.string().optional(),\n  secretKey: z.string().optional(),\n  endpoint: z.string().optional(),\n  encryption: z.object({\n    enabled: z.boolean().default(true),\n    algorithm: z.enum([\"AES-256-GCM\", \"AES-256-CBC\"]).default(\"AES-256-GCM\"),\n    keyId: z.string().optional(),\n  }).optional(),\n});\nexport type StorageConfig = z.infer<typeof StorageConfigSchema>;\n\n// =============================================================================\n// BACKUP MANIFEST\n// =============================================================================\n\nexport const BackupItemSchema = z.object({\n  resource: z.string(),\n  type: z.string(),\n  count: z.number(),\n  sizeBytes: z.number(),\n  checksum: z.string(),\n});\nexport type BackupItem = z.infer<typeof BackupItemSchema>;\n\nexport const BackupManifestSchema = z.object({\n  id: z.string(),\n  type: BackupTypeSchema,\n  status: BackupStatusSchema,\n  startedAt: z.string(),\n  completedAt: z.string().optional(),\n  sizeBytes: z.number().default(0),\n  items: z.array(BackupItemSchema).default([]),\n  parentBackupId: z.string().optional(), // For incremental backups\n  checksum: z.string().optional(),\n  encryptionKeyId: z.string().optional(),\n  storageLocation: z.string(),\n  metadata: z.record(z.unknown()).optional(),\n  version: z.string().default(\"1.0.0\"),\n});\nexport type BackupManifest = z.infer<typeof BackupManifestSchema>;\n\n// =============================================================================\n// RESTORE TYPES\n// =============================================================================\n\nexport const RestoreStatusSchema = z.enum([\n  \"pending\",\n  \"validating\",\n  \"in_progress\",\n  \"completed\",\n  \"failed\",\n  \"rolled_back\",\n]);\nexport type RestoreStatus = z.infer<typeof RestoreStatusSchema>;\n\nexport const RestoreModeSchema = z.enum([\n  \"full\",           // Restore everything\n  \"selective\",      // Restore specific resources\n  \"point_in_time\",  // Restore to specific point in time\n]);\nexport type RestoreMode = z.infer<typeof RestoreModeSchema>;\n\nexport const RestoreOptionsSchema = z.object({\n  mode: RestoreModeSchema.default(\"full\"),\n  targetBackupId: z.string(),\n  resources: z.array(z.string()).optional(), // For selective restore\n  pointInTime: z.string().optional(),\n  skipValidation: z.boolean().default(false),\n  createSnapshot: z.boolean().default(true), // Create snapshot before restore\n  dryRun: z.boolean().default(false),\n});\nexport type RestoreOptions = z.infer<typeof RestoreOptionsSchema>;\n\nexport const RestoreProgressSchema = z.object({\n  id: z.string(),\n  status: RestoreStatusSchema,\n  backupId: z.string(),\n  mode: RestoreModeSchema,\n  startedAt: z.string(),\n  completedAt: z.string().optional(),\n  totalItems: z.number(),\n  processedItems: z.number(),\n  failedItems: z.number(),\n  currentResource: z.string().optional(),\n  errors: z.array(z.string()).default([]),\n  snapshotId: z.string().optional(), // Pre-restore snapshot\n});\nexport type RestoreProgress = z.infer<typeof RestoreProgressSchema>;\n\n// =============================================================================\n// POINT IN TIME RECOVERY\n// =============================================================================\n\nexport const WALEntrySchema = z.object({\n  id: z.string(),\n  timestamp: z.string(),\n  resource: z.string(),\n  operation: z.enum([\"create\", \"update\", \"delete\"]),\n  data: z.unknown(),\n  checksum: z.string(),\n});\nexport type WALEntry = z.infer<typeof WALEntrySchema>;\n\nexport const RecoveryPointSchema = z.object({\n  id: z.string(),\n  timestamp: z.string(),\n  backupId: z.string(),\n  walSegment: z.number(),\n  description: z.string().optional(),\n});\nexport type RecoveryPoint = z.infer<typeof RecoveryPointSchema>;\n\n// =============================================================================\n// BACKUP VERIFICATION\n// =============================================================================\n\nexport const VerificationStatusSchema = z.enum([\n  \"pending\",\n  \"in_progress\",\n  \"passed\",\n  \"failed\",\n  \"warnings\",\n]);\nexport type VerificationStatus = z.infer<typeof VerificationStatusSchema>;\n\nexport const VerificationResultSchema = z.object({\n  backupId: z.string(),\n  status: VerificationStatusSchema,\n  startedAt: z.string(),\n  completedAt: z.string().optional(),\n  checksumValid: z.boolean(),\n  itemsVerified: z.number(),\n  itemsFailed: z.number(),\n  errors: z.array(z.string()).default([]),\n  warnings: z.array(z.string()).default([]),\n  metadata: z.record(z.unknown()).optional(),\n});\nexport type VerificationResult = z.infer<typeof VerificationResultSchema>;\n\n// =============================================================================\n// DR MANAGER CONFIGURATION\n// =============================================================================\n\nexport const DRManagerConfigSchema = z.object({\n  storage: StorageConfigSchema,\n  schedule: BackupScheduleSchema.optional(),\n  verification: z.object({\n    enabled: z.boolean().default(true),\n    afterBackup: z.boolean().default(true),\n    schedule: z.string().optional(), // Cron for periodic verification\n  }).optional(),\n  wal: z.object({\n    enabled: z.boolean().default(true),\n    retentionHours: z.number().default(168), // 7 days\n    flushIntervalMs: z.number().default(5000),\n  }).optional(),\n  alerts: z.object({\n    onBackupFailure: z.boolean().default(true),\n    onVerificationFailure: z.boolean().default(true),\n    onLowStorage: z.boolean().default(true),\n    storageThresholdPercent: z.number().default(80),\n  }).optional(),\n});\nexport type DRManagerConfig = z.infer<typeof DRManagerConfigSchema>;\n\n// =============================================================================\n// DR STATE\n// =============================================================================\n\nexport const DRStateSchema = z.object({\n  lastBackup: BackupManifestSchema.optional(),\n  lastVerification: VerificationResultSchema.optional(),\n  nextScheduledBackup: z.string().optional(),\n  totalBackups: z.number(),\n  totalSizeBytes: z.number(),\n  oldestBackup: z.string().optional(),\n  newestBackup: z.string().optional(),\n  storageUsedPercent: z.number(),\n  walEnabled: z.boolean(),\n  walSegments: z.number(),\n});\nexport type DRState = z.infer<typeof DRStateSchema>;\n\n// =============================================================================\n// DR EVENTS\n// =============================================================================\n\nexport interface DREvents {\n  \"backup:started\": (backup: BackupManifest) => void;\n  \"backup:progress\": (backup: BackupManifest, percent: number) => void;\n  \"backup:completed\": (backup: BackupManifest) => void;\n  \"backup:failed\": (backup: BackupManifest, error: Error) => void;\n  \"restore:started\": (progress: RestoreProgress) => void;\n  \"restore:progress\": (progress: RestoreProgress) => void;\n  \"restore:completed\": (progress: RestoreProgress) => void;\n  \"restore:failed\": (progress: RestoreProgress, error: Error) => void;\n  \"verification:started\": (backupId: string) => void;\n  \"verification:completed\": (result: VerificationResult) => void;\n  \"wal:flushed\": (segment: number, entries: number) => void;\n  \"storage:low\": (usedPercent: number) => void;\n  \"retention:cleaned\": (deletedCount: number, freedBytes: number) => void;\n}\n\n// =============================================================================\n// CONSTANTS\n// =============================================================================\n\nexport const DEFAULT_BACKUP_SCHEDULE: BackupSchedule = {\n  enabled: true,\n  cron: \"0 2 * * *\", // Daily at 2 AM\n  type: \"incremental\",\n  retentionDays: 30,\n  maxBackups: 100,\n};\n\nexport const BACKUP_RESOURCES = [\n  \"pipelines\",\n  \"schedules\",\n  \"budgets\",\n  \"webhooks\",\n  \"analytics\",\n  \"organizations\",\n  \"members\",\n  \"plugins\",\n  \"templates\",\n  \"executions\",\n] as const;\n\nexport type BackupResource = typeof BACKUP_RESOURCES[number];\n","/**\n * Backup Manager\n * Phase 12B: Create and Manage Backups\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport { createHash } from \"crypto\";\nimport type {\n  BackupType,\n  BackupStatus,\n  BackupManifest,\n  BackupItem,\n  BackupSchedule,\n  StorageConfig,\n  DREvents,\n  BackupResource,\n} from \"./types.js\";\nimport { BACKUP_RESOURCES, DEFAULT_BACKUP_SCHEDULE } from \"./types.js\";\n\n// =============================================================================\n// BACKUP MANAGER\n// =============================================================================\n\nexport class BackupManager extends EventEmitter<DREvents> {\n  private storageConfig: StorageConfig;\n  private schedule: BackupSchedule;\n  private backups: Map<string, BackupManifest> = new Map();\n  private scheduleInterval: NodeJS.Timeout | null = null;\n  private lastFullBackupId: string | null = null;\n\n  // Data providers for backing up\n  private dataProviders: Map<BackupResource, () => Promise<unknown[]>> = new Map();\n\n  constructor(storageConfig: StorageConfig, schedule?: Partial<BackupSchedule>) {\n    super();\n    this.storageConfig = storageConfig;\n    this.schedule = { ...DEFAULT_BACKUP_SCHEDULE, ...schedule };\n  }\n\n  // ===========================================================================\n  // DATA PROVIDERS\n  // ===========================================================================\n\n  registerDataProvider(resource: BackupResource, provider: () => Promise<unknown[]>): void {\n    this.dataProviders.set(resource, provider);\n    console.log(`[BACKUP] Registered data provider for: ${resource}`);\n  }\n\n  unregisterDataProvider(resource: BackupResource): void {\n    this.dataProviders.delete(resource);\n  }\n\n  // ===========================================================================\n  // BACKUP CREATION\n  // ===========================================================================\n\n  async createBackup(\n    type: BackupType = \"full\",\n    resources?: BackupResource[]\n  ): Promise<BackupManifest> {\n    const backupId = `backup_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`;\n    const resourcesToBackup = resources ?? [...BACKUP_RESOURCES];\n\n    const backup: BackupManifest = {\n      id: backupId,\n      type,\n      status: \"in_progress\",\n      startedAt: new Date().toISOString(),\n      sizeBytes: 0,\n      items: [],\n      storageLocation: this.getStorageLocation(backupId),\n      version: \"1.0.0\",\n    };\n\n    // For incremental/differential, track parent\n    if (type === \"incremental\" || type === \"differential\") {\n      backup.parentBackupId = this.lastFullBackupId ?? undefined;\n    }\n\n    this.backups.set(backupId, backup);\n    this.emit(\"backup:started\", backup);\n\n    try {\n      let totalSize = 0;\n      let processedResources = 0;\n\n      for (const resource of resourcesToBackup) {\n        const provider = this.dataProviders.get(resource);\n        if (!provider) {\n          console.log(`[BACKUP] No provider for ${resource}, skipping`);\n          continue;\n        }\n\n        try {\n          const data = await provider();\n          const serialized = JSON.stringify(data);\n          const sizeBytes = Buffer.byteLength(serialized, \"utf8\");\n          const checksum = this.calculateChecksum(serialized);\n\n          const item: BackupItem = {\n            resource,\n            type: \"json\",\n            count: Array.isArray(data) ? data.length : 1,\n            sizeBytes,\n            checksum,\n          };\n\n          backup.items.push(item);\n          totalSize += sizeBytes;\n\n          // Simulate storage write (in production, write to actual storage)\n          await this.writeToStorage(backupId, resource, serialized);\n\n          processedResources++;\n          const percent = Math.round((processedResources / resourcesToBackup.length) * 100);\n          this.emit(\"backup:progress\", backup, percent);\n        } catch (err) {\n          console.error(`[BACKUP] Failed to backup ${resource}:`, err);\n        }\n      }\n\n      // Calculate overall checksum\n      backup.sizeBytes = totalSize;\n      backup.checksum = this.calculateManifestChecksum(backup);\n      backup.status = \"completed\";\n      backup.completedAt = new Date().toISOString();\n\n      if (type === \"full\") {\n        this.lastFullBackupId = backupId;\n      }\n\n      this.emit(\"backup:completed\", backup);\n      console.log(`[BACKUP] Completed: ${backupId} (${this.formatBytes(totalSize)})`);\n\n      return backup;\n    } catch (error) {\n      backup.status = \"failed\";\n      backup.completedAt = new Date().toISOString();\n      this.emit(\"backup:failed\", backup, error instanceof Error ? error : new Error(String(error)));\n      throw error;\n    }\n  }\n\n  async createSnapshot(description?: string): Promise<BackupManifest> {\n    const snapshot = await this.createBackup(\"snapshot\");\n    snapshot.metadata = { ...snapshot.metadata, description };\n    return snapshot;\n  }\n\n  // ===========================================================================\n  // BACKUP RETRIEVAL\n  // ===========================================================================\n\n  getBackup(backupId: string): BackupManifest | undefined {\n    return this.backups.get(backupId);\n  }\n\n  listBackups(options?: {\n    type?: BackupType;\n    status?: BackupStatus;\n    limit?: number;\n    fromDate?: Date;\n    toDate?: Date;\n  }): BackupManifest[] {\n    let backups = Array.from(this.backups.values());\n\n    if (options?.type) {\n      backups = backups.filter(b => b.type === options.type);\n    }\n    if (options?.status) {\n      backups = backups.filter(b => b.status === options.status);\n    }\n    if (options?.fromDate) {\n      backups = backups.filter(b => new Date(b.startedAt) >= options.fromDate!);\n    }\n    if (options?.toDate) {\n      backups = backups.filter(b => new Date(b.startedAt) <= options.toDate!);\n    }\n\n    // Sort by date descending\n    backups.sort((a, b) => new Date(b.startedAt).getTime() - new Date(a.startedAt).getTime());\n\n    if (options?.limit) {\n      backups = backups.slice(0, options.limit);\n    }\n\n    return backups;\n  }\n\n  getLatestBackup(type?: BackupType): BackupManifest | undefined {\n    const backups = this.listBackups({ type, status: \"completed\", limit: 1 });\n    return backups[0];\n  }\n\n  // ===========================================================================\n  // BACKUP DELETION\n  // ===========================================================================\n\n  async deleteBackup(backupId: string): Promise<boolean> {\n    const backup = this.backups.get(backupId);\n    if (!backup) {\n      return false;\n    }\n\n    // Don't delete if it's the parent of other backups\n    const dependentBackups = Array.from(this.backups.values())\n      .filter(b => b.parentBackupId === backupId);\n\n    if (dependentBackups.length > 0) {\n      throw new Error(`Cannot delete backup ${backupId}: ${dependentBackups.length} backups depend on it`);\n    }\n\n    // Delete from storage (simulated)\n    await this.deleteFromStorage(backupId);\n\n    this.backups.delete(backupId);\n    console.log(`[BACKUP] Deleted: ${backupId}`);\n\n    return true;\n  }\n\n  async cleanupExpired(): Promise<{ deletedCount: number; freedBytes: number }> {\n    const now = Date.now();\n    const retentionMs = this.schedule.retentionDays * 24 * 60 * 60 * 1000;\n    let deletedCount = 0;\n    let freedBytes = 0;\n\n    const backupsToDelete: string[] = [];\n\n    for (const [id, backup] of this.backups) {\n      const backupAge = now - new Date(backup.startedAt).getTime();\n      if (backupAge > retentionMs && backup.status === \"completed\") {\n        // Check if it's a parent of other backups\n        const isParent = Array.from(this.backups.values())\n          .some(b => b.parentBackupId === id);\n\n        if (!isParent) {\n          backupsToDelete.push(id);\n          freedBytes += backup.sizeBytes;\n        }\n      }\n    }\n\n    // Also enforce max backups limit\n    const completedBackups = this.listBackups({ status: \"completed\" });\n    if (completedBackups.length > this.schedule.maxBackups) {\n      const excess = completedBackups.slice(this.schedule.maxBackups);\n      for (const backup of excess) {\n        if (!backupsToDelete.includes(backup.id)) {\n          backupsToDelete.push(backup.id);\n          freedBytes += backup.sizeBytes;\n        }\n      }\n    }\n\n    // Delete backups\n    for (const id of backupsToDelete) {\n      try {\n        await this.deleteBackup(id);\n        deletedCount++;\n      } catch (err) {\n        console.error(`[BACKUP] Failed to delete ${id}:`, err);\n      }\n    }\n\n    if (deletedCount > 0) {\n      this.emit(\"retention:cleaned\", deletedCount, freedBytes);\n      console.log(`[BACKUP] Cleanup: deleted ${deletedCount} backups, freed ${this.formatBytes(freedBytes)}`);\n    }\n\n    return { deletedCount, freedBytes };\n  }\n\n  // ===========================================================================\n  // SCHEDULING\n  // ===========================================================================\n\n  startScheduler(): void {\n    if (!this.schedule.enabled) {\n      console.log(\"[BACKUP] Scheduler disabled\");\n      return;\n    }\n\n    // Simple interval-based scheduling (in production, use cron parser)\n    const intervalMs = 24 * 60 * 60 * 1000; // Daily\n\n    console.log(`[BACKUP] Scheduler started (${this.schedule.type} backups, ${this.schedule.retentionDays} day retention)`);\n\n    this.scheduleInterval = setInterval(async () => {\n      try {\n        await this.createBackup(this.schedule.type);\n        await this.cleanupExpired();\n      } catch (err) {\n        console.error(\"[BACKUP] Scheduled backup failed:\", err);\n      }\n    }, intervalMs);\n  }\n\n  stopScheduler(): void {\n    if (this.scheduleInterval) {\n      clearInterval(this.scheduleInterval);\n      this.scheduleInterval = null;\n      console.log(\"[BACKUP] Scheduler stopped\");\n    }\n  }\n\n  // ===========================================================================\n  // STORAGE OPERATIONS (Simulated)\n  // ===========================================================================\n\n  private getStorageLocation(backupId: string): string {\n    const { type, bucket, path } = this.storageConfig;\n    switch (type) {\n      case \"s3\":\n        return `s3://${bucket}${path}/${backupId}`;\n      case \"gcs\":\n        return `gs://${bucket}${path}/${backupId}`;\n      case \"azure\":\n        return `azure://${bucket}${path}/${backupId}`;\n      case \"r2\":\n        return `r2://${bucket}${path}/${backupId}`;\n      default:\n        return `${path}/${backupId}`;\n    }\n  }\n\n  private async writeToStorage(backupId: string, resource: string, data: string): Promise<void> {\n    // In production, implement actual storage writes\n    // For now, simulate storage operation\n    await new Promise(resolve => setTimeout(resolve, 50));\n  }\n\n  private async deleteFromStorage(backupId: string): Promise<void> {\n    // In production, implement actual storage deletion\n    await new Promise(resolve => setTimeout(resolve, 20));\n  }\n\n  // ===========================================================================\n  // UTILITIES\n  // ===========================================================================\n\n  private calculateChecksum(data: string): string {\n    return createHash(\"sha256\").update(data).digest(\"hex\").slice(0, 16);\n  }\n\n  private calculateManifestChecksum(manifest: BackupManifest): string {\n    const itemChecksums = manifest.items.map(i => i.checksum).sort().join(\"\");\n    return this.calculateChecksum(itemChecksums);\n  }\n\n  private formatBytes(bytes: number): string {\n    if (bytes < 1024) return `${bytes} B`;\n    if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n    if (bytes < 1024 * 1024 * 1024) return `${(bytes / 1024 / 1024).toFixed(1)} MB`;\n    return `${(bytes / 1024 / 1024 / 1024).toFixed(1)} GB`;\n  }\n\n  // ===========================================================================\n  // STATS\n  // ===========================================================================\n\n  getStats(): {\n    totalBackups: number;\n    totalSizeBytes: number;\n    oldestBackup: string | null;\n    newestBackup: string | null;\n    backupsByType: Record<BackupType, number>;\n    backupsByStatus: Record<BackupStatus, number>;\n  } {\n    const backups = Array.from(this.backups.values());\n    const completedBackups = backups.filter(b => b.status === \"completed\");\n\n    const byType: Record<string, number> = {};\n    const byStatus: Record<string, number> = {};\n\n    for (const backup of backups) {\n      byType[backup.type] = (byType[backup.type] || 0) + 1;\n      byStatus[backup.status] = (byStatus[backup.status] || 0) + 1;\n    }\n\n    const dates = completedBackups.map(b => new Date(b.startedAt).getTime());\n\n    return {\n      totalBackups: backups.length,\n      totalSizeBytes: completedBackups.reduce((sum, b) => sum + b.sizeBytes, 0),\n      oldestBackup: dates.length > 0 ? new Date(Math.min(...dates)).toISOString() : null,\n      newestBackup: dates.length > 0 ? new Date(Math.max(...dates)).toISOString() : null,\n      backupsByType: byType as any,\n      backupsByStatus: byStatus as any,\n    };\n  }\n}\n\n// =============================================================================\n// SINGLETON\n// =============================================================================\n\nlet backupManagerInstance: BackupManager | null = null;\n\nexport function getBackupManager(): BackupManager | null {\n  return backupManagerInstance;\n}\n\nexport function createBackupManager(\n  storageConfig: StorageConfig,\n  schedule?: Partial<BackupSchedule>\n): BackupManager {\n  backupManagerInstance = new BackupManager(storageConfig, schedule);\n  return backupManagerInstance;\n}\n","/**\n * Restore Manager\n * Phase 12B: Restore from Backups\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport type {\n  BackupManifest,\n  RestoreMode,\n  RestoreOptions,\n  RestoreProgress,\n  DREvents,\n  BackupResource,\n} from \"./types.js\";\nimport { BackupManager, getBackupManager } from \"./backup-manager.js\";\n\n// =============================================================================\n// RESTORE MANAGER\n// =============================================================================\n\nexport class RestoreManager extends EventEmitter<DREvents> {\n  private backupManager: BackupManager;\n  private restoreHistory: Map<string, RestoreProgress> = new Map();\n  private currentRestore: RestoreProgress | null = null;\n\n  // Data handlers for restoring\n  private dataHandlers: Map<BackupResource, (data: unknown[]) => Promise<void>> = new Map();\n\n  constructor(backupManager: BackupManager) {\n    super();\n    this.backupManager = backupManager;\n  }\n\n  // ===========================================================================\n  // DATA HANDLERS\n  // ===========================================================================\n\n  registerDataHandler(resource: BackupResource, handler: (data: unknown[]) => Promise<void>): void {\n    this.dataHandlers.set(resource, handler);\n    console.log(`[RESTORE] Registered data handler for: ${resource}`);\n  }\n\n  unregisterDataHandler(resource: BackupResource): void {\n    this.dataHandlers.delete(resource);\n  }\n\n  // ===========================================================================\n  // RESTORE EXECUTION\n  // ===========================================================================\n\n  async restore(options: RestoreOptions): Promise<RestoreProgress> {\n    if (this.currentRestore && this.currentRestore.status === \"in_progress\") {\n      throw new Error(\"A restore operation is already in progress\");\n    }\n\n    const backup = this.backupManager.getBackup(options.targetBackupId);\n    if (!backup) {\n      throw new Error(`Backup not found: ${options.targetBackupId}`);\n    }\n\n    if (backup.status !== \"completed\") {\n      throw new Error(`Cannot restore from backup with status: ${backup.status}`);\n    }\n\n    const restoreId = `restore_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`;\n\n    const progress: RestoreProgress = {\n      id: restoreId,\n      status: \"pending\",\n      backupId: options.targetBackupId,\n      mode: options.mode,\n      startedAt: new Date().toISOString(),\n      totalItems: backup.items.length,\n      processedItems: 0,\n      failedItems: 0,\n      errors: [],\n    };\n\n    this.currentRestore = progress;\n    this.restoreHistory.set(restoreId, progress);\n\n    // Create pre-restore snapshot if configured\n    if (options.createSnapshot) {\n      try {\n        progress.status = \"validating\";\n        const snapshot = await this.backupManager.createSnapshot(\"Pre-restore snapshot\");\n        progress.snapshotId = snapshot.id;\n        console.log(`[RESTORE] Created pre-restore snapshot: ${snapshot.id}`);\n      } catch (err) {\n        console.warn(\"[RESTORE] Failed to create pre-restore snapshot:\", err);\n      }\n    }\n\n    // Dry run mode\n    if (options.dryRun) {\n      progress.status = \"completed\";\n      progress.completedAt = new Date().toISOString();\n      console.log(`[RESTORE] Dry run completed for backup ${options.targetBackupId}`);\n      return progress;\n    }\n\n    this.emit(\"restore:started\", progress);\n\n    try {\n      progress.status = \"in_progress\";\n\n      // Determine which resources to restore\n      const resourcesToRestore = options.mode === \"selective\" && options.resources\n        ? options.resources as BackupResource[]\n        : backup.items.map(item => item.resource as BackupResource);\n\n      for (const resource of resourcesToRestore) {\n        const backupItem = backup.items.find(item => item.resource === resource);\n        if (!backupItem) {\n          console.warn(`[RESTORE] Resource not found in backup: ${resource}`);\n          continue;\n        }\n\n        const handler = this.dataHandlers.get(resource);\n        if (!handler) {\n          console.warn(`[RESTORE] No handler for resource: ${resource}`);\n          progress.failedItems++;\n          progress.errors.push(`No handler for resource: ${resource}`);\n          continue;\n        }\n\n        progress.currentResource = resource;\n        this.emit(\"restore:progress\", progress);\n\n        try {\n          // In production, read actual data from storage\n          // For now, simulate restore\n          const data = await this.readFromStorage(backup.id, resource);\n          await handler(data);\n\n          progress.processedItems++;\n          console.log(`[RESTORE] Restored ${resource} (${backupItem.count} items)`);\n        } catch (err) {\n          progress.failedItems++;\n          const errorMsg = err instanceof Error ? err.message : String(err);\n          progress.errors.push(`Failed to restore ${resource}: ${errorMsg}`);\n          console.error(`[RESTORE] Failed to restore ${resource}:`, err);\n        }\n      }\n\n      progress.status = progress.failedItems === 0 ? \"completed\" : \"completed\";\n      progress.completedAt = new Date().toISOString();\n      progress.currentResource = undefined;\n\n      this.emit(\"restore:completed\", progress);\n      console.log(`[RESTORE] Completed: ${progress.processedItems}/${progress.totalItems} items restored`);\n\n      return progress;\n    } catch (error) {\n      progress.status = \"failed\";\n      progress.completedAt = new Date().toISOString();\n      progress.errors.push(error instanceof Error ? error.message : String(error));\n\n      this.emit(\"restore:failed\", progress, error instanceof Error ? error : new Error(String(error)));\n\n      // Attempt rollback if we have a snapshot\n      if (progress.snapshotId) {\n        console.log(`[RESTORE] Attempting rollback to snapshot ${progress.snapshotId}`);\n        // In production, implement actual rollback\n        progress.status = \"rolled_back\";\n      }\n\n      throw error;\n    } finally {\n      this.currentRestore = null;\n    }\n  }\n\n  // ===========================================================================\n  // RESTORE STATUS\n  // ===========================================================================\n\n  getRestoreProgress(restoreId: string): RestoreProgress | undefined {\n    return this.restoreHistory.get(restoreId);\n  }\n\n  getCurrentRestore(): RestoreProgress | null {\n    return this.currentRestore;\n  }\n\n  listRestores(limit: number = 20): RestoreProgress[] {\n    return Array.from(this.restoreHistory.values())\n      .sort((a, b) => new Date(b.startedAt).getTime() - new Date(a.startedAt).getTime())\n      .slice(0, limit);\n  }\n\n  // ===========================================================================\n  // POINT IN TIME RECOVERY\n  // ===========================================================================\n\n  async restoreToPointInTime(targetTime: Date): Promise<RestoreProgress> {\n    // Find the most recent backup before the target time\n    const backups = this.backupManager.listBackups({ status: \"completed\" });\n    const eligibleBackups = backups.filter(b => new Date(b.startedAt) <= targetTime);\n\n    if (eligibleBackups.length === 0) {\n      throw new Error(`No backups found before ${targetTime.toISOString()}`);\n    }\n\n    const targetBackup = eligibleBackups[0]; // Most recent before target time\n\n    console.log(`[RESTORE] Point-in-time recovery to ${targetTime.toISOString()}`);\n    console.log(`[RESTORE] Using backup ${targetBackup.id} from ${targetBackup.startedAt}`);\n\n    return this.restore({\n      mode: \"point_in_time\",\n      targetBackupId: targetBackup.id,\n      pointInTime: targetTime.toISOString(),\n      createSnapshot: true,\n    });\n  }\n\n  // ===========================================================================\n  // STORAGE OPERATIONS (Simulated)\n  // ===========================================================================\n\n  private async readFromStorage(backupId: string, resource: string): Promise<unknown[]> {\n    // In production, implement actual storage reads\n    // For now, return empty array (simulated)\n    await new Promise(resolve => setTimeout(resolve, 50));\n    return [];\n  }\n\n  // ===========================================================================\n  // VALIDATION\n  // ===========================================================================\n\n  async validateBackup(backupId: string): Promise<{\n    valid: boolean;\n    errors: string[];\n    warnings: string[];\n  }> {\n    const backup = this.backupManager.getBackup(backupId);\n    if (!backup) {\n      return {\n        valid: false,\n        errors: [`Backup not found: ${backupId}`],\n        warnings: [],\n      };\n    }\n\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    // Check status\n    if (backup.status !== \"completed\") {\n      errors.push(`Backup status is ${backup.status}, not completed`);\n    }\n\n    // Check items\n    if (backup.items.length === 0) {\n      warnings.push(\"Backup contains no items\");\n    }\n\n    // Check for handlers\n    for (const item of backup.items) {\n      if (!this.dataHandlers.has(item.resource as BackupResource)) {\n        warnings.push(`No handler registered for resource: ${item.resource}`);\n      }\n    }\n\n    // Check for parent backup (incremental)\n    if (backup.parentBackupId) {\n      const parent = this.backupManager.getBackup(backup.parentBackupId);\n      if (!parent) {\n        errors.push(`Parent backup not found: ${backup.parentBackupId}`);\n      } else if (parent.status !== \"completed\") {\n        errors.push(`Parent backup status is ${parent.status}`);\n      }\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n      warnings,\n    };\n  }\n}\n\n// =============================================================================\n// SINGLETON\n// =============================================================================\n\nlet restoreManagerInstance: RestoreManager | null = null;\n\nexport function getRestoreManager(): RestoreManager | null {\n  return restoreManagerInstance;\n}\n\nexport function createRestoreManager(backupManager?: BackupManager): RestoreManager {\n  const mgr = backupManager ?? getBackupManager();\n  if (!mgr) {\n    throw new Error(\"BackupManager must be created first\");\n  }\n  restoreManagerInstance = new RestoreManager(mgr);\n  return restoreManagerInstance;\n}\n","/**\n * Observability Types\n * Phase 12D: Distributed Tracing & Metrics\n */\n\nimport { z } from \"zod\";\n\n// =============================================================================\n// TRACE CONTEXT\n// =============================================================================\n\nexport const TraceContextSchema = z.object({\n  traceId: z.string().describe(\"Unique trace identifier (W3C format)\"),\n  spanId: z.string().describe(\"Current span identifier\"),\n  parentSpanId: z.string().optional().describe(\"Parent span identifier\"),\n  traceFlags: z.number().default(1).describe(\"Trace flags (sampled=1)\"),\n  traceState: z.string().optional().describe(\"Vendor-specific trace state\"),\n});\nexport type TraceContext = z.infer<typeof TraceContextSchema>;\n\n// =============================================================================\n// SPAN STATUS\n// =============================================================================\n\nexport const SpanStatusCodeSchema = z.enum([\n  \"UNSET\",\n  \"OK\",\n  \"ERROR\",\n]);\nexport type SpanStatusCode = z.infer<typeof SpanStatusCodeSchema>;\n\nexport const SpanStatusSchema = z.object({\n  code: SpanStatusCodeSchema,\n  message: z.string().optional(),\n});\nexport type SpanStatus = z.infer<typeof SpanStatusSchema>;\n\n// =============================================================================\n// SPAN KIND\n// =============================================================================\n\nexport const SpanKindSchema = z.enum([\n  \"INTERNAL\",\n  \"SERVER\",\n  \"CLIENT\",\n  \"PRODUCER\",\n  \"CONSUMER\",\n]);\nexport type SpanKind = z.infer<typeof SpanKindSchema>;\n\n// =============================================================================\n// SPAN EVENTS\n// =============================================================================\n\nexport const SpanEventSchema = z.object({\n  name: z.string(),\n  timestamp: z.number(),\n  attributes: z.record(z.union([z.string(), z.number(), z.boolean()])).optional(),\n});\nexport type SpanEvent = z.infer<typeof SpanEventSchema>;\n\n// =============================================================================\n// SPAN LINKS\n// =============================================================================\n\nexport const SpanLinkSchema = z.object({\n  traceId: z.string(),\n  spanId: z.string(),\n  attributes: z.record(z.union([z.string(), z.number(), z.boolean()])).optional(),\n});\nexport type SpanLink = z.infer<typeof SpanLinkSchema>;\n\n// =============================================================================\n// SPAN\n// =============================================================================\n\nexport const SpanSchema = z.object({\n  traceId: z.string(),\n  spanId: z.string(),\n  parentSpanId: z.string().optional(),\n  name: z.string(),\n  kind: SpanKindSchema.default(\"INTERNAL\"),\n  startTime: z.number(),\n  endTime: z.number().optional(),\n  duration: z.number().optional().describe(\"Duration in ms\"),\n  status: SpanStatusSchema.default({ code: \"UNSET\" }),\n  attributes: z.record(z.union([z.string(), z.number(), z.boolean()])).default({}),\n  events: z.array(SpanEventSchema).default([]),\n  links: z.array(SpanLinkSchema).default([]),\n  resource: z.object({\n    serviceName: z.string(),\n    serviceVersion: z.string().optional(),\n    environment: z.string().optional(),\n    hostName: z.string().optional(),\n    instanceId: z.string().optional(),\n  }),\n});\nexport type Span = z.infer<typeof SpanSchema>;\n\n// =============================================================================\n// TRACE\n// =============================================================================\n\nexport const TraceSchema = z.object({\n  traceId: z.string(),\n  rootSpan: SpanSchema,\n  spans: z.array(SpanSchema),\n  startTime: z.number(),\n  endTime: z.number().optional(),\n  duration: z.number().optional(),\n  spanCount: z.number(),\n  errorCount: z.number().default(0),\n  serviceName: z.string(),\n  operationName: z.string(),\n});\nexport type Trace = z.infer<typeof TraceSchema>;\n\n// =============================================================================\n// METRIC TYPES\n// =============================================================================\n\nexport const MetricTypeSchema = z.enum([\n  \"counter\",\n  \"gauge\",\n  \"histogram\",\n  \"summary\",\n]);\nexport type MetricType = z.infer<typeof MetricTypeSchema>;\n\nexport const MetricUnitSchema = z.enum([\n  \"ms\",\n  \"s\",\n  \"bytes\",\n  \"requests\",\n  \"errors\",\n  \"percent\",\n  \"count\",\n  \"none\",\n]);\nexport type MetricUnit = z.infer<typeof MetricUnitSchema>;\n\n// =============================================================================\n// METRIC POINT\n// =============================================================================\n\nexport const MetricPointSchema = z.object({\n  timestamp: z.number(),\n  value: z.number(),\n  labels: z.record(z.string()).default({}),\n});\nexport type MetricPoint = z.infer<typeof MetricPointSchema>;\n\n// =============================================================================\n// HISTOGRAM BUCKETS\n// =============================================================================\n\nexport const HistogramBucketsSchema = z.object({\n  boundaries: z.array(z.number()),\n  counts: z.array(z.number()),\n  sum: z.number(),\n  count: z.number(),\n  min: z.number().optional(),\n  max: z.number().optional(),\n});\nexport type HistogramBuckets = z.infer<typeof HistogramBucketsSchema>;\n\n// =============================================================================\n// METRIC DEFINITION\n// =============================================================================\n\nexport const MetricDefinitionSchema = z.object({\n  name: z.string(),\n  type: MetricTypeSchema,\n  unit: MetricUnitSchema.default(\"none\"),\n  description: z.string().optional(),\n  labels: z.array(z.string()).default([]),\n  buckets: z.array(z.number()).optional().describe(\"For histograms\"),\n});\nexport type MetricDefinition = z.infer<typeof MetricDefinitionSchema>;\n\n// =============================================================================\n// METRIC DATA\n// =============================================================================\n\nexport const MetricDataSchema = z.object({\n  name: z.string(),\n  type: MetricTypeSchema,\n  unit: MetricUnitSchema,\n  description: z.string().optional(),\n  points: z.array(MetricPointSchema),\n  histogram: HistogramBucketsSchema.optional(),\n  resource: z.object({\n    serviceName: z.string(),\n    environment: z.string().optional(),\n  }),\n});\nexport type MetricData = z.infer<typeof MetricDataSchema>;\n\n// =============================================================================\n// LOG SEVERITY\n// =============================================================================\n\nexport const LogSeveritySchema = z.enum([\n  \"TRACE\",\n  \"DEBUG\",\n  \"INFO\",\n  \"WARN\",\n  \"ERROR\",\n  \"FATAL\",\n]);\nexport type LogSeverity = z.infer<typeof LogSeveritySchema>;\n\n// =============================================================================\n// LOG RECORD\n// =============================================================================\n\nexport const LogRecordSchema = z.object({\n  timestamp: z.number(),\n  severity: LogSeveritySchema,\n  body: z.string(),\n  attributes: z.record(z.union([z.string(), z.number(), z.boolean()])).default({}),\n  traceId: z.string().optional(),\n  spanId: z.string().optional(),\n  resource: z.object({\n    serviceName: z.string(),\n    environment: z.string().optional(),\n  }),\n});\nexport type LogRecord = z.infer<typeof LogRecordSchema>;\n\n// =============================================================================\n// EXPORTER CONFIG\n// =============================================================================\n\nexport const ExporterTypeSchema = z.enum([\n  \"console\",\n  \"otlp\",\n  \"jaeger\",\n  \"zipkin\",\n  \"prometheus\",\n  \"custom\",\n]);\nexport type ExporterType = z.infer<typeof ExporterTypeSchema>;\n\nexport const ExporterConfigSchema = z.object({\n  type: ExporterTypeSchema,\n  endpoint: z.string().optional(),\n  headers: z.record(z.string()).optional(),\n  compression: z.enum([\"none\", \"gzip\"]).default(\"none\"),\n  timeout: z.number().default(30000),\n  batchSize: z.number().default(512),\n  flushInterval: z.number().default(5000),\n});\nexport type ExporterConfig = z.infer<typeof ExporterConfigSchema>;\n\n// =============================================================================\n// SAMPLER CONFIG\n// =============================================================================\n\nexport const SamplerTypeSchema = z.enum([\n  \"always_on\",\n  \"always_off\",\n  \"trace_id_ratio\",\n  \"parent_based\",\n]);\nexport type SamplerType = z.infer<typeof SamplerTypeSchema>;\n\nexport const SamplerConfigSchema = z.object({\n  type: SamplerTypeSchema.default(\"always_on\"),\n  ratio: z.number().min(0).max(1).default(1),\n  parentBased: z.boolean().default(true),\n});\nexport type SamplerConfig = z.infer<typeof SamplerConfigSchema>;\n\n// =============================================================================\n// OBSERVABILITY CONFIG\n// =============================================================================\n\nexport const ObservabilityConfigSchema = z.object({\n  serviceName: z.string().default(\"integration-hub\"),\n  serviceVersion: z.string().optional(),\n  environment: z.string().default(\"development\"),\n\n  // Tracing\n  tracing: z.object({\n    enabled: z.boolean().default(true),\n    sampler: SamplerConfigSchema.default({}),\n    exporter: ExporterConfigSchema.optional(),\n    maxSpanAttributes: z.number().default(128),\n    maxSpanEvents: z.number().default(128),\n    maxSpanLinks: z.number().default(128),\n  }).default({}),\n\n  // Metrics\n  metrics: z.object({\n    enabled: z.boolean().default(true),\n    exporter: ExporterConfigSchema.optional(),\n    collectInterval: z.number().default(60000),\n    defaultBuckets: z.array(z.number()).default([5, 10, 25, 50, 100, 250, 500, 1000, 2500, 5000, 10000]),\n  }).default({}),\n\n  // Logging\n  logging: z.object({\n    enabled: z.boolean().default(true),\n    minSeverity: LogSeveritySchema.default(\"INFO\"),\n    exporter: ExporterConfigSchema.optional(),\n    includeTraceContext: z.boolean().default(true),\n  }).default({}),\n\n  // Resource\n  resource: z.object({\n    hostName: z.string().optional(),\n    instanceId: z.string().optional(),\n    attributes: z.record(z.string()).default({}),\n  }).default({}),\n\n  // Retention\n  retention: z.object({\n    traces: z.number().default(24 * 60 * 60 * 1000), // 24h\n    metrics: z.number().default(7 * 24 * 60 * 60 * 1000), // 7d\n    logs: z.number().default(24 * 60 * 60 * 1000), // 24h\n  }).default({}),\n});\nexport type ObservabilityConfig = z.infer<typeof ObservabilityConfigSchema>;\n\n// =============================================================================\n// QUERY TYPES\n// =============================================================================\n\nexport const TraceQuerySchema = z.object({\n  traceId: z.string().optional(),\n  serviceName: z.string().optional(),\n  operationName: z.string().optional(),\n  minDuration: z.number().optional(),\n  maxDuration: z.number().optional(),\n  tags: z.record(z.string()).optional(),\n  startTime: z.number().optional(),\n  endTime: z.number().optional(),\n  limit: z.number().default(100),\n});\nexport type TraceQuery = z.infer<typeof TraceQuerySchema>;\n\nexport const MetricQuerySchema = z.object({\n  name: z.string(),\n  labels: z.record(z.string()).optional(),\n  startTime: z.number().optional(),\n  endTime: z.number().optional(),\n  step: z.number().optional().describe(\"Query resolution in ms\"),\n  aggregation: z.enum([\"sum\", \"avg\", \"min\", \"max\", \"count\", \"rate\"]).optional(),\n});\nexport type MetricQuery = z.infer<typeof MetricQuerySchema>;\n\nexport const LogQuerySchema = z.object({\n  traceId: z.string().optional(),\n  spanId: z.string().optional(),\n  serviceName: z.string().optional(),\n  severity: LogSeveritySchema.optional(),\n  bodyContains: z.string().optional(),\n  startTime: z.number().optional(),\n  endTime: z.number().optional(),\n  limit: z.number().default(100),\n});\nexport type LogQuery = z.infer<typeof LogQuerySchema>;\n\n// =============================================================================\n// STATS & SUMMARY\n// =============================================================================\n\nexport const TraceSummarySchema = z.object({\n  totalTraces: z.number(),\n  totalSpans: z.number(),\n  errorRate: z.number(),\n  avgDuration: z.number(),\n  p50Duration: z.number(),\n  p95Duration: z.number(),\n  p99Duration: z.number(),\n  topServices: z.array(z.object({\n    name: z.string(),\n    traceCount: z.number(),\n    avgDuration: z.number(),\n  })),\n  topOperations: z.array(z.object({\n    name: z.string(),\n    traceCount: z.number(),\n    avgDuration: z.number(),\n    errorRate: z.number(),\n  })),\n});\nexport type TraceSummary = z.infer<typeof TraceSummarySchema>;\n\nexport const MetricsSummarySchema = z.object({\n  totalMetrics: z.number(),\n  totalPoints: z.number(),\n  metricsByType: z.record(z.number()),\n  topMetrics: z.array(z.object({\n    name: z.string(),\n    type: MetricTypeSchema,\n    pointCount: z.number(),\n    lastValue: z.number(),\n  })),\n});\nexport type MetricsSummary = z.infer<typeof MetricsSummarySchema>;\n\nexport const ObservabilitySummarySchema = z.object({\n  traces: TraceSummarySchema,\n  metrics: MetricsSummarySchema,\n  uptime: z.number(),\n  lastUpdated: z.number(),\n});\nexport type ObservabilitySummary = z.infer<typeof ObservabilitySummarySchema>;\n\n// =============================================================================\n// EVENTS\n// =============================================================================\n\nexport type ObservabilityEvents = {\n  // Tracing\n  \"span:started\": (span: Span) => void;\n  \"span:ended\": (span: Span) => void;\n  \"trace:completed\": (trace: Trace) => void;\n\n  // Metrics\n  \"metric:recorded\": (metric: MetricData) => void;\n  \"metric:exported\": (count: number) => void;\n\n  // Logging\n  \"log:recorded\": (log: LogRecord) => void;\n  \"log:exported\": (count: number) => void;\n\n  // Export\n  \"export:started\": (type: \"traces\" | \"metrics\" | \"logs\") => void;\n  \"export:completed\": (type: \"traces\" | \"metrics\" | \"logs\", count: number) => void;\n  \"export:failed\": (type: \"traces\" | \"metrics\" | \"logs\", error: Error) => void;\n\n  // Errors\n  \"error\": (error: Error) => void;\n};\n\n// =============================================================================\n// BUILT-IN METRICS\n// =============================================================================\n\nexport const BUILTIN_METRICS: MetricDefinition[] = [\n  // HTTP metrics\n  {\n    name: \"http_requests_total\",\n    type: \"counter\",\n    unit: \"requests\",\n    description: \"Total HTTP requests\",\n    labels: [\"method\", \"path\", \"status\"],\n  },\n  {\n    name: \"http_request_duration_ms\",\n    type: \"histogram\",\n    unit: \"ms\",\n    description: \"HTTP request duration\",\n    labels: [\"method\", \"path\"],\n    buckets: [5, 10, 25, 50, 100, 250, 500, 1000, 2500, 5000],\n  },\n  {\n    name: \"http_request_size_bytes\",\n    type: \"histogram\",\n    unit: \"bytes\",\n    description: \"HTTP request size\",\n    labels: [\"method\", \"path\"],\n    buckets: [100, 1000, 10000, 100000, 1000000],\n  },\n  {\n    name: \"http_response_size_bytes\",\n    type: \"histogram\",\n    unit: \"bytes\",\n    description: \"HTTP response size\",\n    labels: [\"method\", \"path\"],\n    buckets: [100, 1000, 10000, 100000, 1000000],\n  },\n\n  // Pipeline metrics\n  {\n    name: \"pipeline_executions_total\",\n    type: \"counter\",\n    unit: \"count\",\n    description: \"Total pipeline executions\",\n    labels: [\"pipeline\", \"status\"],\n  },\n  {\n    name: \"pipeline_duration_ms\",\n    type: \"histogram\",\n    unit: \"ms\",\n    description: \"Pipeline execution duration\",\n    labels: [\"pipeline\"],\n    buckets: [100, 500, 1000, 5000, 10000, 30000, 60000, 300000],\n  },\n  {\n    name: \"pipeline_steps_total\",\n    type: \"counter\",\n    unit: \"count\",\n    description: \"Total pipeline steps executed\",\n    labels: [\"pipeline\", \"step\", \"status\"],\n  },\n\n  // Queue metrics\n  {\n    name: \"queue_jobs_total\",\n    type: \"counter\",\n    unit: \"count\",\n    description: \"Total queue jobs\",\n    labels: [\"queue\", \"status\"],\n  },\n  {\n    name: \"queue_depth\",\n    type: \"gauge\",\n    unit: \"count\",\n    description: \"Current queue depth\",\n    labels: [\"queue\"],\n  },\n  {\n    name: \"queue_job_duration_ms\",\n    type: \"histogram\",\n    unit: \"ms\",\n    description: \"Queue job duration\",\n    labels: [\"queue\"],\n    buckets: [100, 500, 1000, 5000, 10000, 30000],\n  },\n\n  // System metrics\n  {\n    name: \"memory_usage_bytes\",\n    type: \"gauge\",\n    unit: \"bytes\",\n    description: \"Memory usage\",\n    labels: [\"type\"],\n  },\n  {\n    name: \"cpu_usage_percent\",\n    type: \"gauge\",\n    unit: \"percent\",\n    description: \"CPU usage percentage\",\n    labels: [],\n  },\n  {\n    name: \"active_connections\",\n    type: \"gauge\",\n    unit: \"count\",\n    description: \"Active connections\",\n    labels: [\"type\"],\n  },\n];\n\n// =============================================================================\n// STANDARD SPAN ATTRIBUTES\n// =============================================================================\n\nexport const SPAN_ATTRIBUTES = {\n  // HTTP\n  HTTP_METHOD: \"http.method\",\n  HTTP_URL: \"http.url\",\n  HTTP_TARGET: \"http.target\",\n  HTTP_HOST: \"http.host\",\n  HTTP_SCHEME: \"http.scheme\",\n  HTTP_STATUS_CODE: \"http.status_code\",\n  HTTP_REQUEST_CONTENT_LENGTH: \"http.request_content_length\",\n  HTTP_RESPONSE_CONTENT_LENGTH: \"http.response_content_length\",\n  HTTP_USER_AGENT: \"http.user_agent\",\n\n  // Database\n  DB_SYSTEM: \"db.system\",\n  DB_CONNECTION_STRING: \"db.connection_string\",\n  DB_USER: \"db.user\",\n  DB_NAME: \"db.name\",\n  DB_STATEMENT: \"db.statement\",\n  DB_OPERATION: \"db.operation\",\n\n  // Pipeline\n  PIPELINE_ID: \"pipeline.id\",\n  PIPELINE_NAME: \"pipeline.name\",\n  PIPELINE_STEP: \"pipeline.step\",\n  PIPELINE_STATUS: \"pipeline.status\",\n\n  // Queue\n  QUEUE_NAME: \"queue.name\",\n  QUEUE_JOB_ID: \"queue.job_id\",\n  QUEUE_PRIORITY: \"queue.priority\",\n\n  // Error\n  ERROR_TYPE: \"error.type\",\n  ERROR_MESSAGE: \"error.message\",\n  ERROR_STACK: \"error.stack\",\n\n  // Custom\n  ORG_ID: \"gicm.org_id\",\n  USER_ID: \"gicm.user_id\",\n  REQUEST_ID: \"gicm.request_id\",\n} as const;\n","/**\n * Distributed Tracer\n * Phase 12D: OpenTelemetry-compatible tracing\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport { randomUUID } from \"crypto\";\nimport type {\n  Span,\n  SpanKind,\n  SpanStatus,\n  SpanStatusCode,\n  SpanEvent,\n  SpanLink,\n  TraceContext,\n  Trace,\n  ObservabilityConfig,\n  ObservabilityEvents,\n  SamplerConfig,\n} from \"./types.js\";\n\n// =============================================================================\n// SPAN BUILDER\n// =============================================================================\n\nexport class SpanBuilder {\n  private span: Partial<Span>;\n  private tracer: Tracer;\n\n  constructor(tracer: Tracer, name: string, options: SpanOptions = {}) {\n    const now = Date.now();\n    const traceId = options.context?.traceId ?? generateTraceId();\n    const spanId = generateSpanId();\n\n    this.tracer = tracer;\n    this.span = {\n      traceId,\n      spanId,\n      parentSpanId: options.context?.spanId ?? options.parentSpanId,\n      name,\n      kind: options.kind ?? \"INTERNAL\",\n      startTime: options.startTime ?? now,\n      status: { code: \"UNSET\" },\n      attributes: { ...options.attributes },\n      events: [],\n      links: options.links ?? [],\n      resource: tracer.getResource(),\n    };\n  }\n\n  setAttribute(key: string, value: string | number | boolean): this {\n    this.span.attributes![key] = value;\n    return this;\n  }\n\n  setAttributes(attrs: Record<string, string | number | boolean>): this {\n    Object.assign(this.span.attributes!, attrs);\n    return this;\n  }\n\n  addEvent(name: string, attributes?: Record<string, string | number | boolean>): this {\n    this.span.events!.push({\n      name,\n      timestamp: Date.now(),\n      attributes,\n    });\n    return this;\n  }\n\n  addLink(traceId: string, spanId: string, attributes?: Record<string, string | number | boolean>): this {\n    this.span.links!.push({ traceId, spanId, attributes });\n    return this;\n  }\n\n  setStatus(code: SpanStatusCode, message?: string): this {\n    this.span.status = { code, message };\n    return this;\n  }\n\n  setError(error: Error): this {\n    this.span.status = { code: \"ERROR\", message: error.message };\n    this.addEvent(\"exception\", {\n      \"exception.type\": error.name,\n      \"exception.message\": error.message,\n      \"exception.stacktrace\": error.stack ?? \"\",\n    });\n    return this;\n  }\n\n  getSpan(): Span {\n    return this.span as Span;\n  }\n\n  getContext(): TraceContext {\n    return {\n      traceId: this.span.traceId!,\n      spanId: this.span.spanId!,\n      parentSpanId: this.span.parentSpanId,\n      traceFlags: 1,\n    };\n  }\n\n  end(endTime?: number): Span {\n    const now = endTime ?? Date.now();\n    this.span.endTime = now;\n    this.span.duration = now - this.span.startTime!;\n\n    const completedSpan = this.span as Span;\n    this.tracer.recordSpan(completedSpan);\n\n    return completedSpan;\n  }\n}\n\n// =============================================================================\n// SPAN OPTIONS\n// =============================================================================\n\nexport interface SpanOptions {\n  kind?: SpanKind;\n  context?: TraceContext;\n  parentSpanId?: string;\n  startTime?: number;\n  attributes?: Record<string, string | number | boolean>;\n  links?: SpanLink[];\n}\n\n// =============================================================================\n// TRACER\n// =============================================================================\n\nexport class Tracer extends EventEmitter<ObservabilityEvents> {\n  private config: ObservabilityConfig;\n  private spans: Map<string, Span> = new Map();\n  private traces: Map<string, Span[]> = new Map();\n  private activeSpans: Map<string, SpanBuilder> = new Map();\n  private sampler: Sampler;\n\n  constructor(config: Partial<ObservabilityConfig> = {}) {\n    super();\n    this.config = {\n      serviceName: config.serviceName ?? \"integration-hub\",\n      serviceVersion: config.serviceVersion,\n      environment: config.environment ?? \"development\",\n      tracing: {\n        enabled: true,\n        sampler: { type: \"always_on\", ratio: 1, parentBased: true },\n        maxSpanAttributes: 128,\n        maxSpanEvents: 128,\n        maxSpanLinks: 128,\n        ...config.tracing,\n      },\n      metrics: { enabled: true, collectInterval: 60000, defaultBuckets: [], ...config.metrics },\n      logging: { enabled: true, minSeverity: \"INFO\", includeTraceContext: true, ...config.logging },\n      resource: { attributes: {}, ...config.resource },\n      retention: { traces: 86400000, metrics: 604800000, logs: 86400000, ...config.retention },\n    };\n    this.sampler = new Sampler(this.config.tracing.sampler);\n\n    // Periodic cleanup\n    setInterval(() => this.cleanup(), 60000);\n  }\n\n  getResource() {\n    return {\n      serviceName: this.config.serviceName,\n      serviceVersion: this.config.serviceVersion,\n      environment: this.config.environment,\n      hostName: this.config.resource.hostName,\n      instanceId: this.config.resource.instanceId,\n    };\n  }\n\n  /**\n   * Start a new span\n   */\n  startSpan(name: string, options: SpanOptions = {}): SpanBuilder {\n    if (!this.config.tracing.enabled) {\n      // Return a no-op span builder\n      return new NoOpSpanBuilder(this, name);\n    }\n\n    // Check sampling\n    const shouldSample = this.sampler.shouldSample(options.context);\n    if (!shouldSample) {\n      return new NoOpSpanBuilder(this, name);\n    }\n\n    const builder = new SpanBuilder(this, name, options);\n    this.activeSpans.set(builder.getContext().spanId, builder);\n    this.emit(\"span:started\", builder.getSpan());\n\n    return builder;\n  }\n\n  /**\n   * Create a child span from a parent context\n   */\n  startChildSpan(name: string, parentContext: TraceContext, options: Omit<SpanOptions, \"context\"> = {}): SpanBuilder {\n    return this.startSpan(name, { ...options, context: parentContext });\n  }\n\n  /**\n   * Wrap an async function with tracing\n   */\n  async trace<T>(\n    name: string,\n    fn: (span: SpanBuilder) => Promise<T>,\n    options: SpanOptions = {}\n  ): Promise<T> {\n    const span = this.startSpan(name, options);\n\n    try {\n      const result = await fn(span);\n      span.setStatus(\"OK\");\n      return result;\n    } catch (error) {\n      span.setError(error as Error);\n      throw error;\n    } finally {\n      span.end();\n    }\n  }\n\n  /**\n   * Record a completed span\n   */\n  recordSpan(span: Span): void {\n    // Enforce limits\n    if (Object.keys(span.attributes).length > this.config.tracing.maxSpanAttributes) {\n      const entries = Object.entries(span.attributes).slice(0, this.config.tracing.maxSpanAttributes);\n      span.attributes = Object.fromEntries(entries);\n    }\n\n    if (span.events.length > this.config.tracing.maxSpanEvents) {\n      span.events = span.events.slice(0, this.config.tracing.maxSpanEvents);\n    }\n\n    if (span.links.length > this.config.tracing.maxSpanLinks) {\n      span.links = span.links.slice(0, this.config.tracing.maxSpanLinks);\n    }\n\n    // Store span\n    this.spans.set(span.spanId, span);\n\n    // Group by trace\n    const traceSpans = this.traces.get(span.traceId) ?? [];\n    traceSpans.push(span);\n    this.traces.set(span.traceId, traceSpans);\n\n    // Remove from active\n    this.activeSpans.delete(span.spanId);\n\n    this.emit(\"span:ended\", span);\n\n    // Check if trace is complete (root span ended)\n    if (!span.parentSpanId) {\n      this.checkTraceComplete(span.traceId);\n    }\n  }\n\n  /**\n   * Check if a trace is complete\n   */\n  private checkTraceComplete(traceId: string): void {\n    const spans = this.traces.get(traceId);\n    if (!spans || spans.length === 0) return;\n\n    // Find root span\n    const rootSpan = spans.find(s => !s.parentSpanId);\n    if (!rootSpan || !rootSpan.endTime) return;\n\n    // Build trace object\n    const trace: Trace = {\n      traceId,\n      rootSpan,\n      spans,\n      startTime: rootSpan.startTime,\n      endTime: rootSpan.endTime,\n      duration: rootSpan.duration,\n      spanCount: spans.length,\n      errorCount: spans.filter(s => s.status.code === \"ERROR\").length,\n      serviceName: rootSpan.resource.serviceName,\n      operationName: rootSpan.name,\n    };\n\n    this.emit(\"trace:completed\", trace);\n  }\n\n  /**\n   * Get a span by ID\n   */\n  getSpan(spanId: string): Span | undefined {\n    return this.spans.get(spanId);\n  }\n\n  /**\n   * Get all spans for a trace\n   */\n  getTraceSpans(traceId: string): Span[] {\n    return this.traces.get(traceId) ?? [];\n  }\n\n  /**\n   * Get a complete trace\n   */\n  getTrace(traceId: string): Trace | null {\n    const spans = this.traces.get(traceId);\n    if (!spans || spans.length === 0) return null;\n\n    const rootSpan = spans.find(s => !s.parentSpanId);\n    if (!rootSpan) return null;\n\n    return {\n      traceId,\n      rootSpan,\n      spans,\n      startTime: rootSpan.startTime,\n      endTime: rootSpan.endTime,\n      duration: rootSpan.duration,\n      spanCount: spans.length,\n      errorCount: spans.filter(s => s.status.code === \"ERROR\").length,\n      serviceName: rootSpan.resource.serviceName,\n      operationName: rootSpan.name,\n    };\n  }\n\n  /**\n   * Search traces\n   */\n  searchTraces(query: {\n    serviceName?: string;\n    operationName?: string;\n    minDuration?: number;\n    maxDuration?: number;\n    tags?: Record<string, string>;\n    startTime?: number;\n    endTime?: number;\n    limit?: number;\n  }): Trace[] {\n    const results: Trace[] = [];\n    const limit = query.limit ?? 100;\n\n    for (const traceId of this.traces.keys()) {\n      if (results.length >= limit) break;\n\n      const trace = this.getTrace(traceId);\n      if (!trace || !trace.rootSpan.endTime) continue;\n\n      // Apply filters\n      if (query.serviceName && trace.serviceName !== query.serviceName) continue;\n      if (query.operationName && trace.operationName !== query.operationName) continue;\n      if (query.minDuration && (trace.duration ?? 0) < query.minDuration) continue;\n      if (query.maxDuration && (trace.duration ?? 0) > query.maxDuration) continue;\n      if (query.startTime && trace.startTime < query.startTime) continue;\n      if (query.endTime && trace.startTime > query.endTime) continue;\n\n      // Check tags\n      if (query.tags) {\n        const hasAllTags = Object.entries(query.tags).every(\n          ([key, value]) => trace.rootSpan.attributes[key] === value\n        );\n        if (!hasAllTags) continue;\n      }\n\n      results.push(trace);\n    }\n\n    return results.sort((a, b) => b.startTime - a.startTime);\n  }\n\n  /**\n   * Get trace stats\n   */\n  getStats(): {\n    totalTraces: number;\n    totalSpans: number;\n    activeSpans: number;\n    avgDuration: number;\n    errorRate: number;\n  } {\n    const traces = Array.from(this.traces.values());\n    const allSpans = traces.flat();\n    const completedTraces = traces.filter(spans => {\n      const root = spans.find(s => !s.parentSpanId);\n      return root?.endTime;\n    });\n\n    const durations = completedTraces\n      .map(spans => spans.find(s => !s.parentSpanId)?.duration ?? 0)\n      .filter(d => d > 0);\n\n    const avgDuration = durations.length > 0\n      ? durations.reduce((a, b) => a + b, 0) / durations.length\n      : 0;\n\n    const errorCount = allSpans.filter(s => s.status.code === \"ERROR\").length;\n\n    return {\n      totalTraces: this.traces.size,\n      totalSpans: allSpans.length,\n      activeSpans: this.activeSpans.size,\n      avgDuration,\n      errorRate: allSpans.length > 0 ? errorCount / allSpans.length : 0,\n    };\n  }\n\n  /**\n   * Clean up old traces\n   */\n  private cleanup(): void {\n    const cutoff = Date.now() - this.config.retention.traces;\n\n    for (const [spanId, span] of this.spans) {\n      if (span.startTime < cutoff) {\n        this.spans.delete(spanId);\n      }\n    }\n\n    for (const [traceId, spans] of this.traces) {\n      const root = spans.find(s => !s.parentSpanId);\n      if (root && root.startTime < cutoff) {\n        this.traces.delete(traceId);\n      }\n    }\n  }\n\n  /**\n   * Clear all data\n   */\n  clear(): void {\n    this.spans.clear();\n    this.traces.clear();\n    this.activeSpans.clear();\n  }\n}\n\n// =============================================================================\n// NO-OP SPAN BUILDER\n// =============================================================================\n\nclass NoOpSpanBuilder extends SpanBuilder {\n  setAttribute(_key: string, _value: string | number | boolean): this {\n    return this;\n  }\n\n  setAttributes(_attrs: Record<string, string | number | boolean>): this {\n    return this;\n  }\n\n  addEvent(_name: string, _attributes?: Record<string, string | number | boolean>): this {\n    return this;\n  }\n\n  addLink(_traceId: string, _spanId: string, _attributes?: Record<string, string | number | boolean>): this {\n    return this;\n  }\n\n  setStatus(_code: SpanStatusCode, _message?: string): this {\n    return this;\n  }\n\n  setError(_error: Error): this {\n    return this;\n  }\n\n  end(_endTime?: number): Span {\n    return this.getSpan();\n  }\n}\n\n// =============================================================================\n// SAMPLER\n// =============================================================================\n\nclass Sampler {\n  private config: SamplerConfig;\n\n  constructor(config: SamplerConfig) {\n    this.config = config;\n  }\n\n  shouldSample(parentContext?: TraceContext): boolean {\n    switch (this.config.type) {\n      case \"always_on\":\n        return true;\n\n      case \"always_off\":\n        return false;\n\n      case \"trace_id_ratio\":\n        // Use hash of trace ID if available, otherwise random\n        return Math.random() < this.config.ratio;\n\n      case \"parent_based\":\n        if (parentContext && this.config.parentBased) {\n          // Inherit sampling decision from parent\n          return (parentContext.traceFlags & 1) === 1;\n        }\n        return Math.random() < this.config.ratio;\n\n      default:\n        return true;\n    }\n  }\n}\n\n// =============================================================================\n// HELPERS\n// =============================================================================\n\nfunction generateTraceId(): string {\n  return randomUUID().replace(/-/g, \"\");\n}\n\nfunction generateSpanId(): string {\n  return randomUUID().replace(/-/g, \"\").substring(0, 16);\n}\n\n// =============================================================================\n// SINGLETON\n// =============================================================================\n\nlet tracerInstance: Tracer | null = null;\n\nexport function getTracer(): Tracer | null {\n  return tracerInstance;\n}\n\nexport function createTracer(config?: Partial<ObservabilityConfig>): Tracer {\n  tracerInstance = new Tracer(config);\n  return tracerInstance;\n}\n\nexport { generateTraceId, generateSpanId };\n","/**\n * Metrics Collector\n * Phase 12D: OpenTelemetry-compatible metrics\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport type {\n  MetricType,\n  MetricUnit,\n  MetricPoint,\n  MetricDefinition,\n  MetricData,\n  HistogramBuckets,\n  ObservabilityConfig,\n  ObservabilityEvents,\n  MetricQuery,\n  MetricsSummary,\n} from \"./types.js\";\nimport { BUILTIN_METRICS } from \"./types.js\";\n\n// =============================================================================\n// COUNTER\n// =============================================================================\n\nexport class Counter {\n  private name: string;\n  private unit: MetricUnit;\n  private description: string;\n  private labels: string[];\n  private values: Map<string, number> = new Map();\n  private points: Map<string, MetricPoint[]> = new Map();\n  private collector: MetricsCollector;\n\n  constructor(collector: MetricsCollector, definition: MetricDefinition) {\n    this.collector = collector;\n    this.name = definition.name;\n    this.unit = definition.unit ?? \"count\";\n    this.description = definition.description ?? \"\";\n    this.labels = definition.labels ?? [];\n  }\n\n  private getKey(labels: Record<string, string>): string {\n    return JSON.stringify(labels);\n  }\n\n  inc(labels: Record<string, string> = {}, value: number = 1): void {\n    const key = this.getKey(labels);\n    const current = this.values.get(key) ?? 0;\n    const newValue = current + value;\n    this.values.set(key, newValue);\n\n    const point: MetricPoint = {\n      timestamp: Date.now(),\n      value: newValue,\n      labels,\n    };\n\n    const pointsList = this.points.get(key) ?? [];\n    pointsList.push(point);\n    this.points.set(key, pointsList);\n\n    this.collector.recordMetric(this.getData());\n  }\n\n  getValue(labels: Record<string, string> = {}): number {\n    return this.values.get(this.getKey(labels)) ?? 0;\n  }\n\n  getData(): MetricData {\n    const allPoints: MetricPoint[] = [];\n    for (const points of this.points.values()) {\n      allPoints.push(...points);\n    }\n\n    return {\n      name: this.name,\n      type: \"counter\",\n      unit: this.unit,\n      description: this.description,\n      points: allPoints,\n      resource: this.collector.getResource(),\n    };\n  }\n\n  reset(): void {\n    this.values.clear();\n    this.points.clear();\n  }\n}\n\n// =============================================================================\n// GAUGE\n// =============================================================================\n\nexport class Gauge {\n  private name: string;\n  private unit: MetricUnit;\n  private description: string;\n  private labels: string[];\n  private values: Map<string, number> = new Map();\n  private points: Map<string, MetricPoint[]> = new Map();\n  private collector: MetricsCollector;\n\n  constructor(collector: MetricsCollector, definition: MetricDefinition) {\n    this.collector = collector;\n    this.name = definition.name;\n    this.unit = definition.unit ?? \"none\";\n    this.description = definition.description ?? \"\";\n    this.labels = definition.labels ?? [];\n  }\n\n  private getKey(labels: Record<string, string>): string {\n    return JSON.stringify(labels);\n  }\n\n  set(value: number, labels: Record<string, string> = {}): void {\n    const key = this.getKey(labels);\n    this.values.set(key, value);\n\n    const point: MetricPoint = {\n      timestamp: Date.now(),\n      value,\n      labels,\n    };\n\n    const pointsList = this.points.get(key) ?? [];\n    pointsList.push(point);\n    this.points.set(key, pointsList);\n\n    this.collector.recordMetric(this.getData());\n  }\n\n  inc(labels: Record<string, string> = {}, value: number = 1): void {\n    const current = this.getValue(labels);\n    this.set(current + value, labels);\n  }\n\n  dec(labels: Record<string, string> = {}, value: number = 1): void {\n    const current = this.getValue(labels);\n    this.set(current - value, labels);\n  }\n\n  getValue(labels: Record<string, string> = {}): number {\n    return this.values.get(this.getKey(labels)) ?? 0;\n  }\n\n  getData(): MetricData {\n    const allPoints: MetricPoint[] = [];\n    for (const points of this.points.values()) {\n      allPoints.push(...points);\n    }\n\n    return {\n      name: this.name,\n      type: \"gauge\",\n      unit: this.unit,\n      description: this.description,\n      points: allPoints,\n      resource: this.collector.getResource(),\n    };\n  }\n\n  reset(): void {\n    this.values.clear();\n    this.points.clear();\n  }\n}\n\n// =============================================================================\n// HISTOGRAM\n// =============================================================================\n\nexport class Histogram {\n  private name: string;\n  private unit: MetricUnit;\n  private description: string;\n  private labels: string[];\n  private buckets: number[];\n  private data: Map<string, HistogramData> = new Map();\n  private points: Map<string, MetricPoint[]> = new Map();\n  private collector: MetricsCollector;\n\n  constructor(collector: MetricsCollector, definition: MetricDefinition) {\n    this.collector = collector;\n    this.name = definition.name;\n    this.unit = definition.unit ?? \"ms\";\n    this.description = definition.description ?? \"\";\n    this.labels = definition.labels ?? [];\n    this.buckets = definition.buckets ?? [5, 10, 25, 50, 100, 250, 500, 1000, 2500, 5000, 10000];\n  }\n\n  private getKey(labels: Record<string, string>): string {\n    return JSON.stringify(labels);\n  }\n\n  private getOrCreateData(key: string): HistogramData {\n    let data = this.data.get(key);\n    if (!data) {\n      data = {\n        sum: 0,\n        count: 0,\n        min: Infinity,\n        max: -Infinity,\n        counts: new Array(this.buckets.length + 1).fill(0),\n      };\n      this.data.set(key, data);\n    }\n    return data;\n  }\n\n  observe(value: number, labels: Record<string, string> = {}): void {\n    const key = this.getKey(labels);\n    const data = this.getOrCreateData(key);\n\n    data.sum += value;\n    data.count++;\n    data.min = Math.min(data.min, value);\n    data.max = Math.max(data.max, value);\n\n    // Find bucket\n    for (let i = 0; i < this.buckets.length; i++) {\n      if (value <= this.buckets[i]) {\n        data.counts[i]++;\n        break;\n      }\n    }\n    // +Inf bucket\n    if (value > this.buckets[this.buckets.length - 1]) {\n      data.counts[this.buckets.length]++;\n    }\n\n    const point: MetricPoint = {\n      timestamp: Date.now(),\n      value,\n      labels,\n    };\n\n    const pointsList = this.points.get(key) ?? [];\n    pointsList.push(point);\n    this.points.set(key, pointsList);\n\n    this.collector.recordMetric(this.getData());\n  }\n\n  /**\n   * Time a function execution\n   */\n  async time<T>(fn: () => Promise<T>, labels: Record<string, string> = {}): Promise<T> {\n    const start = performance.now();\n    try {\n      return await fn();\n    } finally {\n      const duration = performance.now() - start;\n      this.observe(duration, labels);\n    }\n  }\n\n  /**\n   * Start a timer that returns a function to stop\n   */\n  startTimer(labels: Record<string, string> = {}): () => number {\n    const start = performance.now();\n    return () => {\n      const duration = performance.now() - start;\n      this.observe(duration, labels);\n      return duration;\n    };\n  }\n\n  getBuckets(labels: Record<string, string> = {}): HistogramBuckets | null {\n    const key = this.getKey(labels);\n    const data = this.data.get(key);\n    if (!data) return null;\n\n    return {\n      boundaries: this.buckets,\n      counts: data.counts,\n      sum: data.sum,\n      count: data.count,\n      min: data.min === Infinity ? undefined : data.min,\n      max: data.max === -Infinity ? undefined : data.max,\n    };\n  }\n\n  getPercentile(percentile: number, labels: Record<string, string> = {}): number | null {\n    const key = this.getKey(labels);\n    const data = this.data.get(key);\n    if (!data || data.count === 0) return null;\n\n    const targetCount = Math.ceil((percentile / 100) * data.count);\n    let cumulative = 0;\n\n    for (let i = 0; i < data.counts.length; i++) {\n      cumulative += data.counts[i];\n      if (cumulative >= targetCount) {\n        return i < this.buckets.length ? this.buckets[i] : this.buckets[this.buckets.length - 1];\n      }\n    }\n\n    return this.buckets[this.buckets.length - 1];\n  }\n\n  getData(): MetricData {\n    const allPoints: MetricPoint[] = [];\n    for (const points of this.points.values()) {\n      allPoints.push(...points);\n    }\n\n    // Get histogram data for first label set\n    const firstKey = this.data.keys().next().value;\n    const histogram = firstKey ? this.getBuckets(JSON.parse(firstKey)) ?? undefined : undefined;\n\n    return {\n      name: this.name,\n      type: \"histogram\",\n      unit: this.unit,\n      description: this.description,\n      points: allPoints,\n      histogram,\n      resource: this.collector.getResource(),\n    };\n  }\n\n  reset(): void {\n    this.data.clear();\n    this.points.clear();\n  }\n}\n\ninterface HistogramData {\n  sum: number;\n  count: number;\n  min: number;\n  max: number;\n  counts: number[];\n}\n\n// =============================================================================\n// METRICS COLLECTOR\n// =============================================================================\n\nexport class MetricsCollector extends EventEmitter<ObservabilityEvents> {\n  private config: ObservabilityConfig;\n  private definitions: Map<string, MetricDefinition> = new Map();\n  private counters: Map<string, Counter> = new Map();\n  private gauges: Map<string, Gauge> = new Map();\n  private histograms: Map<string, Histogram> = new Map();\n  private metricData: Map<string, MetricData> = new Map();\n  private collectInterval?: ReturnType<typeof setInterval>;\n\n  constructor(config: Partial<ObservabilityConfig> = {}) {\n    super();\n    this.config = {\n      serviceName: config.serviceName ?? \"integration-hub\",\n      serviceVersion: config.serviceVersion,\n      environment: config.environment ?? \"development\",\n      tracing: { enabled: true, sampler: { type: \"always_on\", ratio: 1, parentBased: true }, maxSpanAttributes: 128, maxSpanEvents: 128, maxSpanLinks: 128, ...config.tracing },\n      metrics: {\n        enabled: true,\n        collectInterval: 60000,\n        defaultBuckets: [5, 10, 25, 50, 100, 250, 500, 1000, 2500, 5000, 10000],\n        ...config.metrics,\n      },\n      logging: { enabled: true, minSeverity: \"INFO\", includeTraceContext: true, ...config.logging },\n      resource: { attributes: {}, ...config.resource },\n      retention: { traces: 86400000, metrics: 604800000, logs: 86400000, ...config.retention },\n    };\n\n    // Register built-in metrics\n    for (const metric of BUILTIN_METRICS) {\n      this.register(metric);\n    }\n\n    // Start collection interval\n    if (this.config.metrics.enabled) {\n      this.startCollection();\n    }\n  }\n\n  getResource() {\n    return {\n      serviceName: this.config.serviceName,\n      environment: this.config.environment,\n    };\n  }\n\n  /**\n   * Register a metric definition\n   */\n  register(definition: MetricDefinition): void {\n    this.definitions.set(definition.name, definition);\n  }\n\n  /**\n   * Get or create a counter\n   */\n  counter(name: string, options: Partial<MetricDefinition> = {}): Counter {\n    let counter = this.counters.get(name);\n    if (!counter) {\n      const definition: MetricDefinition = {\n        name,\n        type: \"counter\",\n        unit: options.unit ?? \"count\",\n        description: options.description,\n        labels: options.labels ?? [],\n      };\n      this.register(definition);\n      counter = new Counter(this, definition);\n      this.counters.set(name, counter);\n    }\n    return counter;\n  }\n\n  /**\n   * Get or create a gauge\n   */\n  gauge(name: string, options: Partial<MetricDefinition> = {}): Gauge {\n    let gauge = this.gauges.get(name);\n    if (!gauge) {\n      const definition: MetricDefinition = {\n        name,\n        type: \"gauge\",\n        unit: options.unit ?? \"none\",\n        description: options.description,\n        labels: options.labels ?? [],\n      };\n      this.register(definition);\n      gauge = new Gauge(this, definition);\n      this.gauges.set(name, gauge);\n    }\n    return gauge;\n  }\n\n  /**\n   * Get or create a histogram\n   */\n  histogram(name: string, options: Partial<MetricDefinition> = {}): Histogram {\n    let histogram = this.histograms.get(name);\n    if (!histogram) {\n      const definition: MetricDefinition = {\n        name,\n        type: \"histogram\",\n        unit: options.unit ?? \"ms\",\n        description: options.description,\n        labels: options.labels ?? [],\n        buckets: options.buckets ?? this.config.metrics.defaultBuckets,\n      };\n      this.register(definition);\n      histogram = new Histogram(this, definition);\n      this.histograms.set(name, histogram);\n    }\n    return histogram;\n  }\n\n  /**\n   * Record a metric data point (internal)\n   */\n  recordMetric(data: MetricData): void {\n    this.metricData.set(data.name, data);\n    this.emit(\"metric:recorded\", data);\n  }\n\n  /**\n   * Get all metric data\n   */\n  getAllMetrics(): MetricData[] {\n    return Array.from(this.metricData.values());\n  }\n\n  /**\n   * Get specific metric data\n   */\n  getMetric(name: string): MetricData | undefined {\n    return this.metricData.get(name);\n  }\n\n  /**\n   * Query metrics\n   */\n  query(query: MetricQuery): MetricPoint[] {\n    const metric = this.metricData.get(query.name);\n    if (!metric) return [];\n\n    let points = metric.points;\n\n    // Filter by labels\n    if (query.labels) {\n      points = points.filter(p => {\n        return Object.entries(query.labels!).every(\n          ([key, value]) => p.labels[key] === value\n        );\n      });\n    }\n\n    // Filter by time range\n    if (query.startTime) {\n      points = points.filter(p => p.timestamp >= query.startTime!);\n    }\n    if (query.endTime) {\n      points = points.filter(p => p.timestamp <= query.endTime!);\n    }\n\n    // Apply aggregation\n    if (query.aggregation && query.step) {\n      points = this.aggregatePoints(points, query.aggregation, query.step);\n    }\n\n    return points;\n  }\n\n  private aggregatePoints(\n    points: MetricPoint[],\n    aggregation: \"sum\" | \"avg\" | \"min\" | \"max\" | \"count\" | \"rate\",\n    step: number\n  ): MetricPoint[] {\n    if (points.length === 0) return [];\n\n    // Group points by time bucket\n    const buckets: Map<number, MetricPoint[]> = new Map();\n    for (const point of points) {\n      const bucket = Math.floor(point.timestamp / step) * step;\n      const bucketPoints = buckets.get(bucket) ?? [];\n      bucketPoints.push(point);\n      buckets.set(bucket, bucketPoints);\n    }\n\n    // Aggregate each bucket\n    const results: MetricPoint[] = [];\n    for (const [timestamp, bucketPoints] of buckets) {\n      const values = bucketPoints.map(p => p.value);\n      let value: number;\n\n      switch (aggregation) {\n        case \"sum\":\n          value = values.reduce((a, b) => a + b, 0);\n          break;\n        case \"avg\":\n          value = values.reduce((a, b) => a + b, 0) / values.length;\n          break;\n        case \"min\":\n          value = Math.min(...values);\n          break;\n        case \"max\":\n          value = Math.max(...values);\n          break;\n        case \"count\":\n          value = values.length;\n          break;\n        case \"rate\":\n          value = values.reduce((a, b) => a + b, 0) / (step / 1000);\n          break;\n      }\n\n      results.push({\n        timestamp,\n        value,\n        labels: {},\n      });\n    }\n\n    return results.sort((a, b) => a.timestamp - b.timestamp);\n  }\n\n  /**\n   * Get metrics summary\n   */\n  getSummary(): MetricsSummary {\n    const metrics = this.getAllMetrics();\n    const byType: Record<string, number> = {};\n\n    for (const metric of metrics) {\n      byType[metric.type] = (byType[metric.type] ?? 0) + 1;\n    }\n\n    const topMetrics = metrics\n      .map(m => ({\n        name: m.name,\n        type: m.type,\n        pointCount: m.points.length,\n        lastValue: m.points.length > 0 ? m.points[m.points.length - 1].value : 0,\n      }))\n      .sort((a, b) => b.pointCount - a.pointCount)\n      .slice(0, 10);\n\n    return {\n      totalMetrics: metrics.length,\n      totalPoints: metrics.reduce((sum, m) => sum + m.points.length, 0),\n      metricsByType: byType,\n      topMetrics,\n    };\n  }\n\n  /**\n   * Start periodic collection\n   */\n  private startCollection(): void {\n    this.collectInterval = setInterval(() => {\n      this.collectSystemMetrics();\n    }, this.config.metrics.collectInterval);\n  }\n\n  /**\n   * Collect system metrics\n   */\n  private collectSystemMetrics(): void {\n    // Memory usage\n    if (typeof process !== \"undefined\" && process.memoryUsage) {\n      const memory = process.memoryUsage();\n      const memoryGauge = this.gauge(\"memory_usage_bytes\");\n      memoryGauge.set(memory.heapUsed, { type: \"heap_used\" });\n      memoryGauge.set(memory.heapTotal, { type: \"heap_total\" });\n      memoryGauge.set(memory.external, { type: \"external\" });\n      memoryGauge.set(memory.rss, { type: \"rss\" });\n    }\n  }\n\n  /**\n   * Stop collection\n   */\n  stop(): void {\n    if (this.collectInterval) {\n      clearInterval(this.collectInterval);\n      this.collectInterval = undefined;\n    }\n  }\n\n  /**\n   * Reset all metrics\n   */\n  reset(): void {\n    for (const counter of this.counters.values()) {\n      counter.reset();\n    }\n    for (const gauge of this.gauges.values()) {\n      gauge.reset();\n    }\n    for (const histogram of this.histograms.values()) {\n      histogram.reset();\n    }\n    this.metricData.clear();\n  }\n\n  /**\n   * Export metrics in Prometheus format\n   */\n  toPrometheus(): string {\n    const lines: string[] = [];\n\n    for (const metric of this.getAllMetrics()) {\n      // Add HELP line\n      if (metric.description) {\n        lines.push(`# HELP ${metric.name} ${metric.description}`);\n      }\n\n      // Add TYPE line\n      lines.push(`# TYPE ${metric.name} ${metric.type}`);\n\n      // Add data points\n      if (metric.type === \"histogram\" && metric.histogram) {\n        const h = metric.histogram;\n        for (let i = 0; i < h.boundaries.length; i++) {\n          lines.push(`${metric.name}_bucket{le=\"${h.boundaries[i]}\"} ${h.counts[i]}`);\n        }\n        lines.push(`${metric.name}_bucket{le=\"+Inf\"} ${h.counts[h.boundaries.length]}`);\n        lines.push(`${metric.name}_sum ${h.sum}`);\n        lines.push(`${metric.name}_count ${h.count}`);\n      } else {\n        for (const point of metric.points) {\n          const labels = Object.entries(point.labels)\n            .map(([k, v]) => `${k}=\"${v}\"`)\n            .join(\",\");\n          const labelStr = labels ? `{${labels}}` : \"\";\n          lines.push(`${metric.name}${labelStr} ${point.value}`);\n        }\n      }\n\n      lines.push(\"\");\n    }\n\n    return lines.join(\"\\n\");\n  }\n}\n\n// =============================================================================\n// SINGLETON\n// =============================================================================\n\nlet metricsInstance: MetricsCollector | null = null;\n\nexport function getMetricsCollector(): MetricsCollector | null {\n  return metricsInstance;\n}\n\nexport function createMetricsCollector(config?: Partial<ObservabilityConfig>): MetricsCollector {\n  metricsInstance = new MetricsCollector(config);\n  return metricsInstance;\n}\n","/**\n * Structured Logger\n * Phase 12D: OpenTelemetry-compatible logging\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport type {\n  LogSeverity,\n  LogRecord,\n  ObservabilityConfig,\n  ObservabilityEvents,\n  LogQuery,\n  TraceContext,\n} from \"./types.js\";\n\n// =============================================================================\n// SEVERITY LEVELS\n// =============================================================================\n\nconst SEVERITY_LEVELS: Record<LogSeverity, number> = {\n  TRACE: 0,\n  DEBUG: 1,\n  INFO: 2,\n  WARN: 3,\n  ERROR: 4,\n  FATAL: 5,\n};\n\n// =============================================================================\n// LOGGER\n// =============================================================================\n\nexport class Logger extends EventEmitter<ObservabilityEvents> {\n  private config: ObservabilityConfig;\n  private logs: LogRecord[] = [];\n  private maxLogs: number = 10000;\n  private currentContext?: TraceContext;\n\n  constructor(config: Partial<ObservabilityConfig> = {}) {\n    super();\n    this.config = {\n      serviceName: config.serviceName ?? \"integration-hub\",\n      serviceVersion: config.serviceVersion,\n      environment: config.environment ?? \"development\",\n      tracing: { enabled: true, sampler: { type: \"always_on\", ratio: 1, parentBased: true }, maxSpanAttributes: 128, maxSpanEvents: 128, maxSpanLinks: 128, ...config.tracing },\n      metrics: { enabled: true, collectInterval: 60000, defaultBuckets: [], ...config.metrics },\n      logging: {\n        enabled: true,\n        minSeverity: \"INFO\",\n        includeTraceContext: true,\n        ...config.logging,\n      },\n      resource: { attributes: {}, ...config.resource },\n      retention: { traces: 86400000, metrics: 604800000, logs: 86400000, ...config.retention },\n    };\n\n    // Periodic cleanup\n    setInterval(() => this.cleanup(), 60000);\n  }\n\n  /**\n   * Set trace context for subsequent logs\n   */\n  setContext(context: TraceContext | undefined): void {\n    this.currentContext = context;\n  }\n\n  /**\n   * Create a child logger with a specific context\n   */\n  withContext(context: TraceContext): Logger {\n    const child = new Logger({\n      ...this.config,\n      serviceName: this.config.serviceName,\n    });\n    child.setContext(context);\n    return child;\n  }\n\n  /**\n   * Log with specified severity\n   */\n  log(\n    severity: LogSeverity,\n    message: string,\n    attributes: Record<string, string | number | boolean> = {}\n  ): void {\n    if (!this.config.logging.enabled) return;\n\n    // Check minimum severity\n    const minLevel = SEVERITY_LEVELS[this.config.logging.minSeverity];\n    const currentLevel = SEVERITY_LEVELS[severity];\n    if (currentLevel < minLevel) return;\n\n    const record: LogRecord = {\n      timestamp: Date.now(),\n      severity,\n      body: message,\n      attributes,\n      resource: {\n        serviceName: this.config.serviceName,\n        environment: this.config.environment,\n      },\n    };\n\n    // Add trace context if enabled\n    if (this.config.logging.includeTraceContext && this.currentContext) {\n      record.traceId = this.currentContext.traceId;\n      record.spanId = this.currentContext.spanId;\n    }\n\n    // Store log\n    this.logs.push(record);\n\n    // Trim if needed\n    if (this.logs.length > this.maxLogs) {\n      this.logs = this.logs.slice(-this.maxLogs);\n    }\n\n    this.emit(\"log:recorded\", record);\n\n    // Also output to console in development\n    if (this.config.environment === \"development\") {\n      this.outputToConsole(record);\n    }\n  }\n\n  /**\n   * Log at TRACE level\n   */\n  trace(message: string, attributes: Record<string, string | number | boolean> = {}): void {\n    this.log(\"TRACE\", message, attributes);\n  }\n\n  /**\n   * Log at DEBUG level\n   */\n  debug(message: string, attributes: Record<string, string | number | boolean> = {}): void {\n    this.log(\"DEBUG\", message, attributes);\n  }\n\n  /**\n   * Log at INFO level\n   */\n  info(message: string, attributes: Record<string, string | number | boolean> = {}): void {\n    this.log(\"INFO\", message, attributes);\n  }\n\n  /**\n   * Log at WARN level\n   */\n  warn(message: string, attributes: Record<string, string | number | boolean> = {}): void {\n    this.log(\"WARN\", message, attributes);\n  }\n\n  /**\n   * Log at ERROR level\n   */\n  error(message: string, error?: Error, attributes: Record<string, string | number | boolean> = {}): void {\n    const attrs = { ...attributes };\n    if (error) {\n      attrs[\"error.type\"] = error.name;\n      attrs[\"error.message\"] = error.message;\n      attrs[\"error.stack\"] = error.stack ?? \"\";\n    }\n    this.log(\"ERROR\", message, attrs);\n  }\n\n  /**\n   * Log at FATAL level\n   */\n  fatal(message: string, error?: Error, attributes: Record<string, string | number | boolean> = {}): void {\n    const attrs = { ...attributes };\n    if (error) {\n      attrs[\"error.type\"] = error.name;\n      attrs[\"error.message\"] = error.message;\n      attrs[\"error.stack\"] = error.stack ?? \"\";\n    }\n    this.log(\"FATAL\", message, attrs);\n  }\n\n  /**\n   * Query logs\n   */\n  query(query: LogQuery): LogRecord[] {\n    let results = this.logs;\n\n    // Filter by trace ID\n    if (query.traceId) {\n      results = results.filter(l => l.traceId === query.traceId);\n    }\n\n    // Filter by span ID\n    if (query.spanId) {\n      results = results.filter(l => l.spanId === query.spanId);\n    }\n\n    // Filter by service name\n    if (query.serviceName) {\n      results = results.filter(l => l.resource.serviceName === query.serviceName);\n    }\n\n    // Filter by severity\n    if (query.severity) {\n      const minLevel = SEVERITY_LEVELS[query.severity];\n      results = results.filter(l => SEVERITY_LEVELS[l.severity] >= minLevel);\n    }\n\n    // Filter by body content\n    if (query.bodyContains) {\n      const search = query.bodyContains.toLowerCase();\n      results = results.filter(l => l.body.toLowerCase().includes(search));\n    }\n\n    // Filter by time range\n    if (query.startTime) {\n      results = results.filter(l => l.timestamp >= query.startTime!);\n    }\n    if (query.endTime) {\n      results = results.filter(l => l.timestamp <= query.endTime!);\n    }\n\n    // Apply limit\n    const limit = query.limit ?? 100;\n    return results.slice(-limit);\n  }\n\n  /**\n   * Get logs for a specific trace\n   */\n  getTraceLogs(traceId: string): LogRecord[] {\n    return this.logs.filter(l => l.traceId === traceId);\n  }\n\n  /**\n   * Get all logs\n   */\n  getAllLogs(): LogRecord[] {\n    return [...this.logs];\n  }\n\n  /**\n   * Get stats\n   */\n  getStats(): {\n    totalLogs: number;\n    bySeverity: Record<LogSeverity, number>;\n    logsPerMinute: number;\n  } {\n    const bySeverity: Record<LogSeverity, number> = {\n      TRACE: 0,\n      DEBUG: 0,\n      INFO: 0,\n      WARN: 0,\n      ERROR: 0,\n      FATAL: 0,\n    };\n\n    const oneMinuteAgo = Date.now() - 60000;\n    let recentCount = 0;\n\n    for (const log of this.logs) {\n      bySeverity[log.severity]++;\n      if (log.timestamp >= oneMinuteAgo) {\n        recentCount++;\n      }\n    }\n\n    return {\n      totalLogs: this.logs.length,\n      bySeverity,\n      logsPerMinute: recentCount,\n    };\n  }\n\n  /**\n   * Output log to console\n   */\n  private outputToConsole(record: LogRecord): void {\n    const timestamp = new Date(record.timestamp).toISOString();\n    const prefix = `[${timestamp}] [${record.severity}]`;\n    const traceInfo = record.traceId ? ` [trace=${record.traceId.substring(0, 8)}]` : \"\";\n\n    switch (record.severity) {\n      case \"TRACE\":\n      case \"DEBUG\":\n        console.debug(`${prefix}${traceInfo} ${record.body}`, record.attributes);\n        break;\n      case \"INFO\":\n        console.info(`${prefix}${traceInfo} ${record.body}`, record.attributes);\n        break;\n      case \"WARN\":\n        console.warn(`${prefix}${traceInfo} ${record.body}`, record.attributes);\n        break;\n      case \"ERROR\":\n      case \"FATAL\":\n        console.error(`${prefix}${traceInfo} ${record.body}`, record.attributes);\n        break;\n    }\n  }\n\n  /**\n   * Clean up old logs\n   */\n  private cleanup(): void {\n    const cutoff = Date.now() - this.config.retention.logs;\n    this.logs = this.logs.filter(l => l.timestamp >= cutoff);\n  }\n\n  /**\n   * Clear all logs\n   */\n  clear(): void {\n    this.logs = [];\n  }\n\n  /**\n   * Export logs as JSON\n   */\n  toJSON(): LogRecord[] {\n    return [...this.logs];\n  }\n\n  /**\n   * Export logs as NDJSON (newline-delimited JSON)\n   */\n  toNDJSON(): string {\n    return this.logs.map(l => JSON.stringify(l)).join(\"\\n\");\n  }\n}\n\n// =============================================================================\n// SINGLETON\n// =============================================================================\n\nlet loggerInstance: Logger | null = null;\n\nexport function getLogger(): Logger | null {\n  return loggerInstance;\n}\n\nexport function createLogger(config?: Partial<ObservabilityConfig>): Logger {\n  loggerInstance = new Logger(config);\n  return loggerInstance;\n}\n","/**\n * Observability Manager\n * Phase 12D: Unified observability orchestration\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport { Tracer, createTracer, getTracer, type SpanBuilder, type SpanOptions } from \"./tracer.js\";\nimport { MetricsCollector, createMetricsCollector, getMetricsCollector, Counter, Gauge, Histogram } from \"./metrics.js\";\nimport { Logger, createLogger, getLogger } from \"./logger.js\";\nimport type {\n  ObservabilityConfig,\n  ObservabilityEvents,\n  ObservabilitySummary,\n  TraceQuery,\n  MetricQuery,\n  LogQuery,\n  Trace,\n  MetricData,\n  LogRecord,\n  TraceContext,\n} from \"./types.js\";\n\n// =============================================================================\n// OBSERVABILITY MANAGER\n// =============================================================================\n\nexport class ObservabilityManager extends EventEmitter<ObservabilityEvents> {\n  private config: ObservabilityConfig;\n  private tracer: Tracer;\n  private metrics: MetricsCollector;\n  private logger: Logger;\n  private startTime: number;\n\n  constructor(config: Partial<ObservabilityConfig> = {}) {\n    super();\n\n    this.startTime = Date.now();\n    this.config = {\n      serviceName: config.serviceName ?? \"integration-hub\",\n      serviceVersion: config.serviceVersion,\n      environment: config.environment ?? \"development\",\n      tracing: {\n        enabled: true,\n        sampler: { type: \"always_on\", ratio: 1, parentBased: true },\n        maxSpanAttributes: 128,\n        maxSpanEvents: 128,\n        maxSpanLinks: 128,\n        ...config.tracing,\n      },\n      metrics: {\n        enabled: true,\n        collectInterval: 60000,\n        defaultBuckets: [5, 10, 25, 50, 100, 250, 500, 1000, 2500, 5000, 10000],\n        ...config.metrics,\n      },\n      logging: {\n        enabled: true,\n        minSeverity: \"INFO\",\n        includeTraceContext: true,\n        ...config.logging,\n      },\n      resource: { attributes: {}, ...config.resource },\n      retention: {\n        traces: 24 * 60 * 60 * 1000,\n        metrics: 7 * 24 * 60 * 60 * 1000,\n        logs: 24 * 60 * 60 * 1000,\n        ...config.retention,\n      },\n    };\n\n    // Initialize components\n    this.tracer = createTracer(this.config);\n    this.metrics = createMetricsCollector(this.config);\n    this.logger = createLogger(this.config);\n\n    // Forward events\n    this.tracer.on(\"span:started\", (span) => this.emit(\"span:started\", span));\n    this.tracer.on(\"span:ended\", (span) => this.emit(\"span:ended\", span));\n    this.tracer.on(\"trace:completed\", (trace) => this.emit(\"trace:completed\", trace));\n\n    this.metrics.on(\"metric:recorded\", (metric) => this.emit(\"metric:recorded\", metric));\n\n    this.logger.on(\"log:recorded\", (log) => this.emit(\"log:recorded\", log));\n\n    // Log startup\n    this.logger.info(\"Observability manager started\", {\n      serviceName: this.config.serviceName,\n      environment: this.config.environment,\n    });\n  }\n\n  // ===========================================================================\n  // TRACING\n  // ===========================================================================\n\n  /**\n   * Start a new span\n   */\n  startSpan(name: string, options?: SpanOptions): SpanBuilder {\n    return this.tracer.startSpan(name, options);\n  }\n\n  /**\n   * Create a child span\n   */\n  startChildSpan(name: string, parentContext: TraceContext, options?: Omit<SpanOptions, \"context\">): SpanBuilder {\n    return this.tracer.startChildSpan(name, parentContext, options);\n  }\n\n  /**\n   * Trace an async function\n   */\n  async trace<T>(\n    name: string,\n    fn: (span: SpanBuilder) => Promise<T>,\n    options?: SpanOptions\n  ): Promise<T> {\n    return this.tracer.trace(name, fn, options);\n  }\n\n  /**\n   * Get a trace by ID\n   */\n  getTrace(traceId: string): Trace | null {\n    return this.tracer.getTrace(traceId);\n  }\n\n  /**\n   * Search traces\n   */\n  searchTraces(query: Omit<TraceQuery, \"traceId\">): Trace[] {\n    return this.tracer.searchTraces(query);\n  }\n\n  // ===========================================================================\n  // METRICS\n  // ===========================================================================\n\n  /**\n   * Get or create a counter\n   */\n  counter(name: string, options?: { unit?: string; description?: string; labels?: string[] }): Counter {\n    return this.metrics.counter(name, options as any);\n  }\n\n  /**\n   * Get or create a gauge\n   */\n  gauge(name: string, options?: { unit?: string; description?: string; labels?: string[] }): Gauge {\n    return this.metrics.gauge(name, options as any);\n  }\n\n  /**\n   * Get or create a histogram\n   */\n  histogram(name: string, options?: { unit?: string; description?: string; labels?: string[]; buckets?: number[] }): Histogram {\n    return this.metrics.histogram(name, options as any);\n  }\n\n  /**\n   * Record a metric value\n   */\n  recordMetric(name: string, value: number, labels: Record<string, string> = {}): void {\n    const counter = this.metrics.counter(name);\n    counter.inc(labels, value);\n  }\n\n  /**\n   * Query metrics\n   */\n  queryMetrics(query: MetricQuery): MetricData | undefined {\n    return this.metrics.getMetric(query.name);\n  }\n\n  /**\n   * Get all metrics\n   */\n  getAllMetrics(): MetricData[] {\n    return this.metrics.getAllMetrics();\n  }\n\n  /**\n   * Export metrics in Prometheus format\n   */\n  getPrometheusMetrics(): string {\n    return this.metrics.toPrometheus();\n  }\n\n  // ===========================================================================\n  // LOGGING\n  // ===========================================================================\n\n  /**\n   * Set log context (trace ID, span ID)\n   */\n  setLogContext(context: TraceContext | undefined): void {\n    this.logger.setContext(context);\n  }\n\n  /**\n   * Log at trace level\n   */\n  logTrace(message: string, attributes?: Record<string, string | number | boolean>): void {\n    this.logger.trace(message, attributes);\n  }\n\n  /**\n   * Log at debug level\n   */\n  logDebug(message: string, attributes?: Record<string, string | number | boolean>): void {\n    this.logger.debug(message, attributes);\n  }\n\n  /**\n   * Log at info level\n   */\n  logInfo(message: string, attributes?: Record<string, string | number | boolean>): void {\n    this.logger.info(message, attributes);\n  }\n\n  /**\n   * Log at warn level\n   */\n  logWarn(message: string, attributes?: Record<string, string | number | boolean>): void {\n    this.logger.warn(message, attributes);\n  }\n\n  /**\n   * Log at error level\n   */\n  logError(message: string, error?: Error, attributes?: Record<string, string | number | boolean>): void {\n    this.logger.error(message, error, attributes);\n  }\n\n  /**\n   * Log at fatal level\n   */\n  logFatal(message: string, error?: Error, attributes?: Record<string, string | number | boolean>): void {\n    this.logger.fatal(message, error, attributes);\n  }\n\n  /**\n   * Query logs\n   */\n  queryLogs(query: LogQuery): LogRecord[] {\n    return this.logger.query(query);\n  }\n\n  /**\n   * Get all logs\n   */\n  getAllLogs(): LogRecord[] {\n    return this.logger.getAllLogs();\n  }\n\n  // ===========================================================================\n  // SUMMARY & STATS\n  // ===========================================================================\n\n  /**\n   * Get observability summary\n   */\n  getSummary(): ObservabilitySummary {\n    const traceStats = this.tracer.getStats();\n    const metricsSummary = this.metrics.getSummary();\n\n    // Calculate trace summary\n    const traces = this.searchTraces({ limit: 1000 });\n    const durations = traces.map(t => t.duration ?? 0).filter(d => d > 0);\n    const sortedDurations = durations.sort((a, b) => a - b);\n\n    const getPercentile = (arr: number[], p: number) => {\n      if (arr.length === 0) return 0;\n      const index = Math.ceil((p / 100) * arr.length) - 1;\n      return arr[Math.max(0, index)];\n    };\n\n    // Top services\n    const serviceMap = new Map<string, { count: number; totalDuration: number }>();\n    for (const trace of traces) {\n      const entry = serviceMap.get(trace.serviceName) ?? { count: 0, totalDuration: 0 };\n      entry.count++;\n      entry.totalDuration += trace.duration ?? 0;\n      serviceMap.set(trace.serviceName, entry);\n    }\n\n    const topServices = Array.from(serviceMap.entries())\n      .map(([name, data]) => ({\n        name,\n        traceCount: data.count,\n        avgDuration: data.count > 0 ? data.totalDuration / data.count : 0,\n      }))\n      .sort((a, b) => b.traceCount - a.traceCount)\n      .slice(0, 10);\n\n    // Top operations\n    const opMap = new Map<string, { count: number; totalDuration: number; errors: number }>();\n    for (const trace of traces) {\n      const entry = opMap.get(trace.operationName) ?? { count: 0, totalDuration: 0, errors: 0 };\n      entry.count++;\n      entry.totalDuration += trace.duration ?? 0;\n      entry.errors += trace.errorCount;\n      opMap.set(trace.operationName, entry);\n    }\n\n    const topOperations = Array.from(opMap.entries())\n      .map(([name, data]) => ({\n        name,\n        traceCount: data.count,\n        avgDuration: data.count > 0 ? data.totalDuration / data.count : 0,\n        errorRate: data.count > 0 ? data.errors / data.count : 0,\n      }))\n      .sort((a, b) => b.traceCount - a.traceCount)\n      .slice(0, 10);\n\n    return {\n      traces: {\n        totalTraces: traceStats.totalTraces,\n        totalSpans: traceStats.totalSpans,\n        errorRate: traceStats.errorRate,\n        avgDuration: traceStats.avgDuration,\n        p50Duration: getPercentile(sortedDurations, 50),\n        p95Duration: getPercentile(sortedDurations, 95),\n        p99Duration: getPercentile(sortedDurations, 99),\n        topServices,\n        topOperations,\n      },\n      metrics: metricsSummary,\n      uptime: Date.now() - this.startTime,\n      lastUpdated: Date.now(),\n    };\n  }\n\n  /**\n   * Get health status\n   */\n  getHealth(): {\n    healthy: boolean;\n    tracing: { enabled: boolean; activeSpans: number };\n    metrics: { enabled: boolean; metricCount: number };\n    logging: { enabled: boolean; logCount: number };\n  } {\n    const traceStats = this.tracer.getStats();\n    const metricsSummary = this.metrics.getSummary();\n    const logStats = this.logger.getStats();\n\n    return {\n      healthy: true,\n      tracing: {\n        enabled: this.config.tracing.enabled,\n        activeSpans: traceStats.activeSpans,\n      },\n      metrics: {\n        enabled: this.config.metrics.enabled,\n        metricCount: metricsSummary.totalMetrics,\n      },\n      logging: {\n        enabled: this.config.logging.enabled,\n        logCount: logStats.totalLogs,\n      },\n    };\n  }\n\n  // ===========================================================================\n  // LIFECYCLE\n  // ===========================================================================\n\n  /**\n   * Shutdown observability\n   */\n  shutdown(): void {\n    this.logger.info(\"Observability manager shutting down\");\n    this.metrics.stop();\n    this.removeAllListeners();\n  }\n\n  /**\n   * Reset all data\n   */\n  reset(): void {\n    this.tracer.clear();\n    this.metrics.reset();\n    this.logger.clear();\n  }\n\n  /**\n   * Get configuration\n   */\n  getConfig(): ObservabilityConfig {\n    return { ...this.config };\n  }\n}\n\n// =============================================================================\n// SINGLETON\n// =============================================================================\n\nlet observabilityInstance: ObservabilityManager | null = null;\n\nexport function getObservabilityManager(): ObservabilityManager | null {\n  return observabilityInstance;\n}\n\nexport function createObservabilityManager(config?: Partial<ObservabilityConfig>): ObservabilityManager {\n  observabilityInstance = new ObservabilityManager(config);\n  return observabilityInstance;\n}\n\n// =============================================================================\n// CONVENIENCE EXPORTS\n// =============================================================================\n\nexport { getTracer, getMetricsCollector, getLogger };\n","/**\n * API Server - Fastify REST + WebSocket server\n */\n\nimport Fastify, { type FastifyInstance } from \"fastify\";\nimport fastifyCors from \"@fastify/cors\";\nimport fastifyWebsocket from \"@fastify/websocket\";\nimport type { IntegrationHub } from \"../hub.js\";\nimport { registerRoutes } from \"./routes.js\";\nimport authPlugin from \"./auth-plugin.js\";\n\nexport interface ApiServerConfig {\n  port?: number;\n  host?: string;\n}\n\nexport class ApiServer {\n  private fastify: FastifyInstance;\n  private hub: IntegrationHub;\n  private config: Required<ApiServerConfig>;\n\n  constructor(hub: IntegrationHub, config?: ApiServerConfig) {\n    this.hub = hub;\n    this.config = {\n      port: config?.port ?? 3001,  // Dashboard expects 3001\n      host: config?.host ?? \"0.0.0.0\",\n    };\n\n    this.fastify = Fastify({\n      logger: false,\n    });\n  }\n\n  /**\n   * Initialize the server\n   */\n  async initialize(): Promise<void> {\n    // Register CORS - Secure configuration\n    await this.fastify.register(fastifyCors, {\n      origin: (origin, cb) => {\n        // Allow requests with no origin (like mobile apps, Postman, or server-to-server)\n        if (!origin) return cb(null, true);\n\n        const allowedOrigins = [\n          \"http://localhost:3000\",\n          \"http://localhost:3001\",\n          \"http://localhost:3200\",\n          \"https://gicm.dev\",\n          \"https://dashboard.gicm.dev\",\n          \"https://gicm-dashboard.vercel.app\",\n          process.env.DASHBOARD_URL,\n        ].filter(Boolean);\n\n        if (allowedOrigins.includes(origin)) {\n          cb(null, true);\n        } else {\n          // Log unauthorized origin attempts in development\n          if (process.env.NODE_ENV !== \"production\") {\n            console.warn(`[HUB-API] CORS blocked origin: ${origin}`);\n          }\n          cb(null, false);\n        }\n      },\n      credentials: true,\n      methods: [\"GET\", \"POST\", \"PUT\", \"PATCH\", \"DELETE\", \"OPTIONS\"],\n    });\n\n    // Register WebSocket\n    await this.fastify.register(fastifyWebsocket);\n\n    // Register Authentication plugin\n    await this.fastify.register(authPlugin, {\n      jwtSecret: process.env.GICM_JWT_SECRET,\n      apiKeyPrefix: process.env.GICM_API_KEY_PREFIX || \"gicm\",\n      enabled: process.env.NODE_ENV === \"production\" || process.env.GICM_AUTH_ENABLED === \"true\",\n      publicRoutes: [\n        \"/\",\n        \"/health\",\n        \"/ws\",\n        \"/api/status\",\n        \"/api/brain/status\",\n        \"/api/events\",\n        \"/api/events/*\",\n        \"/api/predictions/*\",\n        \"/api/v1/predictions/*\",\n        \"/api/autonomy/status\",\n        \"/api/money/status\",\n        \"/api/growth/status\",\n        \"/api/product/status\",\n        \"/api/hunter/status\",\n      ],\n    });\n\n    // Register REST routes\n    await registerRoutes(this.fastify, this.hub);\n\n    // WebSocket endpoint\n    this.fastify.get(\"/ws\", { websocket: true }, (socket) => {\n      console.log(\"[HUB-API] WebSocket client connected\");\n\n      // Send welcome message immediately\n      socket.send(JSON.stringify({\n        type: \"connected\",\n        timestamp: Date.now(),\n        message: \"Connected to gICM Hub\"\n      }));\n\n      // Subscribe to all events\n      const handler = (event: any) => {\n        try {\n          socket.send(JSON.stringify(event));\n        } catch {\n          // Client disconnected\n        }\n      };\n\n      this.hub.getEventBus().on(\"*\", handler);\n\n      socket.on(\"close\", () => {\n        console.log(\"[HUB-API] WebSocket client disconnected\");\n        this.hub.getEventBus().off(\"*\", handler);\n      });\n\n      socket.on(\"error\", (err) => {\n        console.log(\"[HUB-API] WebSocket error:\", err.message);\n      });\n\n      socket.on(\"message\", (message) => {\n        try {\n          const data = JSON.parse(message.toString());\n\n          // Handle incoming commands\n          if (data.type === \"ping\") {\n            socket.send(JSON.stringify({ type: \"pong\", timestamp: Date.now() }));\n          } else if (data.type === \"subscribe\") {\n            // Acknowledge subscription request\n            socket.send(JSON.stringify({\n              type: \"subscribed\",\n              channels: data.channels || [],\n              timestamp: Date.now()\n            }));\n          } else if (data.action === \"subscribe\") {\n            // Alternative format from useWebSocket hook\n            socket.send(JSON.stringify({\n              type: \"subscribed\",\n              rooms: data.rooms || [],\n              timestamp: Date.now()\n            }));\n          }\n        } catch {\n          // Invalid message - ignore\n        }\n      });\n    });\n\n    // Health check\n    this.fastify.get(\"/health\", async () => {\n      return { ok: true, timestamp: Date.now() };\n    });\n\n    // Root route - API info\n    this.fastify.get(\"/\", async () => {\n      return {\n        service: \"gICM Integration Hub\",\n        version: \"0.1.0\",\n        status: \"running\",\n        endpoints: {\n          health: \"/health\",\n          api: \"/api\",\n          websocket: \"/ws\",\n          status: \"/api/status\",\n          brain: \"/api/brain/status\",\n        },\n        timestamp: Date.now(),\n      };\n    });\n  }\n\n  /**\n   * Start the server\n   */\n  async start(): Promise<void> {\n    await this.initialize();\n\n    await this.fastify.listen({\n      port: this.config.port,\n      host: this.config.host,\n    });\n\n    console.log(\"[HUB-API] Server listening on port\", this.config.port);\n  }\n\n  /**\n   * Stop the server\n   */\n  async stop(): Promise<void> {\n    await this.fastify.close();\n    console.log(\"[HUB-API] Server stopped\");\n  }\n\n  /**\n   * Get the Fastify instance\n   */\n  getFastify(): FastifyInstance {\n    return this.fastify;\n  }\n}\n","import type { FastifyInstance } from \"fastify\";\nimport type { IntegrationHub } from \"../hub.js\";\nimport { getContentStorage } from \"../storage/content-storage.js\";\nimport { generateContentBriefsDaily, materializeContentFromBriefs } from \"../workflows/content.js\";\nimport { getDistributionService } from \"../distribution/index.js\";\nimport type {\n  EngineEvent,\n  WinRecord,\n  ContentBrief,\n  ContentArticle,\n  DistributionPacket,\n  ContentChannel,\n} from \"../types/content.js\";\n\nexport async function registerContentRoutes(\n  fastify: FastifyInstance,\n  hub: IntegrationHub\n): Promise<void> {\n  const storage = getContentStorage();\n  await storage.initialize();\n\n  // =========================================================================\n  // ENGINE EVENTS - Ingestion from Money/Growth/Product engines\n  // =========================================================================\n\n  /**\n   * POST /api/content/events - Ingest an engine event\n   */\n  fastify.post<{\n    Body: Omit<EngineEvent, \"id\" | \"timestamp\"> & { id?: string; timestamp?: string };\n  }>(\"/api/content/events\", async (req, reply) => {\n    const eventData = req.body;\n\n    if (!eventData.engine || !eventData.type || !eventData.title) {\n      reply.code(400);\n      return { ok: false, error: \"Missing required fields: engine, type, title\" };\n    }\n\n    const event: EngineEvent = {\n      ...eventData,\n      id: eventData.id || `evt_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`,\n      timestamp: eventData.timestamp || new Date().toISOString(),\n    };\n\n    await storage.saveEngineEvent(event);\n    hub.getEventBus().publish(event.engine, event.type, event);\n\n    return { ok: true, id: event.id };\n  });\n\n  /**\n   * GET /api/content/events - List events\n   */\n  fastify.get<{\n    Querystring: { since?: string; engine?: string; type?: string; limit?: string };\n  }>(\"/api/content/events\", async (req, reply) => {\n    const sinceStr = req.query.since;\n    const since = sinceStr ? new Date(sinceStr) : new Date(Date.now() - 24 * 60 * 60 * 1000);\n\n    if (isNaN(since.getTime())) {\n      reply.code(400);\n      return { ok: false, error: \"Invalid date format for 'since'\" };\n    }\n\n    let events = await storage.getEngineEventsSince(since);\n\n    // Filter by engine if specified\n    if (req.query.engine) {\n      events = events.filter((e) => e.engine === req.query.engine);\n    }\n\n    // Filter by type if specified\n    if (req.query.type) {\n      events = events.filter((e) => e.type === req.query.type);\n    }\n\n    // Limit results\n    const limit = parseInt(req.query.limit || \"100\", 10);\n    events = events.slice(0, limit);\n\n    return { ok: true, count: events.length, events };\n  });\n\n  // Legacy endpoint for backwards compatibility\n  fastify.post<{\n    Body: Omit<EngineEvent, \"id\" | \"timestamp\"> & { id?: string; timestamp?: string };\n  }>(\"/api/integration/events\", async (req, reply) => {\n    const eventData = req.body;\n    if (!eventData.engine || !eventData.type || !eventData.title) {\n      reply.code(400);\n      return { ok: false, error: \"Missing required fields: engine, type, title\" };\n    }\n    const event: EngineEvent = {\n      ...eventData,\n      id: eventData.id || `evt_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`,\n      timestamp: eventData.timestamp || new Date().toISOString(),\n    };\n    await storage.saveEngineEvent(event);\n    hub.getEventBus().publish(event.engine, event.type, event);\n    return { ok: true, id: event.id };\n  });\n\n  fastify.get<{ Querystring: { since?: string } }>(\"/api/integration/events\", async (req) => {\n    const sinceStr = req.query.since;\n    const since = sinceStr ? new Date(sinceStr) : new Date(Date.now() - 24 * 60 * 60 * 1000);\n    if (isNaN(since.getTime())) {\n      return { ok: false, error: \"Invalid date format for 'since'\" };\n    }\n    const events = await storage.getEngineEventsSince(since);\n    return { ok: true, count: events.length, events };\n  });\n\n  // =========================================================================\n  // WIN RECORDS\n  // =========================================================================\n\n  /**\n   * POST /api/content/wins - Record a win\n   */\n  fastify.post<{\n    Body: Omit<WinRecord, \"id\" | \"createdAt\"> & { id?: string; createdAt?: string };\n  }>(\"/api/content/wins\", async (req, reply) => {\n    const winData = req.body;\n\n    if (!winData.category || !winData.title || winData.value === undefined) {\n      reply.code(400);\n      return { ok: false, error: \"Missing required fields: category, title, value\" };\n    }\n\n    const win: WinRecord = {\n      ...winData,\n      id: winData.id || `win_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`,\n      createdAt: winData.createdAt || new Date().toISOString(),\n    };\n\n    await storage.saveWinRecord(win);\n\n    return { ok: true, id: win.id };\n  });\n\n  /**\n   * GET /api/content/wins - List wins\n   */\n  fastify.get<{\n    Querystring: { since?: string; category?: string; limit?: string };\n  }>(\"/api/content/wins\", async (req, reply) => {\n    const sinceStr = req.query.since;\n    const since = sinceStr ? new Date(sinceStr) : new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);\n\n    if (isNaN(since.getTime())) {\n      reply.code(400);\n      return { ok: false, error: \"Invalid date format for 'since'\" };\n    }\n\n    let wins = await storage.getWinRecordsSince(since);\n\n    if (req.query.category) {\n      wins = wins.filter((w) => w.category === req.query.category);\n    }\n\n    const limit = parseInt(req.query.limit || \"50\", 10);\n    wins = wins.slice(0, limit);\n\n    return { ok: true, count: wins.length, wins };\n  });\n\n  // =========================================================================\n  // CONTENT BRIEFS\n  // =========================================================================\n\n  /**\n   * POST /api/content/briefs - Create a brief manually\n   */\n  fastify.post<{\n    Body: Omit<ContentBrief, \"id\" | \"createdAt\"> & { id?: string; createdAt?: string };\n  }>(\"/api/content/briefs\", async (req, reply) => {\n    const briefData = req.body;\n\n    if (!briefData.keyIdea || !briefData.narrativeAngle) {\n      reply.code(400);\n      return { ok: false, error: \"Missing required fields: keyIdea, narrativeAngle\" };\n    }\n\n    const brief: ContentBrief = {\n      ...briefData,\n      id: briefData.id || `brief_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`,\n      createdAt: briefData.createdAt || new Date().toISOString(),\n    };\n\n    await storage.saveContentBrief(brief);\n\n    return { ok: true, id: brief.id, brief };\n  });\n\n  /**\n   * GET /api/content/briefs - List briefs\n   */\n  fastify.get<{\n    Querystring: { status?: string; narrative?: string; limit?: string };\n  }>(\"/api/content/briefs\", async (req) => {\n    // Get all briefs (pending ones for now, would need to expand storage)\n    const briefs = await storage.listPendingBriefs();\n\n    // Filter by narrative angle if specified\n    let filtered = briefs;\n    if (req.query.narrative) {\n      filtered = filtered.filter((b) => b.narrativeAngle === req.query.narrative);\n    }\n\n    const limit = parseInt(req.query.limit || \"50\", 10);\n    filtered = filtered.slice(0, limit);\n\n    return { ok: true, count: filtered.length, briefs: filtered };\n  });\n\n  /**\n   * GET /api/content/briefs/:id - Get a specific brief\n   */\n  fastify.get<{ Params: { id: string } }>(\"/api/content/briefs/:id\", async (req, reply) => {\n    const brief = await storage.getBrief(req.params.id);\n\n    if (!brief) {\n      reply.code(404);\n      return { ok: false, error: \"Brief not found\" };\n    }\n\n    return { ok: true, brief };\n  });\n\n  // =========================================================================\n  // CONTENT ARTICLES\n  // =========================================================================\n\n  /**\n   * GET /api/content/articles - List articles\n   */\n  fastify.get<{\n    Querystring: { status?: string; limit?: string };\n  }>(\"/api/content/articles\", async (req) => {\n    // This would need a new storage method - for now return what we have\n    const pendingBriefs = await storage.listPendingBriefs();\n    const articles: ContentArticle[] = [];\n\n    for (const brief of pendingBriefs) {\n      const article = await storage.getArticleByBriefId(brief.id);\n      if (article) {\n        if (!req.query.status || article.status === req.query.status) {\n          articles.push(article);\n        }\n      }\n    }\n\n    const limit = parseInt(req.query.limit || \"50\", 10);\n    return { ok: true, count: articles.length, articles: articles.slice(0, limit) };\n  });\n\n  /**\n   * GET /api/content/articles/:briefId - Get article by brief ID\n   */\n  fastify.get<{ Params: { briefId: string } }>(\n    \"/api/content/articles/:briefId\",\n    async (req, reply) => {\n      const article = await storage.getArticleByBriefId(req.params.briefId);\n\n      if (!article) {\n        reply.code(404);\n        return { ok: false, error: \"Article not found for this brief\" };\n      }\n\n      return { ok: true, article };\n    }\n  );\n\n  /**\n   * PATCH /api/content/articles/:id/status - Update article status\n   */\n  fastify.patch<{\n    Params: { id: string };\n    Body: { status: ContentArticle[\"status\"]; reviewerNotes?: string };\n  }>(\"/api/content/articles/:id/status\", async (req, reply) => {\n    const { status, reviewerNotes } = req.body;\n    const validStatuses = [\"draft\", \"ready_for_review\", \"ready_for_publish\", \"published\"];\n\n    if (!validStatuses.includes(status)) {\n      reply.code(400);\n      return { ok: false, error: `Invalid status. Must be one of: ${validStatuses.join(\", \")}` };\n    }\n\n    // Would need to get article by ID first, then update\n    // For now, return success stub\n    return {\n      ok: true,\n      message: `Article status updated to ${status}`,\n      reviewerNotes: reviewerNotes || null,\n    };\n  });\n\n  // =========================================================================\n  // DISTRIBUTION\n  // =========================================================================\n\n  /**\n   * POST /api/content/distribute/:articleId - Trigger distribution for an article\n   */\n  fastify.post<{\n    Params: { articleId: string };\n    Body: { channels?: ContentChannel[]; dryRun?: boolean };\n  }>(\"/api/content/distribute/:articleId\", async (req, reply) => {\n    const { articleId } = req.params;\n    const { channels, dryRun } = req.body;\n\n    // Get the distribution packet for this article\n    const packet = await storage.getDistributionPacketByArticleId(articleId);\n    if (!packet) {\n      reply.code(404);\n      return { ok: false, error: \"Distribution packet not found for this article\" };\n    }\n\n    // Use the distribution service\n    const distributionService = getDistributionService({ dryRun });\n    const results = await distributionService.distribute(packet, channels);\n\n    // Calculate summary\n    const successful = results.filter((r) => r.success);\n    const failed = results.filter((r) => !r.success);\n\n    return {\n      ok: true,\n      message: `Distribution completed: ${successful.length} successful, ${failed.length} failed`,\n      articleId,\n      results,\n      tier1: {\n        automated: results.filter((r) =>\n          [\"blog\", \"substack\", \"mirror\", \"medium\", \"devto\", \"hashnode\", \"github\", \"rss\", \"email\"].includes(r.channel)\n        ),\n      },\n      tier2: {\n        queuedForApproval: results.filter((r) =>\n          [\"twitter\", \"linkedin\", \"reddit\"].includes(r.channel)\n        ),\n      },\n    };\n  });\n\n  /**\n   * GET /api/content/distribution/:articleId - Get distribution status\n   */\n  fastify.get<{ Params: { articleId: string } }>(\n    \"/api/content/distribution/:articleId\",\n    async (req, reply) => {\n      const { articleId } = req.params;\n\n      // Get distribution packet\n      const packet = await storage.getDistributionPacketByArticleId(articleId);\n      if (!packet) {\n        reply.code(404);\n        return { ok: false, error: \"Distribution packet not found\" };\n      }\n\n      // Get attempts from the distribution service\n      const distributionService = getDistributionService();\n      const attempts = distributionService.getAttempts(packet.id);\n\n      return {\n        ok: true,\n        articleId,\n        packetId: packet.id,\n        status: packet.status,\n        attempts,\n        channels: {\n          tier1Automated: [\"blog\", \"substack\", \"mirror\", \"medium\", \"devto\", \"hashnode\", \"github\", \"rss\", \"email\"],\n          tier2Approval: [\"twitter\", \"linkedin\", \"reddit\"],\n        },\n      };\n    }\n  );\n\n  // =========================================================================\n  // PIPELINE TRIGGERS\n  // =========================================================================\n\n  /**\n   * POST /api/content/trigger/orchestrator - Generate briefs from recent events\n   */\n  fastify.post(\"/api/content/trigger/orchestrator\", async () => {\n    try {\n      await generateContentBriefsDaily();\n      return { ok: true, message: \"Content brief generation completed\" };\n    } catch (error) {\n      return {\n        ok: false,\n        error: \"Brief generation failed\",\n        details: error instanceof Error ? error.message : String(error),\n      };\n    }\n  });\n\n  /**\n   * POST /api/content/trigger/production - Generate articles from pending briefs\n   */\n  fastify.post(\"/api/content/trigger/production\", async () => {\n    try {\n      await materializeContentFromBriefs();\n      return { ok: true, message: \"Content production completed\" };\n    } catch (error) {\n      return {\n        ok: false,\n        error: \"Content production failed\",\n        details: error instanceof Error ? error.message : String(error),\n      };\n    }\n  });\n\n  /**\n   * POST /api/content/trigger/full-pipeline - Run the entire content pipeline\n   */\n  fastify.post(\"/api/content/trigger/full-pipeline\", async () => {\n    try {\n      // Step 1: Generate briefs from events\n      await generateContentBriefsDaily();\n\n      // Step 2: Generate articles from briefs\n      await materializeContentFromBriefs();\n\n      return {\n        ok: true,\n        message: \"Full content pipeline completed\",\n        steps: [\"brief_generation\", \"article_production\", \"distribution_ready\"],\n      };\n    } catch (error) {\n      return {\n        ok: false,\n        error: \"Pipeline failed\",\n        details: error instanceof Error ? error.message : String(error),\n      };\n    }\n  });\n\n  // =========================================================================\n  // METRICS & ANALYTICS\n  // =========================================================================\n\n  /**\n   * GET /api/content/metrics - Get content performance metrics\n   */\n  fastify.get<{\n    Querystring: { period?: string; channel?: string };\n  }>(\"/api/content/metrics\", async (req) => {\n    const period = req.query.period || \"week\";\n    const channel = req.query.channel;\n\n    // Would aggregate from content_metrics table\n    return {\n      ok: true,\n      period,\n      channel: channel || \"all\",\n      metrics: {\n        totalArticles: 0,\n        totalViews: 0,\n        totalEngagement: 0,\n        avgEngagementRate: 0,\n        topPerformingChannels: [],\n        topPerformingArticles: [],\n      },\n      note: \"Real metrics will be available after connecting platform analytics\",\n    };\n  });\n\n  /**\n   * GET /api/content/pipeline/status - Get pipeline overview\n   */\n  fastify.get(\"/api/content/pipeline/status\", async () => {\n    const pendingBriefs = await storage.listPendingBriefs();\n    const last24h = new Date(Date.now() - 24 * 60 * 60 * 1000);\n    const recentEvents = await storage.getEngineEventsSince(last24h);\n\n    return {\n      ok: true,\n      pipeline: {\n        eventsLast24h: recentEvents.length,\n        pendingBriefs: pendingBriefs.length,\n        draftArticles: 0, // Would need storage method\n        readyForReview: 0,\n        published: 0,\n        distributionQueued: 0,\n      },\n      channels: {\n        tier1Automated: [\"blog\", \"substack\", \"mirror\", \"medium\", \"devto\", \"hashnode\", \"github\", \"rss\", \"email\"],\n        tier2Approval: [\"twitter\", \"linkedin\", \"reddit\"],\n      },\n    };\n  });\n}\n","/**\n * Organization Routes - Multi-Tenancy & RBAC API Endpoints\n * Phase 9A: Enterprise Security Foundation\n */\n\nimport type { FastifyInstance, FastifyRequest, FastifyReply } from \"fastify\";\nimport {\n  getRBACManager,\n  CreateOrgSchema,\n  UpdateOrgSchema,\n  AddMemberSchema,\n  UpdateMemberSchema,\n  CreateInviteSchema,\n  Permission,\n  Role,\n} from \"../auth/index.js\";\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\ninterface AuthenticatedRequest extends FastifyRequest {\n  userId?: string;\n  orgId?: string;\n}\n\n// ============================================================================\n// AUTH MIDDLEWARE (simplified - in production use JWT/session)\n// ============================================================================\n\nasync function requireAuth(\n  request: AuthenticatedRequest,\n  reply: FastifyReply\n): Promise<void> {\n  // In production, extract userId from JWT or session\n  const userId = request.headers[\"x-user-id\"] as string;\n\n  if (!userId) {\n    reply.code(401).send({ ok: false, error: \"Authentication required\" });\n    return;\n  }\n\n  request.userId = userId;\n}\n\nasync function requireOrgMembership(\n  request: AuthenticatedRequest,\n  reply: FastifyReply\n): Promise<void> {\n  await requireAuth(request, reply);\n  if (reply.sent) return;\n\n  const orgId = (request.params as any).orgId || request.headers[\"x-org-id\"];\n\n  if (!orgId) {\n    reply.code(400).send({ ok: false, error: \"Organization ID required\" });\n    return;\n  }\n\n  const rbac = getRBACManager();\n  const member = rbac.getMember(orgId, request.userId!);\n\n  if (!member) {\n    reply.code(403).send({ ok: false, error: \"Not a member of this organization\" });\n    return;\n  }\n\n  request.orgId = orgId;\n}\n\nfunction requirePermission(permission: Permission) {\n  return async (request: AuthenticatedRequest, reply: FastifyReply): Promise<void> => {\n    await requireOrgMembership(request, reply);\n    if (reply.sent) return;\n\n    const rbac = getRBACManager();\n    const hasPermission = rbac.hasPermission(request.userId!, request.orgId!, permission);\n\n    if (!hasPermission) {\n      reply.code(403).send({\n        ok: false,\n        error: `Permission denied: ${permission}`,\n      });\n    }\n  };\n}\n\nfunction requireRole(minRole: Role) {\n  return async (request: AuthenticatedRequest, reply: FastifyReply): Promise<void> => {\n    await requireOrgMembership(request, reply);\n    if (reply.sent) return;\n\n    const rbac = getRBACManager();\n    const hasRole = rbac.hasRole(request.userId!, request.orgId!, minRole);\n\n    if (!hasRole) {\n      reply.code(403).send({\n        ok: false,\n        error: `Role \"${minRole}\" or higher required`,\n      });\n    }\n  };\n}\n\n// ============================================================================\n// ROUTE REGISTRATION\n// ============================================================================\n\nexport async function registerOrgRoutes(fastify: FastifyInstance): Promise<void> {\n  const rbac = getRBACManager();\n\n  // =========================================================================\n  // ORGANIZATION ENDPOINTS\n  // =========================================================================\n\n  /**\n   * POST /api/orgs - Create a new organization\n   */\n  fastify.post<{\n    Body: {\n      name: string;\n      slug: string;\n      description?: string;\n      billingEmail?: string;\n    };\n  }>(\"/api/orgs\", {\n    preHandler: requireAuth,\n  }, async (request: AuthenticatedRequest, reply) => {\n    try {\n      const input = CreateOrgSchema.parse(request.body);\n      const org = await rbac.createOrganization({\n        ...input,\n        createdBy: request.userId!,\n      }, request.userId!);\n\n      return {\n        ok: true,\n        organization: {\n          id: org.id,\n          name: org.name,\n          slug: org.slug,\n          description: org.description,\n          plan: org.plan,\n          createdAt: org.createdAt,\n        },\n      };\n    } catch (error) {\n      reply.code(400);\n      return {\n        ok: false,\n        error: error instanceof Error ? error.message : \"Failed to create organization\",\n      };\n    }\n  });\n\n  /**\n   * GET /api/orgs - List user's organizations\n   */\n  fastify.get(\"/api/orgs\", {\n    preHandler: requireAuth,\n  }, async (request: AuthenticatedRequest) => {\n    const orgs = rbac.getUserOrganizations(request.userId!);\n\n    return {\n      ok: true,\n      count: orgs.length,\n      organizations: orgs.map((org) => ({\n        id: org.id,\n        name: org.name,\n        slug: org.slug,\n        plan: org.plan,\n        createdAt: org.createdAt,\n      })),\n    };\n  });\n\n  /**\n   * GET /api/orgs/:orgId - Get organization details\n   */\n  fastify.get<{ Params: { orgId: string } }>(\"/api/orgs/:orgId\", {\n    preHandler: requireOrgMembership,\n  }, async (request: AuthenticatedRequest, reply) => {\n    const org = rbac.getOrganization(request.orgId!);\n\n    if (!org) {\n      reply.code(404);\n      return { ok: false, error: \"Organization not found\" };\n    }\n\n    const member = rbac.getMember(request.orgId!, request.userId!);\n\n    return {\n      ok: true,\n      organization: {\n        id: org.id,\n        name: org.name,\n        slug: org.slug,\n        description: org.description,\n        plan: org.plan,\n        settings: org.settings,\n        createdAt: org.createdAt,\n        updatedAt: org.updatedAt,\n      },\n      membership: {\n        role: member?.role,\n        joinedAt: member?.joinedAt,\n      },\n    };\n  });\n\n  /**\n   * PATCH /api/orgs/:orgId - Update organization\n   */\n  fastify.patch<{\n    Params: { orgId: string };\n    Body: {\n      name?: string;\n      slug?: string;\n      description?: string;\n      billingEmail?: string;\n      settings?: Record<string, unknown>;\n    };\n  }>(\"/api/orgs/:orgId\", {\n    preHandler: requirePermission(\"organization:update\"),\n  }, async (request: AuthenticatedRequest, reply) => {\n    try {\n      const updates = UpdateOrgSchema.parse(request.body);\n      const org = await rbac.updateOrganization(request.orgId!, updates);\n\n      if (!org) {\n        reply.code(404);\n        return { ok: false, error: \"Organization not found\" };\n      }\n\n      return {\n        ok: true,\n        organization: {\n          id: org.id,\n          name: org.name,\n          slug: org.slug,\n          description: org.description,\n          updatedAt: org.updatedAt,\n        },\n      };\n    } catch (error) {\n      reply.code(400);\n      return {\n        ok: false,\n        error: error instanceof Error ? error.message : \"Failed to update organization\",\n      };\n    }\n  });\n\n  /**\n   * DELETE /api/orgs/:orgId - Delete organization\n   */\n  fastify.delete<{ Params: { orgId: string } }>(\"/api/orgs/:orgId\", {\n    preHandler: requirePermission(\"organization:delete\"),\n  }, async (request: AuthenticatedRequest, reply) => {\n    const deleted = await rbac.deleteOrganization(request.orgId!);\n\n    if (!deleted) {\n      reply.code(404);\n      return { ok: false, error: \"Organization not found\" };\n    }\n\n    return { ok: true, message: \"Organization deleted\" };\n  });\n\n  // =========================================================================\n  // MEMBER ENDPOINTS\n  // =========================================================================\n\n  /**\n   * GET /api/orgs/:orgId/members - List organization members\n   */\n  fastify.get<{ Params: { orgId: string } }>(\"/api/orgs/:orgId/members\", {\n    preHandler: requirePermission(\"member:read\"),\n  }, async (request: AuthenticatedRequest) => {\n    const members = rbac.getOrgMembers(request.orgId!);\n\n    return {\n      ok: true,\n      count: members.length,\n      members: members.map((m) => ({\n        id: m.id,\n        userId: m.userId,\n        email: m.email,\n        displayName: m.displayName,\n        avatarUrl: m.avatarUrl,\n        role: m.role,\n        joinedAt: m.joinedAt,\n        lastActiveAt: m.lastActiveAt,\n      })),\n    };\n  });\n\n  /**\n   * GET /api/orgs/:orgId/members/:userId - Get member details\n   */\n  fastify.get<{ Params: { orgId: string; userId: string } }>(\n    \"/api/orgs/:orgId/members/:userId\",\n    { preHandler: requirePermission(\"member:read\") },\n    async (request: AuthenticatedRequest, reply) => {\n      const member = rbac.getMember(request.orgId!, request.params.userId);\n\n      if (!member) {\n        reply.code(404);\n        return { ok: false, error: \"Member not found\" };\n      }\n\n      return {\n        ok: true,\n        member: {\n          id: member.id,\n          userId: member.userId,\n          email: member.email,\n          displayName: member.displayName,\n          avatarUrl: member.avatarUrl,\n          role: member.role,\n          customPermissions: member.customPermissions,\n          status: member.status,\n          invitedBy: member.invitedBy,\n          joinedAt: member.joinedAt,\n          lastActiveAt: member.lastActiveAt,\n        },\n      };\n    }\n  );\n\n  /**\n   * PATCH /api/orgs/:orgId/members/:userId - Update member role\n   */\n  fastify.patch<{\n    Params: { orgId: string; userId: string };\n    Body: { role?: Role; customPermissions?: string[] };\n  }>(\n    \"/api/orgs/:orgId/members/:userId\",\n    { preHandler: requirePermission(\"member:update\") },\n    async (request: AuthenticatedRequest, reply) => {\n      try {\n        // Prevent self-demotion for owners\n        if (\n          request.params.userId === request.userId &&\n          request.body.role &&\n          request.body.role !== \"owner\"\n        ) {\n          const member = rbac.getMember(request.orgId!, request.userId!);\n          if (member?.role === \"owner\") {\n            reply.code(400);\n            return { ok: false, error: \"Cannot demote yourself. Transfer ownership first.\" };\n          }\n        }\n\n        const updates = UpdateMemberSchema.parse(request.body);\n        const member = await rbac.updateMember(\n          request.orgId!,\n          request.params.userId,\n          updates\n        );\n\n        if (!member) {\n          reply.code(404);\n          return { ok: false, error: \"Member not found\" };\n        }\n\n        return {\n          ok: true,\n          member: {\n            id: member.id,\n            userId: member.userId,\n            role: member.role,\n            customPermissions: member.customPermissions,\n          },\n        };\n      } catch (error) {\n        reply.code(400);\n        return {\n          ok: false,\n          error: error instanceof Error ? error.message : \"Failed to update member\",\n        };\n      }\n    }\n  );\n\n  /**\n   * DELETE /api/orgs/:orgId/members/:userId - Remove member\n   */\n  fastify.delete<{ Params: { orgId: string; userId: string } }>(\n    \"/api/orgs/:orgId/members/:userId\",\n    { preHandler: requirePermission(\"member:delete\") },\n    async (request: AuthenticatedRequest, reply) => {\n      // Prevent self-removal\n      if (request.params.userId === request.userId) {\n        reply.code(400);\n        return { ok: false, error: \"Cannot remove yourself. Leave the organization instead.\" };\n      }\n\n      try {\n        const removed = await rbac.removeMember(request.orgId!, request.params.userId);\n\n        if (!removed) {\n          reply.code(404);\n          return { ok: false, error: \"Member not found\" };\n        }\n\n        return { ok: true, message: \"Member removed\" };\n      } catch (error) {\n        reply.code(400);\n        return {\n          ok: false,\n          error: error instanceof Error ? error.message : \"Failed to remove member\",\n        };\n      }\n    }\n  );\n\n  /**\n   * POST /api/orgs/:orgId/leave - Leave organization\n   */\n  fastify.post<{ Params: { orgId: string } }>(\"/api/orgs/:orgId/leave\", {\n    preHandler: requireOrgMembership,\n  }, async (request: AuthenticatedRequest, reply) => {\n    try {\n      const removed = await rbac.removeMember(request.orgId!, request.userId!);\n\n      if (!removed) {\n        reply.code(400);\n        return { ok: false, error: \"Failed to leave organization\" };\n      }\n\n      return { ok: true, message: \"Left organization\" };\n    } catch (error) {\n      reply.code(400);\n      return {\n        ok: false,\n        error: error instanceof Error ? error.message : \"Failed to leave organization\",\n      };\n    }\n  });\n\n  // =========================================================================\n  // INVITE ENDPOINTS\n  // =========================================================================\n\n  /**\n   * GET /api/orgs/:orgId/invites - List pending invites\n   */\n  fastify.get<{ Params: { orgId: string } }>(\"/api/orgs/:orgId/invites\", {\n    preHandler: requirePermission(\"invite:read\"),\n  }, async (request: AuthenticatedRequest) => {\n    const invites = rbac.getOrgInvites(request.orgId!, true);\n\n    return {\n      ok: true,\n      count: invites.length,\n      invites: invites.map((i) => ({\n        id: i.id,\n        email: i.email,\n        role: i.role,\n        status: i.status,\n        expiresAt: i.expiresAt,\n        invitedAt: i.invitedAt,\n        message: i.message,\n      })),\n    };\n  });\n\n  /**\n   * POST /api/orgs/:orgId/invites - Create invite\n   */\n  fastify.post<{\n    Params: { orgId: string };\n    Body: { email: string; role?: Role; message?: string; expiresInDays?: number };\n  }>(\n    \"/api/orgs/:orgId/invites\",\n    { preHandler: requirePermission(\"invite:create\") },\n    async (request: AuthenticatedRequest, reply) => {\n      try {\n        const input = CreateInviteSchema.parse(request.body);\n        const invite = await rbac.createInvite(\n          request.orgId!,\n          input,\n          request.userId!\n        );\n\n        // In production, send email here\n\n        return {\n          ok: true,\n          invite: {\n            id: invite.id,\n            email: invite.email,\n            role: invite.role,\n            expiresAt: invite.expiresAt,\n            // Include token only for API response (would normally be emailed)\n            inviteUrl: `https://app.gicm.dev/invite/${invite.token}`,\n          },\n        };\n      } catch (error) {\n        reply.code(400);\n        return {\n          ok: false,\n          error: error instanceof Error ? error.message : \"Failed to create invite\",\n        };\n      }\n    }\n  );\n\n  /**\n   * DELETE /api/orgs/:orgId/invites/:inviteId - Revoke invite\n   */\n  fastify.delete<{ Params: { orgId: string; inviteId: string } }>(\n    \"/api/orgs/:orgId/invites/:inviteId\",\n    { preHandler: requirePermission(\"invite:delete\") },\n    async (request: AuthenticatedRequest, reply) => {\n      const revoked = await rbac.revokeInvite(request.params.inviteId);\n\n      if (!revoked) {\n        reply.code(404);\n        return { ok: false, error: \"Invite not found or already processed\" };\n      }\n\n      return { ok: true, message: \"Invite revoked\" };\n    }\n  );\n\n  /**\n   * POST /api/invites/accept - Accept an invite (public endpoint)\n   */\n  fastify.post<{\n    Body: { token: string; displayName?: string };\n  }>(\"/api/invites/accept\", {\n    preHandler: requireAuth,\n  }, async (request: AuthenticatedRequest, reply) => {\n    const { token, displayName } = request.body;\n\n    if (!token) {\n      reply.code(400);\n      return { ok: false, error: \"Token required\" };\n    }\n\n    try {\n      // Get invite to find email (in production, use authenticated user's email)\n      const invite = rbac.getInviteByToken(token);\n      if (!invite) {\n        reply.code(404);\n        return { ok: false, error: \"Invalid or expired invite\" };\n      }\n\n      const member = await rbac.acceptInvite(\n        token,\n        request.userId!,\n        invite.email,\n        displayName\n      );\n\n      const org = rbac.getOrganization(invite.orgId);\n\n      return {\n        ok: true,\n        message: \"Invite accepted\",\n        organization: {\n          id: org?.id,\n          name: org?.name,\n          slug: org?.slug,\n        },\n        membership: {\n          role: member.role,\n          joinedAt: member.joinedAt,\n        },\n      };\n    } catch (error) {\n      reply.code(400);\n      return {\n        ok: false,\n        error: error instanceof Error ? error.message : \"Failed to accept invite\",\n      };\n    }\n  });\n\n  // =========================================================================\n  // PERMISSION CHECK ENDPOINT\n  // =========================================================================\n\n  /**\n   * POST /api/orgs/:orgId/check-permission - Check if user has permission\n   */\n  fastify.post<{\n    Params: { orgId: string };\n    Body: { permission: string };\n  }>(\n    \"/api/orgs/:orgId/check-permission\",\n    { preHandler: requireOrgMembership },\n    async (request: AuthenticatedRequest) => {\n      const { permission } = request.body;\n      const hasPermission = rbac.hasPermission(\n        request.userId!,\n        request.orgId!,\n        permission as Permission\n      );\n\n      return {\n        ok: true,\n        permission,\n        allowed: hasPermission,\n      };\n    }\n  );\n\n  // =========================================================================\n  // AUTH CONTEXT ENDPOINT\n  // =========================================================================\n\n  /**\n   * GET /api/orgs/:orgId/context - Get auth context for current user\n   */\n  fastify.get<{ Params: { orgId: string } }>(\"/api/orgs/:orgId/context\", {\n    preHandler: requireOrgMembership,\n  }, async (request: AuthenticatedRequest, reply) => {\n    const context = rbac.getAuthContext(request.userId!, request.orgId!);\n\n    if (!context) {\n      reply.code(403);\n      return { ok: false, error: \"Not a member of this organization\" };\n    }\n\n    return {\n      ok: true,\n      context,\n    };\n  });\n\n  // =========================================================================\n  // STATS ENDPOINT (admin only)\n  // =========================================================================\n\n  /**\n   * GET /api/admin/rbac/stats - Get RBAC statistics\n   */\n  fastify.get(\"/api/admin/rbac/stats\", {\n    preHandler: requireAuth,\n  }, async () => {\n    // In production, check if user is system admin\n    const stats = rbac.getStats();\n\n    return {\n      ok: true,\n      stats,\n    };\n  });\n}\n","/**\n * Audit API Routes\n * Phase 9B: Enterprise Audit Logging\n */\n\nimport { FastifyInstance, FastifyRequest, FastifyReply } from \"fastify\";\nimport { z } from \"zod\";\nimport {\n  AuditLogger,\n  getAuditLogger,\n  AuditQuerySchema,\n  AuditExportOptionsSchema,\n  AuditCategory,\n  AuditAction,\n  AuditSeverity,\n} from \"../audit/index.js\";\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\ninterface AuthenticatedRequest extends FastifyRequest {\n  userId: string;\n  orgId: string;\n  userRole: string;\n}\n\n// ============================================================================\n// VALIDATION SCHEMAS\n// ============================================================================\n\nconst QueryParamsSchema = z.object({\n  category: z.string().optional(),\n  action: z.string().optional(),\n  severity: z.string().optional(),\n  result: z.string().optional(),\n  userId: z.string().optional(),\n  resourceType: z.string().optional(),\n  resourceId: z.string().optional(),\n  startDate: z.string().optional(),\n  endDate: z.string().optional(),\n  search: z.string().optional(),\n  limit: z.string().optional(),\n  offset: z.string().optional(),\n  sortBy: z.enum([\"timestamp\", \"severity\", \"category\"]).optional(),\n  sortOrder: z.enum([\"asc\", \"desc\"]).optional(),\n});\n\nconst ExportBodySchema = z.object({\n  format: z.enum([\"json\", \"csv\", \"pdf\"]),\n  startDate: z.string().optional(),\n  endDate: z.string().optional(),\n  category: z.string().optional(),\n  includeContext: z.boolean().optional(),\n  includeChanges: z.boolean().optional(),\n  includeMetadata: z.boolean().optional(),\n});\n\nconst RetentionPolicySchema = z.object({\n  category: z.string(),\n  retentionDays: z.number().min(1).max(3650),\n  archiveAfterDays: z.number().optional(),\n  deleteAfterArchive: z.boolean().optional(),\n});\n\n// ============================================================================\n// MIDDLEWARE\n// ============================================================================\n\nasync function requireAuditAccess(\n  request: FastifyRequest,\n  reply: FastifyReply\n): Promise<void> {\n  const req = request as AuthenticatedRequest;\n\n  if (!req.userId || !req.orgId) {\n    reply.code(401).send({ error: \"Unauthorized\" });\n    return;\n  }\n\n  // Only admins and owners can access audit logs\n  if (![\"admin\", \"owner\"].includes(req.userRole)) {\n    reply.code(403).send({\n      error: \"Forbidden\",\n      message: \"Audit access requires admin or owner role\",\n    });\n    return;\n  }\n}\n\n// ============================================================================\n// ROUTES\n// ============================================================================\n\nexport async function registerAuditRoutes(fastify: FastifyInstance): Promise<void> {\n  const auditLogger = getAuditLogger();\n\n  // --------------------------------------------------------------------------\n  // GET /api/audit - Query audit events\n  // --------------------------------------------------------------------------\n  fastify.get(\n    \"/api/audit\",\n    { preHandler: requireAuditAccess },\n    async (request: FastifyRequest, reply: FastifyReply) => {\n      const req = request as AuthenticatedRequest;\n\n      try {\n        const params = QueryParamsSchema.parse(request.query);\n\n        const query = {\n          orgId: req.orgId,\n          category: params.category as AuditCategory | undefined,\n          action: params.action as AuditAction | undefined,\n          severity: params.severity as AuditSeverity | undefined,\n          result: params.result as \"success\" | \"failure\" | \"partial\" | \"pending\" | undefined,\n          userId: params.userId,\n          resourceType: params.resourceType,\n          resourceId: params.resourceId,\n          startDate: params.startDate ? new Date(params.startDate) : undefined,\n          endDate: params.endDate ? new Date(params.endDate) : undefined,\n          search: params.search,\n          limit: params.limit ? parseInt(params.limit, 10) : 100,\n          offset: params.offset ? parseInt(params.offset, 10) : 0,\n          sortBy: params.sortBy || \"timestamp\",\n          sortOrder: params.sortOrder || \"desc\",\n        };\n\n        const result = await auditLogger.query(query);\n\n        // Log the access\n        await auditLogger.info(\n          \"audit\",\n          \"read\",\n          `Queried audit logs: ${result.total} events`,\n          { userId: req.userId, orgId: req.orgId }\n        );\n\n        reply.send(result);\n      } catch (error) {\n        if (error instanceof z.ZodError) {\n          reply.code(400).send({ error: \"Invalid query parameters\", details: error.errors });\n        } else {\n          throw error;\n        }\n      }\n    }\n  );\n\n  // --------------------------------------------------------------------------\n  // GET /api/audit/:id - Get single audit event\n  // --------------------------------------------------------------------------\n  fastify.get(\n    \"/api/audit/:id\",\n    { preHandler: requireAuditAccess },\n    async (request: FastifyRequest<{ Params: { id: string } }>, reply: FastifyReply) => {\n      const req = request as AuthenticatedRequest & { Params: { id: string } };\n\n      const event = await auditLogger.getEvent(req.params.id);\n\n      if (!event) {\n        reply.code(404).send({ error: \"Event not found\" });\n        return;\n      }\n\n      // Verify org access\n      if (event.context.orgId && event.context.orgId !== req.orgId) {\n        reply.code(403).send({ error: \"Forbidden\" });\n        return;\n      }\n\n      reply.send(event);\n    }\n  );\n\n  // --------------------------------------------------------------------------\n  // GET /api/audit/stats - Get audit statistics\n  // --------------------------------------------------------------------------\n  fastify.get(\n    \"/api/audit/stats\",\n    { preHandler: requireAuditAccess },\n    async (request: FastifyRequest, reply: FastifyReply) => {\n      const req = request as AuthenticatedRequest;\n      const { days } = request.query as { days?: string };\n\n      const stats = await auditLogger.getStats(\n        req.orgId,\n        days ? parseInt(days, 10) : 30\n      );\n\n      reply.send(stats);\n    }\n  );\n\n  // --------------------------------------------------------------------------\n  // GET /api/audit/security - Get security events\n  // --------------------------------------------------------------------------\n  fastify.get(\n    \"/api/audit/security\",\n    { preHandler: requireAuditAccess },\n    async (request: FastifyRequest, reply: FastifyReply) => {\n      const req = request as AuthenticatedRequest;\n      const { severity, limit } = request.query as { severity?: string; limit?: string };\n\n      const events = await auditLogger.getSecurityEvents(\n        req.orgId,\n        severity as AuditSeverity | undefined,\n        limit ? parseInt(limit, 10) : 100\n      );\n\n      reply.send({ events, count: events.length });\n    }\n  );\n\n  // --------------------------------------------------------------------------\n  // POST /api/audit/export - Export audit logs\n  // --------------------------------------------------------------------------\n  fastify.post(\n    \"/api/audit/export\",\n    { preHandler: requireAuditAccess },\n    async (request: FastifyRequest, reply: FastifyReply) => {\n      const req = request as AuthenticatedRequest;\n\n      try {\n        const body = ExportBodySchema.parse(request.body);\n\n        const options = {\n          format: body.format,\n          query: {\n            orgId: req.orgId,\n            startDate: body.startDate ? new Date(body.startDate) : undefined,\n            endDate: body.endDate ? new Date(body.endDate) : undefined,\n            category: body.category as AuditCategory | undefined,\n            limit: 10000, // Max export\n          },\n          includeContext: body.includeContext ?? true,\n          includeChanges: body.includeChanges ?? true,\n          includeMetadata: body.includeMetadata ?? false,\n        };\n\n        const output = await auditLogger.export(options);\n\n        // Log the export\n        await auditLogger.info(\n          \"audit\",\n          \"export\",\n          `Exported audit logs in ${body.format} format`,\n          { userId: req.userId, orgId: req.orgId }\n        );\n\n        // Set appropriate headers\n        const contentType = {\n          json: \"application/json\",\n          csv: \"text/csv\",\n          pdf: \"application/pdf\",\n        }[body.format];\n\n        const filename = `audit-export-${new Date().toISOString().split(\"T\")[0]}.${body.format}`;\n\n        reply\n          .header(\"Content-Type\", contentType)\n          .header(\"Content-Disposition\", `attachment; filename=\"${filename}\"`)\n          .send(output);\n      } catch (error) {\n        if (error instanceof z.ZodError) {\n          reply.code(400).send({ error: \"Invalid export options\", details: error.errors });\n        } else {\n          throw error;\n        }\n      }\n    }\n  );\n\n  // --------------------------------------------------------------------------\n  // GET /api/audit/retention - Get retention policies\n  // --------------------------------------------------------------------------\n  fastify.get(\n    \"/api/audit/retention\",\n    { preHandler: requireAuditAccess },\n    async (request: FastifyRequest, reply: FastifyReply) => {\n      const req = request as AuthenticatedRequest;\n\n      // Return default policies (in production, fetch from DB)\n      const policies = [\n        { category: \"auth\", retentionDays: 365 },\n        { category: \"organization\", retentionDays: 730 },\n        { category: \"member\", retentionDays: 365 },\n        { category: \"pipeline\", retentionDays: 90 },\n        { category: \"schedule\", retentionDays: 90 },\n        { category: \"budget\", retentionDays: 365 },\n        { category: \"webhook\", retentionDays: 90 },\n        { category: \"settings\", retentionDays: 365 },\n        { category: \"api\", retentionDays: 30 },\n        { category: \"security\", retentionDays: 730 },\n        { category: \"system\", retentionDays: 365 },\n      ];\n\n      reply.send({ policies });\n    }\n  );\n\n  // --------------------------------------------------------------------------\n  // PUT /api/audit/retention - Update retention policy\n  // --------------------------------------------------------------------------\n  fastify.put(\n    \"/api/audit/retention\",\n    { preHandler: requireAuditAccess },\n    async (request: FastifyRequest, reply: FastifyReply) => {\n      const req = request as AuthenticatedRequest;\n\n      try {\n        const policy = RetentionPolicySchema.parse(request.body);\n\n        // Log the change\n        await auditLogger.info(\n          \"settings\",\n          \"update\",\n          `Updated retention policy for ${policy.category}: ${policy.retentionDays} days`,\n          { userId: req.userId, orgId: req.orgId },\n          { type: \"retention_policy\", id: policy.category }\n        );\n\n        // In production, save to database\n        reply.send({ success: true, policy });\n      } catch (error) {\n        if (error instanceof z.ZodError) {\n          reply.code(400).send({ error: \"Invalid policy\", details: error.errors });\n        } else {\n          throw error;\n        }\n      }\n    }\n  );\n\n  // --------------------------------------------------------------------------\n  // POST /api/audit/verify - Verify audit chain integrity\n  // --------------------------------------------------------------------------\n  fastify.post(\n    \"/api/audit/verify\",\n    { preHandler: requireAuditAccess },\n    async (request: FastifyRequest, reply: FastifyReply) => {\n      const req = request as AuthenticatedRequest;\n\n      // Get events for this org\n      const result = await auditLogger.query({\n        orgId: req.orgId,\n        limit: 10000,\n        sortBy: \"timestamp\",\n        sortOrder: \"asc\",\n      });\n\n      const integrity = await auditLogger.verifyIntegrity(result.events);\n\n      // Log the verification\n      await auditLogger.info(\n        \"audit\",\n        \"read\",\n        `Verified audit chain integrity: ${integrity.valid ? \"valid\" : \"invalid\"}`,\n        { userId: req.userId, orgId: req.orgId }\n      );\n\n      reply.send({\n        totalEvents: result.total,\n        valid: integrity.valid,\n        invalidCount: integrity.invalidEvents.length,\n        invalidEvents: integrity.invalidEvents.slice(0, 10), // Return first 10\n      });\n    }\n  );\n\n  // --------------------------------------------------------------------------\n  // GET /api/audit/user/:userId - Get user activity\n  // --------------------------------------------------------------------------\n  fastify.get(\n    \"/api/audit/user/:userId\",\n    { preHandler: requireAuditAccess },\n    async (request: FastifyRequest<{ Params: { userId: string } }>, reply: FastifyReply) => {\n      const req = request as AuthenticatedRequest & { Params: { userId: string } };\n\n      const events = await auditLogger.getUserEvents(req.params.userId, 100);\n\n      // Filter to only include events from user's org\n      const orgEvents = events.filter(e => e.context.orgId === req.orgId);\n\n      reply.send({ events: orgEvents, count: orgEvents.length });\n    }\n  );\n\n  // --------------------------------------------------------------------------\n  // DELETE /api/audit/cleanup - Manually trigger cleanup\n  // --------------------------------------------------------------------------\n  fastify.delete(\n    \"/api/audit/cleanup\",\n    { preHandler: requireAuditAccess },\n    async (request: FastifyRequest, reply: FastifyReply) => {\n      const req = request as AuthenticatedRequest;\n\n      // Only owners can trigger cleanup\n      if (req.userRole !== \"owner\") {\n        reply.code(403).send({ error: \"Only owners can trigger audit cleanup\" });\n        return;\n      }\n\n      const result = await auditLogger.applyRetention();\n\n      // Log the cleanup\n      await auditLogger.info(\n        \"system\",\n        \"delete\",\n        `Manual audit cleanup: deleted ${result.deleted}, archived ${result.archived}`,\n        { userId: req.userId, orgId: req.orgId }\n      );\n\n      reply.send(result);\n    }\n  );\n}\n","/**\n * Git Integration API Routes\n *\n * REST API for managing Git repositories and pipeline-as-code sync\n */\n\nimport type { FastifyInstance, FastifyRequest, FastifyReply } from \"fastify\";\nimport {\n  GitManager,\n  getGitManager,\n  CreateRepoConfigSchema,\n  parsePipelineYAML,\n  validatePipelineYAML,\n  EXAMPLE_PIPELINES,\n  type CreateRepoConfig,\n  type GitProvider,\n} from \"../git/index.js\";\n\n// =============================================================================\n// ROUTE HANDLER\n// =============================================================================\n\nexport async function gitRoutes(fastify: FastifyInstance): Promise<void> {\n  const gitManager = getGitManager();\n\n  // ===========================================================================\n  // REPOSITORY MANAGEMENT\n  // ===========================================================================\n\n  /**\n   * GET /api/git/repos\n   * List all connected repositories\n   */\n  fastify.get(\"/api/git/repos\", async (_request, reply) => {\n    const repos = gitManager.listRepos();\n    return reply.send({\n      success: true,\n      data: repos,\n      count: repos.length,\n    });\n  });\n\n  /**\n   * GET /api/git/repos/:id\n   * Get repository by ID\n   */\n  fastify.get(\n    \"/api/git/repos/:id\",\n    async (\n      request: FastifyRequest<{ Params: { id: string } }>,\n      reply: FastifyReply\n    ) => {\n      const repo = gitManager.getRepo(request.params.id);\n      if (!repo) {\n        return reply.status(404).send({\n          success: false,\n          error: \"Repository not found\",\n        });\n      }\n      return reply.send({\n        success: true,\n        data: repo,\n      });\n    }\n  );\n\n  /**\n   * POST /api/git/repos\n   * Connect a new repository\n   */\n  fastify.post(\n    \"/api/git/repos\",\n    async (\n      request: FastifyRequest<{ Body: CreateRepoConfig }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const config = CreateRepoConfigSchema.parse(request.body);\n        const repo = await gitManager.connectRepo(config);\n        return reply.status(201).send({\n          success: true,\n          data: repo,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to connect repository\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * DELETE /api/git/repos/:id\n   * Disconnect a repository\n   */\n  fastify.delete(\n    \"/api/git/repos/:id\",\n    async (\n      request: FastifyRequest<{ Params: { id: string } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        await gitManager.disconnectRepo(request.params.id);\n        return reply.send({\n          success: true,\n          message: \"Repository disconnected\",\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to disconnect repository\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  // ===========================================================================\n  // SYNC OPERATIONS\n  // ===========================================================================\n\n  /**\n   * POST /api/git/repos/:id/pull\n   * Pull pipelines from repository\n   */\n  fastify.post(\n    \"/api/git/repos/:id/pull\",\n    async (\n      request: FastifyRequest<{ Params: { id: string } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const changes = await gitManager.pullPipelines(request.params.id);\n        return reply.send({\n          success: true,\n          data: {\n            changes,\n            count: changes.length,\n          },\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to pull pipelines\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * POST /api/git/repos/:id/push\n   * Push a pipeline to repository\n   */\n  fastify.post(\n    \"/api/git/repos/:id/push\",\n    async (\n      request: FastifyRequest<{\n        Params: { id: string };\n        Body: {\n          pipeline: {\n            id: string;\n            name: string;\n            description?: string;\n            schedule?: string;\n            steps: Array<{\n              id: string;\n              name: string;\n              toolId: string;\n              config?: Record<string, unknown>;\n              timeout?: number;\n              retries?: number;\n              condition?: string;\n              dependsOn?: string[];\n            }>;\n            metadata?: Record<string, unknown>;\n          };\n          commitMessage?: string;\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { pipeline, commitMessage } = request.body;\n        const record = await gitManager.pushPipeline(\n          request.params.id,\n          pipeline,\n          commitMessage\n        );\n        return reply.send({\n          success: true,\n          data: record,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to push pipeline\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * DELETE /api/git/repos/:repoId/pipelines/:pipelineId\n   * Delete a pipeline from repository\n   */\n  fastify.delete(\n    \"/api/git/repos/:repoId/pipelines/:pipelineId\",\n    async (\n      request: FastifyRequest<{\n        Params: { repoId: string; pipelineId: string };\n      }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        await gitManager.deletePipeline(\n          request.params.repoId,\n          request.params.pipelineId\n        );\n        return reply.send({\n          success: true,\n          message: \"Pipeline deleted from repository\",\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to delete pipeline\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  // ===========================================================================\n  // SYNC HISTORY\n  // ===========================================================================\n\n  /**\n   * GET /api/git/repos/:id/history\n   * Get sync history for repository\n   */\n  fastify.get(\n    \"/api/git/repos/:id/history\",\n    async (\n      request: FastifyRequest<{ Params: { id: string } }>,\n      reply: FastifyReply\n    ) => {\n      const history = gitManager.getSyncHistory(request.params.id);\n      return reply.send({\n        success: true,\n        data: history,\n        count: history.length,\n      });\n    }\n  );\n\n  /**\n   * GET /api/git/repos/:id/latest\n   * Get latest sync record for repository\n   */\n  fastify.get(\n    \"/api/git/repos/:id/latest\",\n    async (\n      request: FastifyRequest<{ Params: { id: string } }>,\n      reply: FastifyReply\n    ) => {\n      const latest = gitManager.getLatestSync(request.params.id);\n      if (!latest) {\n        return reply.status(404).send({\n          success: false,\n          error: \"No sync records found\",\n        });\n      }\n      return reply.send({\n        success: true,\n        data: latest,\n      });\n    }\n  );\n\n  // ===========================================================================\n  // WEBHOOKS\n  // ===========================================================================\n\n  /**\n   * POST /api/git/repos/:id/webhook\n   * Setup webhook for repository\n   */\n  fastify.post(\n    \"/api/git/repos/:id/webhook\",\n    async (\n      request: FastifyRequest<{\n        Params: { id: string };\n        Body: { webhookUrl: string };\n      }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { webhookUrl } = request.body;\n        const result = await gitManager.setupWebhook(\n          request.params.id,\n          webhookUrl\n        );\n        return reply.send({\n          success: true,\n          data: result,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to setup webhook\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * POST /api/git/webhook/:provider\n   * Receive webhook from Git provider\n   */\n  fastify.post(\n    \"/api/git/webhook/:provider\",\n    async (\n      request: FastifyRequest<{\n        Params: { provider: string };\n        Body: unknown;\n        Headers: { \"x-hub-signature-256\"?: string };\n      }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const provider = request.params.provider as GitProvider;\n        const signature = request.headers[\"x-hub-signature-256\"];\n\n        await gitManager.handleWebhook(provider, request.body, signature);\n\n        return reply.send({\n          success: true,\n          message: \"Webhook processed\",\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to process webhook\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  // ===========================================================================\n  // YAML UTILITIES\n  // ===========================================================================\n\n  /**\n   * POST /api/git/yaml/parse\n   * Parse YAML string to pipeline object\n   */\n  fastify.post(\n    \"/api/git/yaml/parse\",\n    async (\n      request: FastifyRequest<{ Body: { yaml: string } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { yaml } = request.body;\n        const result = parsePipelineYAML(yaml);\n        return reply.send({\n          success: result.success,\n          data: result.pipeline,\n          errors: result.errors,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to parse YAML\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * POST /api/git/yaml/validate\n   * Validate a pipeline YAML\n   */\n  fastify.post(\n    \"/api/git/yaml/validate\",\n    async (\n      request: FastifyRequest<{ Body: { yaml: string } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { yaml } = request.body;\n        const parseResult = parsePipelineYAML(yaml);\n\n        if (!parseResult.success || !parseResult.pipeline) {\n          return reply.send({\n            success: false,\n            valid: false,\n            errors: parseResult.errors?.map((e) => ({\n              path: \"yaml\",\n              message: e,\n              severity: \"error\" as const,\n            })),\n            warnings: [],\n          });\n        }\n\n        const validation = validatePipelineYAML(parseResult.pipeline);\n        return reply.send({\n          success: true,\n          valid: validation.valid,\n          errors: validation.errors,\n          warnings: validation.warnings,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to validate YAML\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * GET /api/git/yaml/examples\n   * Get example pipeline YAML templates\n   */\n  fastify.get(\"/api/git/yaml/examples\", async (_request, reply) => {\n    return reply.send({\n      success: true,\n      data: EXAMPLE_PIPELINES,\n    });\n  });\n\n  /**\n   * GET /api/git/yaml/examples/:name\n   * Get specific example pipeline\n   */\n  fastify.get(\n    \"/api/git/yaml/examples/:name\",\n    async (\n      request: FastifyRequest<{ Params: { name: string } }>,\n      reply: FastifyReply\n    ) => {\n      const name = request.params.name as keyof typeof EXAMPLE_PIPELINES;\n      const example = EXAMPLE_PIPELINES[name];\n\n      if (!example) {\n        return reply.status(404).send({\n          success: false,\n          error: `Example not found: ${name}. Available: ${Object.keys(EXAMPLE_PIPELINES).join(\", \")}`,\n        });\n      }\n\n      return reply.send({\n        success: true,\n        data: {\n          name,\n          yaml: example,\n        },\n      });\n    }\n  );\n}\n\nexport default gitRoutes;\n","/**\n * Bot API Routes\n *\n * REST API for Slack/Discord bot management and notifications\n */\n\nimport type { FastifyInstance, FastifyRequest, FastifyReply } from \"fastify\";\nimport {\n  getChatManager,\n  type ChatPlatform,\n  type SendMessageOptions,\n  type NotificationType,\n} from \"../chat/index.js\";\n\n// =============================================================================\n// ROUTE HANDLER\n// =============================================================================\n\nexport async function botRoutes(fastify: FastifyInstance): Promise<void> {\n  const chatManager = getChatManager();\n\n  // ===========================================================================\n  // BOT STATUS\n  // ===========================================================================\n\n  /**\n   * GET /api/bots/status\n   * Get status of all connected bots\n   */\n  fastify.get(\"/api/bots/status\", async (_request, reply) => {\n    const status = chatManager.getConnectionStatus();\n    const bots = chatManager.getBots();\n\n    return reply.send({\n      success: true,\n      data: {\n        connections: Object.fromEntries(status),\n        bots: bots.map((b) => ({\n          id: b.id,\n          name: b.name,\n          platform: b.platform,\n          enabled: b.enabled,\n        })),\n      },\n    });\n  });\n\n  /**\n   * GET /api/bots/:platform/status\n   * Get status of a specific platform\n   */\n  fastify.get(\n    \"/api/bots/:platform/status\",\n    async (\n      request: FastifyRequest<{ Params: { platform: string } }>,\n      reply: FastifyReply\n    ) => {\n      const platform = request.params.platform as ChatPlatform;\n      const status = chatManager.getConnectionStatus().get(platform);\n\n      return reply.send({\n        success: true,\n        data: {\n          platform,\n          status: status || \"disconnected\",\n        },\n      });\n    }\n  );\n\n  // ===========================================================================\n  // BOT CONNECTION\n  // ===========================================================================\n\n  /**\n   * POST /api/bots/connect\n   * Connect a bot to a platform\n   */\n  fastify.post(\n    \"/api/bots/connect\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          platform: ChatPlatform;\n          credentials: Record<string, unknown>;\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { platform, credentials } = request.body;\n\n        const bot = await chatManager.connectBot({\n          platform,\n          ...credentials,\n        } as any);\n\n        return reply.status(201).send({\n          success: true,\n          data: {\n            id: bot.id,\n            name: bot.name,\n            platform: bot.platform,\n          },\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to connect bot\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * POST /api/bots/:id/disconnect\n   * Disconnect a bot\n   */\n  fastify.post(\n    \"/api/bots/:id/disconnect\",\n    async (\n      request: FastifyRequest<{ Params: { id: string } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        await chatManager.disconnectBot(request.params.id);\n        return reply.send({\n          success: true,\n          message: \"Bot disconnected\",\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to disconnect bot\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  // ===========================================================================\n  // MESSAGING\n  // ===========================================================================\n\n  /**\n   * POST /api/bots/send\n   * Send a message to a channel\n   */\n  fastify.post(\n    \"/api/bots/send\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          platform: ChatPlatform;\n          channelId: string;\n          message: string;\n          blocks?: unknown[];\n          attachments?: Array<{ url: string; type: string }>;\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { platform, channelId, message, blocks, attachments } = request.body;\n\n        const options: SendMessageOptions = {\n          platform,\n          channelId,\n          content: message,\n          blocks,\n          attachments,\n        };\n\n        await chatManager.sendMessage(options);\n\n        return reply.send({\n          success: true,\n          message: \"Message sent\",\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to send message\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * POST /api/bots/broadcast\n   * Send a notification to all subscribed channels\n   */\n  fastify.post(\n    \"/api/bots/broadcast\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          type: NotificationType;\n          data: Record<string, unknown>;\n          severity?: \"info\" | \"warning\" | \"error\" | \"critical\";\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { type, data, severity } = request.body;\n\n        await chatManager.sendNotification(type, data);\n\n        return reply.send({\n          success: true,\n          message: \"Notification broadcast sent\",\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to broadcast\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  // ===========================================================================\n  // SUBSCRIPTIONS\n  // ===========================================================================\n\n  /**\n   * GET /api/bots/subscriptions\n   * List all channel subscriptions\n   */\n  fastify.get(\"/api/bots/subscriptions\", async (_request, reply) => {\n    const subscriptions = chatManager.getNotificationConfigs();\n\n    return reply.send({\n      success: true,\n      data: subscriptions,\n      count: subscriptions.length,\n    });\n  });\n\n  /**\n   * POST /api/bots/subscriptions\n   * Subscribe a channel to notifications\n   */\n  fastify.post(\n    \"/api/bots/subscriptions\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          platform: ChatPlatform;\n          channelId: string;\n          types: NotificationType[];\n          minSeverity?: \"info\" | \"warning\" | \"error\" | \"critical\";\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { platform, channelId, types, minSeverity } = request.body;\n\n        chatManager.configureNotifications({\n          platform,\n          channelId,\n          types,\n          minSeverity: minSeverity || \"info\",\n          enabled: true,\n        });\n\n        return reply.status(201).send({\n          success: true,\n          message: \"Channel subscribed\",\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to subscribe\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * DELETE /api/bots/subscriptions/:platform/:channelId\n   * Unsubscribe a channel\n   */\n  fastify.delete(\n    \"/api/bots/subscriptions/:platform/:channelId\",\n    async (\n      request: FastifyRequest<{\n        Params: { platform: string; channelId: string };\n      }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        // Remove notification config for this channel\n        chatManager.configureNotifications({\n          platform: request.params.platform as ChatPlatform,\n          channelId: request.params.channelId,\n          types: [],\n          enabled: false,\n        });\n\n        return reply.send({\n          success: true,\n          message: \"Channel unsubscribed\",\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to unsubscribe\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  // ===========================================================================\n  // COMMANDS\n  // ===========================================================================\n\n  /**\n   * GET /api/bots/commands\n   * List registered slash commands\n   */\n  fastify.get(\"/api/bots/commands\", async (_request, reply) => {\n    const commands = chatManager.getRegisteredCommands();\n\n    return reply.send({\n      success: true,\n      data: commands,\n      count: commands.length,\n    });\n  });\n\n  // ===========================================================================\n  // WEBHOOKS (for receiving platform events)\n  // ===========================================================================\n\n  /**\n   * POST /api/bots/webhook/slack\n   * Handle incoming Slack events\n   */\n  fastify.post(\n    \"/api/bots/webhook/slack\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          type: string;\n          challenge?: string;\n          event?: unknown;\n          command?: string;\n          text?: string;\n          user_id?: string;\n          channel_id?: string;\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      const { type, challenge, event, command, text, user_id, channel_id } = request.body;\n\n      // URL verification challenge\n      if (type === \"url_verification\" && challenge) {\n        return reply.send({ challenge });\n      }\n\n      // Slash command\n      if (command) {\n        await chatManager.handleCommand({\n          platform: \"slack\",\n          command: command.replace(\"/\", \"\"),\n          args: text || \"\",\n          userId: user_id || \"\",\n          channelId: channel_id || \"\",\n          timestamp: new Date().toISOString(),\n        });\n\n        return reply.send({ ok: true });\n      }\n\n      // Event callback\n      if (type === \"event_callback\" && event) {\n        // Handle different event types\n        console.log(\"[SLACK WEBHOOK] Event received:\", event);\n      }\n\n      return reply.send({ ok: true });\n    }\n  );\n\n  /**\n   * POST /api/bots/webhook/discord\n   * Handle incoming Discord interactions\n   */\n  fastify.post(\n    \"/api/bots/webhook/discord\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          type: number;\n          data?: {\n            name?: string;\n            options?: Array<{ name: string; value: unknown }>;\n          };\n          member?: { user: { id: string } };\n          channel_id?: string;\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      const { type, data, member, channel_id } = request.body;\n\n      // Ping (type 1)\n      if (type === 1) {\n        return reply.send({ type: 1 });\n      }\n\n      // Slash command (type 2)\n      if (type === 2 && data?.name) {\n        const args = data.options?.map((o) => `${o.name}=${o.value}`).join(\" \") || \"\";\n\n        await chatManager.handleCommand({\n          platform: \"discord\",\n          command: data.name,\n          args,\n          userId: member?.user?.id || \"\",\n          channelId: channel_id || \"\",\n          timestamp: new Date().toISOString(),\n        });\n\n        return reply.send({\n          type: 4, // CHANNEL_MESSAGE_WITH_SOURCE\n          data: { content: \"Command received\" },\n        });\n      }\n\n      // Button interaction (type 3)\n      if (type === 3) {\n        console.log(\"[DISCORD WEBHOOK] Button interaction:\", data);\n        return reply.send({\n          type: 6, // DEFERRED_UPDATE_MESSAGE\n        });\n      }\n\n      return reply.send({ type: 1 });\n    }\n  );\n\n  // ===========================================================================\n  // TEMPLATES\n  // ===========================================================================\n\n  /**\n   * GET /api/bots/templates\n   * List notification templates\n   */\n  fastify.get(\"/api/bots/templates\", async (_request, reply) => {\n    const templates = chatManager.getTemplates();\n\n    return reply.send({\n      success: true,\n      data: templates,\n      count: templates.length,\n    });\n  });\n}\n\nexport default botRoutes;\n","/**\n * Terraform API Routes\n *\n * REST API for Infrastructure-as-Code operations\n */\n\nimport type { FastifyInstance, FastifyRequest, FastifyReply } from \"fastify\";\nimport {\n  getTerraformManager,\n  type HCLConfig,\n} from \"../terraform/index.js\";\n\n// =============================================================================\n// ROUTE HANDLER\n// =============================================================================\n\nexport async function terraformRoutes(fastify: FastifyInstance): Promise<void> {\n  const terraformManager = getTerraformManager();\n\n  // ===========================================================================\n  // STATE\n  // ===========================================================================\n\n  /**\n   * GET /api/terraform/state\n   * Get current Terraform state\n   */\n  fastify.get(\"/api/terraform/state\", async (_request, reply) => {\n    const state = terraformManager.getState();\n    return reply.send({\n      success: true,\n      data: state,\n    });\n  });\n\n  /**\n   * POST /api/terraform/state/lock\n   * Lock the state for exclusive access\n   */\n  fastify.post(\n    \"/api/terraform/state/lock\",\n    async (\n      request: FastifyRequest<{ Body: { lockId: string; reason?: string } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { lockId, reason } = request.body;\n        await terraformManager.lockState(lockId, reason);\n        return reply.send({\n          success: true,\n          message: \"State locked\",\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to lock state\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * POST /api/terraform/state/unlock\n   * Unlock the state\n   */\n  fastify.post(\n    \"/api/terraform/state/unlock\",\n    async (\n      request: FastifyRequest<{ Body: { lockId: string } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { lockId } = request.body;\n        await terraformManager.unlockState(lockId);\n        return reply.send({\n          success: true,\n          message: \"State unlocked\",\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to unlock state\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  // ===========================================================================\n  // PLAN & APPLY\n  // ===========================================================================\n\n  /**\n   * POST /api/terraform/plan\n   * Generate a plan from HCL configuration\n   */\n  fastify.post(\n    \"/api/terraform/plan\",\n    async (\n      request: FastifyRequest<{ Body: { config: HCLConfig } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { config } = request.body;\n        const plan = await terraformManager.plan(config);\n        return reply.send({\n          success: true,\n          data: plan,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to generate plan\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * POST /api/terraform/apply\n   * Apply a plan\n   */\n  fastify.post(\n    \"/api/terraform/apply\",\n    async (\n      request: FastifyRequest<{ Body: { config: HCLConfig; autoApprove?: boolean } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { config, autoApprove } = request.body;\n        const result = await terraformManager.apply(config, autoApprove);\n        return reply.send({\n          success: true,\n          data: result,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to apply changes\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * POST /api/terraform/destroy\n   * Destroy resources\n   */\n  fastify.post(\n    \"/api/terraform/destroy\",\n    async (\n      request: FastifyRequest<{\n        Body: { resourceAddresses?: string[]; autoApprove?: boolean };\n      }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { resourceAddresses, autoApprove } = request.body;\n        const result = await terraformManager.destroy(resourceAddresses, autoApprove);\n        return reply.send({\n          success: true,\n          data: result,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to destroy resources\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  // ===========================================================================\n  // RESOURCES\n  // ===========================================================================\n\n  /**\n   * GET /api/terraform/resources\n   * List all managed resources\n   */\n  fastify.get(\"/api/terraform/resources\", async (_request, reply) => {\n    const state = terraformManager.getState();\n    return reply.send({\n      success: true,\n      data: state.resources,\n      count: state.resources.length,\n    });\n  });\n\n  /**\n   * GET /api/terraform/resources/:address\n   * Get a specific resource\n   */\n  fastify.get(\n    \"/api/terraform/resources/:address\",\n    async (\n      request: FastifyRequest<{ Params: { address: string } }>,\n      reply: FastifyReply\n    ) => {\n      const state = terraformManager.getState();\n      const resource = state.resources.find(\n        (r) => `${r.type}.${r.name}` === request.params.address\n      );\n\n      if (!resource) {\n        return reply.status(404).send({\n          success: false,\n          error: \"Resource not found\",\n        });\n      }\n\n      return reply.send({\n        success: true,\n        data: resource,\n      });\n    }\n  );\n\n  /**\n   * POST /api/terraform/import\n   * Import an existing resource into state\n   */\n  fastify.post(\n    \"/api/terraform/import\",\n    async (\n      request: FastifyRequest<{\n        Body: { type: string; id: string; address: string };\n      }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { type, id, address } = request.body;\n        await terraformManager.importResource(type as any, id, address);\n        return reply.send({\n          success: true,\n          message: \"Resource imported\",\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to import resource\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * POST /api/terraform/resources/:address/taint\n   * Mark a resource as tainted (will be recreated on next apply)\n   */\n  fastify.post(\n    \"/api/terraform/resources/:address/taint\",\n    async (\n      request: FastifyRequest<{ Params: { address: string } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        await terraformManager.taintResource(request.params.address);\n        return reply.send({\n          success: true,\n          message: \"Resource tainted\",\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to taint resource\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * POST /api/terraform/resources/:address/untaint\n   * Remove taint from a resource\n   */\n  fastify.post(\n    \"/api/terraform/resources/:address/untaint\",\n    async (\n      request: FastifyRequest<{ Params: { address: string } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        await terraformManager.untaintResource(request.params.address);\n        return reply.send({\n          success: true,\n          message: \"Resource untainted\",\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to untaint resource\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  // ===========================================================================\n  // HCL GENERATION\n  // ===========================================================================\n\n  /**\n   * POST /api/terraform/generate/pipeline\n   * Generate HCL for a pipeline\n   */\n  fastify.post(\n    \"/api/terraform/generate/pipeline\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          name: string;\n          displayName: string;\n          description?: string;\n          steps: Array<{\n            id: string;\n            name: string;\n            tool: string;\n            config?: Record<string, unknown>;\n            dependsOn?: string[];\n          }>;\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      const { name, displayName, description, steps } = request.body;\n\n      const hcl = generatePipelineHCL(name, displayName, description, steps);\n\n      return reply.send({\n        success: true,\n        data: { hcl },\n      });\n    }\n  );\n\n  /**\n   * POST /api/terraform/generate/schedule\n   * Generate HCL for a schedule\n   */\n  fastify.post(\n    \"/api/terraform/generate/schedule\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          name: string;\n          displayName: string;\n          pipelineRef: string;\n          cron: string;\n          timezone?: string;\n          inputs?: Record<string, unknown>;\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      const { name, displayName, pipelineRef, cron, timezone, inputs } = request.body;\n\n      const hcl = generateScheduleHCL(name, displayName, pipelineRef, cron, timezone, inputs);\n\n      return reply.send({\n        success: true,\n        data: { hcl },\n      });\n    }\n  );\n\n  /**\n   * GET /api/terraform/schema\n   * Get JSON schema for all resource types\n   */\n  fastify.get(\"/api/terraform/schema\", async (_request, reply) => {\n    return reply.send({\n      success: true,\n      data: {\n        provider: {\n          api_url: { type: \"string\", required: true },\n          api_key: { type: \"string\", required: true, sensitive: true },\n          organization_id: { type: \"string\", required: false },\n        },\n        resources: {\n          gicm_pipeline: {\n            name: { type: \"string\", required: true },\n            description: { type: \"string\" },\n            enabled: { type: \"bool\", default: true },\n            steps: { type: \"list\", required: true },\n            tags: { type: \"map(string)\" },\n          },\n          gicm_schedule: {\n            name: { type: \"string\", required: true },\n            pipeline_id: { type: \"string\", required: true },\n            cron: { type: \"string\", required: true },\n            timezone: { type: \"string\", default: \"UTC\" },\n            enabled: { type: \"bool\", default: true },\n            inputs: { type: \"map(any)\" },\n          },\n          gicm_webhook: {\n            name: { type: \"string\", required: true },\n            url: { type: \"string\", required: true },\n            events: { type: \"list(string)\", required: true },\n            enabled: { type: \"bool\", default: true },\n            retry_count: { type: \"number\", default: 3 },\n            timeout_ms: { type: \"number\", default: 5000 },\n          },\n          gicm_budget: {\n            name: { type: \"string\", required: true },\n            daily_limit: { type: \"number\" },\n            weekly_limit: { type: \"number\" },\n            monthly_limit: { type: \"number\" },\n            scope_type: { type: \"string\", default: \"global\" },\n            enabled: { type: \"bool\", default: true },\n            enforce: { type: \"bool\", default: false },\n            alert_thresholds: { type: \"list(number)\", default: [50, 75, 90, 100] },\n          },\n        },\n      },\n    });\n  });\n}\n\n// =============================================================================\n// HCL GENERATORS\n// =============================================================================\n\nfunction generatePipelineHCL(\n  name: string,\n  displayName: string,\n  description: string | undefined,\n  steps: Array<{\n    id: string;\n    name: string;\n    tool: string;\n    config?: Record<string, unknown>;\n    dependsOn?: string[];\n  }>\n): string {\n  const lines: string[] = [];\n  lines.push(`resource \"gicm_pipeline\" \"${name}\" {`);\n  lines.push(`  name        = \"${displayName}\"`);\n  if (description) {\n    lines.push(`  description = \"${description}\"`);\n  }\n  lines.push(`  enabled     = true`);\n  lines.push(\"\");\n\n  for (const step of steps) {\n    lines.push(`  step {`);\n    lines.push(`    id   = \"${step.id}\"`);\n    lines.push(`    name = \"${step.name}\"`);\n    lines.push(`    tool = \"${step.tool}\"`);\n    if (step.config && Object.keys(step.config).length > 0) {\n      lines.push(`    config = {`);\n      for (const [key, value] of Object.entries(step.config)) {\n        const formattedValue = typeof value === \"string\" ? `\"${value}\"` : JSON.stringify(value);\n        lines.push(`      ${key} = ${formattedValue}`);\n      }\n      lines.push(`    }`);\n    }\n    if (step.dependsOn && step.dependsOn.length > 0) {\n      lines.push(`    depends_on = [\"${step.dependsOn.join('\", \"')}\"]`);\n    }\n    lines.push(`  }`);\n    lines.push(\"\");\n  }\n\n  lines.push(`}`);\n  return lines.join(\"\\n\");\n}\n\nfunction generateScheduleHCL(\n  name: string,\n  displayName: string,\n  pipelineRef: string,\n  cron: string,\n  timezone?: string,\n  inputs?: Record<string, unknown>\n): string {\n  const lines: string[] = [];\n  lines.push(`resource \"gicm_schedule\" \"${name}\" {`);\n  lines.push(`  name        = \"${displayName}\"`);\n  lines.push(`  pipeline_id = ${pipelineRef}`);\n  lines.push(`  cron        = \"${cron}\"`);\n  lines.push(`  timezone    = \"${timezone || \"UTC\"}\"`);\n  lines.push(`  enabled     = true`);\n\n  if (inputs && Object.keys(inputs).length > 0) {\n    lines.push(\"\");\n    lines.push(`  inputs = {`);\n    for (const [key, value] of Object.entries(inputs)) {\n      const formattedValue = typeof value === \"string\" ? `\"${value}\"` : JSON.stringify(value);\n      lines.push(`    ${key} = ${formattedValue}`);\n    }\n    lines.push(`  }`);\n  }\n\n  lines.push(`}`);\n  return lines.join(\"\\n\");\n}\n\nexport default terraformRoutes;\n","/**\n * VS Code Extension API Routes\n *\n * REST API for VS Code extension communication\n */\n\nimport type { FastifyInstance, FastifyRequest, FastifyReply } from \"fastify\";\nimport {\n  getVSCodeManager,\n  type TreeItem,\n  type CompletionItem,\n  type CodeAction,\n  type Diagnostic,\n  PIPELINE_SNIPPETS,\n} from \"../vscode/index.js\";\n\n// =============================================================================\n// ROUTE HANDLER\n// =============================================================================\n\nexport async function vscodeRoutes(fastify: FastifyInstance): Promise<void> {\n  const vscodeManager = getVSCodeManager();\n\n  // ===========================================================================\n  // STATE & CONFIG\n  // ===========================================================================\n\n  /**\n   * GET /api/vscode/state\n   * Get extension state\n   */\n  fastify.get(\"/api/vscode/state\", async (_request, reply) => {\n    const state = vscodeManager.getState();\n    return reply.send({\n      success: true,\n      data: state,\n    });\n  });\n\n  /**\n   * POST /api/vscode/connect\n   * Register VS Code extension connection\n   */\n  fastify.post(\n    \"/api/vscode/connect\",\n    async (\n      request: FastifyRequest<{\n        Body: { extensionId: string; version: string; machineId?: string };\n      }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { extensionId, version, machineId } = request.body;\n        await vscodeManager.connect(extensionId, version, machineId);\n        return reply.send({\n          success: true,\n          message: \"Extension connected\",\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to connect\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * POST /api/vscode/disconnect\n   * Disconnect VS Code extension\n   */\n  fastify.post(\"/api/vscode/disconnect\", async (_request, reply) => {\n    await vscodeManager.disconnect();\n    return reply.send({\n      success: true,\n      message: \"Extension disconnected\",\n    });\n  });\n\n  // ===========================================================================\n  // TREE VIEW\n  // ===========================================================================\n\n  /**\n   * GET /api/vscode/tree/pipelines\n   * Get pipeline tree items\n   */\n  fastify.get(\"/api/vscode/tree/pipelines\", async (_request, reply) => {\n    const items = await vscodeManager.getPipelineTreeItems();\n    return reply.send({\n      success: true,\n      data: items,\n      count: items.length,\n    });\n  });\n\n  /**\n   * GET /api/vscode/tree/schedules\n   * Get schedule tree items\n   */\n  fastify.get(\"/api/vscode/tree/schedules\", async (_request, reply) => {\n    const items = await vscodeManager.getScheduleTreeItems();\n    return reply.send({\n      success: true,\n      data: items,\n      count: items.length,\n    });\n  });\n\n  /**\n   * GET /api/vscode/tree/executions\n   * Get recent execution tree items\n   */\n  fastify.get(\n    \"/api/vscode/tree/executions\",\n    async (\n      request: FastifyRequest<{ Querystring: { limit?: string } }>,\n      reply: FastifyReply\n    ) => {\n      const limit = parseInt(request.query.limit || \"20\", 10);\n      const items = await vscodeManager.getExecutionTreeItems(limit);\n      return reply.send({\n        success: true,\n        data: items,\n        count: items.length,\n      });\n    }\n  );\n\n  // ===========================================================================\n  // INTELLISENSE\n  // ===========================================================================\n\n  /**\n   * POST /api/vscode/completions\n   * Get completion items for position\n   */\n  fastify.post(\n    \"/api/vscode/completions\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          document: string;\n          position: { line: number; character: number };\n          triggerCharacter?: string;\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      const { document, position, triggerCharacter } = request.body;\n      const completions = await vscodeManager.getCompletions(\n        document,\n        position,\n        triggerCharacter\n      );\n      return reply.send({\n        success: true,\n        data: completions,\n      });\n    }\n  );\n\n  /**\n   * POST /api/vscode/hover\n   * Get hover information for position\n   */\n  fastify.post(\n    \"/api/vscode/hover\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          document: string;\n          position: { line: number; character: number };\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      const { document, position } = request.body;\n      const hover = await vscodeManager.getHoverInfo(document, position);\n      return reply.send({\n        success: true,\n        data: hover,\n      });\n    }\n  );\n\n  /**\n   * POST /api/vscode/diagnostics\n   * Get diagnostics for document\n   */\n  fastify.post(\n    \"/api/vscode/diagnostics\",\n    async (\n      request: FastifyRequest<{ Body: { document: string; uri: string } }>,\n      reply: FastifyReply\n    ) => {\n      const { document, uri } = request.body;\n      const diagnostics = await vscodeManager.getDiagnostics(document, uri);\n      return reply.send({\n        success: true,\n        data: diagnostics,\n        count: diagnostics.length,\n      });\n    }\n  );\n\n  /**\n   * POST /api/vscode/codeactions\n   * Get code actions for range\n   */\n  fastify.post(\n    \"/api/vscode/codeactions\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          document: string;\n          range: {\n            start: { line: number; character: number };\n            end: { line: number; character: number };\n          };\n          diagnostics?: Diagnostic[];\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      const { document, range, diagnostics } = request.body;\n      const actions = await vscodeManager.getCodeActions(document, range, diagnostics);\n      return reply.send({\n        success: true,\n        data: actions,\n      });\n    }\n  );\n\n  // ===========================================================================\n  // COMMANDS\n  // ===========================================================================\n\n  /**\n   * GET /api/vscode/commands\n   * List available commands\n   */\n  fastify.get(\"/api/vscode/commands\", async (_request, reply) => {\n    const commands = vscodeManager.getCommands();\n    return reply.send({\n      success: true,\n      data: commands,\n      count: commands.length,\n    });\n  });\n\n  /**\n   * POST /api/vscode/commands/:command\n   * Execute a command\n   */\n  fastify.post(\n    \"/api/vscode/commands/:command\",\n    async (\n      request: FastifyRequest<{\n        Params: { command: string };\n        Body: { args?: unknown[] };\n      }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { command } = request.params;\n        const { args } = request.body;\n        const result = await vscodeManager.executeCommand(command, args);\n        return reply.send({\n          success: true,\n          data: result,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Command failed\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  // ===========================================================================\n  // SNIPPETS\n  // ===========================================================================\n\n  /**\n   * GET /api/vscode/snippets\n   * Get available snippets\n   */\n  fastify.get(\"/api/vscode/snippets\", async (_request, reply) => {\n    return reply.send({\n      success: true,\n      data: PIPELINE_SNIPPETS,\n    });\n  });\n\n  // ===========================================================================\n  // NOTIFICATIONS\n  // ===========================================================================\n\n  /**\n   * POST /api/vscode/notify\n   * Send notification to VS Code\n   */\n  fastify.post(\n    \"/api/vscode/notify\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          type: \"info\" | \"warning\" | \"error\";\n          message: string;\n          actions?: Array<{ title: string; command?: string }>;\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { type, message, actions } = request.body;\n        await vscodeManager.sendNotification({\n          id: `notif_${Date.now()}`,\n          type,\n          message,\n          actions: actions?.map((a) => ({\n            label: a.title,\n            command: a.command,\n          })),\n          timestamp: new Date().toISOString(),\n        });\n        return reply.send({\n          success: true,\n          message: \"Notification sent\",\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to send notification\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  // ===========================================================================\n  // WEBVIEW\n  // ===========================================================================\n\n  /**\n   * POST /api/vscode/webview/message\n   * Handle webview message\n   */\n  fastify.post(\n    \"/api/vscode/webview/message\",\n    async (\n      request: FastifyRequest<{\n        Body: { type: string; command: string; data?: unknown };\n      }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { type, command, data } = request.body;\n        const response = await vscodeManager.handleWebviewMessage({\n          type: type as any,\n          command,\n          data,\n        });\n        return reply.send({\n          success: true,\n          data: response,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to handle message\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * GET /api/vscode/webview/state/:type\n   * Get webview state\n   */\n  fastify.get(\n    \"/api/vscode/webview/state/:type\",\n    async (\n      request: FastifyRequest<{ Params: { type: string } }>,\n      reply: FastifyReply\n    ) => {\n      const state = await vscodeManager.getWebviewState(request.params.type as any);\n      return reply.send({\n        success: true,\n        data: state,\n      });\n    }\n  );\n\n  // ===========================================================================\n  // WORKSPACE\n  // ===========================================================================\n\n  /**\n   * POST /api/vscode/workspace/scan\n   * Scan workspace for pipeline files\n   */\n  fastify.post(\n    \"/api/vscode/workspace/scan\",\n    async (\n      request: FastifyRequest<{ Body: { rootPath: string } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { rootPath } = request.body;\n        const files = await vscodeManager.scanWorkspace(rootPath);\n        return reply.send({\n          success: true,\n          data: files,\n          count: files.length,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to scan workspace\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * POST /api/vscode/workspace/validate\n   * Validate a pipeline file\n   */\n  fastify.post(\n    \"/api/vscode/workspace/validate\",\n    async (\n      request: FastifyRequest<{ Body: { content: string; filePath: string } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const { content, filePath } = request.body;\n        const result = await vscodeManager.validatePipelineFile(content, filePath);\n        return reply.send({\n          success: true,\n          data: result,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Validation failed\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n}\n\nexport default vscodeRoutes;\n","/**\n * High Availability API Routes\n * Phase 12A: Multi-Region Management\n */\n\nimport type { FastifyInstance, FastifyRequest, FastifyReply } from \"fastify\";\nimport {\n  getHAManager,\n  createHAManager,\n  DEFAULT_HA_CONFIG,\n  type Region,\n  type RegionConfig,\n  type HAManagerConfig,\n} from \"../ha/index.js\";\n\n// =============================================================================\n// ROUTE HANDLER\n// =============================================================================\n\nexport async function haRoutes(fastify: FastifyInstance): Promise<void> {\n  // Initialize HA Manager if not already initialized\n  let haManager = getHAManager();\n  if (!haManager) {\n    haManager = createHAManager(DEFAULT_HA_CONFIG);\n  }\n\n  // ===========================================================================\n  // STATE & STATUS\n  // ===========================================================================\n\n  /**\n   * GET /api/ha/status\n   * Get overall HA status\n   */\n  fastify.get(\"/api/ha/status\", async (_request, reply) => {\n    const state = haManager!.getState();\n    return reply.send({\n      success: true,\n      data: {\n        started: haManager!.isStarted(),\n        primaryRegion: state.primaryRegion,\n        activeRegions: state.activeRegions,\n        globalLatencyMs: state.globalLatencyMs,\n        globalAvailability: state.globalAvailability,\n        failoverCount24h: state.failoverCount24h,\n        lastUpdated: state.lastUpdated,\n      },\n    });\n  });\n\n  /**\n   * GET /api/ha/state\n   * Get full HA state\n   */\n  fastify.get(\"/api/ha/state\", async (_request, reply) => {\n    const state = haManager!.getState();\n    return reply.send({\n      success: true,\n      data: state,\n    });\n  });\n\n  /**\n   * POST /api/ha/start\n   * Start HA monitoring\n   */\n  fastify.post(\"/api/ha/start\", async (_request, reply) => {\n    haManager!.start();\n    return reply.send({\n      success: true,\n      message: \"HA Manager started\",\n    });\n  });\n\n  /**\n   * POST /api/ha/stop\n   * Stop HA monitoring\n   */\n  fastify.post(\"/api/ha/stop\", async (_request, reply) => {\n    haManager!.stop();\n    return reply.send({\n      success: true,\n      message: \"HA Manager stopped\",\n    });\n  });\n\n  // ===========================================================================\n  // REGION MANAGEMENT\n  // ===========================================================================\n\n  /**\n   * GET /api/ha/regions\n   * List all configured regions\n   */\n  fastify.get(\"/api/ha/regions\", async (_request, reply) => {\n    const config = haManager!.getConfig();\n    return reply.send({\n      success: true,\n      data: config.regions,\n      count: config.regions.length,\n    });\n  });\n\n  /**\n   * GET /api/ha/regions/:region\n   * Get specific region details\n   */\n  fastify.get(\n    \"/api/ha/regions/:region\",\n    async (\n      request: FastifyRequest<{ Params: { region: string } }>,\n      reply: FastifyReply\n    ) => {\n      const config = haManager!.getConfig();\n      const region = config.regions.find(r => r.region === request.params.region);\n\n      if (!region) {\n        return reply.status(404).send({\n          success: false,\n          error: \"Region not found\",\n        });\n      }\n\n      const state = haManager!.getState();\n      const health = state.regionHealth[request.params.region as Region];\n\n      return reply.send({\n        success: true,\n        data: {\n          ...region,\n          health,\n        },\n      });\n    }\n  );\n\n  /**\n   * POST /api/ha/regions\n   * Add a new region\n   */\n  fastify.post(\n    \"/api/ha/regions\",\n    async (\n      request: FastifyRequest<{ Body: RegionConfig }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        haManager!.addRegion(request.body);\n        return reply.send({\n          success: true,\n          message: \"Region added\",\n          data: request.body,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to add region\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * DELETE /api/ha/regions/:region\n   * Remove a region\n   */\n  fastify.delete(\n    \"/api/ha/regions/:region\",\n    async (\n      request: FastifyRequest<{ Params: { region: string } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        haManager!.removeRegion(request.params.region as Region);\n        return reply.send({\n          success: true,\n          message: \"Region removed\",\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to remove region\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  // ===========================================================================\n  // HEALTH CHECKS\n  // ===========================================================================\n\n  /**\n   * GET /api/ha/health\n   * Get all region health results\n   */\n  fastify.get(\"/api/ha/health\", async (_request, reply) => {\n    const state = haManager!.getState();\n    return reply.send({\n      success: true,\n      data: state.regionHealth,\n    });\n  });\n\n  /**\n   * POST /api/ha/health/check\n   * Trigger immediate health check\n   */\n  fastify.post(\"/api/ha/health/check\", async (_request, reply) => {\n    try {\n      const healthChecker = haManager!.getHealthChecker();\n      const results = await healthChecker.checkAllRegions();\n      return reply.send({\n        success: true,\n        data: results,\n      });\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"Health check failed\";\n      return reply.status(500).send({\n        success: false,\n        error: message,\n      });\n    }\n  });\n\n  /**\n   * POST /api/ha/health/check/:region\n   * Check specific region health\n   */\n  fastify.post(\n    \"/api/ha/health/check/:region\",\n    async (\n      request: FastifyRequest<{ Params: { region: string } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const healthChecker = haManager!.getHealthChecker();\n        const result = await healthChecker.checkRegion(request.params.region as Region);\n        return reply.send({\n          success: true,\n          data: result,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Health check failed\";\n        return reply.status(500).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  // ===========================================================================\n  // LOAD BALANCING\n  // ===========================================================================\n\n  /**\n   * GET /api/ha/lb/stats\n   * Get load balancer statistics\n   */\n  fastify.get(\"/api/ha/lb/stats\", async (_request, reply) => {\n    const loadBalancer = haManager!.getLoadBalancer();\n    const stats = loadBalancer.getStats();\n    return reply.send({\n      success: true,\n      data: stats,\n    });\n  });\n\n  /**\n   * POST /api/ha/lb/route\n   * Get routing decision\n   */\n  fastify.post(\n    \"/api/ha/lb/route\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          clientIp?: string;\n          sessionId?: string;\n          preferredRegion?: string;\n          excludeRegions?: string[];\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      const decision = haManager!.route({\n        clientIp: request.body.clientIp,\n        sessionId: request.body.sessionId,\n        preferredRegion: request.body.preferredRegion as Region,\n        excludeRegions: request.body.excludeRegions as Region[],\n      });\n\n      if (!decision) {\n        return reply.status(503).send({\n          success: false,\n          error: \"No available regions\",\n        });\n      }\n\n      return reply.send({\n        success: true,\n        data: decision,\n      });\n    }\n  );\n\n  // ===========================================================================\n  // FAILOVER\n  // ===========================================================================\n\n  /**\n   * GET /api/ha/failover/status\n   * Get failover status\n   */\n  fastify.get(\"/api/ha/failover/status\", async (_request, reply) => {\n    const failoverManager = haManager!.getFailoverManager();\n    const stats = failoverManager.getStats();\n    return reply.send({\n      success: true,\n      data: stats,\n    });\n  });\n\n  /**\n   * GET /api/ha/failover/history\n   * Get failover history\n   */\n  fastify.get(\n    \"/api/ha/failover/history\",\n    async (\n      request: FastifyRequest<{ Querystring: { limit?: string } }>,\n      reply: FastifyReply\n    ) => {\n      const limit = parseInt(request.query.limit || \"10\", 10);\n      const failoverManager = haManager!.getFailoverManager();\n      const history = failoverManager.getFailoverHistory(limit);\n      return reply.send({\n        success: true,\n        data: history,\n        count: history.length,\n      });\n    }\n  );\n\n  /**\n   * POST /api/ha/failover\n   * Trigger manual failover\n   */\n  fastify.post(\n    \"/api/ha/failover\",\n    async (\n      request: FastifyRequest<{ Body: { toRegion: string; reason?: string } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const event = await haManager!.triggerFailover(\n          request.body.toRegion as Region,\n          request.body.reason\n        );\n\n        if (!event) {\n          return reply.status(400).send({\n            success: false,\n            error: \"Failover could not be triggered\",\n          });\n        }\n\n        return reply.send({\n          success: true,\n          message: \"Failover triggered\",\n          data: event,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failover failed\";\n        return reply.status(500).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * GET /api/ha/failover/pending\n   * Get pending failover approvals\n   */\n  fastify.get(\"/api/ha/failover/pending\", async (_request, reply) => {\n    const failoverManager = haManager!.getFailoverManager();\n    const pending = failoverManager.getPendingApprovals();\n    return reply.send({\n      success: true,\n      data: pending,\n      count: pending.length,\n    });\n  });\n\n  /**\n   * POST /api/ha/failover/:id/approve\n   * Approve pending failover\n   */\n  fastify.post(\n    \"/api/ha/failover/:id/approve\",\n    async (\n      request: FastifyRequest<{ Params: { id: string } }>,\n      reply: FastifyReply\n    ) => {\n      const event = haManager!.approveFailover(request.params.id);\n\n      if (!event) {\n        return reply.status(404).send({\n          success: false,\n          error: \"Failover not found\",\n        });\n      }\n\n      return reply.send({\n        success: true,\n        message: \"Failover approved\",\n        data: event,\n      });\n    }\n  );\n\n  /**\n   * POST /api/ha/failover/:id/reject\n   * Reject pending failover\n   */\n  fastify.post(\n    \"/api/ha/failover/:id/reject\",\n    async (\n      request: FastifyRequest<{\n        Params: { id: string };\n        Body: { reason?: string };\n      }>,\n      reply: FastifyReply\n    ) => {\n      const event = haManager!.rejectFailover(\n        request.params.id,\n        request.body.reason\n      );\n\n      if (!event) {\n        return reply.status(404).send({\n          success: false,\n          error: \"Failover not found\",\n        });\n      }\n\n      return reply.send({\n        success: true,\n        message: \"Failover rejected\",\n        data: event,\n      });\n    }\n  );\n\n  // ===========================================================================\n  // REPLICATION\n  // ===========================================================================\n\n  /**\n   * GET /api/ha/replication\n   * Get replication status\n   */\n  fastify.get(\"/api/ha/replication\", async (_request, reply) => {\n    const state = haManager!.getState();\n    return reply.send({\n      success: true,\n      data: state.replicationStatus,\n    });\n  });\n\n  /**\n   * POST /api/ha/replication/status\n   * Update replication status (for external replication systems)\n   */\n  fastify.post(\n    \"/api/ha/replication/status\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          sourceRegion: string;\n          targetRegion: string;\n          mode: string;\n          lagMs: number;\n          bytesReplicated: number;\n          healthy: boolean;\n          error?: string;\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        haManager!.updateReplicationStatus({\n          sourceRegion: request.body.sourceRegion as Region,\n          targetRegion: request.body.targetRegion as Region,\n          mode: request.body.mode as any,\n          lagMs: request.body.lagMs,\n          bytesReplicated: request.body.bytesReplicated,\n          lastReplicatedAt: new Date().toISOString(),\n          healthy: request.body.healthy,\n          error: request.body.error,\n        });\n\n        return reply.send({\n          success: true,\n          message: \"Replication status updated\",\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Failed to update status\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  // ===========================================================================\n  // CONFIGURATION\n  // ===========================================================================\n\n  /**\n   * GET /api/ha/config\n   * Get HA configuration\n   */\n  fastify.get(\"/api/ha/config\", async (_request, reply) => {\n    const config = haManager!.getConfig();\n    return reply.send({\n      success: true,\n      data: {\n        healthCheck: config.healthCheck,\n        loadBalancing: config.loadBalancing,\n        failover: config.failover,\n        replication: config.replication,\n        monitoring: config.monitoring,\n      },\n    });\n  });\n}\n\nexport default haRoutes;\n","/**\n * Disaster Recovery API Routes\n * Phase 12B: Backup & Restore Management\n */\n\nimport type { FastifyInstance, FastifyRequest, FastifyReply } from \"fastify\";\nimport {\n  getBackupManager,\n  createBackupManager,\n  getRestoreManager,\n  createRestoreManager,\n  type BackupType,\n  type RestoreOptions,\n  type BackupResource,\n} from \"../dr/index.js\";\n\n// =============================================================================\n// ROUTE HANDLER\n// =============================================================================\n\nexport async function drRoutes(fastify: FastifyInstance): Promise<void> {\n  // Initialize managers if not already initialized\n  let backupManager = getBackupManager();\n  if (!backupManager) {\n    backupManager = createBackupManager({\n      type: \"local\",\n      path: \"/backups\",\n    });\n  }\n\n  let restoreManager = getRestoreManager();\n  if (!restoreManager) {\n    restoreManager = createRestoreManager(backupManager);\n  }\n\n  // ===========================================================================\n  // STATUS\n  // ===========================================================================\n\n  /**\n   * GET /api/dr/status\n   * Get DR status\n   */\n  fastify.get(\"/api/dr/status\", async (_request, reply) => {\n    const stats = backupManager!.getStats();\n    const restores = restoreManager!.listRestores(5);\n\n    return reply.send({\n      success: true,\n      data: {\n        backups: stats,\n        recentRestores: restores.length,\n        currentRestore: restoreManager!.getCurrentRestore(),\n      },\n    });\n  });\n\n  // ===========================================================================\n  // BACKUPS\n  // ===========================================================================\n\n  /**\n   * GET /api/dr/backups\n   * List all backups\n   */\n  fastify.get(\n    \"/api/dr/backups\",\n    async (\n      request: FastifyRequest<{\n        Querystring: {\n          type?: string;\n          status?: string;\n          limit?: string;\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      const limit = parseInt(request.query.limit || \"50\", 10);\n      const backups = backupManager!.listBackups({\n        type: request.query.type as BackupType,\n        status: request.query.status as any,\n        limit,\n      });\n\n      return reply.send({\n        success: true,\n        data: backups,\n        count: backups.length,\n      });\n    }\n  );\n\n  /**\n   * GET /api/dr/backups/:id\n   * Get specific backup\n   */\n  fastify.get(\n    \"/api/dr/backups/:id\",\n    async (\n      request: FastifyRequest<{ Params: { id: string } }>,\n      reply: FastifyReply\n    ) => {\n      const backup = backupManager!.getBackup(request.params.id);\n\n      if (!backup) {\n        return reply.status(404).send({\n          success: false,\n          error: \"Backup not found\",\n        });\n      }\n\n      return reply.send({\n        success: true,\n        data: backup,\n      });\n    }\n  );\n\n  /**\n   * POST /api/dr/backups\n   * Create a new backup\n   */\n  fastify.post(\n    \"/api/dr/backups\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          type?: string;\n          resources?: string[];\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const backup = await backupManager!.createBackup(\n          (request.body.type || \"full\") as BackupType,\n          request.body.resources as BackupResource[]\n        );\n\n        return reply.send({\n          success: true,\n          message: \"Backup created\",\n          data: backup,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Backup failed\";\n        return reply.status(500).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * POST /api/dr/backups/snapshot\n   * Create a snapshot\n   */\n  fastify.post(\n    \"/api/dr/backups/snapshot\",\n    async (\n      request: FastifyRequest<{ Body: { description?: string } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const snapshot = await backupManager!.createSnapshot(request.body.description);\n\n        return reply.send({\n          success: true,\n          message: \"Snapshot created\",\n          data: snapshot,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Snapshot failed\";\n        return reply.status(500).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * DELETE /api/dr/backups/:id\n   * Delete a backup\n   */\n  fastify.delete(\n    \"/api/dr/backups/:id\",\n    async (\n      request: FastifyRequest<{ Params: { id: string } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const deleted = await backupManager!.deleteBackup(request.params.id);\n\n        if (!deleted) {\n          return reply.status(404).send({\n            success: false,\n            error: \"Backup not found\",\n          });\n        }\n\n        return reply.send({\n          success: true,\n          message: \"Backup deleted\",\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Delete failed\";\n        return reply.status(400).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * POST /api/dr/backups/cleanup\n   * Clean up expired backups\n   */\n  fastify.post(\"/api/dr/backups/cleanup\", async (_request, reply) => {\n    try {\n      const result = await backupManager!.cleanupExpired();\n\n      return reply.send({\n        success: true,\n        message: \"Cleanup completed\",\n        data: result,\n      });\n    } catch (error) {\n      const message = error instanceof Error ? error.message : \"Cleanup failed\";\n      return reply.status(500).send({\n        success: false,\n        error: message,\n      });\n    }\n  });\n\n  // ===========================================================================\n  // RESTORE\n  // ===========================================================================\n\n  /**\n   * POST /api/dr/restore\n   * Start a restore operation\n   */\n  fastify.post(\n    \"/api/dr/restore\",\n    async (\n      request: FastifyRequest<{ Body: RestoreOptions }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const progress = await restoreManager!.restore(request.body);\n\n        return reply.send({\n          success: true,\n          message: \"Restore started\",\n          data: progress,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Restore failed\";\n        return reply.status(500).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * POST /api/dr/restore/pitr\n   * Point-in-time recovery\n   */\n  fastify.post(\n    \"/api/dr/restore/pitr\",\n    async (\n      request: FastifyRequest<{ Body: { targetTime: string } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const targetTime = new Date(request.body.targetTime);\n        const progress = await restoreManager!.restoreToPointInTime(targetTime);\n\n        return reply.send({\n          success: true,\n          message: \"Point-in-time restore started\",\n          data: progress,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"PITR failed\";\n        return reply.status(500).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  /**\n   * GET /api/dr/restore/:id\n   * Get restore progress\n   */\n  fastify.get(\n    \"/api/dr/restore/:id\",\n    async (\n      request: FastifyRequest<{ Params: { id: string } }>,\n      reply: FastifyReply\n    ) => {\n      const progress = restoreManager!.getRestoreProgress(request.params.id);\n\n      if (!progress) {\n        return reply.status(404).send({\n          success: false,\n          error: \"Restore not found\",\n        });\n      }\n\n      return reply.send({\n        success: true,\n        data: progress,\n      });\n    }\n  );\n\n  /**\n   * GET /api/dr/restore/current\n   * Get current restore operation\n   */\n  fastify.get(\"/api/dr/restore/current\", async (_request, reply) => {\n    const current = restoreManager!.getCurrentRestore();\n\n    return reply.send({\n      success: true,\n      data: current,\n    });\n  });\n\n  /**\n   * GET /api/dr/restores\n   * List restore history\n   */\n  fastify.get(\n    \"/api/dr/restores\",\n    async (\n      request: FastifyRequest<{ Querystring: { limit?: string } }>,\n      reply: FastifyReply\n    ) => {\n      const limit = parseInt(request.query.limit || \"20\", 10);\n      const restores = restoreManager!.listRestores(limit);\n\n      return reply.send({\n        success: true,\n        data: restores,\n        count: restores.length,\n      });\n    }\n  );\n\n  // ===========================================================================\n  // VALIDATION\n  // ===========================================================================\n\n  /**\n   * POST /api/dr/backups/:id/validate\n   * Validate a backup\n   */\n  fastify.post(\n    \"/api/dr/backups/:id/validate\",\n    async (\n      request: FastifyRequest<{ Params: { id: string } }>,\n      reply: FastifyReply\n    ) => {\n      try {\n        const result = await restoreManager!.validateBackup(request.params.id);\n\n        return reply.send({\n          success: true,\n          data: result,\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Validation failed\";\n        return reply.status(500).send({\n          success: false,\n          error: message,\n        });\n      }\n    }\n  );\n\n  // ===========================================================================\n  // SCHEDULER\n  // ===========================================================================\n\n  /**\n   * POST /api/dr/scheduler/start\n   * Start backup scheduler\n   */\n  fastify.post(\"/api/dr/scheduler/start\", async (_request, reply) => {\n    backupManager!.startScheduler();\n    return reply.send({\n      success: true,\n      message: \"Scheduler started\",\n    });\n  });\n\n  /**\n   * POST /api/dr/scheduler/stop\n   * Stop backup scheduler\n   */\n  fastify.post(\"/api/dr/scheduler/stop\", async (_request, reply) => {\n    backupManager!.stopScheduler();\n    return reply.send({\n      success: true,\n      message: \"Scheduler stopped\",\n    });\n  });\n\n  // ===========================================================================\n  // STATS\n  // ===========================================================================\n\n  /**\n   * GET /api/dr/stats\n   * Get DR statistics\n   */\n  fastify.get(\"/api/dr/stats\", async (_request, reply) => {\n    const stats = backupManager!.getStats();\n\n    return reply.send({\n      success: true,\n      data: stats,\n    });\n  });\n}\n\nexport default drRoutes;\n","/**\n * Observability API Routes\n * Phase 12D: Tracing, Metrics & Logging endpoints\n */\n\nimport type { FastifyInstance, FastifyRequest, FastifyReply } from \"fastify\";\nimport {\n  getObservabilityManager,\n  createObservabilityManager,\n  type TraceQuery,\n  type MetricQuery,\n  type LogQuery,\n} from \"../observability/index.js\";\n\n// =============================================================================\n// ROUTE HANDLER\n// =============================================================================\n\nexport async function observabilityRoutes(fastify: FastifyInstance): Promise<void> {\n  // Initialize manager if not already initialized\n  let observability = getObservabilityManager();\n  if (!observability) {\n    observability = createObservabilityManager({\n      serviceName: \"integration-hub\",\n      environment: process.env.NODE_ENV ?? \"development\",\n    });\n  }\n\n  // ===========================================================================\n  // STATUS & HEALTH\n  // ===========================================================================\n\n  /**\n   * GET /api/observability/status\n   * Get observability status\n   */\n  fastify.get(\"/api/observability/status\", async (_request, reply) => {\n    const health = observability!.getHealth();\n\n    return reply.send({\n      success: true,\n      data: health,\n    });\n  });\n\n  /**\n   * GET /api/observability/summary\n   * Get observability summary\n   */\n  fastify.get(\"/api/observability/summary\", async (_request, reply) => {\n    const summary = observability!.getSummary();\n\n    return reply.send({\n      success: true,\n      data: summary,\n    });\n  });\n\n  // ===========================================================================\n  // TRACES\n  // ===========================================================================\n\n  /**\n   * GET /api/observability/traces\n   * Search traces\n   */\n  fastify.get(\n    \"/api/observability/traces\",\n    async (\n      request: FastifyRequest<{\n        Querystring: {\n          serviceName?: string;\n          operationName?: string;\n          minDuration?: string;\n          maxDuration?: string;\n          startTime?: string;\n          endTime?: string;\n          limit?: string;\n          tags?: string;\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      const query: Omit<TraceQuery, \"traceId\"> = {\n        serviceName: request.query.serviceName,\n        operationName: request.query.operationName,\n        minDuration: request.query.minDuration ? parseInt(request.query.minDuration, 10) : undefined,\n        maxDuration: request.query.maxDuration ? parseInt(request.query.maxDuration, 10) : undefined,\n        startTime: request.query.startTime ? parseInt(request.query.startTime, 10) : undefined,\n        endTime: request.query.endTime ? parseInt(request.query.endTime, 10) : undefined,\n        limit: request.query.limit ? parseInt(request.query.limit, 10) : 100,\n      };\n\n      // Parse tags if provided\n      if (request.query.tags) {\n        try {\n          query.tags = JSON.parse(request.query.tags);\n        } catch {\n          // Ignore parse errors\n        }\n      }\n\n      const traces = observability!.searchTraces(query);\n\n      return reply.send({\n        success: true,\n        data: traces,\n        count: traces.length,\n      });\n    }\n  );\n\n  /**\n   * GET /api/observability/traces/:traceId\n   * Get specific trace\n   */\n  fastify.get(\n    \"/api/observability/traces/:traceId\",\n    async (\n      request: FastifyRequest<{ Params: { traceId: string } }>,\n      reply: FastifyReply\n    ) => {\n      const trace = observability!.getTrace(request.params.traceId);\n\n      if (!trace) {\n        return reply.status(404).send({\n          success: false,\n          error: \"Trace not found\",\n        });\n      }\n\n      return reply.send({\n        success: true,\n        data: trace,\n      });\n    }\n  );\n\n  /**\n   * GET /api/observability/traces/:traceId/logs\n   * Get logs for a trace\n   */\n  fastify.get(\n    \"/api/observability/traces/:traceId/logs\",\n    async (\n      request: FastifyRequest<{ Params: { traceId: string } }>,\n      reply: FastifyReply\n    ) => {\n      const logs = observability!.queryLogs({\n        traceId: request.params.traceId,\n      });\n\n      return reply.send({\n        success: true,\n        data: logs,\n        count: logs.length,\n      });\n    }\n  );\n\n  // ===========================================================================\n  // METRICS\n  // ===========================================================================\n\n  /**\n   * GET /api/observability/metrics\n   * Get all metrics\n   */\n  fastify.get(\"/api/observability/metrics\", async (_request, reply) => {\n    const metrics = observability!.getAllMetrics();\n\n    return reply.send({\n      success: true,\n      data: metrics,\n      count: metrics.length,\n    });\n  });\n\n  /**\n   * GET /api/observability/metrics/:name\n   * Get specific metric\n   */\n  fastify.get(\n    \"/api/observability/metrics/:name\",\n    async (\n      request: FastifyRequest<{\n        Params: { name: string };\n        Querystring: {\n          labels?: string;\n          startTime?: string;\n          endTime?: string;\n          step?: string;\n          aggregation?: string;\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      const query: MetricQuery = {\n        name: request.params.name,\n        startTime: request.query.startTime ? parseInt(request.query.startTime, 10) : undefined,\n        endTime: request.query.endTime ? parseInt(request.query.endTime, 10) : undefined,\n        step: request.query.step ? parseInt(request.query.step, 10) : undefined,\n        aggregation: request.query.aggregation as any,\n      };\n\n      // Parse labels if provided\n      if (request.query.labels) {\n        try {\n          query.labels = JSON.parse(request.query.labels);\n        } catch {\n          // Ignore parse errors\n        }\n      }\n\n      const metric = observability!.queryMetrics(query);\n\n      if (!metric) {\n        return reply.status(404).send({\n          success: false,\n          error: \"Metric not found\",\n        });\n      }\n\n      return reply.send({\n        success: true,\n        data: metric,\n      });\n    }\n  );\n\n  /**\n   * GET /api/observability/metrics/prometheus\n   * Export metrics in Prometheus format\n   */\n  fastify.get(\"/api/observability/metrics/prometheus\", async (_request, reply) => {\n    const prometheus = observability!.getPrometheusMetrics();\n\n    return reply\n      .header(\"Content-Type\", \"text/plain; version=0.0.4; charset=utf-8\")\n      .send(prometheus);\n  });\n\n  /**\n   * POST /api/observability/metrics/record\n   * Record a metric value\n   */\n  fastify.post(\n    \"/api/observability/metrics/record\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          name: string;\n          value: number;\n          labels?: Record<string, string>;\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      observability!.recordMetric(\n        request.body.name,\n        request.body.value,\n        request.body.labels\n      );\n\n      return reply.send({\n        success: true,\n        message: \"Metric recorded\",\n      });\n    }\n  );\n\n  // ===========================================================================\n  // LOGS\n  // ===========================================================================\n\n  /**\n   * GET /api/observability/logs\n   * Query logs\n   */\n  fastify.get(\n    \"/api/observability/logs\",\n    async (\n      request: FastifyRequest<{\n        Querystring: {\n          traceId?: string;\n          spanId?: string;\n          serviceName?: string;\n          severity?: string;\n          bodyContains?: string;\n          startTime?: string;\n          endTime?: string;\n          limit?: string;\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      const query: LogQuery = {\n        traceId: request.query.traceId,\n        spanId: request.query.spanId,\n        serviceName: request.query.serviceName,\n        severity: request.query.severity as any,\n        bodyContains: request.query.bodyContains,\n        startTime: request.query.startTime ? parseInt(request.query.startTime, 10) : undefined,\n        endTime: request.query.endTime ? parseInt(request.query.endTime, 10) : undefined,\n        limit: request.query.limit ? parseInt(request.query.limit, 10) : 100,\n      };\n\n      const logs = observability!.queryLogs(query);\n\n      return reply.send({\n        success: true,\n        data: logs,\n        count: logs.length,\n      });\n    }\n  );\n\n  /**\n   * POST /api/observability/logs\n   * Record a log entry\n   */\n  fastify.post(\n    \"/api/observability/logs\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          severity: \"TRACE\" | \"DEBUG\" | \"INFO\" | \"WARN\" | \"ERROR\" | \"FATAL\";\n          message: string;\n          attributes?: Record<string, string | number | boolean>;\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      const { severity, message, attributes } = request.body;\n\n      switch (severity) {\n        case \"TRACE\":\n          observability!.logTrace(message, attributes);\n          break;\n        case \"DEBUG\":\n          observability!.logDebug(message, attributes);\n          break;\n        case \"INFO\":\n          observability!.logInfo(message, attributes);\n          break;\n        case \"WARN\":\n          observability!.logWarn(message, attributes);\n          break;\n        case \"ERROR\":\n          observability!.logError(message, undefined, attributes);\n          break;\n        case \"FATAL\":\n          observability!.logFatal(message, undefined, attributes);\n          break;\n      }\n\n      return reply.send({\n        success: true,\n        message: \"Log recorded\",\n      });\n    }\n  );\n\n  // ===========================================================================\n  // SPANS\n  // ===========================================================================\n\n  /**\n   * POST /api/observability/spans/start\n   * Start a new span (for external clients)\n   */\n  fastify.post(\n    \"/api/observability/spans/start\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          name: string;\n          kind?: \"INTERNAL\" | \"SERVER\" | \"CLIENT\" | \"PRODUCER\" | \"CONSUMER\";\n          parentTraceId?: string;\n          parentSpanId?: string;\n          attributes?: Record<string, string | number | boolean>;\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      const { name, kind, parentTraceId, parentSpanId, attributes } = request.body;\n\n      const span = observability!.startSpan(name, {\n        kind,\n        context: parentTraceId && parentSpanId\n          ? { traceId: parentTraceId, spanId: parentSpanId, traceFlags: 1 }\n          : undefined,\n        attributes,\n      });\n\n      const context = span.getContext();\n\n      return reply.send({\n        success: true,\n        data: {\n          traceId: context.traceId,\n          spanId: context.spanId,\n          parentSpanId: context.parentSpanId,\n        },\n      });\n    }\n  );\n\n  /**\n   * POST /api/observability/spans/end\n   * End a span (for external clients)\n   */\n  fastify.post(\n    \"/api/observability/spans/end\",\n    async (\n      request: FastifyRequest<{\n        Body: {\n          traceId: string;\n          spanId: string;\n          status?: \"OK\" | \"ERROR\" | \"UNSET\";\n          statusMessage?: string;\n          attributes?: Record<string, string | number | boolean>;\n        };\n      }>,\n      reply: FastifyReply\n    ) => {\n      // Note: In a real implementation, we'd look up the active span\n      // For now, this is a simplified version\n\n      return reply.send({\n        success: true,\n        message: \"Span ended\",\n      });\n    }\n  );\n\n  // ===========================================================================\n  // ADMIN\n  // ===========================================================================\n\n  /**\n   * POST /api/observability/reset\n   * Reset all observability data\n   */\n  fastify.post(\"/api/observability/reset\", async (_request, reply) => {\n    observability!.reset();\n\n    return reply.send({\n      success: true,\n      message: \"Observability data reset\",\n    });\n  });\n\n  /**\n   * GET /api/observability/config\n   * Get observability configuration\n   */\n  fastify.get(\"/api/observability/config\", async (_request, reply) => {\n    const config = observability!.getConfig();\n\n    // Remove sensitive info\n    const safeConfig = {\n      serviceName: config.serviceName,\n      serviceVersion: config.serviceVersion,\n      environment: config.environment,\n      tracing: {\n        enabled: config.tracing.enabled,\n        sampler: config.tracing.sampler,\n      },\n      metrics: {\n        enabled: config.metrics.enabled,\n        collectInterval: config.metrics.collectInterval,\n      },\n      logging: {\n        enabled: config.logging.enabled,\n        minSeverity: config.logging.minSeverity,\n      },\n      retention: config.retention,\n    };\n\n    return reply.send({\n      success: true,\n      data: safeConfig,\n    });\n  });\n}\n\nexport default observabilityRoutes;\n","/**\n * API Routes - REST endpoints for the Integration Hub\n */\n\nimport type { FastifyInstance } from \"fastify\";\nimport type { IntegrationHub } from \"../hub.js\";\nimport { registerContentRoutes } from \"./content-routes.js\";\nimport { registerOrgRoutes } from \"./org-routes.js\";\nimport { registerAuditRoutes } from \"./audit-routes.js\";\nimport { gitRoutes } from \"./git-routes.js\";\nimport { botRoutes } from \"./bot-routes.js\";\nimport { terraformRoutes } from \"./terraform-routes.js\";\nimport { vscodeRoutes } from \"./vscode-routes.js\";\nimport { haRoutes } from \"./ha-routes.js\";\nimport { drRoutes } from \"./dr-routes.js\";\nimport { observabilityRoutes } from \"./observability-routes.js\";\nimport { getAutonomy } from \"@gicm/autonomy\";\n\n// ============================================================================\n// PREDICTION MARKET TYPES & FETCHERS\n// ============================================================================\n\ninterface PredictionMarket {\n  id: string;\n  source: \"polymarket\" | \"kalshi\";\n  question: string;\n  category: \"politics\" | \"crypto\" | \"macro\" | \"other\";\n  yesPrice: number;\n  noPrice: number;\n  volume24h: number;\n  totalVolume: number;\n  liquidity: number;\n  openInterest?: number;\n  priceChange24h: number;\n  expiresAt?: string;\n  url: string;\n}\n\ninterface PredictionsStatus {\n  lastUpdated: string;\n  sources: {\n    polymarket: { active: boolean; marketCount: number; totalVolume: number };\n    kalshi: { active: boolean; marketCount: number; totalVolume: number };\n  };\n  markets: {\n    politics: PredictionMarket[];\n    crypto: PredictionMarket[];\n    trending: PredictionMarket[];\n  };\n  stats: {\n    totalMarkets: number;\n    totalVolume24h: number;\n    topMoverPercent: number;\n  };\n}\n\n// Keywords for categorization\nconst POLITICS_KEYWORDS = [\n  \"election\", \"president\", \"congress\", \"senate\", \"house\",\n  \"governor\", \"vote\", \"ballot\", \"democrat\", \"republican\",\n  \"trump\", \"biden\", \"political\", \"impeach\", \"cabinet\"\n];\nconst CRYPTO_KEYWORDS = [\n  \"bitcoin\", \"btc\", \"ethereum\", \"eth\", \"solana\", \"sol\",\n  \"crypto\", \"etf\", \"sec\", \"coinbase\", \"binance\", \"defi\",\n  \"nft\", \"blockchain\", \"doge\", \"xrp\"\n];\nconst MACRO_KEYWORDS = [\n  \"fed\", \"fomc\", \"interest rate\", \"inflation\", \"cpi\",\n  \"gdp\", \"unemployment\", \"recession\", \"treasury\", \"yield\"\n];\n\nfunction categorizeMarket(question: string): \"politics\" | \"crypto\" | \"macro\" | \"other\" {\n  const q = question.toLowerCase();\n  if (POLITICS_KEYWORDS.some(kw => q.includes(kw))) return \"politics\";\n  if (CRYPTO_KEYWORDS.some(kw => q.includes(kw))) return \"crypto\";\n  if (MACRO_KEYWORDS.some(kw => q.includes(kw))) return \"macro\";\n  return \"other\";\n}\n\nasync function fetchPolymarketMarkets(): Promise<PredictionMarket[]> {\n  try {\n    // Use closed=false to get only open markets\n    const response = await fetch(\"https://gamma-api.polymarket.com/markets?closed=false&limit=100\", {\n      headers: { \"User-Agent\": \"gICM-Hub/1.0\", \"Accept\": \"application/json\" },\n      signal: AbortSignal.timeout(10000),\n    });\n    if (!response.ok) return [];\n    const data = await response.json();\n    const markets = Array.isArray(data) ? data : (data.markets ?? []);\n\n    return markets\n      .filter((m: any) => !m.closed && m.volumeNum > 1000)\n      .map((m: any) => {\n        const prices = m.outcomePrices?.map((p: string) => parseFloat(p) * 100) ?? [50, 50];\n        return {\n          id: `poly-${m.id}`,\n          source: \"polymarket\" as const,\n          question: m.question,\n          category: categorizeMarket(m.question),\n          yesPrice: prices[0] ?? 50,\n          noPrice: prices[1] ?? 50,\n          volume24h: m.volume24hr ?? 0,\n          totalVolume: m.volume ?? 0,\n          liquidity: m.liquidity ?? 0,\n          priceChange24h: 0, // Polymarket doesn't provide this directly\n          expiresAt: m.endDate,\n          url: `https://polymarket.com/event/${m.slug}`,\n        };\n      })\n      .slice(0, 50);\n  } catch (error) {\n    console.error(\"[PREDICTIONS] Polymarket fetch error:\", error);\n    return [];\n  }\n}\n\nasync function fetchKalshiMarkets(): Promise<PredictionMarket[]> {\n  try {\n    // Try the elections API first, then fallback\n    let response = await fetch(\"https://api.elections.kalshi.com/trade-api/v2/markets?status=open&limit=200\", {\n      headers: { \"User-Agent\": \"gICM-Hub/1.0\", \"Accept\": \"application/json\" },\n      signal: AbortSignal.timeout(10000),\n    });\n\n    if (!response.ok) {\n      response = await fetch(\"https://trading-api.kalshi.com/trade-api/v2/markets?status=open&limit=200\", {\n        headers: { \"User-Agent\": \"gICM-Hub/1.0\", \"Accept\": \"application/json\" },\n        signal: AbortSignal.timeout(10000),\n      });\n    }\n\n    if (!response.ok) return [];\n    const data = await response.json();\n    const markets = data.markets ?? [];\n\n    return markets\n      .filter((m: any) => (m.status === \"active\" || m.status === \"open\") && m.volume > 10)\n      .map((m: any) => {\n        const yesPrice = m.yes_bid > 0 ? m.yes_bid : m.last_price;\n        const noPrice = m.no_bid > 0 ? m.no_bid : (100 - m.last_price);\n        const priceChange = m.last_price - m.previous_price;\n\n        return {\n          id: `kalshi-${m.ticker}`,\n          source: \"kalshi\" as const,\n          question: m.title,\n          category: categorizeMarket(m.title),\n          yesPrice,\n          noPrice,\n          volume24h: m.volume_24h ?? 0,\n          totalVolume: m.volume ?? 0,\n          liquidity: m.liquidity ?? 0,\n          openInterest: m.open_interest,\n          priceChange24h: priceChange,\n          expiresAt: m.expiration_time,\n          url: `https://kalshi.com/markets/${m.ticker}`,\n        };\n      })\n      .slice(0, 50);\n  } catch (error) {\n    console.error(\"[PREDICTIONS] Kalshi fetch error:\", error);\n    return [];\n  }\n}\n\nasync function aggregatePredictions(): Promise<PredictionsStatus> {\n  const [polymarkets, kalshiMarkets] = await Promise.all([\n    fetchPolymarketMarkets(),\n    fetchKalshiMarkets(),\n  ]);\n\n  const allMarkets = [...polymarkets, ...kalshiMarkets];\n\n  // Categorize markets\n  const politics = allMarkets.filter(m => m.category === \"politics\").sort((a, b) => b.volume24h - a.volume24h);\n  const crypto = allMarkets.filter(m => m.category === \"crypto\").sort((a, b) => b.volume24h - a.volume24h);\n\n  // Trending = highest activity score: (volume_24h * |priceChange24h|)\n  const trending = [...allMarkets]\n    .map(m => ({ ...m, trendScore: m.volume24h * (Math.abs(m.priceChange24h) + 1) }))\n    .sort((a, b) => b.trendScore - a.trendScore)\n    .slice(0, 20);\n\n  // Calculate stats\n  const totalVolume24h = allMarkets.reduce((sum, m) => sum + m.volume24h, 0);\n  const topMover = allMarkets.reduce((max, m) => Math.abs(m.priceChange24h) > Math.abs(max) ? m.priceChange24h : max, 0);\n\n  return {\n    lastUpdated: new Date().toISOString(),\n    sources: {\n      polymarket: {\n        active: polymarkets.length > 0,\n        marketCount: polymarkets.length,\n        totalVolume: polymarkets.reduce((sum, m) => sum + m.totalVolume, 0),\n      },\n      kalshi: {\n        active: kalshiMarkets.length > 0,\n        marketCount: kalshiMarkets.length,\n        totalVolume: kalshiMarkets.reduce((sum, m) => sum + m.totalVolume, 0),\n      },\n    },\n    markets: {\n      politics: politics.slice(0, 20),\n      crypto: crypto.slice(0, 20),\n      trending,\n    },\n    stats: {\n      totalMarkets: allMarkets.length,\n      totalVolume24h,\n      topMoverPercent: topMover,\n    },\n  };\n}\n\nexport async function registerRoutes(\n  fastify: FastifyInstance,\n  hub: IntegrationHub\n): Promise<void> {\n  // Register Content Engine routes\n  await registerContentRoutes(fastify, hub);\n\n  // Register Organization & RBAC routes (Phase 9A)\n  await registerOrgRoutes(fastify);\n\n  // Register Audit Logging routes (Phase 9B)\n  await registerAuditRoutes(fastify);\n\n  // Register Git Integration routes (Phase 11A)\n  await gitRoutes(fastify);\n\n  // Register Bot routes (Phase 11B)\n  await botRoutes(fastify);\n\n  // Register Terraform routes (Phase 11C)\n  await terraformRoutes(fastify);\n\n  // Register VS Code Extension routes (Phase 11D)\n  await vscodeRoutes(fastify);\n\n  // Register High Availability routes (Phase 12A)\n  await haRoutes(fastify);\n\n  // Register Disaster Recovery routes (Phase 12B)\n  await drRoutes(fastify);\n\n  // Register Observability routes (Phase 12D)\n  await observabilityRoutes(fastify);\n\n  // =========================================================================\n  // ENGINE REGISTRATION ENDPOINTS (for distributed engines)\n  // =========================================================================\n\n  /**\n   * POST /api/engines/register - Register an engine\n   */\n  fastify.post<{ Body: { engineId: string } }>(\"/api/engines/register\", async (req) => {\n    const { engineId } = req.body;\n    const validEngines = [\"brain\", \"money\", \"growth\", \"product\", \"trading\", \"opus67\"] as const;\n    type ValidEngineId = typeof validEngines[number];\n\n    if (!validEngines.includes(engineId as ValidEngineId)) {\n      return { ok: false, error: `Invalid engine ID. Must be one of: ${validEngines.join(\", \")}` };\n    }\n\n    hub.getEngineManager().markConnected(engineId as ValidEngineId);\n    console.log(`[HUB] Engine registered via API: ${engineId}`);\n\n    return { ok: true, message: `Engine ${engineId} registered`, engineId };\n  });\n\n  /**\n   * POST /api/engines/heartbeat - Send heartbeat from an engine\n   */\n  fastify.post<{ Body: { engineId: string } }>(\"/api/engines/heartbeat\", async (req) => {\n    const { engineId } = req.body;\n    const validEngines = [\"brain\", \"money\", \"growth\", \"product\", \"trading\", \"opus67\"] as const;\n    type ValidEngineId = typeof validEngines[number];\n\n    if (!validEngines.includes(engineId as ValidEngineId)) {\n      return { ok: false, error: \"Invalid engine ID\" };\n    }\n\n    hub.getEngineManager().recordHeartbeat(engineId as ValidEngineId);\n\n    return { ok: true, timestamp: Date.now() };\n  });\n\n  /**\n   * POST /api/engines/unregister - Unregister an engine\n   */\n  fastify.post<{ Body: { engineId: string } }>(\"/api/engines/unregister\", async (req) => {\n    const { engineId } = req.body;\n    const validEngines = [\"brain\", \"money\", \"growth\", \"product\", \"trading\", \"opus67\"] as const;\n    type ValidEngineId = typeof validEngines[number];\n\n    if (!validEngines.includes(engineId as ValidEngineId)) {\n      return { ok: false, error: \"Invalid engine ID\" };\n    }\n\n    hub.getEngineManager().markDisconnected(engineId as ValidEngineId);\n    console.log(`[HUB] Engine unregistered: ${engineId}`);\n\n    return { ok: true, message: `Engine ${engineId} unregistered` };\n  });\n\n  // =========================================================================\n  // STATUS ENDPOINTS\n  // =========================================================================\n\n  /**\n   * GET /api/status - Overall system status\n   */\n  fastify.get(\"/api/status\", async () => {\n    const engines = hub.getEngineManager().getAllHealth();\n    const aggregated = hub.getEngineManager().getAggregatedStatus();\n\n    return {\n      ok: aggregated.offline === 0,\n      timestamp: Date.now(),\n      engines: {\n        status: aggregated,\n        details: engines,\n      },\n    };\n  });\n\n  /**\n   * GET /api/brain/status - Brain status\n   */\n  fastify.get(\"/api/brain/status\", async () => {\n    const brain = hub.getBrain();\n\n    // If Brain instance is directly connected, use it\n    if (brain) {\n      return {\n        ok: true,\n        status: brain.getStatus(),\n      };\n    }\n\n    // Otherwise, check if Brain is registered via API\n    const allEngines = hub.getEngineManager().getAllHealth();\n    const engineHealth = allEngines.find(e => e.id === \"brain\");\n    if (engineHealth && engineHealth.connected) {\n      // Brain is registered but not directly connected\n      // Return a basic status indicating it's running\n      return {\n        ok: true,\n        status: {\n          version: \"1.0.0\",\n          isRunning: true,\n          connected: true,\n          lastHeartbeat: engineHealth.lastHeartbeat,\n          message: \"Brain orchestrator is running and registered\",\n        },\n      };\n    }\n\n    return {\n      ok: false,\n      error: \"Brain not connected\",\n    };\n  });\n\n  // =========================================================================\n  // BRAIN CONTROL ENDPOINTS\n  // =========================================================================\n\n  /**\n   * POST /api/brain/start - Start the brain\n   */\n  fastify.post(\"/api/brain/start\", async () => {\n    const brain = hub.getBrain();\n\n    if (!brain) {\n      return { ok: false, error: \"Brain not connected\" };\n    }\n\n    brain.start();\n    return { ok: true, message: \"Brain started\" };\n  });\n\n  /**\n   * POST /api/brain/stop - Stop the brain\n   */\n  fastify.post(\"/api/brain/stop\", async () => {\n    const brain = hub.getBrain();\n\n    if (!brain) {\n      return { ok: false, error: \"Brain not connected\" };\n    }\n\n    brain.stop();\n    return { ok: true, message: \"Brain stopped\" };\n  });\n\n  /**\n   * POST /api/brain/phase - Trigger a specific phase\n   */\n  fastify.post<{ Body: { phase: string } }>(\"/api/brain/phase\", async (req) => {\n    const brain = hub.getBrain();\n\n    if (!brain) {\n      return { ok: false, error: \"Brain not connected\" };\n    }\n\n    const { phase } = req.body;\n    await brain.triggerPhase(phase);\n\n    return { ok: true, message: \"Phase triggered\", phase };\n  });\n\n  // =========================================================================\n  // TREASURY ENDPOINTS\n  // =========================================================================\n\n  /**\n   * GET /api/treasury - Treasury status\n   */\n  fastify.get(\"/api/treasury\", async () => {\n    const moneyEngine = hub.getMoneyEngine();\n\n    if (!moneyEngine) {\n      return {\n        ok: false,\n        error: \"Money engine not connected\",\n      };\n    }\n\n    try {\n      const status = await moneyEngine.getStatus();\n      return {\n        ok: true,\n        treasury: {\n          totalUsd: status.treasury.totalValueUsd.toNumber(),\n          solBalance: status.treasury.solBalance.toNumber(),\n          usdcBalance: status.treasury.usdcBalance.toNumber(),\n          runway: status.health.runway,\n          allocations: Object.fromEntries(\n            Object.entries(status.treasury.allocations).map(([k, v]) => [\n              k,\n              v.toNumber(),\n            ])\n          ),\n        },\n        health: status.health,\n      };\n    } catch (error) {\n      return {\n        ok: false,\n        error: \"Failed to fetch treasury status\",\n      };\n    }\n  });\n\n  // =========================================================================\n  // ENGINE STATUS ENDPOINTS (for dashboard)\n  // =========================================================================\n\n  /**\n   * GET /api/money/status - Money engine detailed status (alias for treasury)\n   */\n  fastify.get(\"/api/money/status\", async () => {\n    const moneyEngine = hub.getMoneyEngine();\n\n    if (!moneyEngine) {\n      return {\n        ok: false,\n        error: \"Money engine not connected\",\n      };\n    }\n\n    try {\n      const status = await moneyEngine.getStatus();\n      return {\n        ok: true,\n        totalValueUsd: status.treasury.totalValueUsd.toNumber(),\n        balances: {\n          sol: status.treasury.solBalance.toNumber(),\n          usdc: status.treasury.usdcBalance.toNumber(),\n        },\n        allocations: Object.fromEntries(\n          Object.entries(status.treasury.allocations).map(([k, v]) => [k, v.toNumber()])\n        ),\n        runway: status.health.runway,\n        expenses: {\n          monthly: 0, // TODO: Wire to expense tracking\n          upcoming: 0,\n        },\n        trading: {\n          activeBots: 1, // DCA bot\n          totalPnL: 0,\n          dailyPnL: 0,\n          weeklyPnL: 0,\n        },\n      };\n    } catch (error) {\n      return { ok: false, error: \"Failed to fetch money status\" };\n    }\n  });\n\n  /**\n   * GET /api/growth/status - Growth engine status\n   */\n  fastify.get(\"/api/growth/status\", async () => {\n    const growthEngine = hub.getGrowthEngine();\n\n    if (!growthEngine) {\n      return {\n        ok: false,\n        error: \"Growth engine not connected\",\n        // Return stub data so dashboard doesn't break\n        running: false,\n        metrics: {\n          traffic: { daily: 0, weekly: 0, monthly: 0 },\n          content: { postsPublished: 0, totalViews: 0, avgEngagement: 0 },\n          social: { twitterFollowers: 0, discordMembers: 0 },\n          seo: { avgPosition: 0, indexedPages: 0, backlinks: 0 },\n        },\n        upcomingContent: { blogPosts: 0, tweets: 0 },\n      };\n    }\n\n    try {\n      const status = growthEngine.getStatus();\n      return {\n        ok: true,\n        running: status.running,\n        metrics: {\n          traffic: { daily: 0, weekly: 0, monthly: 0 }, // TODO: Wire to analytics\n          content: {\n            postsPublished: status.metrics.postsGenerated,\n            totalViews: 0,\n            avgEngagement: 0,\n          },\n          social: {\n            twitterFollowers: 0,\n            discordMembers: 0,\n          },\n          seo: { avgPosition: 0, indexedPages: 0, backlinks: 0 },\n        },\n        upcomingContent: {\n          blogPosts: status.upcomingContent?.length || 0,\n          tweets: 0,\n        },\n      };\n    } catch (error) {\n      return { ok: false, error: \"Failed to fetch growth status\" };\n    }\n  });\n\n  /**\n   * GET /api/product/status - Product engine status\n   */\n  fastify.get(\"/api/product/status\", async () => {\n    const productEngine = hub.getProductEngine();\n\n    if (!productEngine) {\n      return {\n        ok: false,\n        error: \"Product engine not connected\",\n        running: false,\n        backlog: { total: 0, approved: 0, building: 0 },\n        activeBuild: null,\n        metrics: { discovered: 0, built: 0, deployed: 0, successRate: 0 },\n      };\n    }\n\n    try {\n      const backlog = productEngine.getBacklog();\n      const approved = backlog.filter((o: any) => o.status === \"approved\");\n      const building = backlog.filter((o: any) => o.status === \"building\");\n\n      return {\n        ok: true,\n        running: true,\n        backlog: {\n          total: backlog.length,\n          approved: approved.length,\n          building: building.length,\n        },\n        activeBuild: building.length > 0 ? {\n          id: building[0].id,\n          name: building[0].name,\n          progress: 50, // TODO: Track actual progress\n        } : null,\n        metrics: {\n          discovered: backlog.length,\n          built: 0, // TODO: Track completed builds\n          deployed: 0,\n          successRate: 0,\n        },\n      };\n    } catch (error) {\n      return { ok: false, error: \"Failed to fetch product status\" };\n    }\n  });\n\n  /**\n   * GET /api/hunter/status - Hunter agent status\n   */\n  fastify.get(\"/api/hunter/status\", async () => {\n    // Hunter is typically part of the brain or a separate agent\n    // For now, return status based on brain's hunter config if available\n    const brain = hub.getBrain();\n\n    if (brain) {\n      const brainStatus = brain.getStatus();\n      return {\n        ok: true,\n        isRunning: brainStatus.isRunning,\n        enabledSources: brainStatus.hunter?.enabledSources || [\"github\", \"hackernews\", \"twitter\"],\n        totalDiscoveries: brainStatus.hunter?.totalDiscoveries || 0,\n        totalSignals: brainStatus.hunter?.totalSignals || 0,\n        actionableSignals: brainStatus.hunter?.actionableSignals || 0,\n        recentDiscoveries: [], // TODO: Fetch from hunter agent\n      };\n    }\n\n    // Default response when brain not connected\n    return {\n      ok: true,\n      isRunning: false,\n      enabledSources: [\"github\", \"hackernews\", \"twitter\", \"producthunt\"],\n      totalDiscoveries: 0,\n      totalSignals: 0,\n      actionableSignals: 0,\n      recentDiscoveries: [],\n    };\n  });\n\n  /**\n   * GET /api/autonomy/status - Autonomy engine status (LIVE)\n   */\n  fastify.get(\"/api/autonomy/status\", async () => {\n    try {\n      const autonomy = getAutonomy();\n      const status = autonomy.getStatus();\n      return {\n        ok: true,\n        level: status.level,\n        running: status.running,\n        queue: {\n          pending: status.queue.pending,\n          approved: status.queue.approved,\n          rejected: status.queue.rejected,\n        },\n        audit: status.audit,\n        today: {\n          autoExecuted: status.usage.actionsExecuted,\n          queued: status.usage.actionsQueued,\n          escalated: status.usage.escalations,\n          cost: status.usage.spending,\n          revenue: 0,\n        },\n        stats: {\n          autoExecuted: status.executor.totalExecuted,\n          queued: status.queue.pending,\n          pending: status.queue.pending,\n        },\n      };\n    } catch (error) {\n      return {\n        ok: false,\n        error: error instanceof Error ? error.message : \"Unknown error\",\n        level: 2,\n        queue: { pending: 0, approved: 0, rejected: 0 },\n        audit: { total: 0, auto: 0, queued: 0, escalated: 0, successRate: 100 },\n        today: { autoExecuted: 0, queued: 0, escalated: 0, cost: 0, revenue: 0 },\n        stats: { autoExecuted: 0, queued: 0, pending: 0 },\n      };\n    }\n  });\n\n  /**\n   * GET /api/autonomy/queue - Get pending approval queue\n   */\n  fastify.get(\"/api/autonomy/queue\", async () => {\n    try {\n      const autonomy = getAutonomy();\n      return { ok: true, queue: autonomy.getQueue() };\n    } catch (error) {\n      return { ok: false, error: error instanceof Error ? error.message : \"Unknown error\", queue: [] };\n    }\n  });\n\n  /**\n   * POST /api/autonomy/approve/:id - Approve a pending request\n   */\n  fastify.post(\"/api/autonomy/approve/:id\", async (request) => {\n    try {\n      const { id } = request.params;\n      const autonomy = getAutonomy();\n      const result = await autonomy.approve(id);\n      return { ok: !!result, request: result };\n    } catch (error) {\n      return { ok: false, error: error instanceof Error ? error.message : \"Unknown error\" };\n    }\n  });\n\n  /**\n   * POST /api/autonomy/reject/:id - Reject a pending request\n   */\n  fastify.post(\"/api/autonomy/reject/:id\", async (request) => {\n    try {\n      const { id } = request.params;\n      const { reason } = request.body || {};\n      const autonomy = getAutonomy();\n      const result = await autonomy.reject(id, reason || \"Rejected by user\");\n      return { ok: !!result, request: result };\n    } catch (error) {\n      return { ok: false, error: error instanceof Error ? error.message : \"Unknown error\" };\n    }\n  });\n\n  /**\n   * GET /api/autonomy/boundaries - Get current boundaries\n   */\n  fastify.get(\"/api/autonomy/boundaries\", async () => {\n    try {\n      const autonomy = getAutonomy();\n      return { ok: true, boundaries: autonomy.getBoundaries() };\n    } catch (error) {\n      return { ok: false, error: error instanceof Error ? error.message : \"Unknown error\" };\n    }\n  });\n\n  // =========================================================================\n  // HYPER BRAIN KNOWLEDGE ENDPOINTS (integrated into Hub)\n  // =========================================================================\n\n  /**\n   * GET /api/brain/stats - Brain knowledge stats\n   */\n  fastify.get(\"/api/brain/stats\", async () => {\n    // TODO: Connect to HyperBrain when integrated\n    // For now, return stats structure that dashboard expects\n    return {\n      ok: true,\n      knowledge: {\n        total: 0,\n        bySource: { github: 0, hackernews: 0, twitter: 0, arxiv: 0, producthunt: 0 },\n        byTopic: {},\n        recent24h: 0,\n      },\n      patterns: {\n        total: 0,\n        byType: { correlation: 0, trend: 0, anomaly: 0, recurring: 0 },\n        avgConfidence: 0,\n      },\n      predictions: {\n        total: 0,\n        pending: 0,\n        accuracy: 0,\n      },\n      uptime: Date.now(),\n      lastIngestion: 0,\n    };\n  });\n\n  /**\n   * GET /api/brain/recent - Recent knowledge items\n   */\n  fastify.get<{ Querystring: { limit?: string } }>(\"/api/brain/recent\", async (req) => {\n    const limit = parseInt(req.query.limit || \"20\", 10);\n\n    // TODO: Connect to HyperBrain knowledge store\n    // For now, return empty array\n    return {\n      ok: true,\n      items: [],\n      count: 0,\n      limit,\n    };\n  });\n\n  /**\n   * GET /api/brain/patterns - Discovered patterns\n   */\n  fastify.get(\"/api/brain/patterns\", async () => {\n    // TODO: Connect to HyperBrain pattern discovery\n    return {\n      ok: true,\n      patterns: [],\n      count: 0,\n    };\n  });\n\n  /**\n   * GET /api/brain/predictions - Active predictions\n   */\n  fastify.get(\"/api/brain/predictions\", async () => {\n    // TODO: Connect to HyperBrain prediction engine\n    return {\n      ok: true,\n      predictions: [],\n      count: 0,\n    };\n  });\n\n  /**\n   * POST /api/brain/search - Search knowledge base\n   */\n  fastify.post<{ Body: { query: string; limit?: number } }>(\"/api/brain/search\", async (req) => {\n    const { query, limit = 20 } = req.body;\n\n    // TODO: Connect to HyperBrain semantic search\n    return {\n      ok: true,\n      query,\n      results: [],\n      count: 0,\n    };\n  });\n\n  /**\n   * POST /api/brain/ingest - Trigger knowledge ingestion\n   */\n  fastify.post<{ Body: { source?: string } }>(\"/api/brain/ingest\", async (req) => {\n    const { source } = req.body;\n\n    // TODO: Trigger actual ingestion\n    hub.getEventBus().publish(\"brain\", \"brain.ingest_triggered\", { source: source || \"all\" });\n\n    return {\n      ok: true,\n      message: source ? `Ingestion triggered for ${source}` : \"Full ingestion triggered\",\n    };\n  });\n\n  // =========================================================================\n  // EVENT ENDPOINTS\n  // =========================================================================\n\n  // Import event enrichment\n  const { enrichEvents, getAllCategories, CATEGORY_ICONS } = await import(\"../events/index.js\");\n\n  /**\n   * GET /api/events - Recent events (raw)\n   */\n  fastify.get<{ Querystring: { limit?: string; category?: string } }>(\n    \"/api/events\",\n    async (req) => {\n      const limit = parseInt(req.query.limit || \"50\", 10);\n      const category = req.query.category;\n\n      let events;\n      if (category) {\n        events = hub\n          .getEventBus()\n          .getEventsByCategory(category as any, limit);\n      } else {\n        events = hub.getEventBus().getRecentEvents(limit);\n      }\n\n      return {\n        ok: true,\n        count: events.length,\n        events,\n      };\n    }\n  );\n\n  /**\n   * GET /api/events/enriched - Recent events with enrichment (titles, icons, actions)\n   */\n  fastify.get<{ Querystring: { limit?: string; category?: string; severity?: string } }>(\n    \"/api/events/enriched\",\n    async (req) => {\n      const limit = parseInt(req.query.limit || \"50\", 10);\n      const category = req.query.category;\n      const severity = req.query.severity;\n\n      let events;\n      if (category) {\n        events = hub\n          .getEventBus()\n          .getEventsByCategory(category as any, limit);\n      } else {\n        events = hub.getEventBus().getRecentEvents(limit);\n      }\n\n      // Enrich events\n      let enriched = enrichEvents(events);\n\n      // Filter by severity if specified\n      if (severity) {\n        enriched = enriched.filter((e) => e.severity === severity);\n      }\n\n      return {\n        ok: true,\n        count: enriched.length,\n        events: enriched,\n      };\n    }\n  );\n\n  /**\n   * GET /api/events/categories - List available event categories\n   */\n  fastify.get(\"/api/events/categories\", async () => {\n    const categories = getAllCategories();\n    return {\n      ok: true,\n      categories: categories.map((c) => ({\n        id: c,\n        name: c.charAt(0).toUpperCase() + c.slice(1),\n        icon: CATEGORY_ICONS[c],\n      })),\n    };\n  });\n\n  // =========================================================================\n  // DISCOVERY ENDPOINTS\n  // =========================================================================\n\n  /**\n   * GET /api/backlog - Product backlog\n   */\n  fastify.get(\"/api/backlog\", async () => {\n    const productEngine = hub.getProductEngine();\n\n    if (!productEngine) {\n      return { ok: false, error: \"Product engine not connected\" };\n    }\n\n    const backlog = productEngine.getBacklog();\n    return {\n      ok: true,\n      count: backlog.length,\n      items: backlog,\n    };\n  });\n\n  /**\n   * POST /api/discovery/run - Run discovery\n   */\n  fastify.post(\"/api/discovery/run\", async () => {\n    const productEngine = hub.getProductEngine();\n\n    if (!productEngine) {\n      return { ok: false, error: \"Product engine not connected\" };\n    }\n\n    try {\n      const opportunities = await productEngine.runDiscovery();\n      return {\n        ok: true,\n        found: opportunities.length,\n        opportunities,\n      };\n    } catch (error) {\n      return { ok: false, error: \"Discovery failed\" };\n    }\n  });\n\n  // =========================================================================\n  // CONTENT ENDPOINTS\n  // =========================================================================\n\n  /**\n   * POST /api/content/generate - Generate content\n   */\n  fastify.post<{ Body: { type: \"blog\" | \"tweet\" | \"thread\" } }>(\n    \"/api/content/generate\",\n    async (req) => {\n      const growthEngine = hub.getGrowthEngine();\n\n      if (!growthEngine) {\n        return { ok: false, error: \"Growth engine not connected\" };\n      }\n\n      const { type } = req.body;\n\n      try {\n        await growthEngine.generateNow(type);\n        const status = growthEngine.getStatus();\n\n        return {\n          ok: true,\n          type,\n          upcomingContent: status.upcomingContent,\n        };\n      } catch (error) {\n        return { ok: false, error: \"Content generation failed\" };\n      }\n    }\n  );\n\n  // =========================================================================\n  // PREDICTION MARKET ENDPOINTS\n  // =========================================================================\n\n  /**\n   * GET /api/predictions/status - Prediction markets data\n   */\n  fastify.get(\"/api/predictions/status\", async () => {\n    try {\n      const predictions = await aggregatePredictions();\n      return predictions;\n    } catch (error) {\n      console.error(\"[PREDICTIONS] Error fetching predictions:\", error);\n      return {\n        lastUpdated: new Date().toISOString(),\n        sources: {\n          polymarket: { active: false, marketCount: 0, totalVolume: 0 },\n          kalshi: { active: false, marketCount: 0, totalVolume: 0 },\n        },\n        markets: { politics: [], crypto: [], trending: [] },\n        stats: { totalMarkets: 0, totalVolume24h: 0, topMoverPercent: 0 },\n      };\n    }\n  });\n\n  // Also register at /api/v1/predictions/status for dashboard compatibility\n  fastify.get(\"/api/v1/predictions/status\", async () => {\n    try {\n      const predictions = await aggregatePredictions();\n      return predictions;\n    } catch (error) {\n      console.error(\"[PREDICTIONS] Error fetching predictions:\", error);\n      return {\n        lastUpdated: new Date().toISOString(),\n        sources: {\n          polymarket: { active: false, marketCount: 0, totalVolume: 0 },\n          kalshi: { active: false, marketCount: 0, totalVolume: 0 },\n        },\n        markets: { politics: [], crypto: [], trending: [] },\n        stats: { totalMarkets: 0, totalVolume24h: 0, topMoverPercent: 0 },\n      };\n    }\n  });\n\n  // =========================================================================\n  // PIPELINE EXECUTION ENDPOINTS (PTC)\n  // =========================================================================\n\n  // In-memory pipeline execution store (in production, use Redis/DB)\n  const pipelineExecutions = new Map<string, PipelineExecution>();\n\n  interface PipelineExecution {\n    id: string;\n    pipelineId: string;\n    pipelineName: string;\n    status: \"pending\" | \"running\" | \"completed\" | \"failed\" | \"cancelled\";\n    progress: number; // 0-100\n    currentStep: string | null;\n    steps: StepProgress[];\n    startedAt: number;\n    completedAt: number | null;\n    result: any | null;\n    error: string | null;\n  }\n\n  interface StepProgress {\n    id: string;\n    name: string;\n    status: \"pending\" | \"running\" | \"completed\" | \"failed\" | \"skipped\";\n    startedAt: number | null;\n    completedAt: number | null;\n    output: any | null;\n    error: string | null;\n  }\n\n  /**\n   * POST /api/pipelines/execute - Execute a pipeline\n   */\n  fastify.post<{\n    Body: {\n      pipeline: {\n        id: string;\n        name: string;\n        description?: string;\n        steps: Array<{\n          id: string;\n          tool: string;\n          name?: string;\n          inputs: Record<string, unknown>;\n          dependsOn?: string[];\n          condition?: string;\n        }>;\n      };\n      inputs?: Record<string, unknown>;\n    };\n  }>(\"/api/pipelines/execute\", async (req) => {\n    const { pipeline, inputs = {} } = req.body;\n    const executionId = `exec_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`;\n\n    // Initialize execution record\n    const execution: PipelineExecution = {\n      id: executionId,\n      pipelineId: pipeline.id,\n      pipelineName: pipeline.name,\n      status: \"pending\",\n      progress: 0,\n      currentStep: null,\n      steps: pipeline.steps.map((s) => ({\n        id: s.id,\n        name: s.name || s.tool,\n        status: \"pending\",\n        startedAt: null,\n        completedAt: null,\n        output: null,\n        error: null,\n      })),\n      startedAt: Date.now(),\n      completedAt: null,\n      result: null,\n      error: null,\n    };\n\n    pipelineExecutions.set(executionId, execution);\n\n    // Emit pipeline:started event\n    hub.getEventBus().publish(\"pipeline\", \"pipeline.started\", {\n      executionId,\n      pipelineId: pipeline.id,\n      pipelineName: pipeline.name,\n      stepCount: pipeline.steps.length,\n    });\n\n    // Start async execution\n    executePipelineAsync(execution, pipeline, inputs, hub.getEventBus());\n\n    return {\n      ok: true,\n      executionId,\n      message: \"Pipeline execution started\",\n    };\n  });\n\n  /**\n   * GET /api/pipelines/:executionId/status - Get pipeline execution status\n   */\n  fastify.get<{ Params: { executionId: string } }>(\n    \"/api/pipelines/:executionId/status\",\n    async (req) => {\n      const { executionId } = req.params;\n      const execution = pipelineExecutions.get(executionId);\n\n      if (!execution) {\n        return {\n          ok: false,\n          error: `Execution not found: ${executionId}`,\n        };\n      }\n\n      return {\n        ok: true,\n        execution: {\n          id: execution.id,\n          pipelineId: execution.pipelineId,\n          pipelineName: execution.pipelineName,\n          status: execution.status,\n          progress: execution.progress,\n          currentStep: execution.currentStep,\n          steps: execution.steps,\n          startedAt: execution.startedAt,\n          completedAt: execution.completedAt,\n          duration: execution.completedAt\n            ? execution.completedAt - execution.startedAt\n            : Date.now() - execution.startedAt,\n          result: execution.result,\n          error: execution.error,\n        },\n      };\n    }\n  );\n\n  /**\n   * GET /api/pipelines/executions - List all pipeline executions\n   */\n  fastify.get<{ Querystring: { limit?: string; status?: string } }>(\n    \"/api/pipelines/executions\",\n    async (req) => {\n      const limit = parseInt(req.query.limit || \"20\", 10);\n      const statusFilter = req.query.status;\n\n      let executions = Array.from(pipelineExecutions.values());\n\n      if (statusFilter) {\n        executions = executions.filter((e) => e.status === statusFilter);\n      }\n\n      // Sort by most recent first\n      executions.sort((a, b) => b.startedAt - a.startedAt);\n\n      return {\n        ok: true,\n        total: executions.length,\n        executions: executions.slice(0, limit).map((e) => ({\n          id: e.id,\n          pipelineId: e.pipelineId,\n          pipelineName: e.pipelineName,\n          status: e.status,\n          progress: e.progress,\n          startedAt: e.startedAt,\n          completedAt: e.completedAt,\n          duration: e.completedAt\n            ? e.completedAt - e.startedAt\n            : Date.now() - e.startedAt,\n        })),\n      };\n    }\n  );\n\n  /**\n   * POST /api/pipelines/:executionId/cancel - Cancel a running pipeline\n   */\n  fastify.post<{ Params: { executionId: string } }>(\n    \"/api/pipelines/:executionId/cancel\",\n    async (req) => {\n      const { executionId } = req.params;\n      const execution = pipelineExecutions.get(executionId);\n\n      if (!execution) {\n        return { ok: false, error: `Execution not found: ${executionId}` };\n      }\n\n      if (execution.status !== \"running\" && execution.status !== \"pending\") {\n        return { ok: false, error: `Cannot cancel execution with status: ${execution.status}` };\n      }\n\n      execution.status = \"cancelled\";\n      execution.completedAt = Date.now();\n\n      hub.getEventBus().publish(\"pipeline\", \"pipeline.cancelled\", {\n        executionId,\n        pipelineId: execution.pipelineId,\n      });\n\n      return { ok: true, message: \"Pipeline cancelled\" };\n    }\n  );\n\n  // Helper function to execute pipeline asynchronously\n  async function executePipelineAsync(\n    execution: PipelineExecution,\n    pipeline: any,\n    inputs: Record<string, unknown>,\n    eventBus: any\n  ): Promise<void> {\n    try {\n      execution.status = \"running\";\n\n      const results: Record<string, unknown> = {};\n      const completedSteps = new Set<string>();\n      const totalSteps = pipeline.steps.length;\n\n      for (let i = 0; i < pipeline.steps.length; i++) {\n        // Check if cancelled\n        if (execution.status === \"cancelled\") {\n          return;\n        }\n\n        const step = pipeline.steps[i];\n        const stepRecord = execution.steps.find((s: StepProgress) => s.id === step.id)!;\n\n        // Check dependencies\n        if (step.dependsOn?.length) {\n          const depsOk = step.dependsOn.every((dep: string) => completedSteps.has(dep));\n          if (!depsOk) {\n            stepRecord.status = \"skipped\";\n            stepRecord.error = \"Dependencies not met\";\n            eventBus.publish(\"pipeline\", \"pipeline.step_skipped\", {\n              executionId: execution.id,\n              stepId: step.id,\n              reason: \"Dependencies not met\",\n            });\n            continue;\n          }\n        }\n\n        // Start step\n        execution.currentStep = step.id;\n        stepRecord.status = \"running\";\n        stepRecord.startedAt = Date.now();\n\n        eventBus.publish(\"pipeline\", \"pipeline.step_started\", {\n          executionId: execution.id,\n          stepId: step.id,\n          tool: step.tool,\n        });\n\n        try {\n          // Simulate step execution (in real impl, call PTC Coordinator)\n          await simulateStepExecution(step, inputs, results);\n\n          stepRecord.status = \"completed\";\n          stepRecord.completedAt = Date.now();\n          stepRecord.output = { success: true, tool: step.tool };\n          completedSteps.add(step.id);\n          results[step.id] = stepRecord.output;\n\n          eventBus.publish(\"pipeline\", \"pipeline.step_completed\", {\n            executionId: execution.id,\n            stepId: step.id,\n            duration: stepRecord.completedAt - (stepRecord.startedAt || 0),\n          });\n        } catch (error) {\n          stepRecord.status = \"failed\";\n          stepRecord.completedAt = Date.now();\n          stepRecord.error = error instanceof Error ? error.message : String(error);\n\n          eventBus.publish(\"pipeline\", \"pipeline.step_failed\", {\n            executionId: execution.id,\n            stepId: step.id,\n            error: stepRecord.error,\n          });\n        }\n\n        // Update progress\n        execution.progress = Math.round(((i + 1) / totalSteps) * 100);\n      }\n\n      // Complete\n      execution.status = execution.steps.some((s: StepProgress) => s.status === \"failed\") ? \"failed\" : \"completed\";\n      execution.completedAt = Date.now();\n      execution.currentStep = null;\n      execution.result = results;\n\n      eventBus.publish(\"pipeline\", \"pipeline.completed\", {\n        executionId: execution.id,\n        pipelineId: execution.pipelineId,\n        status: execution.status,\n        duration: execution.completedAt - execution.startedAt,\n      });\n    } catch (error) {\n      execution.status = \"failed\";\n      execution.completedAt = Date.now();\n      execution.error = error instanceof Error ? error.message : String(error);\n\n      eventBus.publish(\"pipeline\", \"pipeline.failed\", {\n        executionId: execution.id,\n        pipelineId: execution.pipelineId,\n        error: execution.error,\n      });\n    }\n  }\n\n  // Simulate step execution (placeholder - would call actual PTC Coordinator)\n  async function simulateStepExecution(\n    step: any,\n    inputs: Record<string, unknown>,\n    results: Record<string, unknown>\n  ): Promise<void> {\n    // Simulate 500-2000ms execution time\n    const delay = 500 + Math.random() * 1500;\n    await new Promise((resolve) => setTimeout(resolve, delay));\n\n    // Simulate random failure (10% chance)\n    if (Math.random() < 0.1) {\n      throw new Error(`Step ${step.id} failed: simulated error`);\n    }\n  }\n\n  // =========================================================================\n  // ANALYTICS ENDPOINTS\n  // =========================================================================\n\n  // Import analytics manager (late import to avoid circular deps)\n  const { getAnalyticsManager } = await import(\"../analytics.js\");\n  const analytics = getAnalyticsManager();\n\n  // Hook up pipeline executions to analytics\n  // When pipeline starts, track in analytics\n  hub.getEventBus().subscribe(\"pipeline\", \"pipeline.started\", async (data: any) => {\n    const exec = pipelineExecutions.get(data.executionId);\n    if (exec) {\n      analytics.startExecution(exec.pipelineId, exec.pipelineName, exec.steps.length);\n    }\n  });\n\n  // When step completes, record in analytics\n  hub.getEventBus().subscribe(\"pipeline\", \"pipeline.step_completed\", async (data: any) => {\n    const exec = pipelineExecutions.get(data.executionId);\n    if (exec) {\n      const step = exec.steps.find((s: StepProgress) => s.id === data.stepId);\n      if (step) {\n        // Simulate token usage (in production, get from actual LLM call)\n        analytics.recordStep(\n          data.executionId,\n          data.stepId,\n          step.name,\n          \"completed\",\n          { input: 500 + Math.random() * 500, output: 200 + Math.random() * 300, total: 0 }\n        );\n      }\n    }\n  });\n\n  // When pipeline completes, finalize analytics\n  hub.getEventBus().subscribe(\"pipeline\", \"pipeline.completed\", async (data: any) => {\n    analytics.completeExecution(\n      data.executionId,\n      data.status === \"completed\" ? \"completed\" : \"failed\"\n    );\n  });\n\n  /**\n   * GET /api/analytics/summary - Get analytics summary\n   */\n  fastify.get<{ Querystring: { period?: string } }>(\n    \"/api/analytics/summary\",\n    async (req) => {\n      const period = (req.query.period || \"week\") as \"day\" | \"week\" | \"month\";\n      const summary = analytics.getSummary(period);\n\n      return {\n        ok: true,\n        summary,\n      };\n    }\n  );\n\n  /**\n   * GET /api/analytics/executions - Get recent execution analytics\n   */\n  fastify.get<{ Querystring: { limit?: string; pipelineId?: string } }>(\n    \"/api/analytics/executions\",\n    async (req) => {\n      const limit = parseInt(req.query.limit || \"50\", 10);\n      const pipelineId = req.query.pipelineId;\n\n      let executions;\n      if (pipelineId) {\n        executions = analytics.getExecutionsByPipeline(pipelineId, limit);\n      } else {\n        executions = analytics.getRecentExecutions(limit);\n      }\n\n      return {\n        ok: true,\n        count: executions.length,\n        executions,\n      };\n    }\n  );\n\n  /**\n   * GET /api/analytics/daily - Get daily statistics\n   */\n  fastify.get<{ Querystring: { date?: string } }>(\n    \"/api/analytics/daily\",\n    async (req) => {\n      const date = req.query.date;\n      const stats = analytics.getDailyStats(date);\n\n      if (!stats) {\n        return {\n          ok: true,\n          stats: null,\n          message: \"No data for this date\",\n        };\n      }\n\n      return {\n        ok: true,\n        stats,\n      };\n    }\n  );\n\n  /**\n   * GET /api/analytics/tokens - Get token usage breakdown\n   */\n  fastify.get<{ Querystring: { period?: string } }>(\n    \"/api/analytics/tokens\",\n    async (req) => {\n      const period = (req.query.period || \"week\") as \"day\" | \"week\" | \"month\";\n      const breakdown = analytics.getTokenUsageBreakdown(period);\n\n      return {\n        ok: true,\n        period,\n        ...breakdown,\n      };\n    }\n  );\n\n  /**\n   * GET /api/analytics/costs - Get cost breakdown\n   */\n  fastify.get<{ Querystring: { period?: string } }>(\n    \"/api/analytics/costs\",\n    async (req) => {\n      const period = (req.query.period || \"week\") as \"day\" | \"week\" | \"month\";\n      const summary = analytics.getSummary(period);\n\n      return {\n        ok: true,\n        period,\n        totalCost: summary.totalCost,\n        costTrend: summary.costTrend,\n        avgCostPerExecution: summary.totalExecutions > 0\n          ? summary.totalCost / summary.totalExecutions\n          : 0,\n        topCostPipelines: summary.topPipelines.map((p) => ({\n          id: p.id,\n          name: p.name,\n          executions: p.count,\n        })),\n      };\n    }\n  );\n\n  /**\n   * GET /api/analytics/success-rate - Get success rate metrics\n   */\n  fastify.get<{ Querystring: { period?: string } }>(\n    \"/api/analytics/success-rate\",\n    async (req) => {\n      const period = (req.query.period || \"week\") as \"day\" | \"week\" | \"month\";\n      const summary = analytics.getSummary(period);\n\n      return {\n        ok: true,\n        period,\n        overall: {\n          successRate: summary.successRate,\n          totalExecutions: summary.totalExecutions,\n        },\n        byPipeline: summary.topPipelines.map((p) => ({\n          id: p.id,\n          name: p.name,\n          successRate: p.successRate,\n          executions: p.count,\n        })),\n        trend: summary.executionTrend,\n      };\n    }\n  );\n\n  // =========================================================================\n  // WEBHOOK MANAGEMENT ENDPOINTS\n  // =========================================================================\n\n  // Import webhook manager (late import to avoid circular deps)\n  const { getWebhookManager } = await import(\"../notifications/webhooks.js\");\n  const webhookManager = getWebhookManager();\n  await webhookManager.initialize();\n\n  /**\n   * GET /api/webhooks - List all webhooks\n   */\n  fastify.get(\"/api/webhooks\", async () => {\n    const webhooks = webhookManager.getWebhooks();\n    return {\n      ok: true,\n      count: webhooks.length,\n      webhooks: webhooks.map((w) => ({\n        id: w.id,\n        name: w.name,\n        url: w.url,\n        events: w.events,\n        enabled: w.enabled,\n        lastTriggeredAt: w.lastTriggeredAt,\n        lastStatus: w.lastStatus,\n        failureCount: w.failureCount,\n        createdAt: w.createdAt,\n      })),\n    };\n  });\n\n  /**\n   * GET /api/webhooks/:id - Get webhook by ID\n   */\n  fastify.get<{ Params: { id: string } }>(\"/api/webhooks/:id\", async (req, reply) => {\n    const webhook = webhookManager.getWebhook(req.params.id);\n\n    if (!webhook) {\n      reply.code(404);\n      return { ok: false, error: \"Webhook not found\" };\n    }\n\n    return {\n      ok: true,\n      webhook: {\n        id: webhook.id,\n        name: webhook.name,\n        url: webhook.url,\n        events: webhook.events,\n        enabled: webhook.enabled,\n        retryCount: webhook.retryCount,\n        timeoutMs: webhook.timeoutMs,\n        lastTriggeredAt: webhook.lastTriggeredAt,\n        lastStatus: webhook.lastStatus,\n        failureCount: webhook.failureCount,\n        metadata: webhook.metadata,\n        createdAt: webhook.createdAt,\n        updatedAt: webhook.updatedAt,\n      },\n    };\n  });\n\n  /**\n   * POST /api/webhooks - Create a new webhook\n   */\n  fastify.post<{\n    Body: {\n      name: string;\n      url: string;\n      secret?: string;\n      events?: string[];\n      enabled?: boolean;\n      retryCount?: number;\n      timeoutMs?: number;\n      metadata?: Record<string, unknown>;\n    };\n  }>(\"/api/webhooks\", async (req, reply) => {\n    const { name, url, secret, events, enabled, retryCount, timeoutMs, metadata } = req.body;\n\n    if (!name || !url) {\n      reply.code(400);\n      return { ok: false, error: \"name and url are required\" };\n    }\n\n    // Validate URL\n    try {\n      new URL(url);\n    } catch {\n      reply.code(400);\n      return { ok: false, error: \"Invalid URL\" };\n    }\n\n    // Generate secret if not provided\n    const webhookSecret =\n      secret || `whsec_${Date.now().toString(36)}${Math.random().toString(36).slice(2)}`;\n\n    const webhook = await webhookManager.registerWebhook({\n      name,\n      url,\n      secret: webhookSecret,\n      events: (events as any) || [\"pipeline.completed\"],\n      enabled: enabled !== false,\n      retryCount: retryCount || 3,\n      timeoutMs: timeoutMs || 5000,\n      metadata: metadata || {},\n    });\n\n    return {\n      ok: true,\n      webhook: {\n        id: webhook.id,\n        name: webhook.name,\n        url: webhook.url,\n        secret: webhook.secret, // Include secret only on creation\n        events: webhook.events,\n        enabled: webhook.enabled,\n        createdAt: webhook.createdAt,\n      },\n    };\n  });\n\n  /**\n   * PATCH /api/webhooks/:id - Update a webhook\n   */\n  fastify.patch<{\n    Params: { id: string };\n    Body: {\n      name?: string;\n      url?: string;\n      events?: string[];\n      enabled?: boolean;\n      retryCount?: number;\n      timeoutMs?: number;\n      metadata?: Record<string, unknown>;\n    };\n  }>(\"/api/webhooks/:id\", async (req, reply) => {\n    const existing = webhookManager.getWebhook(req.params.id);\n\n    if (!existing) {\n      reply.code(404);\n      return { ok: false, error: \"Webhook not found\" };\n    }\n\n    // Validate URL if provided\n    if (req.body.url) {\n      try {\n        new URL(req.body.url);\n      } catch {\n        reply.code(400);\n        return { ok: false, error: \"Invalid URL\" };\n      }\n    }\n\n    const updated = webhookManager.updateWebhook(req.params.id, {\n      ...(req.body.name && { name: req.body.name }),\n      ...(req.body.url && { url: req.body.url }),\n      ...(req.body.events && { events: req.body.events as any }),\n      ...(req.body.enabled !== undefined && { enabled: req.body.enabled }),\n      ...(req.body.retryCount && { retryCount: req.body.retryCount }),\n      ...(req.body.timeoutMs && { timeoutMs: req.body.timeoutMs }),\n      ...(req.body.metadata && { metadata: req.body.metadata }),\n    });\n\n    return {\n      ok: true,\n      webhook: {\n        id: updated!.id,\n        name: updated!.name,\n        url: updated!.url,\n        events: updated!.events,\n        enabled: updated!.enabled,\n        updatedAt: updated!.updatedAt,\n      },\n    };\n  });\n\n  /**\n   * DELETE /api/webhooks/:id - Delete a webhook\n   */\n  fastify.delete<{ Params: { id: string } }>(\"/api/webhooks/:id\", async (req, reply) => {\n    const existing = webhookManager.getWebhook(req.params.id);\n\n    if (!existing) {\n      reply.code(404);\n      return { ok: false, error: \"Webhook not found\" };\n    }\n\n    webhookManager.removeWebhook(req.params.id);\n\n    return {\n      ok: true,\n      message: \"Webhook deleted\",\n    };\n  });\n\n  /**\n   * POST /api/webhooks/:id/test - Test a webhook\n   */\n  fastify.post<{ Params: { id: string } }>(\"/api/webhooks/:id/test\", async (req, reply) => {\n    const webhook = webhookManager.getWebhook(req.params.id);\n\n    if (!webhook) {\n      reply.code(404);\n      return { ok: false, error: \"Webhook not found\" };\n    }\n\n    // Send test payload\n    await webhookManager.triggerPipelineEvent(\"pipeline.completed\", {\n      id: `test_${Date.now()}`,\n      pipelineId: \"test-pipeline\",\n      pipelineName: \"Test Pipeline\",\n      status: \"completed\",\n      startTime: Date.now() - 5000,\n      endTime: Date.now(),\n      duration: 5000,\n      steps: [],\n      cost: { total: 0.01, breakdown: { llm: 0.01, api: 0, compute: 0 }, currency: \"USD\" },\n      tokens: { input: 1000, output: 500, total: 1500 },\n    });\n\n    return {\n      ok: true,\n      message: \"Test webhook triggered\",\n    };\n  });\n\n  // =========================================================================\n  // QUEUE MANAGEMENT ENDPOINTS\n  // =========================================================================\n\n  // Import queue (late import to avoid circular deps)\n  const { getPipelineQueue, createPipelineWorker } = await import(\"../queue/index.js\");\n  const queue = await getPipelineQueue();\n  createPipelineWorker(queue, { analytics });\n\n  /**\n   * GET /api/queue/stats - Get queue statistics\n   */\n  fastify.get(\"/api/queue/stats\", async () => {\n    const stats = queue.getStats();\n    return {\n      ok: true,\n      stats,\n    };\n  });\n\n  /**\n   * POST /api/queue/jobs - Add a job to the queue\n   */\n  fastify.post<{\n    Body: {\n      pipelineId: string;\n      pipelineName: string;\n      inputs?: Record<string, unknown>;\n      steps: Array<{\n        id: string;\n        tool: string;\n        inputs?: Record<string, unknown>;\n        dependsOn?: string[];\n      }>;\n      priority?: string;\n      webhookUrl?: string;\n    };\n  }>(\"/api/queue/jobs\", async (req, reply) => {\n    const { pipelineId, pipelineName, inputs, steps, priority, webhookUrl } = req.body;\n\n    if (!pipelineId || !pipelineName || !steps || steps.length === 0) {\n      reply.code(400);\n      return { ok: false, error: \"pipelineId, pipelineName, and steps are required\" };\n    }\n\n    const jobId = await queue.addJob({\n      pipelineId,\n      pipelineName,\n      inputs: inputs || {},\n      steps,\n      priority: (priority as any) || \"normal\",\n      webhookUrl,\n    });\n\n    return {\n      ok: true,\n      jobId,\n      message: \"Job added to queue\",\n    };\n  });\n\n  /**\n   * GET /api/queue/jobs/:id - Get job status\n   */\n  fastify.get<{ Params: { id: string } }>(\"/api/queue/jobs/:id\", async (req, reply) => {\n    const progress = queue.getProgress(req.params.id);\n\n    if (!progress) {\n      reply.code(404);\n      return { ok: false, error: \"Job not found\" };\n    }\n\n    const job = queue.getJob(req.params.id);\n\n    return {\n      ok: true,\n      job: job\n        ? {\n            id: job.id,\n            pipelineId: job.pipelineId,\n            pipelineName: job.pipelineName,\n            priority: job.priority,\n          }\n        : null,\n      progress,\n    };\n  });\n\n  /**\n   * POST /api/queue/pause - Pause the queue\n   */\n  fastify.post(\"/api/queue/pause\", async () => {\n    await queue.pause();\n    return { ok: true, message: \"Queue paused\" };\n  });\n\n  /**\n   * POST /api/queue/resume - Resume the queue\n   */\n  fastify.post(\"/api/queue/resume\", async () => {\n    await queue.resume();\n    return { ok: true, message: \"Queue resumed\" };\n  });\n}\n","/**\n * Fastify Authentication Plugin\n * Integrates with @gicm/agent-core security module\n */\n\nimport type { FastifyInstance, FastifyRequest, FastifyReply } from \"fastify\";\nimport fp from \"fastify-plugin\";\nimport { AuthMiddleware, ApiKeyManager, hasScope } from \"@gicm/agent-core/security/auth\";\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport interface AuthPluginOptions {\n  /** JWT secret for token signing (min 32 chars) */\n  jwtSecret?: string;\n  /** API key prefix (default: gicm) */\n  apiKeyPrefix?: string;\n  /** Routes that don't require authentication */\n  publicRoutes?: string[];\n  /** Whether to enable auth (can disable for development) */\n  enabled?: boolean;\n}\n\nexport interface AuthenticatedUser {\n  userId: string;\n  scope?: string[];\n  expiresAt?: number;\n}\n\n// Extend Fastify types\ndeclare module \"fastify\" {\n  interface FastifyRequest {\n    user?: AuthenticatedUser;\n    isAuthenticated: boolean;\n  }\n}\n\n// ============================================================================\n// Default Configuration\n// ============================================================================\n\nconst DEFAULT_PUBLIC_ROUTES = [\n  \"/\",\n  \"/health\",\n  \"/ws\",\n  \"/api/status\",\n  \"/api/brain/status\",\n  \"/api/events\",\n  \"/api/events/enriched\",\n  \"/api/events/categories\",\n  \"/api/predictions/status\",\n  \"/api/v1/predictions/status\",\n];\n\n// ============================================================================\n// Plugin Implementation\n// ============================================================================\n\nasync function authPlugin(\n  fastify: FastifyInstance,\n  options: AuthPluginOptions\n): Promise<void> {\n  const {\n    jwtSecret = process.env.GICM_JWT_SECRET,\n    apiKeyPrefix = process.env.GICM_API_KEY_PREFIX || \"gicm\",\n    publicRoutes = DEFAULT_PUBLIC_ROUTES,\n    enabled = process.env.NODE_ENV === \"production\" || process.env.GICM_AUTH_ENABLED === \"true\",\n  } = options;\n\n  // Initialize auth middleware\n  const authMiddleware = new AuthMiddleware({\n    jwtSecret,\n    apiKeyPrefix,\n    enableApiKey: true,\n    enableJwt: !!jwtSecret,\n  });\n\n  // Pre-create a default API key for development\n  if (!enabled) {\n    console.log(\"[AUTH] Authentication disabled (development mode)\");\n    console.log(\"[AUTH] Set GICM_AUTH_ENABLED=true or NODE_ENV=production to enable\");\n  }\n\n  // Decorate request with auth properties\n  fastify.decorateRequest(\"user\", null);\n  fastify.decorateRequest(\"isAuthenticated\", false);\n\n  // Add preHandler hook for authentication\n  fastify.addHook(\"preHandler\", async (request: FastifyRequest, reply: FastifyReply) => {\n    // Skip auth if disabled\n    if (!enabled) {\n      request.isAuthenticated = true;\n      request.user = { userId: \"dev-user\", scope: [\"*\"] };\n      return;\n    }\n\n    // Check if route is public\n    const isPublicRoute = publicRoutes.some((route) => {\n      // Exact match\n      if (request.url === route) return true;\n      // Prefix match with wildcard\n      if (route.endsWith(\"*\") && request.url.startsWith(route.slice(0, -1))) return true;\n      // Match route path without query string\n      const pathOnly = request.url.split(\"?\")[0];\n      return pathOnly === route;\n    });\n\n    if (isPublicRoute) {\n      request.isAuthenticated = true;\n      return;\n    }\n\n    // Extract auth header\n    const authHeader = request.headers.authorization;\n\n    // Authenticate\n    const result = authMiddleware.authenticate({\n      headers: {\n        authorization: authHeader,\n        Authorization: authHeader,\n      },\n    });\n\n    if (result.authenticated) {\n      request.isAuthenticated = true;\n      request.user = {\n        userId: result.userId!,\n        scope: result.scope,\n        expiresAt: result.expiresAt,\n      };\n    } else {\n      // Return 401 for protected routes\n      reply.code(401).send({\n        ok: false,\n        error: result.error || \"Authentication required\",\n        code: \"UNAUTHORIZED\",\n      });\n      return;\n    }\n  });\n\n  // Add route for generating API keys (admin only)\n  fastify.post<{\n    Body: {\n      name: string;\n      userId?: string;\n      scope?: string[];\n      expiresIn?: number;\n    };\n  }>(\"/api/auth/keys\", async (request, reply) => {\n    // Check if user has admin scope\n    if (!request.user?.scope?.includes(\"admin\") && !request.user?.scope?.includes(\"*\")) {\n      reply.code(403).send({\n        ok: false,\n        error: \"Admin access required\",\n        code: \"FORBIDDEN\",\n      });\n      return;\n    }\n\n    const { name, userId, scope, expiresIn } = request.body;\n\n    if (!name) {\n      reply.code(400).send({\n        ok: false,\n        error: \"name is required\",\n        code: \"BAD_REQUEST\",\n      });\n      return;\n    }\n\n    const apiKey = authMiddleware.generateApiKey({\n      userId: userId || request.user?.userId || \"system\",\n      name,\n      scope: scope || [\"read\"],\n      expiresIn,\n    });\n\n    if (!apiKey) {\n      reply.code(500).send({\n        ok: false,\n        error: \"Failed to generate API key\",\n        code: \"INTERNAL_ERROR\",\n      });\n      return;\n    }\n\n    return {\n      ok: true,\n      apiKey: {\n        id: apiKey.id,\n        key: apiKey.key, // Only shown once!\n        name: apiKey.name,\n        scope: apiKey.scope,\n        createdAt: apiKey.createdAt,\n        expiresAt: apiKey.expiresAt,\n      },\n      warning: \"Store this key securely - it won't be shown again!\",\n    };\n  });\n\n  // Add route for revoking API keys\n  fastify.delete<{\n    Params: { keyId: string };\n  }>(\"/api/auth/keys/:keyId\", async (request, reply) => {\n    // Check if user has admin scope\n    if (!request.user?.scope?.includes(\"admin\") && !request.user?.scope?.includes(\"*\")) {\n      reply.code(403).send({\n        ok: false,\n        error: \"Admin access required\",\n        code: \"FORBIDDEN\",\n      });\n      return;\n    }\n\n    const { keyId } = request.params;\n    const revoked = authMiddleware.revokeApiKey(keyId);\n\n    if (!revoked) {\n      reply.code(404).send({\n        ok: false,\n        error: \"API key not found\",\n        code: \"NOT_FOUND\",\n      });\n      return;\n    }\n\n    return {\n      ok: true,\n      message: \"API key revoked\",\n    };\n  });\n\n  // Add route for getting current user info\n  fastify.get(\"/api/auth/me\", async (request) => {\n    if (!request.isAuthenticated || !request.user) {\n      return {\n        ok: false,\n        authenticated: false,\n      };\n    }\n\n    return {\n      ok: true,\n      authenticated: true,\n      user: {\n        userId: request.user.userId,\n        scope: request.user.scope,\n        expiresAt: request.user.expiresAt,\n      },\n    };\n  });\n\n  // Add scope checking helper\n  fastify.decorate(\"requireScope\", function (requiredScope: string | string[]) {\n    return async (request: FastifyRequest, reply: FastifyReply) => {\n      if (!request.user?.scope) {\n        reply.code(403).send({\n          ok: false,\n          error: \"Insufficient permissions\",\n          code: \"FORBIDDEN\",\n        });\n        return;\n      }\n\n      if (!hasScope(request.user.scope, requiredScope)) {\n        reply.code(403).send({\n          ok: false,\n          error: `Required scope: ${Array.isArray(requiredScope) ? requiredScope.join(\", \") : requiredScope}`,\n          code: \"FORBIDDEN\",\n        });\n        return;\n      }\n    };\n  });\n\n  console.log(`[AUTH] Authentication plugin loaded (enabled: ${enabled})`);\n  console.log(`[AUTH] Public routes: ${publicRoutes.length}`);\n}\n\n// Export as Fastify plugin\nexport default fp(authPlugin, {\n  fastify: \"5.x\",\n  name: \"gicm-auth\",\n});\n\n// Named export\nexport { authPlugin };\n","/**\n * Workflow Registry - Cross-engine automation workflows\n */\n\nimport type { EventBus } from \"../event-bus.js\";\nimport type { IntegrationHub } from \"../hub.js\";\n\nexport interface Workflow {\n  id: string;\n  name: string;\n  description: string;\n  trigger: string; // Event type that triggers this workflow\n  enabled: boolean;\n  execute: (hub: IntegrationHub, payload: Record<string, unknown>) => Promise<void>;\n}\n\n// ============================================================================\n// WORKFLOW IMPLEMENTATIONS\n// ============================================================================\n\n/**\n * Feature Announcement Workflow\n * When ProductEngine deploys a new feature, announce via GrowthEngine\n */\nconst featureAnnouncementWorkflow: Workflow = {\n  id: \"feature-announcement\",\n  name: \"Feature Announcement\",\n  description: \"Announce new features when ProductEngine deploys them\",\n  trigger: \"build.completed\",\n  enabled: true,\n  execute: async (hub, payload) => {\n    const growthEngine = hub.getGrowthEngine();\n    if (!growthEngine) return;\n\n    const { name, description } = payload as { name?: string; description?: string };\n    if (!name) return;\n\n    try {\n      await growthEngine.announceFeature({\n        name,\n        description: description || \"New feature deployed!\",\n      });\n      console.log(\"[WORKFLOW] Feature announced:\", name);\n\n      hub.getEventBus().publish(\"workflow\", \"content.published\", {\n        workflow: \"feature-announcement\",\n        feature: name,\n      });\n    } catch (error) {\n      console.error(\"[WORKFLOW] Feature announcement failed:\", error);\n    }\n  },\n};\n\n/**\n * Profitable Trade Workflow\n * When a trade makes profit above threshold, tweet about it\n */\nconst profitableTradeWorkflow: Workflow = {\n  id: \"profitable-trade\",\n  name: \"Profitable Trade Tweet\",\n  description: \"Tweet about profitable trades above threshold\",\n  trigger: \"trade.profit\",\n  enabled: true,\n  execute: async (hub, payload) => {\n    const growthEngine = hub.getGrowthEngine();\n    if (!growthEngine) return;\n\n    const { profit, symbol } = payload as { profit?: number; symbol?: string };\n    if (!profit || profit < 100) return; // Only announce profits > $100\n\n    try {\n      await growthEngine.generateNow(\"tweet\");\n      console.log(\"[WORKFLOW] Profit tweet generated for\", symbol);\n    } catch (error) {\n      console.error(\"[WORKFLOW] Profit tweet failed:\", error);\n    }\n  },\n};\n\n/**\n * Low Treasury Alert Workflow\n * When treasury drops below threshold, pause risky operations\n */\nconst lowTreasuryAlertWorkflow: Workflow = {\n  id: \"low-treasury-alert\",\n  name: \"Low Treasury Alert\",\n  description: \"Alert and pause operations when treasury is critically low\",\n  trigger: \"treasury.critical\",\n  enabled: true,\n  execute: async (hub, payload) => {\n    const brain = hub.getBrain();\n    if (!brain) return;\n\n    const { totalUsd, threshold } = payload as { totalUsd?: number; threshold?: number };\n\n    console.warn(\"[WORKFLOW] CRITICAL: Treasury below threshold!\", {\n      totalUsd,\n      threshold,\n    });\n\n    // Could pause trading or other risky operations here\n    hub.getEventBus().publish(\"workflow\", \"engine.error\", {\n      workflow: \"low-treasury-alert\",\n      message: \"Treasury critically low - manual review required\",\n      totalUsd,\n    });\n  },\n};\n\n/**\n * Daily Summary Workflow\n * Generate and publish daily performance summary\n */\nconst dailySummaryWorkflow: Workflow = {\n  id: \"daily-summary\",\n  name: \"Daily Summary\",\n  description: \"Generate daily performance summary\",\n  trigger: \"brain.phase_completed\",\n  enabled: true,\n  execute: async (hub, payload) => {\n    const { phase } = payload as { phase?: string };\n    if (phase !== \"night_summary\") return;\n\n    const growthEngine = hub.getGrowthEngine();\n    if (!growthEngine) return;\n\n    try {\n      await growthEngine.generateNow(\"thread\");\n      console.log(\"[WORKFLOW] Daily summary thread generated\");\n    } catch (error) {\n      console.error(\"[WORKFLOW] Daily summary failed:\", error);\n    }\n  },\n};\n\n// ============================================================================\n// OPUS67 WORKFLOWS\n// ============================================================================\n\n/**\n * OPUS67 Mode Change Workflow\n * Log mode changes and potentially adjust engine behavior\n */\nconst opus67ModeChangeWorkflow: Workflow = {\n  id: \"opus67-mode-change\",\n  name: \"OPUS67 Mode Change\",\n  description: \"Handle OPUS67 mode changes and adjust engine behavior\",\n  trigger: \"opus67.mode_changed\",\n  enabled: true,\n  execute: async (hub, payload) => {\n    const { from, to, reason } = payload as { from?: string; to?: string; reason?: string };\n\n    console.log(`[WORKFLOW] OPUS67 mode changed: ${from}  ${to} (${reason})`);\n\n    // If switching to SWARM mode, could enable parallel processing\n    if (to === \"swarm\") {\n      console.log(\"[WORKFLOW] SWARM mode enabled - parallel processing active\");\n    }\n\n    // If switching to AUDIT mode, could trigger security scans\n    if (to === \"audit\") {\n      console.log(\"[WORKFLOW] AUDIT mode enabled - security focus active\");\n    }\n\n    hub.getEventBus().publish(\"workflow\", \"engine.heartbeat\", {\n      workflow: \"opus67-mode-change\",\n      mode: to,\n    });\n  },\n};\n\n/**\n * OPUS67 Query Processed Workflow\n * Track query processing for analytics\n */\nconst opus67QueryProcessedWorkflow: Workflow = {\n  id: \"opus67-query-processed\",\n  name: \"OPUS67 Query Analytics\",\n  description: \"Track and analyze OPUS67 query processing\",\n  trigger: \"opus67.query_processed\",\n  enabled: true,\n  execute: async (hub, payload) => {\n    const { query, mode, confidence, skills } = payload as {\n      query?: string;\n      mode?: string;\n      confidence?: number;\n      skills?: string[];\n    };\n\n    console.log(`[WORKFLOW] OPUS67 processed query in ${mode} mode (${confidence}% confidence)`);\n\n    // Could send analytics to external service\n    // Could trigger content generation based on query patterns\n  },\n};\n\n/**\n * OPUS67 Agent Spawn Workflow\n * Track sub-agent spawning for monitoring\n */\nconst opus67AgentSpawnWorkflow: Workflow = {\n  id: \"opus67-agent-spawn\",\n  name: \"OPUS67 Agent Monitor\",\n  description: \"Monitor OPUS67 sub-agent spawning\",\n  trigger: \"opus67.agent_spawned\",\n  enabled: true,\n  execute: async (hub, payload) => {\n    const { agentId, role, mode } = payload as {\n      agentId?: string;\n      role?: string;\n      mode?: string;\n    };\n\n    console.log(`[WORKFLOW] OPUS67 spawned agent: ${agentId} (${role}) in ${mode} mode`);\n  },\n};\n\n// ============================================================================\n// WORKFLOW REGISTRY\n// ============================================================================\n\nexport const workflows: Workflow[] = [\n  featureAnnouncementWorkflow,\n  profitableTradeWorkflow,\n  lowTreasuryAlertWorkflow,\n  dailySummaryWorkflow,\n  opus67ModeChangeWorkflow,\n  opus67QueryProcessedWorkflow,\n  opus67AgentSpawnWorkflow,\n];\n\n/**\n * Register all workflows with the event bus\n */\nexport function registerWorkflows(hub: IntegrationHub): void {\n  const eventBus = hub.getEventBus();\n\n  for (const workflow of workflows) {\n    if (!workflow.enabled) continue;\n\n    eventBus.on(workflow.trigger as any, async (event) => {\n      console.log(\"[WORKFLOW] Triggered:\", workflow.name);\n\n      try {\n        await workflow.execute(hub, event.payload);\n      } catch (error) {\n        console.error(\"[WORKFLOW] Error in\", workflow.name, error);\n      }\n    });\n  }\n\n  console.log(\"[WORKFLOW] Registered\", workflows.filter((w) => w.enabled).length, \"workflows\");\n}\n\n/**\n * Get all workflows\n */\nexport function getWorkflows(): Workflow[] {\n  return workflows;\n}\n","import { CronJob } from \"cron\";\nimport { generateContentBriefsDaily, materializeContentFromBriefs } from \"../workflows/content.js\";\n\nexport class ContentScheduler {\n  private dailyBriefJob: CronJob | null = null;\n  private contentMaterializationJob: CronJob | null = null;\n\n  constructor() {\n    // Schedule daily brief generation at a specific time (e.g., 2 AM daily)\n    // In a real scenario, these schedules might be configurable.\n    this.dailyBriefJob = new CronJob(\n      \"0 2 * * *\", // 2:00 AM daily\n      async () => {\n        console.log(\"[ContentScheduler] Running daily content brief generation...\");\n        try {\n          await generateContentBriefsDaily();\n          console.log(\"[ContentScheduler] Daily content brief generation completed.\");\n        } catch (error) {\n          console.error(\"[ContentScheduler] Daily content brief generation failed:\", error);\n        }\n      },\n      null, // onComplete\n      true, // start\n      \"UTC\" // timeZone\n    );\n\n    // Schedule content materialization every 4 hours\n    this.contentMaterializationJob = new CronJob(\n      \"0 */4 * * *\", // Every 4 hours\n      async () => {\n        console.log(\"[ContentScheduler] Running content materialization...\");\n        try {\n          await materializeContentFromBriefs();\n          console.log(\"[ContentScheduler] Content materialization completed.\");\n        } catch (error) {\n          console.error(\"[ContentScheduler] Content materialization failed:\", error);\n        }\n      },\n      null, // onComplete\n      true, // start\n      \"UTC\" // timeZone\n    );\n  }\n\n  start(): void {\n    if (this.dailyBriefJob && !this.dailyBriefJob.running) {\n      this.dailyBriefJob.start();\n      console.log(\"[ContentScheduler] Daily brief generation job started.\");\n    }\n    if (this.contentMaterializationJob && !this.contentMaterializationJob.running) {\n      this.contentMaterializationJob.start();\n      console.log(\"[ContentScheduler] Content materialization job started.\");\n    }\n  }\n\n  stop(): void {\n    if (this.dailyBriefJob && this.dailyBriefJob.running) {\n      this.dailyBriefJob.stop();\n      console.log(\"[ContentScheduler] Daily brief generation job stopped.\");\n    }\n    if (this.contentMaterializationJob && this.contentMaterializationJob.running) {\n      this.contentMaterializationJob.stop();\n      console.log(\"[ContentScheduler] Content materialization job stopped.\");\n    }\n  }\n}\n\n// Singleton instance\nlet instance: ContentScheduler | null = null;\n\nexport function getContentScheduler(): ContentScheduler {\n  if (!instance) {\n    instance = new ContentScheduler();\n  }\n  return instance;\n}\n","/**\n * Integration Hub - Central coordination for all gICM engines\n *\n * Provides:\n * - Event bus for cross-engine communication\n * - Engine health monitoring\n * - REST + WebSocket API\n * - Automated workflows\n */\n\nimport { EventBus, eventBus } from \"./event-bus.js\";\nimport { EngineManager } from \"./engine-manager.js\";\nimport { ApiServer } from \"./api/server.js\";\nimport { registerWorkflows } from \"./workflows/index.js\";\nimport { getContentScheduler, ContentScheduler } from \"./scheduler/content-scheduler.js\";\n\n// Type imports for optional engines\nimport type { GicmBrain } from \"@gicm/orchestrator\";\nimport type { MoneyEngine } from \"@gicm/money-engine\";\nimport type { GrowthEngine } from \"@gicm/growth-engine\";\nimport type { ProductEngine } from \"@gicm/product-engine\";\nimport type { Opus67 } from \"@gicm/opus67\";\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\nexport interface IntegrationHubConfig {\n  apiPort?: number;\n  apiHost?: string;\n  enableWorkflows?: boolean;\n  enableHealthChecks?: boolean;\n}\n\nexport interface HubStatus {\n  running: boolean;\n  startedAt: number | null;\n  apiPort: number;\n  engines: ReturnType<EngineManager[\"getAggregatedStatus\"]>;\n  workflows: number;\n}\n\n// ============================================================================\n// INTEGRATION HUB\n// ============================================================================\n\nexport class IntegrationHub {\n  private config: Required<IntegrationHubConfig>;\n  private eventBusInstance: EventBus;\n  private engineManager: EngineManager;\n  private apiServer: ApiServer;\n  private contentScheduler: ContentScheduler;\n  private running = false;\n  private startedAt: number | null = null;\n\n  // Engine references (optional)\n  private brain?: GicmBrain;\n  private moneyEngine?: MoneyEngine;\n  private growthEngine?: GrowthEngine;\n  private productEngine?: ProductEngine;\n  private opus67?: Opus67;\n\n  constructor(config?: IntegrationHubConfig) {\n    this.config = {\n      apiPort: config?.apiPort ?? 3001,  // Dashboard expects 3001\n      apiHost: config?.apiHost ?? \"0.0.0.0\",\n      enableWorkflows: config?.enableWorkflows ?? true,\n      enableHealthChecks: config?.enableHealthChecks ?? true,\n    };\n\n    this.eventBusInstance = eventBus;\n    this.engineManager = new EngineManager(this.eventBusInstance);\n    this.apiServer = new ApiServer(this, {\n      port: this.config.apiPort,\n      host: this.config.apiHost,\n    });\n    this.contentScheduler = getContentScheduler();\n  }\n\n  // =========================================================================\n  // LIFECYCLE\n  // =========================================================================\n\n  /**\n   * Start the integration hub\n   */\n  async start(): Promise<void> {\n    if (this.running) {\n      console.log(\"[HUB] Already running\");\n      return;\n    }\n\n    console.log(\"[HUB] Starting Integration Hub...\");\n\n    // Start health checks\n    if (this.config.enableHealthChecks) {\n      this.engineManager.startHealthChecks();\n    }\n\n    // Register workflows\n    if (this.config.enableWorkflows) {\n      registerWorkflows(this);\n    }\n\n    // Start API server\n    await this.apiServer.start();\n\n    // Start Content Scheduler\n    this.contentScheduler.start();\n\n    this.running = true;\n    this.startedAt = Date.now();\n\n    console.log(\"[HUB] Integration Hub started on port\", this.config.apiPort);\n    this.eventBusInstance.publish(\"hub\", \"engine.started\", { engine: \"hub\" });\n  }\n\n  /**\n   * Stop the integration hub\n   */\n  async stop(): Promise<void> {\n    if (!this.running) {\n      console.log(\"[HUB] Not running\");\n      return;\n    }\n\n    console.log(\"[HUB] Stopping Integration Hub...\");\n\n    // Stop health checks\n    this.engineManager.stopHealthChecks();\n\n    // Stop API server\n    await this.apiServer.stop();\n\n    // Stop Content Scheduler\n    this.contentScheduler.stop();\n\n    this.running = false;\n\n    console.log(\"[HUB] Integration Hub stopped\");\n    this.eventBusInstance.publish(\"hub\", \"engine.stopped\", { engine: \"hub\" });\n  }\n\n  // =========================================================================\n  // ENGINE CONNECTIONS\n  // =========================================================================\n\n  /**\n   * Connect the Brain\n   */\n  connectBrain(brain: GicmBrain): void {\n    this.brain = brain;\n    this.engineManager.markConnected(\"brain\");\n    console.log(\"[HUB] Brain connected\");\n  }\n\n  /**\n   * Connect the Money Engine\n   */\n  connectMoneyEngine(engine: MoneyEngine): void {\n    this.moneyEngine = engine;\n    this.engineManager.markConnected(\"money\");\n    console.log(\"[HUB] Money Engine connected\");\n\n    // Wire up events\n    this.moneyEngine.on(\"trade\", (trade) => {\n      this.eventBusInstance.publish(\"money\", \"trade.executed\", {\n        id: trade.id,\n        timestamp: new Date(trade.executedAt).toISOString(),\n        engine: \"money\",\n        type: \"trade_executed\",\n        title: `${trade.side.toUpperCase()} ${trade.symbol}`,\n        description: `Executed ${trade.side} ${trade.size} ${trade.symbol} @ $${trade.price}`,\n        metrics: {\n          price: trade.price.toNumber(),\n          size: trade.size.toNumber(),\n          valueUsd: trade.valueUsd.toNumber(),\n          pnl: trade.realizedPnL?.toNumber() || 0,\n        },\n        tags: [\"trading\", trade.symbol.toLowerCase(), trade.side],\n        source: trade,\n      });\n    });\n\n    this.moneyEngine.on(\"alert\", (message) => {\n        // TODO: Handle alerts\n        console.log(`[HUB] Money Engine Alert: ${message}`);\n    });\n  }\n\n  /**\n   * Connect the Growth Engine\n   */\n  connectGrowthEngine(engine: GrowthEngine): void {\n    this.growthEngine = engine;\n    this.engineManager.markConnected(\"growth\");\n    console.log(\"[HUB] Growth Engine connected\");\n  }\n\n  /**\n   * Connect the Product Engine\n   */\n  connectProductEngine(engine: ProductEngine): void {\n    this.productEngine = engine;\n    this.engineManager.markConnected(\"product\");\n    console.log(\"[HUB] Product Engine connected\");\n  }\n\n  /**\n   * Connect OPUS67 Runtime\n   */\n  connectOpus67(runtime: Opus67): void {\n    this.opus67 = runtime;\n    this.engineManager.markConnected(\"opus67\");\n    console.log(\"[HUB] OPUS67 connected\");\n\n    // Emit boot event\n    this.eventBusInstance.publish(\"opus67\", \"opus67.boot\", {\n      mode: runtime.getMode(),\n      version: \"2.0.0\",\n    });\n  }\n\n  // =========================================================================\n  // GETTERS\n  // =========================================================================\n\n  getEventBus(): EventBus {\n    return this.eventBusInstance;\n  }\n\n  getEngineManager(): EngineManager {\n    return this.engineManager;\n  }\n\n  getBrain(): GicmBrain | undefined {\n    return this.brain;\n  }\n\n  getMoneyEngine(): MoneyEngine | undefined {\n    return this.moneyEngine;\n  }\n\n  getGrowthEngine(): GrowthEngine | undefined {\n    return this.growthEngine;\n  }\n\n  getProductEngine(): ProductEngine | undefined {\n    return this.productEngine;\n  }\n\n  getOpus67(): Opus67 | undefined {\n    return this.opus67;\n  }\n\n  /**\n   * Get hub status\n   */\n  getStatus(): HubStatus {\n    return {\n      running: this.running,\n      startedAt: this.startedAt,\n      apiPort: this.config.apiPort,\n      engines: this.engineManager.getAggregatedStatus(),\n      workflows: this.config.enableWorkflows ? 6 : 0, // +2 for content scheduler workflows\n    };\n  }\n}\n\n// ============================================================================\n// SINGLETON ACCESS\n// ============================================================================\n\nlet hubInstance: IntegrationHub | null = null;\n\n/**\n * Set the global hub instance (called from CLI when starting)\n */\nexport function setHubInstance(hub: IntegrationHub): void {\n  hubInstance = hub;\n}\n\n/**\n * Get the global hub instance for engines to emit events\n * Returns a simplified interface for engine event emission\n */\nexport function getHub(): {\n  engineStarted(name: string): void;\n  heartbeat(name: string): void;\n  publish(source: string, type: string, payload: Record<string, unknown>): void;\n} | null {\n  if (!hubInstance) return null;\n\n  const eventBus = hubInstance.getEventBus();\n\n  return {\n    engineStarted: (name: string) => {\n      eventBus.publish(name, \"engine.started\", { engine: name, timestamp: Date.now() });\n    },\n    heartbeat: (name: string) => {\n      eventBus.publish(name, \"engine.heartbeat\", { engine: name, timestamp: Date.now() });\n    },\n    publish: (source: string, type: string, payload: Record<string, unknown>) => {\n      eventBus.publish(source, type, payload);\n    },\n  };\n}\n"],"mappings":";AAMA,OAAO,kBAAkB;AA2FlB,IAAM,WAAN,cAAuB,aAA6B;AAAA,EACjD,WAAuB,CAAC;AAAA,EACxB,aAAa;AAAA;AAAA;AAAA;AAAA,EAKrB,KACE,UACG,MACM;AACT,UAAM,WAAW,KAAK,CAAC;AAGvB,SAAK,SAAS,KAAK,QAAQ;AAC3B,QAAI,KAAK,SAAS,SAAS,KAAK,YAAY;AAC1C,WAAK,SAAS,MAAM;AAAA,IACtB;AAGA,UAAM,SAAS,MAAM,KAAK,OAAO,GAAG,IAAI;AAGxC,UAAM,KAAK,KAAK,QAAQ;AAExB,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,QACE,QACA,MACA,UAAmC,CAAC,GAC9B;AACN,UAAM,WAAW,KAAK,MAAM,GAAG,EAAE,CAAC;AAElC,UAAM,QAAkB;AAAA,MACtB,IAAI,gBAAgB;AAAA,MACpB,WAAW,KAAK,IAAI;AAAA,MACpB;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAEA,SAAK,KAAK,MAAM,KAAK;AAAA,EACvB;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,UACE,QACA,MACA,SACM;AACN,SAAK,GAAG,MAAM,CAAC,UAAU;AAGvB,cAAQ,KAAK;AAAA,IACf,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,gBAAgB,QAAQ,IAAgB;AACtC,WAAO,KAAK,SAAS,MAAM,CAAC,KAAK;AAAA,EACnC;AAAA;AAAA;AAAA;AAAA,EAKA,oBAAoB,UAAyB,QAAQ,IAAgB;AACnE,WAAO,KAAK,SACT,OAAO,CAAC,MAAM,EAAE,aAAa,QAAQ,EACrC,MAAM,CAAC,KAAK;AAAA,EACjB;AAAA;AAAA;AAAA;AAAA,EAKA,WAAiB;AACf,SAAK,WAAW,CAAC;AAAA,EACnB;AACF;AAEA,SAAS,kBAA0B;AACjC,SAAO,KAAK,IAAI,EAAE,SAAS,IAAI,MAAM,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,GAAG,CAAC;AAC5E;AAGO,IAAM,WAAW,IAAI,SAAS;;;ACjK9B,IAAM,gBAAN,MAAoB;AAAA,EACjB;AAAA,EACA,UAAuC,oBAAI,IAAI;AAAA,EAC/C;AAAA,EACA;AAAA,EAER,YAAYA,WAAoB,QAA8B;AAC5D,SAAK,WAAWA;AAChB,SAAK,SAAS;AAAA,MACZ,qBAAqB,QAAQ,uBAAuB;AAAA,MACpD,kBAAkB,QAAQ,oBAAoB;AAAA,IAChD;AAGA,UAAM,YAAwB,CAAC,SAAS,SAAS,UAAU,WAAW,WAAW,QAAQ;AACzF,eAAW,MAAM,WAAW;AAC1B,WAAK,QAAQ,IAAI,IAAI;AAAA,QACnB;AAAA,QACA,WAAW;AAAA,QACX,eAAe;AAAA,QACf,QAAQ;AAAA,MACV,CAAC;AAAA,IACH;AAGA,SAAK,SAAS,GAAG,oBAAoB,CAAC,UAAU;AAC9C,YAAM,WAAW,MAAM;AACvB,WAAK,gBAAgB,QAAQ;AAAA,IAC/B,CAAC;AAGD,SAAK,SAAS,GAAG,kBAAkB,CAAC,UAAU;AAC5C,YAAM,WAAW,MAAM;AACvB,WAAK,cAAc,QAAQ;AAAA,IAC7B,CAAC;AAED,SAAK,SAAS,GAAG,kBAAkB,CAAC,UAAU;AAC5C,YAAM,WAAW,MAAM;AACvB,WAAK,iBAAiB,QAAQ;AAAA,IAChC,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,oBAA0B;AACxB,SAAK,mBAAmB,YAAY,MAAM;AACxC,WAAK,gBAAgB;AAAA,IACvB,GAAG,KAAK,OAAO,mBAAmB;AAAA,EACpC;AAAA;AAAA;AAAA;AAAA,EAKA,mBAAyB;AACvB,QAAI,KAAK,kBAAkB;AACzB,oBAAc,KAAK,gBAAgB;AACnC,WAAK,mBAAmB;AAAA,IAC1B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,gBAAgB,UAA0B;AACxC,UAAM,SAAS,KAAK,QAAQ,IAAI,QAAQ;AACxC,QAAI,QAAQ;AACV,aAAO,gBAAgB,KAAK,IAAI;AAChC,aAAO,YAAY;AACnB,aAAO,SAAS;AAChB,aAAO,QAAQ;AAAA,IACjB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,cAAc,UAA0B;AACtC,UAAM,SAAS,KAAK,QAAQ,IAAI,QAAQ;AACxC,QAAI,QAAQ;AACV,aAAO,YAAY;AACnB,aAAO,gBAAgB,KAAK,IAAI;AAChC,aAAO,SAAS;AAChB,aAAO,QAAQ;AAAA,IACjB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,iBAAiB,UAA0B;AACzC,UAAM,SAAS,KAAK,QAAQ,IAAI,QAAQ;AACxC,QAAI,QAAQ;AACV,aAAO,YAAY;AACnB,aAAO,SAAS;AAAA,IAClB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,UAAU,UAAoB,OAAqB;AACjD,UAAM,SAAS,KAAK,QAAQ,IAAI,QAAQ;AACxC,QAAI,QAAQ;AACV,aAAO,SAAS;AAChB,aAAO,QAAQ;AAAA,IACjB;AAEA,SAAK,SAAS,QAAQ,UAAU,gBAAgB,EAAE,MAAM,CAAC;AAAA,EAC3D;AAAA;AAAA;AAAA;AAAA,EAKQ,kBAAwB;AAC9B,UAAM,MAAM,KAAK,IAAI;AAErB,eAAW,CAAC,IAAI,MAAM,KAAK,KAAK,SAAS;AACvC,UAAI,OAAO,aAAa,OAAO,eAAe;AAC5C,cAAM,qBAAqB,MAAM,OAAO;AAExC,YAAI,qBAAqB,KAAK,OAAO,kBAAkB;AACrD,iBAAO,SAAS;AAChB,iBAAO,QAAQ;AAAA,QACjB;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,eAA+B;AAC7B,WAAO,MAAM,KAAK,KAAK,QAAQ,OAAO,CAAC;AAAA,EACzC;AAAA;AAAA;AAAA;AAAA,EAKA,UAAU,UAA8C;AACtD,WAAO,KAAK,QAAQ,IAAI,QAAQ;AAAA,EAClC;AAAA;AAAA;AAAA;AAAA,EAKA,sBAKE;AACA,QAAI,UAAU;AACd,QAAI,WAAW;AACf,QAAI,UAAU;AAEd,eAAW,UAAU,KAAK,QAAQ,OAAO,GAAG;AAC1C,cAAQ,OAAO,QAAQ;AAAA,QACrB,KAAK;AACH;AACA;AAAA,QACF,KAAK;AACH;AACA;AAAA,QACF,KAAK;AACH;AACA;AAAA,MACJ;AAAA,IACF;AAEA,WAAO,EAAE,SAAS,UAAU,SAAS,OAAO,KAAK,QAAQ,KAAK;AAAA,EAChE;AACF;;;AC3MA,SAAS,gBAAAC,qBAAoB;AAW7B,IAAM,mBAAmB,oBAAI,IAA8B;AAE3D,IAAM,eAAe,CAAC,KAAa,eAAuB;AACtD,UAAQ,IAAI,0DAA0D,GAAG,EAAE;AAG3E,QAAM,qBAAqB,CAAC,WAAmB,cAA4B,SAAS;AAChF,UAAM,eAAe,MAAM;AACvB,UAAI,gBAAgB,KAAM,QAAO;AACjC,UAAI,CAAC,iBAAiB,IAAI,SAAS,EAAG,QAAO,CAAC;AAC9C,aAAO,MAAM,KAAK,iBAAiB,IAAI,SAAS,EAAG,OAAO,CAAC;AAAA,IAC/D;AAEA,WAAO;AAAA,MACH,QAAQ,OAAO,SAAc;AACzB,gBAAQ,IAAI,kDAAkD,SAAS,IAAI,IAAI;AAC/E,YAAI,CAAC,iBAAiB,IAAI,SAAS,EAAG,kBAAiB,IAAI,WAAW,oBAAI,IAAI,CAAC;AAC/E,cAAM,QAAQ,iBAAiB,IAAI,SAAS;AAC5C,cAAM,KAAK,KAAK,MAAM,QAAQ,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,GAAG,CAAC,CAAC;AAClF,cAAM,IAAI,IAAI,EAAE,GAAG,MAAM,GAAG,CAAC;AAC7B,eAAO,EAAE,MAAM,CAAC,EAAE,GAAG,CAAC,GAAG,OAAO,KAAK;AAAA,MACzC;AAAA,MACA,QAAQ,OAAO,MAAW,EAAE,WAAW,MAA8B;AACjE,gBAAQ,IAAI,kDAAkD,SAAS,gBAAgB,UAAU,IAAI,IAAI;AACzG,YAAI,CAAC,iBAAiB,IAAI,SAAS,EAAG,kBAAiB,IAAI,WAAW,oBAAI,IAAI,CAAC;AAC/E,cAAM,QAAQ,iBAAiB,IAAI,SAAS;AAC5C,cAAM,KAAK,KAAK,MAAM,QAAQ,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,GAAG,CAAC,CAAC;AAClF,cAAM,IAAI,IAAI,EAAE,GAAG,MAAM,GAAG,CAAC;AAC7B,eAAO,EAAE,MAAM,CAAC,EAAE,GAAG,CAAC,GAAG,OAAO,KAAK;AAAA,MACzC;AAAA,MACA,QAAQ,CAAC,YAAoB;AACzB,gBAAQ,IAAI,6CAA6C,OAAO,SAAS,SAAS,EAAE;AACpF,eAAO,mBAAmB,WAAW,aAAa,CAAC;AAAA,MACvD;AAAA,MACA,IAAI,CAAC,QAAgB,UAAe;AAChC,gBAAQ,IAAI,sCAAsC,MAAM,MAAM,KAAK,EAAE;AACrE,cAAM,WAAW,aAAa,EAAE,OAAO,UAAQ,KAAK,MAAM,MAAM,KAAK;AAErE,eAAO,EAAE,MAAM,UAAU,OAAO,MAAM,GAAG,mBAAmB,WAAW,QAAQ,EAAE;AAAA,MACrF;AAAA,MACA,KAAK,CAAC,QAAgB,UAAe;AACjC,gBAAQ,IAAI,uCAAuC,MAAM,OAAO,KAAK,EAAE;AACvE,cAAM,WAAW,aAAa,EAAE;AAAA,UAAO,UACnC,IAAI,KAAK,KAAK,MAAM,CAAC,EAAE,QAAQ,KAAK,IAAI,KAAK,KAAK,EAAE,QAAQ;AAAA,QAChE;AACA,eAAO,mBAAmB,WAAW,QAAQ;AAAA,MACjD;AAAA,MACA,QAAQ,CAAC,QAAgB,UAAkB,UAAe;AACtD,gBAAQ,IAAI,6CAA6C,MAAM,IAAI,QAAQ,IAAI,KAAK,EAAE;AACtF,cAAM,WAAW,aAAa,EAAE,OAAO,UAAQ;AAC3C,cAAI,aAAa,MAAO,QAAO,IAAI,KAAK,KAAK,MAAM,CAAC,EAAE,QAAQ,KAAK,IAAI,KAAK,KAAK,EAAE,QAAQ;AAC3F,cAAI,aAAa,KAAM,QAAO,KAAK,MAAM,MAAM;AAC/C,iBAAO;AAAA,QACX,CAAC;AACD,eAAO,EAAE,MAAM,UAAU,OAAO,MAAM,GAAG,mBAAmB,WAAW,QAAQ,EAAE;AAAA,MACrF;AAAA,MACA,OAAO,CAAC,QAAgB,EAAE,YAAY,KAAK,IAA6B,CAAC,MAAM;AAC3E,gBAAQ,IAAI,+CAA+C,MAAM,IAAI,YAAY,QAAQ,MAAM,EAAE;AACjG,cAAM,SAAS,CAAC,GAAG,aAAa,CAAC,EAAE,KAAK,CAAC,GAAG,MAAM;AAC9C,gBAAM,OAAO,IAAI,KAAK,EAAE,MAAM,CAAC,EAAE,QAAQ;AACzC,gBAAM,OAAO,IAAI,KAAK,EAAE,MAAM,CAAC,EAAE,QAAQ;AACzC,iBAAO,YAAY,OAAO,OAAO,OAAO;AAAA,QAC5C,CAAC;AACD,eAAO,EAAE,MAAM,QAAQ,OAAO,MAAM,GAAG,mBAAmB,WAAW,MAAM,EAAE;AAAA,MACjF;AAAA,MACA,OAAO,CAAC,UAAkB;AACtB,gBAAQ,IAAI,+CAA+C,KAAK,EAAE;AAClE,cAAM,UAAU,aAAa,EAAE,MAAM,GAAG,KAAK;AAC7C,eAAO,EAAE,MAAM,SAAS,OAAO,KAAK;AAAA,MACxC;AAAA;AAAA,MAEA,MAAM,CAAC,YAA4D;AAC/D,gBAAQ,EAAE,MAAM,aAAa,GAAG,OAAO,KAAK,CAAC;AAAA,MACjD;AAAA,IACJ;AAAA,EACJ;AAEA,SAAO;AAAA,IACH,MAAM,CAAC,cAAsB,mBAAmB,SAAS;AAAA,EAC7D;AACJ;AAkGO,IAAM,iBAAN,cAA6BA,cAAmC;AAAA,EAC7D;AAAA,EACA,WAAkC;AAAA,EAClC,cAAc;AAAA;AAAA,EAGd,SAAmC,oBAAI,IAAI;AAAA,EAC3C,OAA+B,oBAAI,IAAI;AAAA,EACvC,SAAoC,oBAAI,IAAI;AAAA,EAC5C,WAAwC,oBAAI,IAAI;AAAA,EAChD,UAA2C,oBAAI,IAAI;AAAA,EAE3D,YAAY,SAA+B,CAAC,GAAG;AAC7C,UAAM;AACN,SAAK,SAAS;AAAA,MACZ,kBAAkB;AAAA,MAClB,GAAG;AAAA,IACL;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aAA+B;AACnC,QAAI,KAAK,OAAO,OAAO,KAAK,OAAO,YAAY;AAC7C,UAAI;AACF,aAAK,WAAW,aAAa,KAAK,OAAO,KAAK,KAAK,OAAO,UAAU;AAKpE,aAAK,cAAc;AACnB,aAAK,KAAK,WAAW;AACrB,gBAAQ,IAAI,yCAAyC;AACrD,eAAO;AAAA,MACT,SAAS,OAAO;AACd,gBAAQ,MAAM,gDAAgD,KAAK;AACnE,aAAK,cAAc;AACnB,aAAK,KAAK,SAAS,iBAAiB,QAAQ,QAAQ,IAAI,MAAM,OAAO,KAAK,CAAC,CAAC;AAAA,MAC9E;AAAA,IACF;AAEA,QAAI,KAAK,OAAO,oBAAoB,CAAC,KAAK,aAAa;AACrD,cAAQ,KAAK,gEAAgE;AAC7E,WAAK,cAAc;AACnB,aAAO;AAAA,IACT;AACA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,IAAI,YAAqB;AACvB,WAAO,KAAK;AAAA,EACd;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,gBAAgB,OAAmC;AACvD,QAAI,KAAK,eAAe,KAAK,UAAU;AACrC,YAAM,EAAE,MAAM,IAAI,MAAM,KAAK,SAAS,KAAK,eAAe,EAAE,OAAO,OAAO,EAAE,YAAY,KAAK,CAAC;AAC9F,UAAI,OAAO;AACT,gBAAQ,MAAM,qDAAqD,KAAK;AAExE,YAAI,KAAK,OAAO,iBAAkB,MAAK,OAAO,IAAI,MAAM,IAAI,KAAK;AAAA,YAC5D,OAAM;AAAA,MACb;AAAA,IACF,OAAO;AACL,WAAK,OAAO,IAAI,MAAM,IAAI,KAAK;AAAA,IACjC;AACA,SAAK,KAAK,eAAe,KAAK;AAAA,EAChC;AAAA,EAEA,MAAM,qBAAqB,OAAqC;AAC9D,QAAI,KAAK,eAAe,KAAK,UAAU;AACrC,YAAM,EAAE,MAAM,MAAM,IAAI,MAAM,KAAK,SAChC,KAAK,eAAe,EACpB,OAAO,GAAG,EACV,IAAI,aAAa,MAAM,YAAY,CAAC,EACpC,MAAM,aAAa,EAAE,WAAW,MAAM,CAAC;AAC1C,UAAI,OAAO;AACT,gBAAQ,MAAM,0DAA0D,KAAK;AAE7E,YAAI,KAAK,OAAO,kBAAkB;AAC9B,gBAAM,YAAY,MAAM,QAAQ;AAChC,iBAAO,MAAM,KAAK,KAAK,OAAO,OAAO,CAAC,EACjC,OAAO,CAAC,MAAM,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,KAAK,SAAS,EAC1D,KAAK,CAAC,GAAG,MAAM,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,IAAI,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,CAAC;AAAA,QACzF;AACA,cAAM;AAAA,MACR;AACA,aAAO;AAAA,IACT,OAAO;AACL,YAAM,YAAY,MAAM,QAAQ;AAChC,aAAO,MAAM,KAAK,KAAK,OAAO,OAAO,CAAC,EACnC,OAAO,CAAC,MAAM,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,KAAK,SAAS,EAC1D,KAAK,CAAC,GAAG,MAAM,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,IAAI,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,CAAC;AAAA,IACrF;AAAA,EACF;AAAA,EAEA,MAAM,cAAc,KAA+B;AACjD,QAAI,KAAK,eAAe,KAAK,UAAU;AACnC,YAAM,EAAE,MAAM,IAAI,MAAM,KAAK,SAAS,KAAK,aAAa,EAAE,OAAO,KAAK,EAAE,YAAY,KAAK,CAAC;AAC1F,UAAI,OAAO;AACT,gBAAQ,MAAM,mDAAmD,KAAK;AACtE,YAAI,KAAK,OAAO,iBAAkB,MAAK,KAAK,IAAI,IAAI,IAAI,GAAG;AAAA,YACtD,OAAM;AAAA,MACb;AAAA,IACJ,OAAO;AACH,WAAK,KAAK,IAAI,IAAI,IAAI,GAAG;AAAA,IAC7B;AAAA,EACF;AAAA,EAEA,MAAM,mBAAmB,OAAmC;AAC1D,QAAI,KAAK,eAAe,KAAK,UAAU;AACnC,YAAM,EAAE,MAAM,MAAM,IAAI,MAAM,KAAK,SAChC,KAAK,aAAa,EAClB,OAAO,GAAG,EACV,IAAI,cAAc,MAAM,YAAY,CAAC,EACrC,MAAM,cAAc,EAAE,WAAW,MAAM,CAAC;AAC3C,UAAI,OAAO;AACT,gBAAQ,MAAM,wDAAwD,KAAK;AAC3E,YAAI,KAAK,OAAO,kBAAkB;AAChC,gBAAM,YAAY,MAAM,QAAQ;AAChC,iBAAO,MAAM,KAAK,KAAK,KAAK,OAAO,CAAC,EACjC,OAAO,CAAC,MAAM,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,KAAK,SAAS,EAC1D,KAAK,CAAC,GAAG,MAAM,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,IAAI,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,CAAC;AAAA,QACrF;AACA,cAAM;AAAA,MACR;AACA,aAAO;AAAA,IACX,OAAO;AACL,YAAM,YAAY,MAAM,QAAQ;AAChC,aAAO,MAAM,KAAK,KAAK,KAAK,OAAO,CAAC,EACjC,OAAO,CAAC,MAAM,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,KAAK,SAAS,EAC1D,KAAK,CAAC,GAAG,MAAM,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,IAAI,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,CAAC;AAAA,IACrF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,iBAAiB,OAAoC;AACzD,QAAI,KAAK,eAAe,KAAK,UAAU;AACnC,YAAM,EAAE,MAAM,IAAI,MAAM,KAAK,SAAS,KAAK,gBAAgB,EAAE,OAAO,OAAO,EAAE,YAAY,KAAK,CAAC;AAC/F,UAAI,OAAO;AACT,gBAAQ,MAAM,sDAAsD,KAAK;AACzE,YAAI,KAAK,OAAO,iBAAkB,MAAK,OAAO,IAAI,MAAM,IAAI,KAAK;AAAA,YAC5D,OAAM;AAAA,MACb;AAAA,IACJ,OAAO;AACH,WAAK,OAAO,IAAI,MAAM,IAAI,KAAK;AAAA,IACnC;AACA,SAAK,KAAK,eAAe,KAAK;AAAA,EAChC;AAAA,EAEA,MAAM,oBAA6C;AACjD,QAAI,KAAK,eAAe,KAAK,UAAU;AAInC,YAAM,EAAE,MAAM,YAAY,OAAO,YAAY,IAAI,MAAM,KAAK,SACzD,KAAK,gBAAgB,EACrB,OAAO,GAAG;AACb,UAAI,aAAa;AACf,gBAAQ,MAAM,sEAAsE,WAAW;AAC/F,YAAI,KAAK,OAAO,kBAAkB;AAChC,gBAAMC,mBAAkB,IAAI,IAAI,MAAM,KAAK,KAAK,SAAS,OAAO,CAAC,EAAE,IAAI,OAAK,EAAE,OAAO,CAAC;AACtF,iBAAO,MAAM,KAAK,KAAK,OAAO,OAAO,CAAC,EAAE,OAAO,OAAK,CAACA,iBAAgB,IAAI,EAAE,EAAE,CAAC;AAAA,QAChF;AACA,cAAM;AAAA,MACR;AAEA,YAAM,EAAE,MAAM,cAAc,OAAO,cAAc,IAAI,MAAM,KAAK,SAC7D,KAAK,kBAAkB,EACvB,OAAO,UAAU;AACpB,UAAI,eAAe;AACjB,gBAAQ,MAAM,wEAAwE,aAAa;AACnG,YAAI,KAAK,OAAO,kBAAkB;AAChC,gBAAMA,mBAAkB,IAAI,IAAI,MAAM,KAAK,KAAK,SAAS,OAAO,CAAC,EAAE,IAAI,OAAK,EAAE,OAAO,CAAC;AACtF,iBAAO,MAAM,KAAK,KAAK,OAAO,OAAO,CAAC,EAAE,OAAO,OAAK,CAACA,iBAAgB,IAAI,EAAE,EAAE,CAAC;AAAA,QAChF;AACA,cAAM;AAAA,MACR;AAEA,YAAM,kBAAkB,IAAI,IAAI,cAAc,IAAI,OAAK,EAAE,QAAQ,CAAC;AAClE,aAAQ,WAA8B,OAAO,OAAK,CAAC,gBAAgB,IAAI,EAAE,EAAE,CAAC;AAAA,IAEhF,OAAO;AACL,YAAM,kBAAkB,IAAI,IAAI,MAAM,KAAK,KAAK,SAAS,OAAO,CAAC,EAAE,IAAI,OAAK,EAAE,OAAO,CAAC;AACtF,aAAO,MAAM,KAAK,KAAK,OAAO,OAAO,CAAC,EAAE,OAAO,OAAK,CAAC,gBAAgB,IAAI,EAAE,EAAE,CAAC;AAAA,IAChF;AAAA,EACF;AAAA,EAEA,MAAM,SAAS,IAA+C;AAC5D,QAAI,KAAK,eAAe,KAAK,UAAU;AACnC,YAAM,EAAE,MAAM,MAAM,IAAI,MAAM,KAAK,SAChC,KAAK,gBAAgB,EACrB,OAAO,GAAG,EACV,GAAG,MAAM,EAAE;AACd,UAAI,OAAO;AACT,gBAAQ,MAAM,8CAA8C,KAAK;AACjE,YAAI,KAAK,OAAO,iBAAkB,QAAO,KAAK,OAAO,IAAI,EAAE;AAC3D,cAAM;AAAA,MACR;AACA,aAAO,OAAO,CAAC;AAAA,IACnB,OAAO;AACL,aAAO,KAAK,OAAO,IAAI,EAAE;AAAA,IAC3B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,mBAAmB,SAAwC;AAC/D,QAAI,KAAK,eAAe,KAAK,UAAU;AACnC,YAAM,EAAE,MAAM,IAAI,MAAM,KAAK,SAAS,KAAK,kBAAkB,EAAE,OAAO,SAAS,EAAE,YAAY,KAAK,CAAC;AACnG,UAAI,OAAO;AACT,gBAAQ,MAAM,wDAAwD,KAAK;AAC3E,YAAI,KAAK,OAAO,iBAAkB,MAAK,SAAS,IAAI,QAAQ,IAAI,OAAO;AAAA,YAClE,OAAM;AAAA,MACb;AAAA,IACJ,OAAO;AACH,WAAK,SAAS,IAAI,QAAQ,IAAI,OAAO;AAAA,IACzC;AACA,SAAK,KAAK,iBAAiB,OAAO;AAAA,EACpC;AAAA,EAEA,MAAM,qBAAqB,SAAwC;AAEjE,UAAM,KAAK,mBAAmB,OAAO;AACrC,SAAK,KAAK,iBAAiB,OAAO;AAAA,EACpC;AAAA,EAEA,MAAM,oBAAoB,SAAsD;AAC9E,QAAI,KAAK,eAAe,KAAK,UAAU;AACnC,YAAM,EAAE,MAAM,MAAM,IAAI,MAAM,KAAK,SAChC,KAAK,kBAAkB,EACvB,OAAO,GAAG,EACV,GAAG,YAAY,OAAO;AACzB,UAAI,OAAO;AACT,gBAAQ,MAAM,yDAAyD,KAAK;AAC5E,YAAI,KAAK,OAAO,iBAAkB,QAAO,MAAM,KAAK,KAAK,SAAS,OAAO,CAAC,EAAE,KAAK,OAAK,EAAE,YAAY,OAAO;AAC3G,cAAM;AAAA,MACR;AACA,aAAO,OAAO,CAAC;AAAA,IACnB,OAAO;AACL,aAAO,MAAM,KAAK,KAAK,SAAS,OAAO,CAAC,EAAE,KAAK,OAAK,EAAE,YAAY,OAAO;AAAA,IAC3E;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,uBAAuB,QAA2C;AACtE,QAAI,KAAK,eAAe,KAAK,UAAU;AACnC,YAAM,EAAE,MAAM,IAAI,MAAM,KAAK,SAAS,KAAK,sBAAsB,EAAE,OAAO,QAAQ,EAAE,YAAY,KAAK,CAAC;AACtG,UAAI,OAAO;AACT,gBAAQ,MAAM,4DAA4D,KAAK;AAC/E,YAAI,KAAK,OAAO,iBAAkB,MAAK,QAAQ,IAAI,OAAO,IAAI,MAAM;AAAA,YAC/D,OAAM;AAAA,MACb;AAAA,IACJ,OAAO;AACH,WAAK,QAAQ,IAAI,OAAO,IAAI,MAAM;AAAA,IACtC;AACA,SAAK,KAAK,gBAAgB,MAAM;AAAA,EAClC;AAAA,EAEA,MAAM,iCAAiC,WAA4D;AACjG,QAAI,KAAK,eAAe,KAAK,UAAU;AACnC,YAAM,EAAE,MAAM,MAAM,IAAI,MAAM,KAAK,SAChC,KAAK,sBAAsB,EAC3B,OAAO,GAAG,EACV,GAAG,cAAc,SAAS;AAC7B,UAAI,OAAO;AACT,gBAAQ,MAAM,sEAAsE,KAAK;AACzF,YAAI,KAAK,OAAO,kBAAkB;AAChC,iBAAO,MAAM,KAAK,KAAK,QAAQ,OAAO,CAAC,EAAE,KAAK,OAAK,EAAE,cAAc,SAAS;AAAA,QAC9E;AACA,cAAM;AAAA,MACR;AACA,aAAO,OAAO,CAAC;AAAA,IACnB,OAAO;AACL,aAAO,MAAM,KAAK,KAAK,QAAQ,OAAO,CAAC,EAAE,KAAK,OAAK,EAAE,cAAc,SAAS;AAAA,IAC9E;AAAA,EACF;AAAA,EAEA,MAAM,sBAAsB,IAAqD;AAC/E,QAAI,KAAK,eAAe,KAAK,UAAU;AACnC,YAAM,EAAE,OAAO,KAAK,IAAI,MAAM,KAAK,SAChC,KAAK,sBAAsB,EAC3B,OAAO,GAAG,EACV,GAAG,MAAM,EAAE;AACd,UAAI,OAAO;AACT,gBAAQ,MAAM,2DAA2D,KAAK;AAC9E,YAAI,KAAK,OAAO,iBAAkB,QAAO,KAAK,QAAQ,IAAI,EAAE;AAC5D,cAAM;AAAA,MACR;AACA,aAAO,OAAO,CAAC;AAAA,IACnB,OAAO;AACL,aAAO,KAAK,QAAQ,IAAI,EAAE;AAAA,IAC5B;AAAA,EACF;AAAA,EAEA,MAAM,+BAA+B,IAAY,QAAqD;AACpG,UAAM,SAAS,MAAM,KAAK,sBAAsB,EAAE;AAClD,QAAI,QAAQ;AACV,aAAO,SAAS;AAChB,YAAM,KAAK,uBAAuB,MAAM;AAAA,IAC1C;AAAA,EACF;AACF;AAGA,IAAI,WAAkC;AAE/B,SAAS,oBAAoC;AAClD,MAAI,CAAC,UAAU;AACb,eAAW,IAAI,eAAe;AAAA,MAC1B,KAAK,QAAQ,IAAI;AAAA,MACjB,YAAY,QAAQ,IAAI;AAAA,MACxB,kBAAkB,QAAQ,IAAI,aAAa;AAAA;AAAA,IAC/C,CAAC;AAAA,EACH;AACA,SAAO;AACT;;;AC/fA,OAAO,QAAQ;AACf,OAAO,UAAU;AACjB,SAAS,qBAAqB;AAG9B,IAAM,aAAa,cAAc,YAAY,GAAG;AAChD,IAAM,YAAY,KAAK,QAAQ,UAAU;AACzC,IAAM,cAAc,KAAK,QAAQ,WAAW,eAAe;AAkB3D,SAAS,eAAiC;AACxC,QAAM,eAAe,QAAQ,IAAI;AACjC,QAAM,YAAY,QAAQ,IAAI;AAC9B,QAAM,YAAY,QAAQ,IAAI;AAE9B,MAAI,cAAc;AAChB,WAAO;AAAA,MACL,UAAU;AAAA,MACV,QAAQ;AAAA,MACR,OAAO,QAAQ,IAAI,mBAAmB;AAAA,IACxC;AAAA,EACF;AACA,MAAI,WAAW;AACb,WAAO;AAAA,MACL,UAAU;AAAA,MACV,QAAQ;AAAA,MACR,OAAO,QAAQ,IAAI,gBAAgB;AAAA,IACrC;AAAA,EACF;AACA,MAAI,WAAW;AACb,WAAO;AAAA,MACL,UAAU;AAAA,MACV,QAAQ;AAAA,MACR,OAAO,QAAQ,IAAI,gBAAgB;AAAA,IACrC;AAAA,EACF;AACA,SAAO;AACT;AAMA,eAAe,YACb,cACA,WACA,QACiB;AACjB,MAAI,OAAO,aAAa,aAAa;AACnC,UAAM,WAAW,MAAM,MAAM,yCAAyC;AAAA,MACpE,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,aAAa,OAAO;AAAA,QACpB,qBAAqB;AAAA,MACvB;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,OAAO,OAAO;AAAA,QACd,YAAY;AAAA,QACZ,aAAa;AAAA,QACb,QAAQ;AAAA,QACR,UAAU,CAAC,EAAE,MAAM,QAAQ,SAAS,UAAU,CAAC;AAAA,MACjD,CAAC;AAAA,IACH,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AAChB,YAAM,QAAQ,MAAM,SAAS,KAAK;AAClC,YAAM,IAAI,MAAM,wBAAwB,SAAS,MAAM,MAAM,KAAK,EAAE;AAAA,IACtE;AAEA,UAAM,OAAO,MAAM,SAAS,KAAK;AACjC,WAAO,KAAK,QAAQ,CAAC,GAAG,QAAQ;AAAA,EAClC;AAEA,MAAI,OAAO,aAAa,UAAU;AAChC,UAAM,WAAW,MAAM,MAAM,8CAA8C;AAAA,MACzE,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,eAAe,UAAU,OAAO,MAAM;AAAA,MACxC;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,OAAO,OAAO;AAAA,QACd,UAAU;AAAA,UACR,EAAE,MAAM,UAAU,SAAS,aAAa;AAAA,UACxC,EAAE,MAAM,QAAQ,SAAS,UAAU;AAAA,QACrC;AAAA,QACA,aAAa;AAAA,QACb,YAAY;AAAA,MACd,CAAC;AAAA,IACH,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AAChB,YAAM,QAAQ,MAAM,SAAS,KAAK;AAClC,YAAM,IAAI,MAAM,qBAAqB,SAAS,MAAM,MAAM,KAAK,EAAE;AAAA,IACnE;AAEA,UAAM,OAAO,MAAM,SAAS,KAAK;AACjC,WAAO,KAAK,QAAQ,CAAC,GAAG,SAAS,WAAW;AAAA,EAC9C;AAEA,MAAI,OAAO,aAAa,UAAU;AAChC,UAAM,MAAM,2DAA2D,OAAO,KAAK,wBAAwB,OAAO,MAAM;AACxH,UAAM,WAAW,MAAM,MAAM,KAAK;AAAA,MAChC,QAAQ;AAAA,MACR,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,MAC9C,MAAM,KAAK,UAAU;AAAA,QACnB,UAAU,CAAC,EAAE,MAAM,QAAQ,OAAO,CAAC,EAAE,MAAM,UAAU,CAAC,EAAE,CAAC;AAAA,QACzD,mBAAmB,EAAE,OAAO,CAAC,EAAE,MAAM,aAAa,CAAC,EAAE;AAAA,QACrD,kBAAkB,EAAE,aAAa,KAAK,iBAAiB,KAAK;AAAA,MAC9D,CAAC;AAAA,IACH,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AAChB,YAAM,QAAQ,MAAM,SAAS,KAAK;AAClC,YAAM,IAAI,MAAM,qBAAqB,SAAS,MAAM,MAAM,KAAK,EAAE;AAAA,IACnE;AAEA,UAAM,OAAO,MAAM,SAAS,KAAK;AACjC,WAAO,KAAK,aAAa,CAAC,GAAG,SAAS,QAAQ,CAAC,GAAG,QAAQ;AAAA,EAC5D;AAEA,QAAM,IAAI,MAAM,yBAAyB,OAAO,QAAQ,EAAE;AAC5D;AAMA,SAAS,qBAAqB,YAAoB,OAAiB;AACjE,UAAQ,IAAI,+CAA+C,UAAU,EAAE;AAEvE,MAAI,eAAe,8BAA8B;AAC/C,UAAM,UAAU,SAAS,KAAK,IAAI,CAAC;AACnC,UAAM,UACJ,MAAM,OAAO,SAAS,IAClB,iBAAiB,MAAM,OAAO,CAAC,EAAE,MAAM,cAAc,MAAM,OAAO,CAAC,EAAE,KAAK,KAC1E;AAEN,WAAO;AAAA,MACL;AAAA,QACE,IAAI;AAAA,QACJ,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,QAClC,aAAa;AAAA,QACb,gBAAgB;AAAA,QAChB,iBAAiB;AAAA,QACjB,WAAW;AAAA,QACX;AAAA,QACA,QAAQ,MAAM,OAAO,MAAM,GAAG,CAAC;AAAA,QAC/B,MAAM,MAAM,MAAM,MAAM,GAAG,CAAC,KAAK,CAAC;AAAA,QAClC,eAAe,MAAM,iBAAiB,EAAE,OAAO,iBAAiB;AAAA,QAChE,cAAc;AAAA,QACd,gBAAgB,CAAC,QAAQ,YAAY,SAAS;AAAA,QAC9C,YAAY;AAAA,QACZ,cAAc,CAAC,QAAQ,aAAa,WAAW,mBAAmB,KAAK;AAAA,MACzE;AAAA,IACF;AAAA,EACF;AAEA,MAAI,WAAW,WAAW,SAAS,GAAG;AACpC,UAAM,QAAsB;AAC5B,QAAI,QAAQ;AACZ,QAAI,OAAO;AAEX,QAAI,MAAM,mBAAmB,kBAAkB,MAAM,mBAAmB,kBAAkB;AACxF,cAAQ,kBAAkB,MAAM,OAAO;AACvC,aAAO;AAAA;AAAA;AAAA;AAAA;AACP,cAAQ;AAAA;AAAA;AAAA;AAAA;AACR,cAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IACV,WAAW,MAAM,mBAAmB,YAAY,MAAM,mBAAmB,kBAAkB;AACzF,cAAQ,WAAW,MAAM,OAAO;AAChC,aAAO;AAAA;AAAA;AAAA;AAAA;AACP,cAAQ;AAAA;AAAA;AAAA;AAAA;AACR,cAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IACV,WAAW,MAAM,mBAAmB,sBAAsB;AACxD,cAAQ,uBAAuB,MAAM,OAAO;AAC5C,aAAO;AAAA;AAAA;AAAA;AAAA;AACP,cAAQ;AAAA;AAAA;AAAA;AAAA;AACR,cAAQ;AAAA;AAAA;AAAA;AAAA;AACR,cAAQ;AAAA;AAAA;AAAA;AAAA;AAAA,IACV;AACA,WAAO,KAAK,KAAK;AAAA;AAAA,EAAO,IAAI;AAAA,EAC9B;AAEA,MAAI,eAAe,iBAAiB;AAClC,UAAM,EAAE,MAAM,IAAI;AAClB,UAAM,OAAO,MAAM,QAChB,YAAY,EACZ,QAAQ,eAAe,GAAG,EAC1B,QAAQ,YAAY,EAAE;AACzB,WAAO;AAAA,MACL,UAAU,MAAM,QAAQ,MAAM,GAAG,EAAE;AAAA,MACnC,iBAAiB,GAAG,MAAM,OAAO;AAAA,MACjC;AAAA,MACA,UAAU,CAAC,GAAI,MAAM,gBAAgB,CAAC,GAAI,MAAM,OAAO,QAAQ;AAAA,MAC/D,MAAM,CAAC,WAAW,MAAM,OAAO,KAAK,wBAAwB;AAAA,MAC5D,eAAe,CAAC,sBAAsB,qBAAqB;AAAA,MAC3D,eAAe,CAAC;AAAA,IAClB;AAAA,EACF;AAEA,MAAI,eAAe,yBAAyB;AAC1C,UAAM,EAAE,iBAAiB,KAAK,MAAM,IAAI;AACxC,UAAM,YAAY,gBAAgB,MAAM,IAAI,EAAE,CAAC,EAAE,QAAQ,MAAM,EAAE;AACjE,WAAO;AAAA,MACL,UAAU,IAAI;AAAA,MACd,cAAc,yBAAyB,IAAI,IAAI;AAAA,MAC/C,UAAU;AAAA,MACV,cAAc;AAAA,MACd,YAAY;AAAA,MACZ,YAAY;AAAA,MACZ,WAAW,MAAM,mBAAmB,WAAW,kBAAkB;AAAA,MACjE,cAAc,MAAM,mBAAmB,WAAW,kBAAkB;AAAA,MACpE,eAAe;AAAA,QACb,GAAG,UAAU,MAAM,GAAG,GAAG,CAAC;AAAA,QAC1B;AAAA,QACA,gDAAgD,IAAI,IAAI;AAAA,MAC1D;AAAA,MACA,cAAc,GAAG,MAAM,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAC9B,QAAQ;AAAA,IACV;AAAA,EACF;AAEA,SAAO,CAAC;AACV;AAMA,eAAe,QACb,YACA,OACA,UAA6B,CAAC,GAChB;AACd,QAAM,aAAa,KAAK,KAAK,aAAa,GAAG,UAAU,YAAY;AACnE,MAAI;AAEJ,MAAI;AACF,oBAAgB,MAAM,GAAG,SAAS,YAAY,OAAO;AAAA,EACvD,SAAS,OAAO;AACd,YAAQ,MAAM,wCAAwC,UAAU,KAAK,KAAK;AAC1E,UAAM,IAAI,MAAM,0BAA0B,UAAU,EAAE;AAAA,EACxD;AAGA,QAAM,SAAS,QAAQ,UAAU,aAAa;AAC9C,QAAM,UAAU,QAAQ,WAAW,CAAC,UAAU,QAAQ,IAAI,qBAAqB;AAE/E,MAAI,SAAS;AACX,YAAQ,IAAI,gCAAgC,UAAU,EAAE;AACxD,WAAO,qBAAqB,YAAY,KAAK;AAAA,EAC/C;AAGA,UAAQ,IAAI,qBAAqB,OAAO,QAAQ,QAAQ,UAAU,KAAK;AAEvE,QAAM,YAAY,KAAK,UAAU,OAAO,MAAM,CAAC;AAE/C,MAAI;AACF,UAAM,WAAW,MAAM,YAAY,eAAe,WAAW,MAAM;AAGnE,QACE,eAAe,gCACf,eAAe,mBACf,eAAe,yBACf;AAEA,YAAM,YAAY,SAAS,MAAM,4BAA4B,KAC3C,SAAS,MAAM,aAAa,KAC5B,SAAS,MAAM,aAAa;AAC9C,UAAI,WAAW;AACb,cAAM,UAAU,UAAU,CAAC,KAAK,UAAU,CAAC;AAC3C,eAAO,KAAK,MAAM,OAAO;AAAA,MAC3B;AAEA,aAAO,KAAK,MAAM,QAAQ;AAAA,IAC5B;AAGA,WAAO;AAAA,EACT,SAAS,OAAO;AACd,YAAQ,MAAM,iCAAiC,UAAU,KAAK,KAAK;AACnE,YAAQ,IAAI,yCAAyC;AACrD,WAAO,qBAAqB,YAAY,KAAK;AAAA,EAC/C;AACF;AAEA,eAAsB,6BAA4C;AAChE,QAAM,UAAU,kBAAkB;AAClC,QAAM,QAAQ,WAAW;AAEzB,QAAM,QAAQ,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,KAAK,GAAI;AACvD,QAAM,SAAS,MAAM,QAAQ,qBAAqB,KAAK;AACvD,QAAM,OAAO,MAAM,QAAQ,mBAAmB,KAAK;AAEnD,UAAQ,IAAI,qCAAqC,OAAO,MAAM,eAAe,KAAK,MAAM,OAAO;AAE/F,QAAM,gBAAgB;AAAA,IACpB,QAAQ;AAAA;AAAA,IACR,OAAO;AAAA,EACT;AAKA,QAAM,QAAQ,EAAE,QAAQ,MAAM,cAAc;AAC5C,QAAM,SAAyB,MAAM,QAAQ,8BAA8B,KAAK;AAEhF,aAAW,SAAS,QAAQ;AAC1B,UAAM,QAAQ,iBAAiB,KAAK;AACpC,YAAQ,IAAI,2CAA2C,MAAM,EAAE,MAAM,MAAM,OAAO,EAAE;AAAA,EACtF;AACF;AAEA,eAAsB,+BAA8C;AAClE,QAAM,UAAU,kBAAkB;AAClC,QAAM,QAAQ,WAAW;AAEzB,QAAM,gBAAgB,MAAM,QAAQ,kBAAkB;AACtD,UAAQ,IAAI,8BAA8B,cAAc,MAAM,iBAAiB;AAE/E,aAAW,SAAS,eAAe;AAEjC,QAAI,eAAe;AACnB,QAAI,MAAM,mBAAmB,YAAY,MAAM,mBAAmB,kBAAkB;AAClF,qBAAe;AAAA,IACjB,WAAW,MAAM,mBAAmB,sBAAsB;AACxD,qBAAe;AAAA,IACjB;AAIA,UAAM,kBAAkB,MAAM,QAAQ,cAAc,KAAK;AAIzD,UAAM,MAAM,MAAM,QAAQ,iBAAiB,EAAE,iBAAiB,MAAM,CAAC;AAErE,UAAM,UAAU;AAAA,MACZ,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,MACrB,SAAS,MAAM;AAAA,MACf,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MAClC,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MAClC,UAAU;AAAA,MACV;AAAA,MACA,QAAQ;AAAA,IACZ;AAEA,UAAM,QAAQ,mBAAmB,OAAO;AAIxC,UAAM,aAAa,MAAM,QAAQ,yBAAyB,EAAE,iBAAiB,KAAK,MAAM,CAAC;AAEzF,UAAM,QAAQ,uBAAuB;AAAA,MACjC,GAAG;AAAA,MACH,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,MACrB,WAAW,QAAQ;AAAA,MACnB,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACtC,CAAC;AAED,YAAQ,IAAI,mDAAmD,MAAM,EAAE,EAAE;AAAA,EAC3E;AACF;;;ACpRO,IAAM,sBAAN,MAA0B;AAAA,EACvB;AAAA,EACA,WAA+C,oBAAI,IAAI;AAAA,EAE/D,YAAY,SAA6B,CAAC,GAAG;AAC3C,SAAK,SAAS;AAAA,MACZ,QAAQ,QAAQ,IAAI,yBAAyB;AAAA,MAC7C,GAAG;AAAA,IACL;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,WACJ,QACA,UAC+B;AAC/B,UAAM,iBAAiB,YAAY,KAAK,mBAAmB,MAAM;AACjE,UAAM,UAAgC,CAAC;AAEvC,eAAW,WAAW,gBAAgB;AACpC,UAAI;AACF,cAAM,SAAS,MAAM,KAAK,iBAAiB,QAAQ,OAAO;AAC1D,gBAAQ,KAAK,MAAM;AACnB,aAAK,cAAc,OAAO,IAAI,MAAM;AAAA,MACtC,SAAS,OAAO;AACd,cAAM,cAAkC;AAAA,UACtC;AAAA,UACA,SAAS;AAAA,UACT,OAAO,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK;AAAA,UAC5D,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,QACpC;AACA,gBAAQ,KAAK,WAAW;AACxB,aAAK,cAAc,OAAO,IAAI,WAAW;AAAA,MAC3C;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKQ,mBAAmB,QAA8C;AACvE,UAAM,WAA6B,CAAC,MAAM;AAG1C,QAAI,OAAO,aAAc,UAAS,KAAK,UAAU;AACjD,QAAI,OAAO,WAAY,UAAS,KAAK,QAAQ;AAC7C,QAAI,OAAO,WAAY,UAAS,KAAK,QAAQ;AAC7C,QAAI,OAAO,UAAW,UAAS,KAAK,OAAO;AAC3C,QAAI,OAAO,aAAc,UAAS,KAAK,UAAU;AACjD,QAAI,OAAO,aAAc,UAAS,KAAK,QAAQ;AAC/C,QAAI,OAAO,SAAU,UAAS,KAAK,KAAK;AACxC,QAAI,OAAO,YAAa,UAAS,KAAK,OAAO;AAG7C,QAAI,OAAO,cAAe,UAAS,KAAK,WAAW;AACnD,QAAI,OAAO,SAAU,UAAS,KAAK,MAAM;AACzC,QAAI,OAAO,cAAe,UAAS,KAAK,WAAW;AAGnD,QAAI,OAAO,YAAa,UAAS,KAAK,SAAS;AAC/C,QAAI,OAAO,aAAc,UAAS,KAAK,UAAU;AAGjD,QAAI,OAAO,eAAe,OAAQ,UAAS,KAAK,SAAS;AACzD,QAAI,OAAO,aAAc,UAAS,KAAK,UAAU;AACjD,QAAI,OAAO,YAAa,UAAS,KAAK,QAAQ;AAC9C,QAAI,OAAO,aAAc,UAAS,KAAK,SAAS;AAEhD,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,iBACZ,QACA,SAC6B;AAC7B,QAAI,KAAK,OAAO,QAAQ;AACtB,cAAQ,IAAI,4CAA4C,OAAO,EAAE;AACjE,aAAO;AAAA,QACL;AAAA,QACA,SAAS;AAAA,QACT,aAAa,WAAW,OAAO,gBAAgB,OAAO,QAAQ;AAAA,QAC9D,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAEA,YAAQ,SAAS;AAAA;AAAA,MAEf,KAAK;AACH,eAAO,KAAK,cAAc,MAAM;AAAA,MAClC,KAAK;AACH,eAAO,KAAK,kBAAkB,MAAM;AAAA,MACtC,KAAK;AACH,eAAO,KAAK,gBAAgB,MAAM;AAAA,MACpC,KAAK;AACH,eAAO,KAAK,gBAAgB,MAAM;AAAA,MACpC,KAAK;AACH,eAAO,KAAK,eAAe,MAAM;AAAA,MACnC,KAAK;AACH,eAAO,KAAK,kBAAkB,MAAM;AAAA,MACtC,KAAK;AACH,eAAO,KAAK,gBAAgB,MAAM;AAAA,MACpC,KAAK;AACH,eAAO,KAAK,aAAa,MAAM;AAAA,MACjC,KAAK;AACH,eAAO,KAAK,eAAe,MAAM;AAAA;AAAA,MAGnC,KAAK;AACH,eAAO,KAAK,mBAAmB,MAAM;AAAA,MACvC,KAAK;AACH,eAAO,KAAK,cAAc,MAAM;AAAA,MAClC,KAAK;AACH,eAAO,KAAK,mBAAmB,MAAM;AAAA;AAAA,MAGvC,KAAK;AACH,eAAO,KAAK,iBAAiB,MAAM;AAAA,MACrC,KAAK;AACH,eAAO,KAAK,kBAAkB,MAAM;AAAA;AAAA,MAGtC,KAAK;AACH,eAAO,KAAK,gBAAgB,MAAM;AAAA,MACpC,KAAK;AACH,eAAO,KAAK,iBAAiB,MAAM;AAAA,MACrC,KAAK;AACH,eAAO,KAAK,eAAe,MAAM;AAAA,MACnC,KAAK;AACH,eAAO,KAAK,gBAAgB,MAAM;AAAA,MAEpC;AACE,cAAM,IAAI,MAAM,wBAAwB,OAAO,EAAE;AAAA,IACrD;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAc,cAAc,QAAyD;AACnF,QAAI,CAAC,KAAK,OAAO,YAAY;AAE3B,cAAQ,IAAI,4DAA4D;AACxE,cAAQ,IAAI,iBAAiB,OAAO,QAAQ,EAAE;AAC9C,cAAQ,IAAI,mBAAmB,OAAO,UAAU,MAAM,GAAG,GAAG,CAAC,KAAK;AAElE,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,aAAa,yBAAyB,OAAO,QAAQ;AAAA,QACrD,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAEA,UAAM,WAAW,MAAM,MAAM,KAAK,OAAO,YAAY;AAAA,MACnD,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,eAAe,UAAU,KAAK,OAAO,UAAU;AAAA,MACjD;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,MAAM,OAAO;AAAA,QACb,SAAS,OAAO;AAAA,QAChB,cAAc,OAAO;AAAA,MACvB,CAAC;AAAA,IACH,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AAChB,YAAM,IAAI,MAAM,mBAAmB,SAAS,MAAM,EAAE;AAAA,IACtD;AAEA,UAAM,OAAO,MAAM,SAAS,KAAK;AACjC,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,aAAa,KAAK,OAAO,yBAAyB,OAAO,QAAQ;AAAA,MACjE,YAAY,KAAK;AAAA,MACjB,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,kBAAkB,QAAyD;AACvF,QAAI,CAAC,KAAK,OAAO,gBAAgB;AAC/B,cAAQ,IAAI,kDAAkD;AAC9D,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,OAAO;AAAA,QACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAIA,YAAQ,IAAI,6BAA6B,OAAO,QAAQ,EAAE;AAC1D,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,aAAa,+BAA+B,OAAO,QAAQ;AAAA,MAC3D,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,gBAAgB,QAAyD;AACrF,QAAI,CAAC,KAAK,OAAO,eAAe;AAC9B,cAAQ,IAAI,gDAAgD;AAC5D,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,OAAO;AAAA,QACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAGA,YAAQ,IAAI,2BAA2B,OAAO,QAAQ,EAAE;AACxD,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,aAAa,sBAAsB,KAAK,OAAO,aAAa,IAAI,OAAO,QAAQ;AAAA,MAC/E,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,gBAAgB,QAAyD;AACrF,QAAI,CAAC,KAAK,OAAO,wBAAwB;AACvC,cAAQ,IAAI,gDAAgD;AAC5D,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,OAAO;AAAA,QACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAEA,UAAM,WAAW,MAAM,MAAM,4CAA4C;AAAA,MACvE,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,eAAe,UAAU,KAAK,OAAO,sBAAsB;AAAA,MAC7D;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,OAAO,OAAO,SAAS,QAAQ,MAAM,GAAG;AAAA,QACxC,eAAe;AAAA,QACf,SAAS,OAAO;AAAA,QAChB,cAAc,OAAO;AAAA,QACrB,eAAe;AAAA;AAAA,MACjB,CAAC;AAAA,IACH,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AAChB,YAAM,QAAQ,MAAM,SAAS,KAAK;AAClC,YAAM,IAAI,MAAM,qBAAqB,SAAS,MAAM,MAAM,KAAK,EAAE;AAAA,IACnE;AAEA,UAAM,OAAO,MAAM,SAAS,KAAK;AACjC,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,aAAa,KAAK,MAAM;AAAA,MACxB,YAAY,KAAK,MAAM;AAAA,MACvB,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,eAAe,QAAyD;AACpF,QAAI,CAAC,KAAK,OAAO,eAAe,CAAC,OAAO,WAAW;AACjD,cAAQ,IAAI,8DAA8D;AAC1E,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,OAAO;AAAA,QACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAEA,UAAM,WAAW,MAAM,MAAM,+BAA+B;AAAA,MAC1D,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,WAAW,KAAK,OAAO;AAAA,MACzB;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,SAAS;AAAA,UACP,OAAO,OAAO,SAAS,QAAQ,MAAM,GAAG;AAAA,UACxC,eAAe,OAAO;AAAA,UACtB,WAAW;AAAA;AAAA,UACX,eAAe,OAAO;AAAA,UACtB,MAAM,CAAC,MAAM,UAAU,aAAa;AAAA,QACtC;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AAChB,YAAM,QAAQ,MAAM,SAAS,KAAK;AAClC,YAAM,IAAI,MAAM,qBAAqB,SAAS,MAAM,MAAM,KAAK,EAAE;AAAA,IACnE;AAEA,UAAM,OAAO,MAAM,SAAS,KAAK;AACjC,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,aAAa,KAAK;AAAA,MAClB,YAAY,KAAK,IAAI,SAAS;AAAA,MAC9B,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,kBAAkB,QAAyD;AACvF,QAAI,CAAC,KAAK,OAAO,kBAAkB,CAAC,OAAO,cAAc;AACvD,cAAQ,IAAI,gEAAgE;AAC5E,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,OAAO;AAAA,QACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAEA,UAAM,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWjB,UAAM,WAAW,MAAM,MAAM,4BAA4B;AAAA,MACvD,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,eAAe,KAAK,OAAO;AAAA,MAC7B;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,OAAO;AAAA,QACP,WAAW;AAAA,UACT,OAAO;AAAA,YACL,OAAO,OAAO,SAAS,QAAQ,MAAM,GAAG;AAAA,YACxC,iBAAiB,OAAO;AAAA,YACxB,eAAe,KAAK,OAAO;AAAA,YAC3B,oBAAoB,OAAO;AAAA,UAC7B;AAAA,QACF;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AAChB,YAAM,QAAQ,MAAM,SAAS,KAAK;AAClC,YAAM,IAAI,MAAM,uBAAuB,SAAS,MAAM,MAAM,KAAK,EAAE;AAAA,IACrE;AAEA,UAAM,OAAO,MAAM,SAAS,KAAK;AACjC,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,aAAa,KAAK,MAAM,YAAY,MAAM;AAAA,MAC1C,YAAY,KAAK,MAAM,YAAY,MAAM;AAAA,MACzC,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,gBAAgB,QAAyD;AACrF,QAAI,CAAC,KAAK,OAAO,eAAe,CAAC,OAAO,cAAc;AACpD,cAAQ,IAAI,8DAA8D;AAC1E,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,OAAO;AAAA,QACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAEA,UAAM,EAAE,aAAa,YAAY,eAAe,OAAO,IAAI,KAAK;AAChE,UAAM,WAAW,gBAAgB,OAAO,QAAQ;AAGhD,UAAM,WAAW,MAAM;AAAA,MACrB,gCAAgC,WAAW,IAAI,UAAU,aAAa,QAAQ;AAAA,MAC9E;AAAA,QACE,QAAQ;AAAA,QACR,SAAS;AAAA,UACP,QAAQ;AAAA,UACR,eAAe,SAAS,KAAK,OAAO,WAAW;AAAA,QACjD;AAAA,QACA,MAAM,KAAK,UAAU;AAAA,UACnB,SAAS,kBAAkB,OAAO,QAAQ;AAAA,UAC1C,SAAS,OAAO,KAAK,OAAO,YAAY,EAAE,SAAS,QAAQ;AAAA,UAC3D,QAAQ;AAAA,QACV,CAAC;AAAA,MACH;AAAA,IACF;AAEA,QAAI,CAAC,SAAS,IAAI;AAChB,YAAM,QAAQ,MAAM,SAAS,KAAK;AAClC,YAAM,IAAI,MAAM,qBAAqB,SAAS,MAAM,MAAM,KAAK,EAAE;AAAA,IACnE;AAEA,UAAM,OAAO,MAAM,SAAS,KAAK;AACjC,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,aAAa,KAAK,SAAS;AAAA,MAC3B,YAAY,KAAK,SAAS;AAAA,MAC1B,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,aAAa,QAAyD;AAClF,QAAI,CAAC,OAAO,UAAU;AACpB,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,OAAO;AAAA,QACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAIA,YAAQ,IAAI,sBAAsB,OAAO,SAAS,KAAK,EAAE;AAEzD,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,aAAa,OAAO,SAAS;AAAA,MAC7B,YAAY,OAAO,SAAS;AAAA,MAC5B,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,eAAe,QAAyD;AACpF,QAAI,CAAC,KAAK,OAAO,eAAe,CAAC,OAAO,aAAa;AACnD,cAAQ,IAAI,4DAA4D;AACxE,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,OAAO;AAAA,QACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAEA,UAAM,WAAW,KAAK,OAAO,iBAAiB;AAC9C,QAAI;AAEJ,YAAQ,UAAU;AAAA,MAChB,KAAK;AACH,mBAAW,MAAM,MAAM,0CAA0C;AAAA,UAC/D,QAAQ;AAAA,UACR,SAAS;AAAA,YACP,gBAAgB;AAAA,YAChB,eAAe,SAAS,KAAK,OAAO,WAAW;AAAA,UACjD;AAAA,UACA,MAAM,KAAK,UAAU;AAAA,YACnB,SAAS,OAAO,YAAY;AAAA,YAC5B,MAAM,OAAO,YAAY;AAAA,YACzB,QAAQ;AAAA;AAAA,UACV,CAAC;AAAA,QACH,CAAC;AACD;AAAA,MAEF,KAAK;AACH,mBAAW,MAAM,MAAM,gDAAgD;AAAA,UACrE,QAAQ;AAAA,UACR,SAAS;AAAA,YACP,gBAAgB;AAAA,YAChB,eAAe,UAAU,KAAK,OAAO,WAAW;AAAA,UAClD;AAAA,UACA,MAAM,KAAK,UAAU;AAAA,YACnB,MAAM,OAAO,YAAY;AAAA,YACzB,MAAM;AAAA,YACN,QAAQ;AAAA,cACN;AAAA,gBACE,SAAS,OAAO,YAAY;AAAA,gBAC5B,SAAS,OAAO,YAAY;AAAA,cAC9B;AAAA,YACF;AAAA,UACF,CAAC;AAAA,QACH,CAAC;AACD;AAAA,MAEF;AACE,cAAM,IAAI,MAAM,+BAA+B,QAAQ,EAAE;AAAA,IAC7D;AAEA,QAAI,CAAC,SAAS,IAAI;AAChB,YAAM,QAAQ,MAAM,SAAS,KAAK;AAClC,YAAM,IAAI,MAAM,oBAAoB,SAAS,MAAM,MAAM,KAAK,EAAE;AAAA,IAClE;AAEA,UAAM,OAAO,MAAM,SAAS,KAAK;AACjC,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,YAAY,KAAK;AAAA,MACjB,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,MAAc,mBAAmB,QAAyD;AACxF,QAAI,CAAC,KAAK,OAAO,mBAAmB,CAAC,KAAK,OAAO,uBAAuB,CAAC,OAAO,eAAe;AAC7F,cAAQ,IAAI,8DAA8D;AAC1E,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,OAAO;AAAA,QACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAEA,UAAM,WAAW,MAAM,MAAM,4CAA4C;AAAA,MACvE,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,WAAW,KAAK,OAAO;AAAA,MACzB;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,aAAa,KAAK,OAAO;AAAA,QACzB,MAAM,OAAO;AAAA;AAAA,QAEb,QAAQ,OAAO,eAAe,CAAC,EAAE,KAAK,OAAO,aAAa,CAAC,IAAI;AAAA,MACjE,CAAC;AAAA,IACH,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AAChB,YAAM,QAAQ,MAAM,SAAS,KAAK;AAClC,YAAM,IAAI,MAAM,wBAAwB,SAAS,MAAM,MAAM,KAAK,EAAE;AAAA,IACtE;AAEA,UAAM,OAAO,MAAM,SAAS,KAAK;AACjC,UAAM,OAAO,KAAK,MAAM;AACxB,UAAM,WAAW,KAAK,MAAM,QAAQ;AAEpC,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,aAAa,QAAQ,WAAW,wBAAwB,QAAQ,IAAI,KAAK,MAAM,GAAG,EAAE,CAAC,KAAK;AAAA,MAC1F,YAAY;AAAA,MACZ,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAc,cAAc,QAAyD;AACnF,QAAI,CAAC,KAAK,OAAO,iBAAiB,CAAC,KAAK,OAAO,mBAAmB,CAAC,OAAO,UAAU;AAClF,cAAQ,IAAI,yDAAyD;AACrE,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,OAAO;AAAA,QACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAGA,UAAM,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAcjB,UAAM,WAAW,MAAM,MAAM,4BAA4B;AAAA,MACvD,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,iBAAiB,UAAU,KAAK,OAAO,eAAe;AAAA,QACtD,kBAAkB,KAAK,OAAO;AAAA,MAChC;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,OAAO;AAAA,QACP,WAAW;AAAA,UACT,SAAS;AAAA,YACP,YAAY,yBAAyB,mBAAmB,KAAK,UAAU;AAAA,cACrE,SAAS;AAAA,cACT,MAAM;AAAA,gBACJ,kBAAkB;AAAA,gBAClB,SAAS,OAAO;AAAA,gBAChB,QAAQ;AAAA,cACV;AAAA,YACF,CAAC,CAAC,CAAC;AAAA,UACL;AAAA,QACF;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AAChB,YAAM,QAAQ,MAAM,SAAS,KAAK;AAClC,YAAM,IAAI,MAAM,mBAAmB,SAAS,MAAM,MAAM,KAAK,EAAE;AAAA,IACjE;AAEA,UAAM,OAAO,MAAM,SAAS,KAAK;AACjC,UAAM,SAAS,KAAK,MAAM,aAAa;AAEvC,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,aAAa,SAAS,yBAAyB,MAAM,KAAK;AAAA,MAC1D,YAAY,UAAU,KAAK,MAAM,aAAa;AAAA,MAC9C,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAc,mBAAmB,QAAyD;AACxF,QAAI,CAAC,KAAK,OAAO,mBAAmB,CAAC,OAAO,eAAe;AACzD,cAAQ,IAAI,8DAA8D;AAC1E,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,OAAO;AAAA,QACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAEA,UAAM,WAAW,MAAM,MAAM,sCAAsC;AAAA,MACjE,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,iBAAiB,UAAU,KAAK,OAAO,eAAe;AAAA,MACxD;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,OAAO,OAAO,SAAS,QAAQ,MAAM,GAAG;AAAA,QACxC,UAAU,OAAO;AAAA,QACjB,MAAM,OAAO;AAAA,QACb,QAAQ;AAAA;AAAA,QACR,eAAe,KAAK,OAAO;AAAA,MAC7B,CAAC;AAAA,IACH,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AAChB,YAAM,QAAQ,MAAM,SAAS,KAAK;AAClC,YAAM,IAAI,MAAM,wBAAwB,SAAS,MAAM,MAAM,KAAK,EAAE;AAAA,IACtE;AAEA,UAAM,OAAO,MAAM,SAAS,KAAK;AACjC,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,aAAa,KAAK,OAAO,+BAA+B,KAAK,IAAI,KAAK;AAAA,MACtE,YAAY,KAAK;AAAA,MACjB,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,MAAc,iBAAiB,QAAyD;AACtF,QAAI,CAAC,KAAK,OAAO,iBAAiB,CAAC,KAAK,OAAO,sBAAsB,CAAC,OAAO,aAAa;AACxF,cAAQ,IAAI,4DAA4D;AACxE,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,OAAO;AAAA,QACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAGA,UAAM,kBAAkB,MAAM,MAAM,6DAA6D;AAAA,MAC/F,QAAQ;AAAA,MACR,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,MAC9C,MAAM,KAAK,UAAU;AAAA,QACnB,YAAY,KAAK,OAAO;AAAA,QACxB,UAAU,KAAK,OAAO;AAAA,MACxB,CAAC;AAAA,IACH,CAAC;AAED,QAAI,CAAC,gBAAgB,IAAI;AACvB,YAAM,QAAQ,MAAM,gBAAgB,KAAK;AACzC,YAAM,IAAI,MAAM,uBAAuB,gBAAgB,MAAM,MAAM,KAAK,EAAE;AAAA,IAC5E;AAEA,UAAM,UAAU,MAAM,gBAAgB,KAAK;AAG3C,UAAM,eAAe,MAAM,MAAM,0DAA0D;AAAA,MACzF,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,iBAAiB,UAAU,QAAQ,SAAS;AAAA,MAC9C;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,MAAM,QAAQ;AAAA,QACd,YAAY;AAAA,QACZ,QAAQ;AAAA,UACN,OAAO;AAAA,UACP,MAAM,OAAO;AAAA,UACb,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA;AAAA,UAElC,OAAO,OAAO,eAAe;AAAA,YAC3B,OAAO;AAAA,YACP,UAAU;AAAA,cACR,KAAK,OAAO;AAAA,cACZ,OAAO,OAAO,SAAS,QAAQ,MAAM,GAAG;AAAA,cACxC,aAAa,OAAO,YAAY,MAAM,GAAG,GAAG;AAAA,YAC9C;AAAA,UACF,IAAI;AAAA,QACN;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AAED,QAAI,CAAC,aAAa,IAAI;AACpB,YAAM,QAAQ,MAAM,aAAa,KAAK;AACtC,YAAM,IAAI,MAAM,uBAAuB,aAAa,MAAM,MAAM,KAAK,EAAE;AAAA,IACzE;AAEA,UAAM,WAAW,MAAM,aAAa,KAAK;AAEzC,UAAM,SAAS,SAAS,KAAK,QAAQ,SAAS,2BAA2B,EAAE,QAAQ,wBAAwB,QAAQ;AAEnH,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,aAAa;AAAA,MACb,YAAY,SAAS;AAAA,MACrB,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAc,kBAAkB,QAAyD;AACvF,QAAI,CAAC,KAAK,OAAO,oBAAoB,CAAC,KAAK,OAAO,uBAAuB,CAAC,OAAO,cAAc;AAC7F,cAAQ,IAAI,6DAA6D;AACzE,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,OAAO;AAAA,QACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAEA,UAAMC,YAAW,KAAK,OAAO,iBAAiB,QAAQ,gBAAgB,EAAE,EAAE,QAAQ,OAAO,EAAE;AAE3F,UAAM,WAAW,MAAM,MAAM,WAAWA,SAAQ,oBAAoB;AAAA,MAClE,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,iBAAiB,UAAU,KAAK,OAAO,mBAAmB;AAAA,MAC5D;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,QAAQ,OAAO;AAAA,QACf,YAAY;AAAA;AAAA,QAEZ,GAAI,OAAO,gBAAgB;AAAA,UACzB,WAAW,CAAC;AAAA;AAAA,QACd;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AAChB,YAAM,QAAQ,MAAM,SAAS,KAAK;AAClC,YAAM,IAAI,MAAM,uBAAuB,SAAS,MAAM,MAAM,KAAK,EAAE;AAAA,IACrE;AAEA,UAAM,OAAO,MAAM,SAAS,KAAK;AACjC,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,aAAa,KAAK;AAAA,MAClB,YAAY,KAAK;AAAA,MACjB,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAc,gBAAgB,QAAyD;AACrF,QAAI,CAAC,OAAO,eAAe,QAAQ;AACjC,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,OAAO;AAAA,QACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAGA,YAAQ,IAAI,gCAAgC,OAAO,cAAc,MAAM,sBAAsB;AAC7F,YAAQ,IAAI,0BAA0B,OAAO,cAAc,CAAC,CAAC,EAAE;AAE/D,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,aAAa;AAAA;AAAA,MACb,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,iBAAiB,QAAyD;AACtF,QAAI,CAAC,OAAO,cAAc;AACxB,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,OAAO;AAAA,QACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAEA,YAAQ,IAAI,qCAAqC;AACjD,YAAQ,IAAI,uBAAuB,OAAO,aAAa,MAAM,GAAG,GAAG,CAAC,KAAK;AAEzE,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,eAAe,QAAyD;AACpF,QAAI,CAAC,OAAO,aAAa;AACvB,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,OAAO;AAAA,QACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAEA,YAAQ,IAAI,oCAAoC;AAChD,YAAQ,IAAI,qBAAqB,OAAO,YAAY,MAAM,GAAG,GAAG,CAAC,KAAK;AAEtE,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,MACT,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,gBAAgB,QAAyD;AACrF,QAAI,CAAC,OAAO,cAAc;AACxB,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,OAAO;AAAA,QACP,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAAA,IACF;AAGA,YAAQ,IAAI,qCAAqC;AACjD,YAAQ,IAAI,sBAAsB,OAAO,aAAa,MAAM,GAAG,GAAG,CAAC,KAAK;AAGxE,QAAI,KAAK,OAAO,iBAAiB,KAAK,OAAO,oBAAoB;AAC/D,UAAI;AAEF,cAAM,WAAW,MAAM;AAAA,UACrB,kCAAkC,KAAK,OAAO,aAAa;AAAA,UAC3D;AAAA,YACE,QAAQ;AAAA,YACR,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,YAC9C,MAAM,KAAK,UAAU;AAAA,cACnB,YAAY;AAAA,cACZ,MAAM,OAAO;AAAA,cACb,cAAc,KAAK,OAAO;AAAA,YAC5B,CAAC;AAAA,UACH;AAAA,QACF;AAEA,YAAI,SAAS,IAAI;AACf,gBAAM,OAAO,MAAM,SAAS,KAAK;AACjC,iBAAO;AAAA,YACL,SAAS;AAAA,YACT,SAAS;AAAA,YACT,YAAY,KAAK;AAAA,YACjB,aAAa,KAAK,KAAK,yBAAyB,KAAK,EAAE,KAAK;AAAA,YAC5D,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,UACpC;AAAA,QACF;AAAA,MACF,SAAS,OAAO;AACd,gBAAQ,KAAK,kDAAkD,KAAK;AAAA,MACtE;AAAA,IACF;AAEA,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA;AAAA,MACT,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASQ,cAAc,UAAkB,QAAkC;AACxE,UAAM,UAA+B;AAAA,MACnC,IAAI,WAAW,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,GAAG,CAAC,CAAC;AAAA,MACnE;AAAA,MACA,SAAS,OAAO;AAAA,MAChB,aAAa,OAAO;AAAA,MACpB,QAAQ,OAAO,UAAU,YAAY;AAAA,MACrC,aAAa,OAAO;AAAA,MACpB,YAAY,OAAO;AAAA,MACnB,cAAc,OAAO;AAAA,MACrB,YAAY;AAAA,IACd;AAEA,UAAM,WAAW,KAAK,SAAS,IAAI,QAAQ,KAAK,CAAC;AACjD,aAAS,KAAK,OAAO;AACrB,SAAK,SAAS,IAAI,UAAU,QAAQ;AAAA,EACtC;AAAA;AAAA;AAAA;AAAA,EAKA,YAAY,UAAyC;AACnD,WAAO,KAAK,SAAS,IAAI,QAAQ,KAAK,CAAC;AAAA,EACzC;AAAA;AAAA;AAAA;AAAA,EAKA,aAIE;AACA,QAAI,gBAAgB;AACpB,UAAM,aAAa,oBAAI,IAAoB;AAC3C,UAAM,SAAS,oBAAI,IAAoB;AAEvC,eAAW,YAAY,KAAK,SAAS,OAAO,GAAG;AAC7C,iBAAW,WAAW,UAAU;AAC9B;AACA,YAAI,QAAQ,WAAW,WAAW;AAChC,qBAAW,IAAI,QAAQ,OAAO;AAAA,QAChC,OAAO;AACL,iBAAO,IAAI,QAAQ,OAAO;AAAA,QAC5B;AAAA,MACF;AAAA,IACF;AAEA,WAAO;AAAA,MACL;AAAA,MACA,oBAAoB,MAAM,KAAK,UAAU;AAAA,MACzC,gBAAgB,MAAM,KAAK,MAAM;AAAA,IACnC;AAAA,EACF;AACF;AAMA,IAAIA,YAAuC;AAEpC,SAAS,uBAAuB,QAAkD;AACvF,MAAI,CAACA,WAAU;AACb,IAAAA,YAAW,IAAI,oBAAoB;AAAA;AAAA,MAEjC,YAAY,QAAQ,IAAI;AAAA,MACxB,YAAY,QAAQ,IAAI;AAAA,MACxB,aAAa,QAAQ,IAAI;AAAA,MACzB,wBAAwB,QAAQ,IAAI;AAAA,MACpC,gBAAgB,QAAQ,IAAI;AAAA,MAC5B,uBAAuB,QAAQ,IAAI;AAAA,MACnC,aAAa,QAAQ,IAAI;AAAA,MACzB,aAAa,QAAQ,IAAI,gBAAgB;AAAA,MACzC,YAAY,QAAQ,IAAI,eAAe;AAAA,MACvC,eAAgB,QAAQ,IAAI,kBAAkB;AAAA,MAC9C,aAAa,QAAQ,IAAI;AAAA,MACzB,GAAG;AAAA,IACL,CAAC;AAAA,EACH;AACA,SAAOA;AACT;;;ACtoCA,SAAS,SAAS;AAOX,IAAM,aAAa,EAAE,KAAK,CAAC,SAAS,SAAS,UAAU,QAAQ,CAAC;AAIhE,IAAM,mBAAmB,EAAE,OAAO,EAAE,MAAM,mBAAmB;AAI7D,IAAM,qBAAqB,EAAE,KAAK;AAAA,EACvC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAIM,IAAM,mBAAmB,EAAE,KAAK;AAAA,EACrC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAQM,IAAM,gBAAgB,EAAE,KAAK,CAAC,QAAQ,OAAO,YAAY,CAAC;AAI1D,IAAM,oBAAoB,EAAE,OAAO;AAAA;AAAA,EAExC,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS;AAAA,EACnC,cAAc,EAAE,OAAO,EAAE,MAAM,mBAAmB,EAAE,SAAS;AAAA;AAAA,EAG7D,cAAc,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,QAAQ,EAAE;AAAA,EACpD,YAAY,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,QAAQ,CAAC;AAAA,EACjD,cAAc,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,QAAQ,CAAC;AAAA,EACnD,YAAY,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,QAAQ,CAAC;AAAA;AAAA,EAGjD,uBAAuB,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,QAAQ,EAAE;AAAA,EACzD,cAAc,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,QAAQ,GAAG;AAAA,EACrD,iBAAiB,EAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,EACzC,YAAY,EAAE,QAAQ,EAAE,QAAQ,KAAK;AAAA;AAAA,EAGrC,qBAAqB,EAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,EAC7C,yBAAyB,EAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,EACjD,mBAAmB,EAAE,QAAQ,EAAE,QAAQ,IAAI;AAC7C,CAAC;AAIM,IAAM,qBAAqB,EAAE,OAAO;AAAA,EACzC,IAAI,EAAE,OAAO,EAAE,KAAK;AAAA,EACpB,MAAM,EAAE,OAAO,EAAE,IAAI,CAAC,EAAE,IAAI,GAAG;AAAA,EAC/B,MAAM,EAAE,OAAO,EAAE,MAAM,cAAc,EAAE,IAAI,CAAC,EAAE,IAAI,EAAE;AAAA,EACpD,aAAa,EAAE,OAAO,EAAE,IAAI,GAAG,EAAE,SAAS;AAAA;AAAA,EAG1C,MAAM,cAAc,QAAQ,MAAM;AAAA,EAClC,cAAc,EAAE,OAAO,EAAE,MAAM,EAAE,SAAS;AAAA,EAC1C,kBAAkB,EAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAGtC,UAAU,kBAAkB,QAAQ,CAAC,CAAC;AAAA;AAAA,EAGtC,WAAW,EAAE,KAAK;AAAA,EAClB,WAAW,EAAE,KAAK;AAAA,EAClB,WAAW,EAAE,OAAO,EAAE,KAAK;AAC7B,CAAC;AAIM,IAAM,kBAAkB,mBAAmB,KAAK;AAAA,EACrD,IAAI;AAAA,EACJ,WAAW;AAAA,EACX,WAAW;AACb,CAAC,EAAE,QAAQ;AAAA,EACT,UAAU;AAAA,EACV,MAAM;AACR,CAAC;AAIM,IAAM,kBAAkB,mBAAmB,KAAK;AAAA,EACrD,IAAI;AAAA,EACJ,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AACb,CAAC,EAAE,QAAQ;AAQJ,IAAM,qBAAqB,EAAE,KAAK,CAAC,UAAU,aAAa,SAAS,CAAC;AAIpE,IAAM,kBAAkB,EAAE,OAAO;AAAA,EACtC,IAAI,EAAE,OAAO,EAAE,KAAK;AAAA,EACpB,OAAO,EAAE,OAAO,EAAE,KAAK;AAAA,EACvB,QAAQ,EAAE,OAAO,EAAE,KAAK;AAAA;AAAA,EAGxB,MAAM;AAAA,EACN,mBAAmB,EAAE,MAAM,gBAAgB,EAAE,SAAS;AAAA;AAAA;AAAA,EAGtD,OAAO,EAAE,OAAO,EAAE,MAAM;AAAA,EACxB,aAAa,EAAE,OAAO,EAAE,SAAS;AAAA,EACjC,WAAW,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS;AAAA;AAAA,EAGrC,QAAQ,mBAAmB,QAAQ,QAAQ;AAAA;AAAA,EAG3C,WAAW,EAAE,OAAO,EAAE,KAAK,EAAE,SAAS;AAAA,EACtC,WAAW,EAAE,KAAK,EAAE,SAAS;AAAA,EAC7B,UAAU,EAAE,KAAK;AAAA,EACjB,cAAc,EAAE,KAAK,EAAE,SAAS;AAClC,CAAC;AAIM,IAAM,kBAAkB,EAAE,OAAO;AAAA,EACtC,QAAQ,EAAE,OAAO,EAAE,KAAK;AAAA,EACxB,MAAM;AAAA,EACN,OAAO,EAAE,OAAO,EAAE,MAAM;AAAA,EACxB,aAAa,EAAE,OAAO,EAAE,SAAS;AAAA,EACjC,WAAW,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS;AACvC,CAAC;AAIM,IAAM,qBAAqB,EAAE,OAAO;AAAA,EACzC,MAAM,WAAW,SAAS;AAAA,EAC1B,mBAAmB,EAAE,MAAM,gBAAgB,EAAE,SAAS;AAAA,EACtD,QAAQ,mBAAmB,SAAS;AACtC,CAAC;AAQM,IAAM,qBAAqB,EAAE,KAAK,CAAC,WAAW,YAAY,WAAW,SAAS,CAAC;AAI/E,IAAM,kBAAkB,EAAE,OAAO;AAAA,EACtC,IAAI,EAAE,OAAO,EAAE,KAAK;AAAA,EACpB,OAAO,EAAE,OAAO,EAAE,KAAK;AAAA,EACvB,OAAO,EAAE,OAAO,EAAE,MAAM;AAAA,EACxB,MAAM;AAAA;AAAA,EAGN,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE;AAAA,EACxB,WAAW,EAAE,KAAK;AAAA;AAAA,EAGlB,QAAQ,mBAAmB,QAAQ,SAAS;AAAA;AAAA,EAG5C,WAAW,EAAE,OAAO,EAAE,KAAK;AAAA,EAC3B,WAAW,EAAE,KAAK;AAAA,EAClB,YAAY,EAAE,KAAK,EAAE,SAAS;AAAA,EAC9B,YAAY,EAAE,OAAO,EAAE,KAAK,EAAE,SAAS;AAAA;AAAA,EAGvC,SAAS,EAAE,OAAO,EAAE,IAAI,GAAG,EAAE,SAAS;AACxC,CAAC;AAIM,IAAM,qBAAqB,EAAE,OAAO;AAAA,EACzC,OAAO,EAAE,OAAO,EAAE,MAAM;AAAA,EACxB,MAAM,WAAW,QAAQ,QAAQ;AAAA,EACjC,SAAS,EAAE,OAAO,EAAE,IAAI,GAAG,EAAE,SAAS;AAAA,EACtC,eAAe,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,IAAI,EAAE,EAAE,QAAQ,CAAC;AAC1D,CAAC;AAQM,IAAM,wBAAwB,EAAE,OAAO;AAAA,EAC5C,QAAQ,EAAE,OAAO,EAAE,KAAK;AAAA,EACxB,OAAO,EAAE,OAAO,EAAE,KAAK;AAAA,EACvB,UAAU;AAAA,EACV,QAAQ;AAAA,EACR,YAAY,EAAE,OAAO,EAAE,SAAS;AAAA;AAClC,CAAC;AAIM,IAAM,yBAAyB,EAAE,OAAO;AAAA,EAC7C,SAAS,EAAE,QAAQ;AAAA,EACnB,QAAQ,EAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,MAAM,WAAW,SAAS;AAAA,EAC1B,WAAW,EAAE,KAAK;AACpB,CAAC;AAQM,IAAM,oBAAoB,EAAE,OAAO;AAAA,EACxC,QAAQ,EAAE,OAAO,EAAE,KAAK;AAAA,EACxB,OAAO,EAAE,OAAO,EAAE,KAAK;AAAA,EACvB,MAAM;AAAA,EACN,aAAa,EAAE,MAAM,gBAAgB;AAAA;AAAA,EAGrC,OAAO,EAAE,OAAO,EAAE,MAAM;AAAA,EACxB,aAAa,EAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAGjC,SAAS,EAAE,OAAO;AAAA,EAClB,SAAS;AACX,CAAC;AA4BM,IAAM,cAA4C;AAAA,EACvD,MAAM;AAAA,IACJ,cAAc;AAAA,IACd,YAAY;AAAA,IACZ,cAAc;AAAA,IACd,YAAY;AAAA,IACZ,uBAAuB;AAAA,IACvB,cAAc;AAAA,IACd,iBAAiB;AAAA,IACjB,YAAY;AAAA,IACZ,qBAAqB;AAAA,IACrB,yBAAyB;AAAA,IACzB,mBAAmB;AAAA,EACrB;AAAA,EACA,KAAK;AAAA,IACH,cAAc;AAAA,IACd,YAAY;AAAA,IACZ,cAAc;AAAA,IACd,YAAY;AAAA,IACZ,uBAAuB;AAAA,IACvB,cAAc;AAAA,IACd,iBAAiB;AAAA,IACjB,YAAY;AAAA,IACZ,qBAAqB;AAAA,IACrB,yBAAyB;AAAA,IACzB,mBAAmB;AAAA,EACrB;AAAA,EACA,YAAY;AAAA,IACV,cAAc;AAAA;AAAA,IACd,YAAY;AAAA,IACZ,cAAc;AAAA,IACd,YAAY;AAAA,IACZ,uBAAuB;AAAA,IACvB,cAAc;AAAA,IACd,iBAAiB;AAAA,IACjB,YAAY;AAAA,IACZ,qBAAqB;AAAA,IACrB,yBAAyB;AAAA,IACzB,mBAAmB;AAAA,EACrB;AACF;AAGO,IAAM,cAAoC;AAAA,EAC/C,QAAQ;AAAA,EACR,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,OAAO;AACT;;;ACzTO,IAAM,cAAc;AAAA;AAAA,EAEzB,qBAAqB;AAAA,EACrB,uBAAuB;AAAA,EACvB,uBAAuB;AAAA,EACvB,uBAAuB;AAAA;AAAA,EAGvB,mBAAmB;AAAA,EACnB,iBAAiB;AAAA,EACjB,mBAAmB;AAAA,EACnB,mBAAmB;AAAA,EACnB,oBAAoB;AAAA;AAAA,EAGpB,mBAAmB;AAAA,EACnB,iBAAiB;AAAA,EACjB,mBAAmB;AAAA,EACnB,mBAAmB;AAAA;AAAA,EAGnB,iBAAiB;AAAA,EACjB,eAAe;AAAA,EACf,iBAAiB;AAAA,EACjB,iBAAiB;AAAA;AAAA,EAGjB,kBAAkB;AAAA,EAClB,gBAAgB;AAAA,EAChB,kBAAkB;AAAA,EAClB,kBAAkB;AAAA;AAAA,EAGlB,oBAAoB;AAAA,EACpB,sBAAsB;AAAA,EACtB,sBAAsB;AAAA,EACtB,sBAAsB;AAAA;AAAA,EAGtB,kBAAkB;AAAA,EAClB,oBAAoB;AAAA;AAAA,EAGpB,cAAc;AAAA,EACd,gBAAgB;AAAA;AAAA,EAGhB,iBAAiB;AAAA,EACjB,mBAAmB;AAAA;AAAA,EAGnB,eAAe;AAAA,EACf,iBAAiB;AAAA,EACjB,iBAAiB;AAAA;AAAA,EAGjB,iBAAiB;AAAA,EACjB,eAAe;AAAA,EACf,iBAAiB;AACnB;AAYA,IAAM,qBAAmC;AAAA,EACvC,YAAY,mBAAmB;AAAA,EAC/B,YAAY,eAAe;AAAA,EAC3B,YAAY,eAAe;AAAA,EAC3B,YAAY,aAAa;AAAA,EACzB,YAAY,cAAc;AAAA,EAC1B,YAAY,kBAAkB;AAAA,EAC9B,YAAY,gBAAgB;AAAA,EAC5B,YAAY,eAAe;AAAA,EAC3B,YAAY,aAAa;AAAA,EACzB,YAAY,aAAa;AAC3B;AAEA,IAAM,qBAAmC;AAAA,EACvC,GAAG;AAAA,EACH,YAAY,iBAAiB;AAAA,EAC7B,YAAY,iBAAiB;AAAA,EAC7B,YAAY,kBAAkB;AAAA,EAC9B,YAAY,iBAAiB;AAAA,EAC7B,YAAY,iBAAiB;AAAA,EAC7B,YAAY,eAAe;AAAA,EAC3B,YAAY,eAAe;AAAA,EAC3B,YAAY,gBAAgB;AAAA,EAC5B,YAAY,gBAAgB;AAAA,EAC5B,YAAY,oBAAoB;AAClC;AAEA,IAAM,oBAAkC;AAAA,EACtC,GAAG;AAAA,EACH,YAAY,iBAAiB;AAAA,EAC7B,YAAY,iBAAiB;AAAA,EAC7B,YAAY,eAAe;AAAA,EAC3B,YAAY,gBAAgB;AAAA,EAC5B,YAAY,oBAAoB;AAAA,EAChC,YAAY,oBAAoB;AAAA,EAChC,YAAY,kBAAkB;AAAA,EAC9B,YAAY,YAAY;AAAA,EACxB,YAAY,cAAc;AAAA,EAC1B,YAAY,iBAAiB;AAAA,EAC7B,YAAY,eAAe;AAAA,EAC3B,YAAY,eAAe;AAAA,EAC3B,YAAY,eAAe;AAAA,EAC3B,YAAY,eAAe;AAC7B;AAEA,IAAM,oBAAkC;AAAA,EACtC,GAAG;AAAA,EACH,YAAY,qBAAqB;AAAA,EACjC,YAAY,qBAAqB;AAAA,EACjC,YAAY,qBAAqB;AACnC;AAKO,IAAM,mBAA+C;AAAA,EAC1D,QAAQ;AAAA,EACR,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,OAAO;AACT;AASO,SAAS,gBAAgB,UAAwB,QAAgC;AACtF,SAAO,GAAG,QAAQ,IAAI,MAAM;AAC9B;AAKO,SAAS,gBAAgB,YAA8D;AAC5F,QAAM,CAAC,UAAU,MAAM,IAAI,WAAW,MAAM,GAAG;AAC/C,SAAO,EAAE,UAAU,OAAO;AAC5B;AAKO,SAAS,kBAAkB,MAAY,YAAiC;AAC7E,QAAM,cAAc,iBAAiB,IAAI;AACzC,SAAO,YAAY,SAAS,UAAU;AACxC;AAKO,SAAS,sBAAsB,MAA0B;AAC9D,SAAO,CAAC,GAAG,iBAAiB,IAAI,CAAC;AACnC;AAKO,SAAS,aAAa,OAAa,OAAsB;AAC9D,SAAO,YAAY,KAAK,IAAI,YAAY,KAAK;AAC/C;AAKO,SAAS,cAAc,OAAa,OAAsB;AAC/D,SAAO,YAAY,KAAK,KAAK,YAAY,KAAK;AAChD;AAoBO,SAAS,iBACd,MACA,mBACc;AACd,QAAM,kBAAkB,sBAAsB,IAAI;AAElD,MAAI,CAAC,qBAAqB,kBAAkB,WAAW,GAAG;AACxD,WAAO;AAAA,EACT;AAGA,QAAM,SAAS,oBAAI,IAAI,CAAC,GAAG,iBAAiB,GAAG,iBAAiB,CAAC;AACjE,SAAO,MAAM,KAAK,MAAM;AAC1B;AA2CO,IAAM,oBAAoB;AAAA,EAC/B,WAAW;AAAA,IACT,OAAO;AAAA,IACP,aAAa;AAAA,MACX,EAAE,KAAK,mBAAmB,OAAO,mBAAmB;AAAA,MACpD,EAAE,KAAK,iBAAiB,OAAO,iBAAiB;AAAA,MAChD,EAAE,KAAK,mBAAmB,OAAO,iBAAiB;AAAA,MAClD,EAAE,KAAK,mBAAmB,OAAO,mBAAmB;AAAA,MACpD,EAAE,KAAK,oBAAoB,OAAO,oBAAoB;AAAA,IACxD;AAAA,EACF;AAAA,EACA,WAAW;AAAA,IACT,OAAO;AAAA,IACP,aAAa;AAAA,MACX,EAAE,KAAK,mBAAmB,OAAO,mBAAmB;AAAA,MACpD,EAAE,KAAK,iBAAiB,OAAO,iBAAiB;AAAA,MAChD,EAAE,KAAK,mBAAmB,OAAO,iBAAiB;AAAA,MAClD,EAAE,KAAK,mBAAmB,OAAO,mBAAmB;AAAA,IACtD;AAAA,EACF;AAAA,EACA,SAAS;AAAA,IACP,OAAO;AAAA,IACP,aAAa;AAAA,MACX,EAAE,KAAK,iBAAiB,OAAO,iBAAiB;AAAA,MAChD,EAAE,KAAK,eAAe,OAAO,eAAe;AAAA,MAC5C,EAAE,KAAK,iBAAiB,OAAO,eAAe;AAAA,MAC9C,EAAE,KAAK,iBAAiB,OAAO,iBAAiB;AAAA,IAClD;AAAA,EACF;AAAA,EACA,UAAU;AAAA,IACR,OAAO;AAAA,IACP,aAAa;AAAA,MACX,EAAE,KAAK,kBAAkB,OAAO,kBAAkB;AAAA,MAClD,EAAE,KAAK,gBAAgB,OAAO,gBAAgB;AAAA,MAC9C,EAAE,KAAK,kBAAkB,OAAO,gBAAgB;AAAA,MAChD,EAAE,KAAK,kBAAkB,OAAO,kBAAkB;AAAA,IACpD;AAAA,EACF;AAAA,EACA,aAAa;AAAA,IACX,OAAO;AAAA,IACP,aAAa;AAAA,MACX,EAAE,KAAK,oBAAoB,OAAO,qBAAqB;AAAA,MACvD,EAAE,KAAK,sBAAsB,OAAO,oBAAoB;AAAA,MACxD,EAAE,KAAK,sBAAsB,OAAO,iBAAiB;AAAA,MACrD,EAAE,KAAK,sBAAsB,OAAO,mBAAmB;AAAA,IACzD;AAAA,EACF;AAAA,EACA,WAAW;AAAA,IACT,OAAO;AAAA,IACP,aAAa;AAAA,MACX,EAAE,KAAK,kBAAkB,OAAO,iBAAiB;AAAA,MACjD,EAAE,KAAK,oBAAoB,OAAO,mBAAmB;AAAA,IACvD;AAAA,EACF;AAAA,EACA,OAAO;AAAA,IACL,OAAO;AAAA,IACP,aAAa;AAAA,MACX,EAAE,KAAK,cAAc,OAAO,kBAAkB;AAAA,MAC9C,EAAE,KAAK,gBAAgB,OAAO,oBAAoB;AAAA,IACpD;AAAA,EACF;AAAA,EACA,MAAM;AAAA,IACJ,OAAO;AAAA,IACP,aAAa;AAAA,MACX,EAAE,KAAK,eAAe,OAAO,eAAe;AAAA,MAC5C,EAAE,KAAK,iBAAiB,OAAO,sBAAsB;AAAA,MACrD,EAAE,KAAK,iBAAiB,OAAO,iBAAiB;AAAA,MAChD,EAAE,KAAK,iBAAiB,OAAO,iBAAiB;AAAA,MAChD,EAAE,KAAK,eAAe,OAAO,eAAe;AAAA,MAC5C,EAAE,KAAK,iBAAiB,OAAO,iBAAiB;AAAA,IAClD;AAAA,EACF;AAAA,EACA,cAAc;AAAA,IACZ,OAAO;AAAA,IACP,aAAa;AAAA,MACX,EAAE,KAAK,qBAAqB,OAAO,oBAAoB;AAAA,MACvD,EAAE,KAAK,uBAAuB,OAAO,oBAAoB;AAAA,MACzD,EAAE,KAAK,uBAAuB,OAAO,sBAAsB;AAAA,MAC3D,EAAE,KAAK,uBAAuB,OAAO,wBAAwB;AAAA,MAC7D,EAAE,KAAK,iBAAiB,OAAO,gBAAgB;AAAA,MAC/C,EAAE,KAAK,mBAAmB,OAAO,gBAAgB;AAAA,IACnD;AAAA,EACF;AACF;AAMO,IAAM,oBAA0E;AAAA,EACrF,QAAQ;AAAA,IACN,OAAO;AAAA,IACP,aAAa;AAAA,EACf;AAAA,EACA,QAAQ;AAAA,IACN,OAAO;AAAA,IACP,aAAa;AAAA,EACf;AAAA,EACA,OAAO;AAAA,IACL,OAAO;AAAA,IACP,aAAa;AAAA,EACf;AAAA,EACA,OAAO;AAAA,IACL,OAAO;AAAA,IACP,aAAa;AAAA,EACf;AACF;;;ACzXA,SAAS,gBAAAC,qBAAoB;AAC7B,SAAS,MAAM,cAAc;AAC7B,OAAO,YAAY;AA4CnB,IAAM,iBAA8C;AAAA,EAClD,sBAAsB;AAAA,EACtB,oBAAoB;AAAA,EACpB,gBAAgB;AAAA,EAChB,iBAAiB;AAAA;AACnB;AAMO,IAAM,cAAN,cAA0BC,cAAyB;AAAA,EAChD;AAAA;AAAA,EAGA,gBAA2C,oBAAI,IAAI;AAAA,EACnD,UAAoC,oBAAI,IAAI;AAAA;AAAA,EAC5C,UAAoC,oBAAI,IAAI;AAAA;AAAA,EAC5C,WAAkC,oBAAI,IAAI;AAAA;AAAA,EAE1C,gBAAuC;AAAA,EAE/C,YAAY,SAA4B,CAAC,GAAG;AAC1C,UAAM;AACN,SAAK,SAAS,EAAE,GAAG,gBAAgB,GAAG,OAAO;AAAA,EAC/C;AAAA;AAAA;AAAA;AAAA,EAMA,QAAc;AACZ,QAAI,KAAK,cAAe;AAExB,SAAK,gBAAgB,YAAY,MAAM;AACrC,WAAK,cAAc;AAAA,IACrB,GAAG,KAAK,OAAO,eAAe;AAE9B,YAAQ,IAAI,oDAAoD;AAAA,EAClE;AAAA,EAEA,OAAa;AACX,QAAI,KAAK,eAAe;AACtB,oBAAc,KAAK,aAAa;AAChC,WAAK,gBAAgB;AAAA,IACvB;AACA,YAAQ,IAAI,uBAAuB;AAAA,EACrC;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,mBAAmB,OAAkB,eAA8C;AACvF,UAAM,YAAY,gBAAgB,MAAM,KAAK;AAG7C,UAAM,WAAW,KAAK,SAAS,IAAI,aAAa,KAAK,CAAC;AACtD,QAAI,SAAS,UAAU,KAAK,OAAO,gBAAgB;AACjD,YAAM,IAAI,MAAM,gDAAgD,KAAK,OAAO,cAAc,GAAG;AAAA,IAC/F;AAGA,eAAWC,QAAO,KAAK,cAAc,OAAO,GAAG;AAC7C,UAAIA,KAAI,SAAS,UAAU,MAAM;AAC/B,cAAM,IAAI,MAAM,sBAAsB,UAAU,IAAI,oBAAoB;AAAA,MAC1E;AAAA,IACF;AAEA,UAAM,MAAM,oBAAI,KAAK;AACrB,UAAM,OAAO,UAAU,QAAQ;AAE/B,UAAM,MAAoB,mBAAmB,MAAM;AAAA,MACjD,GAAG;AAAA,MACH,IAAI,OAAO;AAAA,MACX;AAAA,MACA,UAAU,EAAE,GAAG,YAAY,IAAI,GAAG,GAAG,UAAU,SAAS;AAAA,MACxD,WAAW;AAAA,MACX,WAAW;AAAA,MACX,WAAW;AAAA,IACb,CAAC;AAGD,SAAK,cAAc,IAAI,IAAI,IAAI,GAAG;AAClC,SAAK,QAAQ,IAAI,IAAI,IAAI,CAAC,CAAC;AAC3B,SAAK,QAAQ,IAAI,IAAI,IAAI,CAAC,CAAC;AAG3B,UAAM,KAAK,UAAU,IAAI,IAAI;AAAA,MAC3B,QAAQ;AAAA,MACR,MAAM;AAAA,MACN,OAAO,UAAU,gBAAgB;AAAA,MACjC,aAAa;AAAA,IACf,CAAC;AAED,SAAK,KAAK,eAAe,GAAG;AAC5B,YAAQ,IAAI,uCAAuC,IAAI,IAAI,KAAK,IAAI,IAAI,GAAG;AAE3E,WAAO;AAAA,EACT;AAAA,EAEA,gBAAgB,OAAyC;AACvD,WAAO,KAAK,cAAc,IAAI,KAAK;AAAA,EACrC;AAAA,EAEA,sBAAsB,MAAwC;AAC5D,eAAW,OAAO,KAAK,cAAc,OAAO,GAAG;AAC7C,UAAI,IAAI,SAAS,KAAM,QAAO;AAAA,IAChC;AACA,WAAO;AAAA,EACT;AAAA,EAEA,MAAM,mBAAmB,OAAe,SAAkD;AACxF,UAAM,MAAM,KAAK,cAAc,IAAI,KAAK;AACxC,QAAI,CAAC,IAAK,QAAO;AAGjB,QAAI,QAAQ,QAAQ,QAAQ,SAAS,IAAI,MAAM;AAC7C,iBAAW,KAAK,KAAK,cAAc,OAAO,GAAG;AAC3C,YAAI,EAAE,SAAS,QAAQ,QAAQ,EAAE,OAAO,OAAO;AAC7C,gBAAM,IAAI,MAAM,sBAAsB,QAAQ,IAAI,oBAAoB;AAAA,QACxE;AAAA,MACF;AAAA,IACF;AAGA,QAAI,WAAW,IAAI;AACnB,QAAI,QAAQ,QAAQ,QAAQ,SAAS,IAAI,MAAM;AAC7C,iBAAW,EAAE,GAAG,YAAY,QAAQ,IAAI,GAAG,GAAG,QAAQ,SAAS;AAAA,IACjE;AAEA,UAAM,UAAwB;AAAA,MAC5B,GAAG;AAAA,MACH,GAAG;AAAA,MACH,UAAU,QAAQ,WAAW,EAAE,GAAG,UAAU,GAAG,QAAQ,SAAS,IAAI;AAAA,MACpE,WAAW,oBAAI,KAAK;AAAA,IACtB;AAEA,SAAK,cAAc,IAAI,OAAO,OAAO;AACrC,SAAK,KAAK,eAAe,OAAO;AAEhC,WAAO;AAAA,EACT;AAAA,EAEA,MAAM,mBAAmB,OAAiC;AACxD,UAAM,MAAM,KAAK,cAAc,IAAI,KAAK;AACxC,QAAI,CAAC,IAAK,QAAO;AAGjB,UAAM,aAAa,KAAK,QAAQ,IAAI,KAAK,KAAK,CAAC;AAC/C,eAAW,UAAU,YAAY;AAC/B,YAAM,cAAc,KAAK,SAAS,IAAI,OAAO,MAAM,KAAK,CAAC;AACzD,WAAK,SAAS;AAAA,QACZ,OAAO;AAAA,QACP,YAAY,OAAO,CAAC,OAAO,OAAO,KAAK;AAAA,MACzC;AAAA,IACF;AAGA,SAAK,cAAc,OAAO,KAAK;AAC/B,SAAK,QAAQ,OAAO,KAAK;AACzB,SAAK,QAAQ,OAAO,KAAK;AAEzB,SAAK,KAAK,eAAe,KAAK;AAC9B,YAAQ,IAAI,uCAAuC,IAAI,IAAI,EAAE;AAE7D,WAAO;AAAA,EACT;AAAA,EAEA,qBAAqB,QAAgC;AACnD,UAAM,SAAS,KAAK,SAAS,IAAI,MAAM,KAAK,CAAC;AAC7C,WAAO,OACJ,IAAI,CAAC,OAAO,KAAK,cAAc,IAAI,EAAE,CAAC,EACtC,OAAO,CAAC,QAA6B,QAAQ,MAAS;AAAA,EAC3D;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,UAAU,OAAe,OAAsC;AACnE,UAAM,MAAM,KAAK,cAAc,IAAI,KAAK;AACxC,QAAI,CAAC,IAAK,OAAM,IAAI,MAAM,2BAA2B,KAAK,EAAE;AAE5D,UAAM,YAAY,gBAAgB,MAAM,KAAK;AAC7C,UAAM,aAAa,KAAK,QAAQ,IAAI,KAAK,KAAK,CAAC;AAG/C,QAAI,WAAW,KAAK,CAAC,MAAM,EAAE,WAAW,UAAU,MAAM,GAAG;AACzD,YAAM,IAAI,MAAM,+CAA+C;AAAA,IACjE;AAGA,QAAI,IAAI,SAAS,eAAe,MAAM,WAAW,UAAU,IAAI,SAAS,YAAY;AAClF,YAAM,IAAI,MAAM,kDAAkD,IAAI,SAAS,UAAU,GAAG;AAAA,IAC9F;AAEA,UAAM,MAAM,oBAAI,KAAK;AACrB,UAAM,SAAoB,gBAAgB,MAAM;AAAA,MAC9C,IAAI,OAAO;AAAA,MACX;AAAA,MACA,GAAG;AAAA,MACH,QAAQ;AAAA,MACR,UAAU;AAAA,MACV,cAAc;AAAA,IAChB,CAAC;AAGD,eAAW,KAAK,MAAM;AACtB,SAAK,QAAQ,IAAI,OAAO,UAAU;AAGlC,UAAM,cAAc,KAAK,SAAS,IAAI,OAAO,MAAM,KAAK,CAAC;AACzD,gBAAY,KAAK,KAAK;AACtB,SAAK,SAAS,IAAI,OAAO,QAAQ,WAAW;AAE5C,SAAK,KAAK,gBAAgB,MAAM;AAChC,YAAQ,IAAI,8BAA8B,OAAO,KAAK,OAAO,IAAI,IAAI,OAAO,OAAO,IAAI,EAAE;AAEzF,WAAO;AAAA,EACT;AAAA,EAEA,UAAU,OAAe,QAAuC;AAC9D,UAAM,aAAa,KAAK,QAAQ,IAAI,KAAK,KAAK,CAAC;AAC/C,WAAO,WAAW,KAAK,CAAC,MAAM,EAAE,WAAW,UAAU,EAAE,WAAW,QAAQ;AAAA,EAC5E;AAAA,EAEA,cAAc,UAAyC;AACrD,eAAW,WAAW,KAAK,QAAQ,OAAO,GAAG;AAC3C,YAAM,SAAS,QAAQ,KAAK,CAAC,MAAM,EAAE,OAAO,QAAQ;AACpD,UAAI,OAAQ,QAAO;AAAA,IACrB;AACA,WAAO;AAAA,EACT;AAAA,EAEA,cAAc,OAA4B;AACxC,YAAQ,KAAK,QAAQ,IAAI,KAAK,KAAK,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,WAAW,QAAQ;AAAA,EAC5E;AAAA,EAEA,MAAM,aAAa,OAAe,QAAgB,SAAkD;AAClG,UAAM,aAAa,KAAK,QAAQ,IAAI,KAAK,KAAK,CAAC;AAC/C,UAAM,cAAc,WAAW,UAAU,CAAC,MAAM,EAAE,WAAW,MAAM;AAEnE,QAAI,gBAAgB,GAAI,QAAO;AAE/B,UAAM,SAAS,WAAW,WAAW;AAGrC,QAAI,QAAQ,QAAQ,OAAO,SAAS,WAAW,QAAQ,SAAS,SAAS;AACvE,YAAM,SAAS,WAAW,OAAO,CAAC,MAAM,EAAE,SAAS,WAAW,EAAE,WAAW,QAAQ;AACnF,UAAI,OAAO,UAAU,GAAG;AACtB,cAAM,IAAI,MAAM,yDAAyD;AAAA,MAC3E;AAAA,IACF;AAEA,UAAM,UAAqB;AAAA,MACzB,GAAG;AAAA,MACH,GAAG;AAAA,MACH,cAAc,oBAAI,KAAK;AAAA,IACzB;AAEA,eAAW,WAAW,IAAI;AAC1B,SAAK,QAAQ,IAAI,OAAO,UAAU;AAElC,SAAK,KAAK,kBAAkB,OAAO;AACnC,WAAO;AAAA,EACT;AAAA,EAEA,MAAM,aAAa,OAAe,QAAkC;AAClE,UAAM,aAAa,KAAK,QAAQ,IAAI,KAAK,KAAK,CAAC;AAC/C,UAAM,SAAS,WAAW,KAAK,CAAC,MAAM,EAAE,WAAW,MAAM;AAEzD,QAAI,CAAC,OAAQ,QAAO;AAGpB,QAAI,OAAO,SAAS,SAAS;AAC3B,YAAM,SAAS,WAAW,OAAO,CAAC,MAAM,EAAE,SAAS,WAAW,EAAE,WAAW,QAAQ;AACnF,UAAI,OAAO,UAAU,GAAG;AACtB,cAAM,IAAI,MAAM,yDAAyD;AAAA,MAC3E;AAAA,IACF;AAGA,WAAO,SAAS;AAChB,SAAK,QAAQ,IAAI,OAAO,UAAU;AAGlC,UAAM,cAAc,KAAK,SAAS,IAAI,MAAM,KAAK,CAAC;AAClD,SAAK,SAAS;AAAA,MACZ;AAAA,MACA,YAAY,OAAO,CAAC,OAAO,OAAO,KAAK;AAAA,IACzC;AAEA,SAAK,KAAK,kBAAkB,OAAO,IAAI,KAAK;AAC5C,YAAQ,IAAI,gCAAgC,OAAO,KAAK,aAAa,KAAK,EAAE;AAE5E,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,aAAa,OAAe,OAAqB,WAAuC;AAC5F,UAAM,MAAM,KAAK,cAAc,IAAI,KAAK;AACxC,QAAI,CAAC,IAAK,OAAM,IAAI,MAAM,2BAA2B,KAAK,EAAE;AAE5D,UAAM,YAAY,mBAAmB,MAAM,KAAK;AAChD,UAAM,aAAa,KAAK,QAAQ,IAAI,KAAK,KAAK,CAAC;AAC/C,UAAM,aAAa,KAAK,QAAQ,IAAI,KAAK,KAAK,CAAC;AAG/C,QAAI,WAAW,KAAK,CAAC,MAAM,EAAE,UAAU,UAAU,SAAS,EAAE,WAAW,QAAQ,GAAG;AAChF,YAAM,IAAI,MAAM,0CAA0C;AAAA,IAC5D;AAGA,UAAM,iBAAiB,WAAW;AAAA,MAChC,CAAC,MAAM,EAAE,UAAU,UAAU,SAAS,EAAE,WAAW;AAAA,IACrD;AACA,QAAI,gBAAgB;AAClB,YAAM,IAAI,MAAM,6CAA6C;AAAA,IAC/D;AAGA,QAAI,IAAI,SAAS,eAAe,MAAM,WAAW,UAAU,IAAI,SAAS,YAAY;AAClF,YAAM,IAAI,MAAM,kDAAkD,IAAI,SAAS,UAAU,GAAG;AAAA,IAC9F;AAEA,UAAM,MAAM,oBAAI,KAAK;AACrB,UAAM,YAAY,IAAI,KAAK,GAAG;AAC9B,cAAU,QAAQ,UAAU,QAAQ,IAAI,UAAU,aAAa;AAE/D,UAAM,SAAoB,gBAAgB,MAAM;AAAA,MAC9C,IAAI,OAAO;AAAA,MACX;AAAA,MACA,OAAO,UAAU;AAAA,MACjB,MAAM,UAAU;AAAA,MAChB,OAAO,OAAO,YAAY,EAAE,EAAE,SAAS,KAAK;AAAA,MAC5C;AAAA,MACA,QAAQ;AAAA,MACR;AAAA,MACA,WAAW;AAAA,MACX,SAAS,UAAU;AAAA,IACrB,CAAC;AAED,eAAW,KAAK,MAAM;AACtB,SAAK,QAAQ,IAAI,OAAO,UAAU;AAElC,SAAK,KAAK,kBAAkB,MAAM;AAClC,YAAQ,IAAI,oCAAoC,OAAO,KAAK,OAAO,IAAI,IAAI,EAAE;AAE7E,WAAO;AAAA,EACT;AAAA,EAEA,UAAU,UAAyC;AACjD,eAAW,WAAW,KAAK,QAAQ,OAAO,GAAG;AAC3C,YAAM,SAAS,QAAQ,KAAK,CAAC,MAAM,EAAE,OAAO,QAAQ;AACpD,UAAI,OAAQ,QAAO;AAAA,IACrB;AACA,WAAO;AAAA,EACT;AAAA,EAEA,iBAAiB,OAAsC;AACrD,eAAW,WAAW,KAAK,QAAQ,OAAO,GAAG;AAC3C,YAAM,SAAS,QAAQ,KAAK,CAAC,MAAM,EAAE,UAAU,SAAS,EAAE,WAAW,SAAS;AAC9E,UAAI,OAAQ,QAAO;AAAA,IACrB;AACA,WAAO;AAAA,EACT;AAAA,EAEA,cAAc,OAAe,cAAc,MAAmB;AAC5D,UAAM,UAAU,KAAK,QAAQ,IAAI,KAAK,KAAK,CAAC;AAC5C,QAAI,aAAa;AACf,aAAO,QAAQ,OAAO,CAAC,MAAM,EAAE,WAAW,SAAS;AAAA,IACrD;AACA,WAAO;AAAA,EACT;AAAA,EAEA,MAAM,aAAa,OAAe,QAAgB,WAAmB,aAA0C;AAC7G,UAAM,SAAS,KAAK,iBAAiB,KAAK;AAC1C,QAAI,CAAC,OAAQ,OAAM,IAAI,MAAM,2BAA2B;AAGxD,QAAI,oBAAI,KAAK,IAAI,OAAO,WAAW;AACjC,aAAO,SAAS;AAChB,WAAK,KAAK,kBAAkB,OAAO,EAAE;AACrC,YAAM,IAAI,MAAM,oBAAoB;AAAA,IACtC;AAGA,UAAM,SAAS,MAAM,KAAK,UAAU,OAAO,OAAO;AAAA,MAChD;AAAA,MACA,MAAM,OAAO;AAAA,MACb,OAAO;AAAA,MACP;AAAA,IACF,CAAC;AAGD,WAAO,SAAS;AAChB,WAAO,aAAa,oBAAI,KAAK;AAC7B,WAAO,aAAa;AAEpB,SAAK,KAAK,mBAAmB,QAAQ,MAAM;AAC3C,YAAQ,IAAI,oCAAoC,SAAS,EAAE;AAE3D,WAAO;AAAA,EACT;AAAA,EAEA,MAAM,aAAa,UAAoC;AACrD,eAAW,CAAC,OAAO,OAAO,KAAK,KAAK,QAAQ,QAAQ,GAAG;AACrD,YAAM,SAAS,QAAQ,KAAK,CAAC,MAAM,EAAE,OAAO,QAAQ;AACpD,UAAI,UAAU,OAAO,WAAW,WAAW;AACzC,eAAO,SAAS;AAChB,aAAK,KAAK,kBAAkB,QAAQ;AACpC,gBAAQ,IAAI,gCAAgC,QAAQ,EAAE;AACtD,eAAO;AAAA,MACT;AAAA,IACF;AACA,WAAO;AAAA,EACT;AAAA,EAEQ,gBAAsB;AAC5B,UAAM,MAAM,oBAAI,KAAK;AAErB,eAAW,WAAW,KAAK,QAAQ,OAAO,GAAG;AAC3C,iBAAW,UAAU,SAAS;AAC5B,YAAI,OAAO,WAAW,aAAa,MAAM,OAAO,WAAW;AACzD,iBAAO,SAAS;AAChB,eAAK,KAAK,kBAAkB,OAAO,EAAE;AAAA,QACvC;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,gBAAgB,OAAmD;AACvE,UAAM,EAAE,QAAQ,OAAO,UAAU,QAAQ,WAAW,IAAI;AACxD,UAAM,aAAa,gBAAgB,UAAU,MAAM;AAGnD,UAAM,SAAS,KAAK,UAAU,OAAO,MAAM;AAC3C,QAAI,CAAC,QAAQ;AACX,aAAO;AAAA,QACL,SAAS;AAAA,QACT,QAAQ;AAAA,QACR,WAAW,oBAAI,KAAK;AAAA,MACtB;AAAA,IACF;AAGA,QAAI,OAAO,WAAW,aAAa;AACjC,aAAO;AAAA,QACL,SAAS;AAAA,QACT,QAAQ;AAAA,QACR,MAAM,OAAO;AAAA,QACb,WAAW,oBAAI,KAAK;AAAA,MACtB;AAAA,IACF;AAGA,UAAM,cAAc,iBAAiB,OAAO,MAAM,OAAO,iBAAiB;AAG1E,QAAI,CAAC,YAAY,SAAS,UAAU,GAAG;AACrC,WAAK,KAAK,qBAAqB,OAAO;AAAA,QACpC,SAAS;AAAA,QACT,QAAQ,SAAS,OAAO,IAAI,+BAA+B,UAAU;AAAA,QACrE,MAAM,OAAO;AAAA,QACb,WAAW,oBAAI,KAAK;AAAA,MACtB,CAAC;AAED,aAAO;AAAA,QACL,SAAS;AAAA,QACT,QAAQ,sBAAsB,UAAU;AAAA,QACxC,MAAM,OAAO;AAAA,QACb,WAAW,oBAAI,KAAK;AAAA,MACtB;AAAA,IACF;AAEA,WAAO;AAAA,MACL,SAAS;AAAA,MACT,MAAM,OAAO;AAAA,MACb,WAAW,oBAAI,KAAK;AAAA,IACtB;AAAA,EACF;AAAA,EAEA,cAAc,QAAgB,OAAe,YAAiC;AAC5E,UAAM,SAAS,KAAK,UAAU,OAAO,MAAM;AAC3C,QAAI,CAAC,UAAU,OAAO,WAAW,SAAU,QAAO;AAElD,UAAM,cAAc,iBAAiB,OAAO,MAAM,OAAO,iBAAiB;AAC1E,WAAO,YAAY,SAAS,UAAU;AAAA,EACxC;AAAA,EAEA,QAAQ,QAAgB,OAAe,SAAwB;AAC7D,UAAM,SAAS,KAAK,UAAU,OAAO,MAAM;AAC3C,QAAI,CAAC,UAAU,OAAO,WAAW,SAAU,QAAO;AAElD,WAAO,cAAc,OAAO,MAAM,OAAO;AAAA,EAC3C;AAAA;AAAA;AAAA;AAAA,EAMA,eAAe,QAAgB,OAAmC;AAChE,UAAM,SAAS,KAAK,UAAU,OAAO,MAAM;AAC3C,QAAI,CAAC,UAAU,OAAO,WAAW,SAAU,QAAO;AAElD,UAAM,MAAM,KAAK,cAAc,IAAI,KAAK;AACxC,QAAI,CAAC,IAAK,QAAO;AAEjB,UAAM,cAAc,iBAAiB,OAAO,MAAM,OAAO,iBAAiB;AAE1E,WAAO;AAAA,MACL,QAAQ,OAAO;AAAA,MACf;AAAA,MACA,MAAM,OAAO;AAAA,MACb;AAAA,MACA,OAAO,OAAO;AAAA,MACd,aAAa,OAAO;AAAA,MACpB,SAAS,IAAI;AAAA,MACb,SAAS,IAAI;AAAA,IACf;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,WAKE;AACA,UAAM,aAAqC,EAAE,MAAM,GAAG,KAAK,GAAG,YAAY,EAAE;AAC5E,QAAI,eAAe;AACnB,QAAI,eAAe;AAEnB,eAAW,OAAO,KAAK,cAAc,OAAO,GAAG;AAC7C,iBAAW,IAAI,IAAI,KAAK,WAAW,IAAI,IAAI,KAAK,KAAK;AAAA,IACvD;AAEA,eAAW,WAAW,KAAK,QAAQ,OAAO,GAAG;AAC3C,sBAAgB,QAAQ,OAAO,CAAC,MAAM,EAAE,WAAW,QAAQ,EAAE;AAAA,IAC/D;AAEA,eAAW,WAAW,KAAK,QAAQ,OAAO,GAAG;AAC3C,sBAAgB,QAAQ,OAAO,CAAC,MAAM,EAAE,WAAW,SAAS,EAAE;AAAA,IAChE;AAEA,WAAO;AAAA,MACL,WAAW,KAAK,cAAc;AAAA,MAC9B;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF;AACF;AAMA,IAAI,cAAkC;AAE/B,SAAS,eAAe,QAAyC;AACtE,MAAI,CAAC,aAAa;AAChB,kBAAc,IAAI,YAAY,MAAM;AAAA,EACtC;AACA,SAAO;AACT;AAEO,SAAS,kBAAkB,QAAyC;AACzE,SAAO,IAAI,YAAY,MAAM;AAC/B;;;AClnBA,SAAS,KAAAC,UAAS;AAMX,IAAM,sBAAsBA,GAAE,KAAK;AAAA,EACxC;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AACF,CAAC;AAOM,IAAM,oBAAoBA,GAAE,KAAK;AAAA;AAAA,EAEtC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAOM,IAAM,sBAAsBA,GAAE,KAAK;AAAA,EACxC;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AACF,CAAC;AAOM,IAAM,oBAAoBA,GAAE,KAAK;AAAA,EACtC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAOM,IAAM,qBAAqBA,GAAE,OAAO;AAAA;AAAA,EAEzC,QAAQA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,WAAWA,GAAE,OAAO,EAAE,MAAM,EAAE,SAAS;AAAA,EACvC,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAG9B,OAAOA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC3B,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAG7B,WAAWA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC/B,WAAWA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC/B,WAAWA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC/B,WAAWA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAG/B,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC9B,YAAYA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAGhC,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,QAAQA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,MAAMA,GAAE,OAAO,EAAE,SAAS;AAC5B,CAAC;AAOM,IAAM,sBAAsBA,GAAE,OAAO;AAAA,EAC1C,MAAMA,GAAE,OAAO;AAAA;AAAA,EACf,IAAIA,GAAE,OAAO;AAAA;AAAA,EACb,MAAMA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC1B,YAAYA,GAAE,OAAOA,GAAE,QAAQ,CAAC,EAAE,SAAS;AAC7C,CAAC;AAOM,IAAM,oBAAoBA,GAAE,OAAO;AAAA,EACxC,OAAOA,GAAE,OAAO;AAAA,EAChB,UAAUA,GAAE,QAAQ,EAAE,SAAS;AAAA,EAC/B,UAAUA,GAAE,QAAQ,EAAE,SAAS;AACjC,CAAC;AAOM,IAAM,mBAAmBA,GAAE,OAAO;AAAA,EACvC,IAAIA,GAAE,OAAO;AAAA,EACb,WAAWA,GAAE,KAAK;AAAA;AAAA,EAGlB,UAAU;AAAA,EACV,QAAQ;AAAA,EACR,UAAU;AAAA,EACV,QAAQ;AAAA;AAAA,EAGR,aAAaA,GAAE,OAAO;AAAA,EACtB,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAG7B,SAAS;AAAA;AAAA,EAGT,UAAU,oBAAoB,SAAS;AAAA;AAAA,EAGvC,SAASA,GAAE,MAAM,iBAAiB,EAAE,SAAS;AAAA;AAAA,EAG7C,UAAUA,GAAE,OAAOA,GAAE,QAAQ,CAAC,EAAE,SAAS;AAAA;AAAA,EAGzC,WAAWA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC/B,cAAcA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAGlC,eAAeA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAGnC,MAAMA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC1B,cAAcA,GAAE,OAAO,EAAE,SAAS;AACpC,CAAC;AAOM,IAAM,yBAAyB,iBAAiB,KAAK;AAAA,EAC1D,IAAI;AAAA,EACJ,WAAW;AAAA,EACX,MAAM;AAAA,EACN,cAAc;AAChB,CAAC;AAOM,IAAM,mBAAmBA,GAAE,OAAO;AAAA;AAAA,EAEvC,OAAOA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC3B,QAAQA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,UAAU,oBAAoB,SAAS;AAAA,EACvC,QAAQ,kBAAkB,SAAS;AAAA,EACnC,UAAU,oBAAoB,SAAS;AAAA,EACvC,QAAQ,kBAAkB,SAAS;AAAA,EACnC,cAAcA,GAAE,OAAO,EAAE,SAAS;AAAA,EAClC,YAAYA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAGhC,WAAWA,GAAE,KAAK,EAAE,SAAS;AAAA,EAC7B,SAASA,GAAE,KAAK,EAAE,SAAS;AAAA;AAAA,EAG3B,QAAQA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAG5B,OAAOA,GAAE,OAAO,EAAE,IAAI,CAAC,EAAE,IAAI,GAAI,EAAE,QAAQ,GAAG;AAAA,EAC9C,QAAQA,GAAE,OAAO,EAAE,IAAI,CAAC,EAAE,QAAQ,CAAC;AAAA;AAAA,EAGnC,QAAQA,GAAE,KAAK,CAAC,aAAa,YAAY,UAAU,CAAC,EAAE,QAAQ,WAAW;AAAA,EACzE,WAAWA,GAAE,KAAK,CAAC,OAAO,MAAM,CAAC,EAAE,QAAQ,MAAM;AACnD,CAAC;AAOM,IAAM,yBAAyBA,GAAE,OAAO;AAAA,EAC7C,QAAQA,GAAE,MAAM,gBAAgB;AAAA,EAChC,OAAOA,GAAE,OAAO;AAAA,EAChB,OAAOA,GAAE,OAAO;AAAA,EAChB,QAAQA,GAAE,OAAO;AAAA,EACjB,SAASA,GAAE,QAAQ;AACrB,CAAC;AAOM,IAAM,2BAA2BA,GAAE,OAAO;AAAA,EAC/C,QAAQA,GAAE,KAAK,CAAC,QAAQ,OAAO,KAAK,CAAC;AAAA,EACrC,OAAO;AAAA,EACP,gBAAgBA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,EACxC,gBAAgBA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,EACxC,iBAAiBA,GAAE,QAAQ,EAAE,QAAQ,KAAK;AAC5C,CAAC;AAOM,IAAM,6BAA6BA,GAAE,OAAO;AAAA,EACjD,UAAU;AAAA,EACV,eAAeA,GAAE,OAAO,EAAE,IAAI,CAAC;AAAA,EAC/B,kBAAkBA,GAAE,OAAO,EAAE,SAAS;AAAA,EACtC,oBAAoBA,GAAE,QAAQ,EAAE,QAAQ,KAAK;AAC/C,CAAC;AAOM,IAAM,mBAAmBA,GAAE,OAAO;AAAA,EACvC,aAAaA,GAAE,OAAO;AAAA,EACtB,kBAAkBA,GAAE,OAAOA,GAAE,OAAO,CAAC;AAAA,EACrC,kBAAkBA,GAAE,OAAOA,GAAE,OAAO,CAAC;AAAA,EACrC,gBAAgBA,GAAE,OAAOA,GAAE,OAAO,CAAC;AAAA,EACnC,UAAUA,GAAE,MAAMA,GAAE,OAAO;AAAA,IACzB,QAAQA,GAAE,OAAO;AAAA,IACjB,OAAOA,GAAE,OAAO,EAAE,SAAS;AAAA,IAC3B,YAAYA,GAAE,OAAO;AAAA,EACvB,CAAC,CAAC;AAAA,EACF,cAAcA,GAAE,MAAMA,GAAE,OAAO;AAAA,IAC7B,cAAcA,GAAE,OAAO;AAAA,IACvB,YAAYA,GAAE,OAAO;AAAA,IACrB,YAAYA,GAAE,OAAO;AAAA,EACvB,CAAC,CAAC;AAAA,EACF,gBAAgBA,GAAE,MAAMA,GAAE,OAAO;AAAA,IAC/B,MAAMA,GAAE,OAAO;AAAA,IACf,OAAOA,GAAE,OAAO;AAAA,EAClB,CAAC,CAAC;AACJ,CAAC;AAkBM,IAAM,yBAAwD;AAAA,EACnE,MAAM;AAAA,EACN,cAAc;AAAA,EACd,QAAQ;AAAA,EACR,UAAU;AAAA,EACV,UAAU;AAAA,EACV,QAAQ;AAAA,EACR,SAAS;AAAA,EACT,UAAU;AAAA,EACV,KAAK;AAAA,EACL,UAAU;AAAA,EACV,QAAQ;AACV;AAEO,IAAM,kBAAiD;AAAA,EAC5D,OAAO;AAAA,EACP,MAAM;AAAA,EACN,SAAS;AAAA,EACT,OAAO;AAAA,EACP,UAAU;AACZ;;;AChVA,SAAS,gBAAAC,qBAAoB;AAC7B,SAAS,kBAAkB;AAuD3B,IAAMC,kBAAoC;AAAA,EACxC,aAAa;AAAA,EACb,WAAW;AAAA,EACX,iBAAiB;AAAA,EACjB,qBAAqB;AAAA,EACrB,eAAe;AAAA,EACf,cAAc;AAAA,EACd,cAAc;AAAA,EACd,aAAa;AACf;AAMO,IAAM,cAAN,cAA0BC,cAAgC;AAAA,EACvD;AAAA,EACA,SAAuB,CAAC;AAAA,EACxB,QAA4B,CAAC;AAAA,EAC7B,WAA0B;AAAA,EAC1B,aAAoD;AAAA,EACpD,eAAe;AAAA,EAEvB,YAAY,SAAqC,CAAC,GAAG;AACnD,UAAM;AACN,SAAK,SAAS,EAAE,GAAGD,iBAAgB,GAAG,OAAO;AAE7C,QAAI,KAAK,OAAO,cAAc;AAC5B,WAAK,oBAAoB;AAAA,IAC3B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,IAAI,OAA8C;AAEtD,QAAI,gBAAgB,MAAM,QAAQ,IAAI,gBAAgB,KAAK,OAAO,WAAW,GAAG;AAC9E,YAAM,IAAI,MAAM,kBAAkB,MAAM,QAAQ,kBAAkB,KAAK,OAAO,WAAW,EAAE;AAAA,IAC7F;AAGA,QAAI,KAAK,OAAO,mBAAmB,SAAS,MAAM,QAAQ,GAAG;AAC3D,YAAM,IAAI,MAAM,YAAY,MAAM,QAAQ,cAAc;AAAA,IAC1D;AAGA,QAAI,KAAK,OAAO,gBAAgB,SAAS,MAAM,MAAM,GAAG;AACtD,YAAM,IAAI,MAAM,UAAU,MAAM,MAAM,cAAc;AAAA,IACtD;AAEA,QAAI,KAAK,OAAO,cAAc;AAE5B,UAAI,KAAK,MAAM,UAAU,KAAK,OAAO,cAAc;AACjD,cAAM,KAAK,aAAa;AAAA,MAC1B;AACA,WAAK,MAAM,KAAK,KAAK;AAGrB,YAAM,QAAQ,KAAK,YAAY,KAAK;AACpC,aAAO;AAAA,IACT,OAAO;AAEL,YAAM,QAAQ,KAAK,YAAY,KAAK;AACpC,YAAM,KAAK,WAAW,KAAK;AAC3B,aAAO;AAAA,IACT;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,KACJ,UACA,QACA,aACA,SACA,UACqB;AACrB,WAAO,KAAK,IAAI;AAAA,MACd;AAAA,MACA;AAAA,MACA,UAAU;AAAA,MACV,QAAQ;AAAA,MACR;AAAA,MACA,SAAS,WAAW,CAAC;AAAA,MACrB;AAAA,IACF,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,KACJ,UACA,QACA,aACA,SACA,UACqB;AACrB,WAAO,KAAK,IAAI;AAAA,MACd;AAAA,MACA;AAAA,MACA,UAAU;AAAA,MACV,QAAQ;AAAA,MACR;AAAA,MACA,SAAS,WAAW,CAAC;AAAA,MACrB;AAAA,IACF,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,MACJ,UACA,QACA,aACA,OACA,SACA,UACqB;AACrB,WAAO,KAAK,IAAI;AAAA,MACd;AAAA,MACA;AAAA,MACA,UAAU;AAAA,MACV,QAAQ;AAAA,MACR;AAAA,MACA,WAAW,MAAM;AAAA,MACjB,cAAc,MAAM;AAAA,MACpB,SAAS,WAAW,CAAC;AAAA,MACrB;AAAA,IACF,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,SACJ,QACA,aACA,WAA0B,WAC1B,SACA,UACqB;AACrB,WAAO,KAAK,IAAI;AAAA,MACd,UAAU;AAAA,MACV;AAAA,MACA;AAAA,MACA,QAAQ,aAAa,aAAa,YAAY;AAAA,MAC9C;AAAA,MACA,SAAS,WAAW,CAAC;AAAA,MACrB;AAAA,IACF,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OACJ,UACA,cACA,YACA,SACA,SACqB;AACrB,UAAM,cAAc,WAAW,YAAY,IAAI,UAAU,KAAK,QAAQ,IAAI,OAAK,EAAE,KAAK,EAAE,KAAK,IAAI,CAAC;AAElG,WAAO,KAAK,IAAI;AAAA,MACd;AAAA,MACA,QAAQ;AAAA,MACR,UAAU;AAAA,MACV,QAAQ;AAAA,MACR;AAAA,MACA,SAAS,WAAW,CAAC;AAAA,MACrB,UAAU;AAAA,QACR,MAAM;AAAA,QACN,IAAI;AAAA,MACN;AAAA,MACA;AAAA,IACF,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,MAAM,OAA8C;AACxD,QAAI,WAAW,CAAC,GAAG,KAAK,MAAM;AAG9B,QAAI,MAAM,OAAO;AACf,iBAAW,SAAS,OAAO,OAAK,EAAE,QAAQ,UAAU,MAAM,KAAK;AAAA,IACjE;AACA,QAAI,MAAM,QAAQ;AAChB,iBAAW,SAAS,OAAO,OAAK,EAAE,QAAQ,WAAW,MAAM,MAAM;AAAA,IACnE;AACA,QAAI,MAAM,UAAU;AAClB,iBAAW,SAAS,OAAO,OAAK,EAAE,aAAa,MAAM,QAAQ;AAAA,IAC/D;AACA,QAAI,MAAM,QAAQ;AAChB,iBAAW,SAAS,OAAO,OAAK,EAAE,WAAW,MAAM,MAAM;AAAA,IAC3D;AACA,QAAI,MAAM,UAAU;AAClB,iBAAW,SAAS,OAAO,OAAK,EAAE,aAAa,MAAM,QAAQ;AAAA,IAC/D;AACA,QAAI,MAAM,QAAQ;AAChB,iBAAW,SAAS,OAAO,OAAK,EAAE,WAAW,MAAM,MAAM;AAAA,IAC3D;AACA,QAAI,MAAM,cAAc;AACtB,iBAAW,SAAS,OAAO,OAAK,EAAE,UAAU,SAAS,MAAM,YAAY;AAAA,IACzE;AACA,QAAI,MAAM,YAAY;AACpB,iBAAW,SAAS,OAAO,OAAK,EAAE,UAAU,OAAO,MAAM,UAAU;AAAA,IACrE;AAGA,QAAI,MAAM,WAAW;AACnB,iBAAW,SAAS,OAAO,OAAK,EAAE,aAAa,MAAM,SAAU;AAAA,IACjE;AACA,QAAI,MAAM,SAAS;AACjB,iBAAW,SAAS,OAAO,OAAK,EAAE,aAAa,MAAM,OAAQ;AAAA,IAC/D;AAGA,QAAI,MAAM,QAAQ;AAChB,YAAM,cAAc,MAAM,OAAO,YAAY;AAC7C,iBAAW,SAAS;AAAA,QAAO,OACzB,EAAE,YAAY,YAAY,EAAE,SAAS,WAAW,KAChD,EAAE,SAAS,YAAY,EAAE,SAAS,WAAW,KAC7C,EAAE,QAAQ,WAAW,YAAY,EAAE,SAAS,WAAW,KACvD,EAAE,UAAU,MAAM,YAAY,EAAE,SAAS,WAAW;AAAA,MACtD;AAAA,IACF;AAGA,aAAS,KAAK,CAAC,GAAG,MAAM;AACtB,UAAI,UAAU;AACd,cAAQ,MAAM,QAAQ;AAAA,QACpB,KAAK;AACH,oBAAU,EAAE,UAAU,QAAQ,IAAI,EAAE,UAAU,QAAQ;AACtD;AAAA,QACF,KAAK;AACH,oBAAU,gBAAgB,EAAE,QAAQ,IAAI,gBAAgB,EAAE,QAAQ;AAClE;AAAA,QACF,KAAK;AACH,oBAAU,EAAE,SAAS,cAAc,EAAE,QAAQ;AAC7C;AAAA,MACJ;AACA,aAAO,MAAM,cAAc,SAAS,CAAC,UAAU;AAAA,IACjD,CAAC;AAGD,UAAM,QAAQ,SAAS;AACvB,UAAM,SAAS,MAAM,UAAU;AAC/B,UAAM,QAAQ,MAAM,SAAS;AAC7B,UAAM,YAAY,SAAS,MAAM,QAAQ,SAAS,KAAK;AAEvD,WAAO;AAAA,MACL,QAAQ;AAAA,MACR;AAAA,MACA;AAAA,MACA;AAAA,MACA,SAAS,SAAS,QAAQ;AAAA,IAC5B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,SAAS,IAAwC;AACrD,WAAO,KAAK,OAAO,KAAK,OAAK,EAAE,OAAO,EAAE,KAAK;AAAA,EAC/C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,cAAc,QAAgB,QAAQ,IAA2B;AACrE,UAAM,SAAS,MAAM,KAAK,MAAM;AAAA,MAC9B;AAAA,MACA;AAAA,MACA,QAAQ;AAAA,MACR,WAAW;AAAA,IACb,CAAC;AACD,WAAO,OAAO;AAAA,EAChB;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aAAa,OAAe,QAAQ,KAA4B;AACpE,UAAM,SAAS,MAAM,KAAK,MAAM;AAAA,MAC9B;AAAA,MACA;AAAA,MACA,QAAQ;AAAA,MACR,WAAW;AAAA,IACb,CAAC;AACD,WAAO,OAAO;AAAA,EAChB;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,kBACJ,OACA,UACA,QAAQ,KACe;AACvB,UAAM,SAAS,MAAM,KAAK,MAAM;AAAA,MAC9B;AAAA,MACA,UAAU;AAAA,MACV;AAAA,MACA;AAAA,MACA,QAAQ;AAAA,MACR,WAAW;AAAA,IACb,CAAC;AACD,WAAO,OAAO;AAAA,EAChB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,SAAS,OAAgB,OAAO,IAAyB;AAC7D,UAAM,YAAY,oBAAI,KAAK;AAC3B,cAAU,QAAQ,UAAU,QAAQ,IAAI,IAAI;AAE5C,UAAM,SAAS,MAAM,KAAK,MAAM;AAAA,MAC9B;AAAA,MACA;AAAA,MACA,OAAO;AAAA,IACT,CAAC;AAED,UAAM,SAAS,OAAO;AAGtB,UAAM,mBAA2C,CAAC;AAClD,eAAW,KAAK,QAAQ;AACtB,uBAAiB,EAAE,QAAQ,KAAK,iBAAiB,EAAE,QAAQ,KAAK,KAAK;AAAA,IACvE;AAGA,UAAM,mBAA2C,CAAC;AAClD,eAAW,KAAK,QAAQ;AACtB,uBAAiB,EAAE,QAAQ,KAAK,iBAAiB,EAAE,QAAQ,KAAK,KAAK;AAAA,IACvE;AAGA,UAAM,iBAAyC,CAAC;AAChD,eAAW,KAAK,QAAQ;AACtB,qBAAe,EAAE,MAAM,KAAK,eAAe,EAAE,MAAM,KAAK,KAAK;AAAA,IAC/D;AAGA,UAAM,aAAgE,CAAC;AACvE,eAAW,KAAK,QAAQ;AACtB,UAAI,EAAE,QAAQ,QAAQ;AACpB,YAAI,CAAC,WAAW,EAAE,QAAQ,MAAM,GAAG;AACjC,qBAAW,EAAE,QAAQ,MAAM,IAAI,EAAE,OAAO,EAAE,QAAQ,WAAW,OAAO,EAAE;AAAA,QACxE;AACA,mBAAW,EAAE,QAAQ,MAAM,EAAE;AAAA,MAC/B;AAAA,IACF;AACA,UAAM,WAAW,OAAO,QAAQ,UAAU,EACvC,IAAI,CAAC,CAAC,QAAQ,IAAI,OAAO,EAAE,QAAQ,OAAO,KAAK,OAAO,YAAY,KAAK,MAAM,EAAE,EAC/E,KAAK,CAAC,GAAG,MAAM,EAAE,aAAa,EAAE,UAAU,EAC1C,MAAM,GAAG,EAAE;AAGd,UAAM,iBAAyC,CAAC;AAChD,eAAW,KAAK,QAAQ;AACtB,UAAI,EAAE,UAAU;AACd,cAAM,MAAM,GAAG,EAAE,SAAS,IAAI,IAAI,EAAE,SAAS,EAAE;AAC/C,uBAAe,GAAG,KAAK,eAAe,GAAG,KAAK,KAAK;AAAA,MACrD;AAAA,IACF;AACA,UAAM,eAAe,OAAO,QAAQ,cAAc,EAC/C,IAAI,CAAC,CAAC,KAAK,KAAK,MAAM;AACrB,YAAM,CAAC,MAAM,EAAE,IAAI,IAAI,MAAM,GAAG;AAChC,aAAO,EAAE,cAAc,MAAM,YAAY,IAAI,YAAY,MAAM;AAAA,IACjE,CAAC,EACA,KAAK,CAAC,GAAG,MAAM,EAAE,aAAa,EAAE,UAAU,EAC1C,MAAM,GAAG,EAAE;AAGd,UAAM,cAAsC,CAAC;AAC7C,eAAW,KAAK,QAAQ;AACtB,YAAM,OAAO,EAAE,UAAU,YAAY,EAAE,MAAM,GAAG,EAAE,CAAC;AACnD,kBAAY,IAAI,KAAK,YAAY,IAAI,KAAK,KAAK;AAAA,IACjD;AACA,UAAM,iBAAiB,OAAO,QAAQ,WAAW,EAC9C,IAAI,CAAC,CAAC,MAAM,KAAK,OAAO,EAAE,MAAM,MAAM,EAAE,EACxC,KAAK,CAAC,GAAG,MAAM,EAAE,KAAK,cAAc,EAAE,IAAI,CAAC;AAE9C,WAAO;AAAA,MACL,aAAa,OAAO;AAAA,MACpB;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,OAAO,SAA8C;AACzD,UAAM,SAAS,MAAM,KAAK,MAAM,QAAQ,KAAK;AAE7C,QAAI;AAEJ,YAAQ,QAAQ,QAAQ;AAAA,MACtB,KAAK;AACH,iBAAS,KAAK;AAAA,UACZ,OAAO,OAAO,IAAI,OAAK,KAAK,mBAAmB,GAAG,OAAO,CAAC;AAAA,UAC1D;AAAA,UACA;AAAA,QACF;AACA;AAAA,MAEF,KAAK;AACH,iBAAS,KAAK,YAAY,OAAO,QAAQ,OAAO;AAChD;AAAA,MAEF,KAAK;AAEH,iBAAS,KAAK;AAAA,UACZ,OAAO,OAAO,IAAI,OAAK,KAAK,mBAAmB,GAAG,OAAO,CAAC;AAAA,UAC1D;AAAA,UACA;AAAA,QACF;AACA;AAAA,MAEF;AACE,cAAM,IAAI,MAAM,8BAA8B,QAAQ,MAAM,EAAE;AAAA,IAClE;AAEA,SAAK,KAAK,kBAAkB,QAAQ,QAAQ,OAAO,OAAO,MAAM;AAEhE,WAAO;AAAA,EACT;AAAA,EAEQ,mBACN,OACA,SACyB;AACzB,UAAM,SAAkC;AAAA,MACtC,IAAI,MAAM;AAAA,MACV,WAAW,MAAM,UAAU,YAAY;AAAA,MACvC,UAAU,MAAM;AAAA,MAChB,QAAQ,MAAM;AAAA,MACd,UAAU,MAAM;AAAA,MAChB,QAAQ,MAAM;AAAA,MACd,aAAa,MAAM;AAAA,IACrB;AAEA,QAAI,QAAQ,gBAAgB;AAC1B,aAAO,UAAU,MAAM;AAAA,IACzB;AAEA,QAAI,QAAQ,kBAAkB,MAAM,SAAS;AAC3C,aAAO,UAAU,MAAM;AAAA,IACzB;AAEA,QAAI,QAAQ,mBAAmB,MAAM,UAAU;AAC7C,aAAO,WAAW,MAAM;AAAA,IAC1B;AAEA,QAAI,MAAM,UAAU;AAClB,aAAO,WAAW,MAAM;AAAA,IAC1B;AAEA,QAAI,MAAM,WAAW;AACnB,aAAO,YAAY,MAAM;AACzB,aAAO,eAAe,MAAM;AAAA,IAC9B;AAEA,WAAO;AAAA,EACT;AAAA,EAEQ,YAAY,QAAsB,SAAqC;AAC7E,UAAM,UAAU;AAAA,MACd;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAEA,UAAM,OAAO,OAAO,IAAI,OAAK;AAAA,MAC3B,EAAE;AAAA,MACF,EAAE,UAAU,YAAY;AAAA,MACxB,EAAE;AAAA,MACF,EAAE;AAAA,MACF,EAAE;AAAA,MACF,EAAE;AAAA,MACF,IAAI,EAAE,YAAY,QAAQ,MAAM,IAAI,CAAC;AAAA,MACrC,EAAE,QAAQ,UAAU;AAAA,MACpB,EAAE,QAAQ,aAAa;AAAA,MACvB,EAAE,QAAQ,SAAS;AAAA,MACnB,EAAE,UAAU,QAAQ;AAAA,MACpB,EAAE,UAAU,MAAM;AAAA,IACpB,CAAC;AAED,WAAO,CAAC,QAAQ,KAAK,GAAG,GAAG,GAAG,KAAK,IAAI,OAAK,EAAE,KAAK,GAAG,CAAC,CAAC,EAAE,KAAK,IAAI;AAAA,EACrE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,iBAAiE;AACrE,UAAM,WAAW,KAAK,OAAO,qBAAqB,KAAK,mBAAmB;AAC1E,QAAI,UAAU;AACd,QAAI,WAAW;AAEf,eAAW,UAAU,UAAU;AAC7B,YAAM,aAAa,oBAAI,KAAK;AAC5B,iBAAW,QAAQ,WAAW,QAAQ,IAAI,OAAO,aAAa;AAG9D,YAAM,YAAY,KAAK,OAAO;AAAA,QAC5B,OAAK,EAAE,aAAa,OAAO,YAAY,EAAE,YAAY;AAAA,MACvD;AAGA,UAAI,OAAO,kBAAkB;AAC3B,cAAM,gBAAgB,oBAAI,KAAK;AAC/B,sBAAc,QAAQ,cAAc,QAAQ,IAAI,OAAO,gBAAgB;AAEvE,cAAM,YAAY,UAAU,OAAO,OAAK,EAAE,aAAa,aAAa;AAEpE,oBAAY,UAAU;AAAA,MACxB;AAGA,YAAM,WAAW,OAAO,qBACpB,YACA,UAAU,OAAO,OAAK;AACpB,YAAI,OAAO,kBAAkB;AAC3B,gBAAM,gBAAgB,oBAAI,KAAK;AAC/B,wBAAc,QAAQ,cAAc,QAAQ,IAAI,OAAO,gBAAgB;AACvE,iBAAO,EAAE,YAAY;AAAA,QACvB;AACA,eAAO;AAAA,MACT,CAAC;AAEL,WAAK,SAAS,KAAK,OAAO,OAAO,OAAK,CAAC,SAAS,SAAS,CAAC,CAAC;AAC3D,iBAAW,SAAS;AAAA,IACtB;AAEA,SAAK,KAAK,qBAAqB,SAAS,QAAQ;AAEhD,WAAO,EAAE,SAAS,SAAS;AAAA,EAC7B;AAAA,EAEQ,qBAA6C;AACnD,WAAO,OAAO,QAAQ,sBAAsB,EAAE,IAAI,CAAC,CAAC,UAAU,IAAI,OAAO;AAAA,MACvE;AAAA,MACA,eAAe;AAAA,IACjB,EAAE;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,gBAAgB,QAGnB;AACD,UAAM,WAAW,UAAU,KAAK;AAChC,UAAM,gBAA0B,CAAC;AAEjC,QAAI,eAA8B;AAElC,eAAW,SAAS,SAAS,KAAK,CAAC,GAAG,MAAM,EAAE,UAAU,QAAQ,IAAI,EAAE,UAAU,QAAQ,CAAC,GAAG;AAC1F,UAAI,CAAC,MAAM,MAAM;AACf,sBAAc,KAAK,MAAM,EAAE;AAC3B;AAAA,MACF;AAGA,YAAM,eAAe,KAAK,YAAY,KAAK;AAC3C,UAAI,iBAAiB,MAAM,MAAM;AAC/B,sBAAc,KAAK,MAAM,EAAE;AAC3B;AAAA,MACF;AAGA,UAAI,gBAAgB,MAAM,iBAAiB,cAAc;AACvD,sBAAc,KAAK,MAAM,EAAE;AAAA,MAC7B;AAEA,qBAAe,MAAM;AAAA,IACvB;AAEA,WAAO;AAAA,MACL,OAAO,cAAc,WAAW;AAAA,MAChC;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMQ,YAAY,OAAqC;AACvD,UAAM,KAAK,KAAK,WAAW;AAC3B,UAAM,YAAY,oBAAI,KAAK;AAE3B,UAAM,QAAoB;AAAA,MACxB;AAAA,MACA;AAAA,MACA,GAAG;AAAA,MACH,eAAe,MAAM,iBAAiB,uBAAuB,MAAM,QAAQ;AAAA,IAC7E;AAEA,QAAI,KAAK,OAAO,qBAAqB;AACnC,YAAM,eAAe,KAAK,YAAY;AACtC,YAAM,OAAO,KAAK,YAAY,KAAK;AACnC,WAAK,WAAW,MAAM;AAAA,IACxB;AAEA,WAAO;AAAA,EACT;AAAA,EAEA,MAAc,WAAW,OAAkC;AACzD,YAAQ,KAAK,OAAO,aAAa;AAAA,MAC/B,KAAK;AACH,aAAK,OAAO,KAAK,KAAK;AACtB;AAAA,MAEF,KAAK;AAEH,aAAK,OAAO,KAAK,KAAK;AACtB;AAAA,MAEF,KAAK;AAEH,aAAK,OAAO,KAAK,KAAK;AACtB;AAAA,IACJ;AAEA,SAAK,KAAK,gBAAgB,KAAK;AAAA,EACjC;AAAA,EAEQ,sBAA4B;AAClC,SAAK,aAAa,YAAY,MAAM;AAClC,UAAI,KAAK,MAAM,SAAS,KAAK,CAAC,KAAK,cAAc;AAC/C,aAAK,aAAa,EAAE,MAAM,SAAO,KAAK,KAAK,SAAS,GAAG,CAAC;AAAA,MAC1D;AAAA,IACF,GAAG,KAAK,OAAO,eAAe;AAAA,EAChC;AAAA,EAEA,MAAc,eAA8B;AAC1C,QAAI,KAAK,MAAM,WAAW,KAAK,KAAK,aAAc;AAElD,SAAK,eAAe;AAEpB,QAAI;AACF,YAAM,QAAQ,KAAK,MAAM,OAAO,GAAG,KAAK,OAAO,SAAS;AACxD,YAAM,SAAS,MAAM,IAAI,WAAS,KAAK,YAAY,KAAK,CAAC;AAEzD,iBAAW,SAAS,QAAQ;AAC1B,cAAM,KAAK,WAAW,KAAK;AAAA,MAC7B;AAAA,IACF,UAAE;AACA,WAAK,eAAe;AAAA,IACtB;AAAA,EACF;AAAA,EAEQ,YAAY,OAA2B;AAC7C,UAAM,OAAO,KAAK,UAAU;AAAA,MAC1B,IAAI,MAAM;AAAA,MACV,WAAW,MAAM,UAAU,YAAY;AAAA,MACvC,UAAU,MAAM;AAAA,MAChB,QAAQ,MAAM;AAAA,MACd,aAAa,MAAM;AAAA,MACnB,SAAS,MAAM;AAAA,MACf,UAAU,MAAM;AAAA,MAChB,cAAc,MAAM;AAAA,IACtB,CAAC;AAED,WAAO,WAAW,KAAK,OAAO,aAAa,EAAE,OAAO,IAAI,EAAE,OAAO,KAAK;AAAA,EACxE;AAAA,EAEQ,aAAqB;AAC3B,WAAO,OAAO,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,GAAG,EAAE,CAAC;AAAA,EACrE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,QAAuB;AAC3B,QAAI,KAAK,MAAM,SAAS,GAAG;AACzB,YAAM,KAAK,aAAa;AAAA,IAC1B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAsB;AAC1B,QAAI,KAAK,YAAY;AACnB,oBAAc,KAAK,UAAU;AAC7B,WAAK,aAAa;AAAA,IACpB;AACA,UAAM,KAAK,MAAM;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA,EAKA,eAAuB;AACrB,WAAO,KAAK,MAAM;AAAA,EACpB;AAAA;AAAA;AAAA;AAAA,EAKA,gBAAwB;AACtB,WAAO,KAAK,OAAO;AAAA,EACrB;AACF;AAMA,IAAI,sBAA0C;AAEvC,SAAS,iBAA8B;AAC5C,MAAI,CAAC,qBAAqB;AACxB,0BAAsB,IAAI,YAAY;AAAA,EACxC;AACA,SAAO;AACT;AAEO,SAAS,kBAAkB,QAAkD;AAClF,SAAO,IAAI,YAAY,MAAM;AAC/B;;;AC7zBA,SAAS,KAAAE,UAAS;AAMX,IAAM,oBAAoBA,GAAE,KAAK,CAAC,UAAU,UAAU,WAAW,CAAC;AAOlE,IAAM,mBAAmBA,GAAE,OAAO;AAAA,EACvC,IAAIA,GAAE,OAAO;AAAA,EACb,OAAOA,GAAE,OAAO;AAAA,EAChB,UAAU;AAAA,EACV,OAAOA,GAAE,OAAO;AAAA,EAChB,MAAMA,GAAE,OAAO;AAAA,EACf,QAAQA,GAAE,OAAO,EAAE,QAAQ,MAAM;AAAA,EACjC,MAAMA,GAAE,OAAO,EAAE,QAAQ,iBAAiB;AAAA;AAAA,EAC1C,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EACjC,eAAeA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EACnC,aAAaA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,EACrC,UAAUA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA;AAAA,EAClC,WAAWA,GAAE,OAAO;AAAA,EACpB,WAAWA,GAAE,OAAO;AACtB,CAAC;AAGM,IAAM,yBAAyB,iBAAiB,KAAK;AAAA,EAC1D,IAAI;AAAA,EACJ,WAAW;AAAA,EACX,WAAW;AACb,CAAC;AAOM,IAAM,yBAAyBA,GAAE,OAAO;AAAA,EAC7C,IAAIA,GAAE,OAAO;AAAA,EACb,MAAMA,GAAE,OAAO;AAAA,EACf,MAAMA,GAAE,OAAO;AAAA,EACf,QAAQA,GAAE,OAAOA,GAAE,QAAQ,CAAC,EAAE,SAAS;AAAA,EACvC,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,WAAWA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAC/B,WAAWA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAC1C,CAAC;AAGM,IAAM,qBAAqBA,GAAE,OAAO;AAAA,EACzC,SAASA,GAAE,QAAQ,KAAK;AAAA,EACxB,MAAMA,GAAE,OAAO;AAAA,EACf,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAC9B,SAASA,GAAE,OAAO;AAAA,IAChB,QAAQA,GAAE,MAAMA,GAAE,KAAK,CAAC,QAAQ,gBAAgB,YAAY,UAAU,SAAS,CAAC,CAAC,EAAE,SAAS;AAAA,IAC5F,UAAUA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,IACvC,OAAOA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,EACtC,CAAC,EAAE,SAAS;AAAA,EACZ,KAAKA,GAAE,OAAOA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,EACnC,OAAOA,GAAE,MAAM,sBAAsB;AAAA,EACrC,eAAeA,GAAE,OAAO;AAAA,IACtB,WAAWA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA;AAAA,IACxC,WAAWA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,EAC1C,CAAC,EAAE,SAAS;AAAA,EACZ,QAAQA,GAAE,OAAO;AAAA,IACf,eAAeA,GAAE,OAAO,EAAE,SAAS;AAAA,IACnC,cAAcA,GAAE,OAAO,EAAE,SAAS;AAAA,EACpC,CAAC,EAAE,SAAS;AACd,CAAC;AAOM,IAAM,mBAAmBA,GAAE,KAAK;AAAA,EACrC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,mBAAmBA,GAAE,OAAO;AAAA,EACvC,IAAIA,GAAE,OAAO;AAAA,EACb,cAAcA,GAAE,OAAO;AAAA,EACvB,YAAYA,GAAE,OAAO;AAAA,EACrB,UAAUA,GAAE,OAAO;AAAA,EACnB,WAAWA,GAAE,OAAO;AAAA,EACpB,QAAQ;AAAA,EACR,WAAWA,GAAE,KAAK,CAAC,QAAQ,MAAM,CAAC;AAAA,EAClC,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,WAAWA,GAAE,OAAO;AACtB,CAAC;AAOM,IAAM,wBAAwBA,GAAE,OAAO;AAAA,EAC5C,IAAIA,GAAE,OAAO;AAAA,EACb,UAAU;AAAA,EACV,OAAOA,GAAE,OAAO;AAAA;AAAA,EAChB,QAAQA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAC5B,MAAMA,GAAE,OAAO;AAAA,IACb,OAAOA,GAAE,OAAO;AAAA,IAChB,MAAMA,GAAE,OAAO;AAAA,EACjB,CAAC;AAAA,EACD,KAAKA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EACzB,QAAQA,GAAE,OAAO;AAAA,IACf,KAAKA,GAAE,OAAO;AAAA,IACd,SAASA,GAAE,OAAO;AAAA,IAClB,QAAQA,GAAE,OAAO;AAAA,EACnB,CAAC,EAAE,SAAS;AAAA,EACZ,aAAaA,GAAE,OAAO;AAAA,IACpB,QAAQA,GAAE,OAAO;AAAA,IACjB,OAAOA,GAAE,OAAO;AAAA,IAChB,OAAOA,GAAE,OAAO;AAAA,IAChB,cAAcA,GAAE,OAAO;AAAA,IACvB,cAAcA,GAAE,OAAO;AAAA,EACzB,CAAC,EAAE,SAAS;AAAA,EACZ,QAAQA,GAAE,OAAO;AAAA,IACf,OAAOA,GAAE,OAAO;AAAA,IAChB,WAAWA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,CAAC;AAAA,EACD,YAAYA,GAAE,OAAO;AACvB,CAAC;AAOM,IAAM,mBAAmBA,GAAE,OAAO;AAAA,EACvC,MAAMA,GAAE,OAAO;AAAA,EACf,QAAQA,GAAE,KAAK,CAAC,SAAS,YAAY,WAAW,SAAS,CAAC;AAAA,EAC1D,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAC7B,WAAWA,GAAE,OAAO;AAAA,EACpB,WAAWA,GAAE,OAAO;AACtB,CAAC;AAGM,IAAM,uBAAuBA,GAAE,OAAO;AAAA,EAC3C,YAAYA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAChC,cAAcA,GAAE,OAAO;AAAA,EACvB,UAAUA,GAAE,OAAO;AAAA,EACnB,YAAYA,GAAE,KAAK,CAAC,UAAU,UAAU,QAAQ,CAAC;AAAA,EACjD,SAAS,mBAAmB,SAAS;AAAA,EACrC,SAAS,mBAAmB,SAAS;AAAA,EACrC,MAAMA,GAAE,OAAO,EAAE,SAAS;AAAA;AAC5B,CAAC;AAOM,IAAM,mBAAmBA,GAAE,OAAO;AAAA,EACvC,IAAIA,GAAE,OAAO;AAAA,EACb,cAAcA,GAAE,OAAO;AAAA,EACvB,UAAUA,GAAE,OAAO;AAAA,EACnB,OAAOA,GAAE,OAAO;AAAA,EAChB,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,QAAQA,GAAE,KAAK,CAAC,QAAQ,UAAU,QAAQ,CAAC;AAAA,EAC3C,SAASA,GAAE,MAAM,oBAAoB;AAAA,EACrC,QAAQA,GAAE,OAAO;AAAA,EACjB,WAAWA,GAAE,OAAO;AAAA,EACpB,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC9B,cAAcA,GAAE,KAAK,CAAC,WAAW,YAAY,mBAAmB,CAAC,EAAE,SAAS;AAC9E,CAAC;AAOM,IAAM,yBAAyBA,GAAE,OAAO;AAAA;AAAA,EAE7C,iBAAiB,kBAAkB,QAAQ,QAAQ;AAAA;AAAA,EAGnD,gBAAgBA,GAAE,OAAO,EAAE,QAAQ,GAAK;AAAA;AAAA,EACxC,oBAAoBA,GAAE,OAAO,EAAE,QAAQ,CAAC;AAAA;AAAA,EAGxC,kBAAkBA,GAAE,KAAK,CAAC,cAAc,eAAe,QAAQ,CAAC,EAAE,QAAQ,QAAQ;AAAA;AAAA,EAGlF,aAAaA,GAAE,OAAO,EAAE,QAAQ,kBAAkB;AAAA;AAAA,EAGlD,eAAeA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AACzC,CAAC;;;ACvMD,SAAS,SAAS,WAAW,aAAa,qBAAqB;AAoBxD,SAAS,kBAAkB,aAAkC;AAClE,MAAI;AACF,UAAM,SAAS,UAAU,WAAW;AAGpC,UAAM,SAAS,mBAAmB,UAAU,MAAM;AAElD,QAAI,CAAC,OAAO,SAAS;AACnB,aAAO;AAAA,QACL,SAAS;AAAA,QACT,QAAQ,OAAO,MAAM,OAAO;AAAA,UAC1B,CAAC,MAAM,GAAG,EAAE,KAAK,KAAK,GAAG,CAAC,KAAK,EAAE,OAAO;AAAA,QAC1C;AAAA,MACF;AAAA,IACF;AAEA,WAAO;AAAA,MACL,SAAS;AAAA,MACT,UAAU,OAAO;AAAA,IACnB;AAAA,EACF,SAAS,OAAO;AACd,WAAO;AAAA,MACL,SAAS;AAAA,MACT,QAAQ,CAAC,iBAAiB,QAAQ,MAAM,UAAU,qBAAqB;AAAA,IACzE;AAAA,EACF;AACF;AAKO,SAAS,sBAAsB,UAAgC;AACpE,SAAO,cAAc,UAAU;AAAA,IAC7B,QAAQ;AAAA,IACR,WAAW;AAAA,IACX,mBAAmB;AAAA,IACnB,gBAAgB;AAAA,EAClB,CAAC;AACH;AA6BO,SAAS,eACd,MACA,YACkB;AAClB,SAAO;AAAA,IACL,IAAI,cAAc,WAAW,UAAU;AAAA,IACvC,MAAM,KAAK;AAAA,IACX,aAAa,KAAK;AAAA,IAClB,UAAU,KAAK;AAAA,IACf,OAAO,KAAK,MAAM,IAAI,CAAC,UAAU;AAAA,MAC/B,IAAI,KAAK,MAAM,WAAW,MAAM;AAAA,MAChC,MAAM,KAAK;AAAA,MACX,QAAQ,KAAK;AAAA,MACb,QAAQ,KAAK;AAAA,MACb,SAAS,KAAK;AAAA,MACd,SAAS,KAAK;AAAA,MACd,WAAW,KAAK;AAAA,MAChB,WAAW,KAAK;AAAA,IAClB,EAAE;AAAA,IACF,UAAU;AAAA,MACR,SAAS,KAAK;AAAA,MACd,KAAK,KAAK;AAAA,MACV,eAAe,KAAK;AAAA,MACpB,QAAQ,KAAK;AAAA,MACb,aAAa,KAAK;AAAA,IACpB;AAAA,EACF;AACF;AAKO,SAAS,eAAe,UAA0C;AACvE,QAAM,WAAW,SAAS,YAAY,CAAC;AAEvC,SAAO;AAAA,IACL,SAAS;AAAA,IACT,MAAM,SAAS;AAAA,IACf,aAAa,SAAS;AAAA,IACtB,UAAU,SAAS;AAAA,IACnB,SAAS,SAAS;AAAA,IAClB,KAAK,SAAS;AAAA,IACd,OAAO,SAAS,MAAM,IAAI,CAAC,UAAU;AAAA,MACnC,IAAI,KAAK;AAAA,MACT,MAAM,KAAK;AAAA,MACX,MAAM,KAAK;AAAA,MACX,QAAQ,KAAK;AAAA,MACb,SAAS,KAAK;AAAA,MACd,SAAS,KAAK;AAAA,MACd,WAAW,KAAK;AAAA,MAChB,WAAW,KAAK;AAAA,IAClB,EAAE;AAAA,IACF,eAAe,SAAS;AAAA,IACxB,QAAQ,SAAS;AAAA,EACnB;AACF;AA2BO,SAAS,qBAAqB,MAAsC;AACzE,QAAM,SAA4B,CAAC;AACnC,QAAM,WAAgC,CAAC;AAGvC,QAAM,UAAU,oBAAI,IAAY;AAChC,aAAW,QAAQ,KAAK,OAAO;AAC7B,QAAI,QAAQ,IAAI,KAAK,EAAE,GAAG;AACxB,aAAO,KAAK;AAAA,QACV,MAAM,SAAS,KAAK,EAAE;AAAA,QACtB,SAAS,sBAAsB,KAAK,EAAE;AAAA,QACtC,UAAU;AAAA,MACZ,CAAC;AAAA,IACH;AACA,YAAQ,IAAI,KAAK,EAAE;AAAA,EACrB;AAGA,aAAW,QAAQ,KAAK,OAAO;AAC7B,QAAI,KAAK,WAAW;AAClB,iBAAW,OAAO,KAAK,WAAW;AAChC,YAAI,CAAC,QAAQ,IAAI,GAAG,GAAG;AACrB,iBAAO,KAAK;AAAA,YACV,MAAM,SAAS,KAAK,EAAE;AAAA,YACtB,SAAS,uBAAuB,GAAG;AAAA,YACnC,UAAU;AAAA,UACZ,CAAC;AAAA,QACH;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAGA,QAAM,eAAe,2BAA2B,KAAK,KAAK;AAC1D,MAAI,aAAa,SAAS,GAAG;AAC3B,WAAO,KAAK;AAAA,MACV,MAAM;AAAA,MACN,SAAS,iCAAiC,aAAa,KAAK,MAAM,CAAC;AAAA,MACnE,UAAU;AAAA,IACZ,CAAC;AAAA,EACH;AAGA,MAAI,CAAC,KAAK,aAAa;AACrB,aAAS,KAAK;AAAA,MACZ,MAAM;AAAA,MACN,SAAS;AAAA,MACT,UAAU;AAAA,IACZ,CAAC;AAAA,EACH;AAGA,aAAW,QAAQ,KAAK,OAAO;AAC7B,QAAI,CAAC,KAAK,SAAS;AACjB,eAAS,KAAK;AAAA,QACZ,MAAM,SAAS,KAAK,EAAE;AAAA,QACtB,SAAS,SAAS,KAAK,IAAI;AAAA,QAC3B,UAAU;AAAA,MACZ,CAAC;AAAA,IACH;AAAA,EACF;AAGA,MAAI,CAAC,KAAK,QAAQ;AAChB,aAAS,KAAK;AAAA,MACZ,MAAM;AAAA,MACN,SAAS;AAAA,MACT,UAAU;AAAA,IACZ,CAAC;AAAA,EACH;AAEA,SAAO;AAAA,IACL,OAAO,OAAO,WAAW;AAAA,IACzB;AAAA,IACA;AAAA,EACF;AACF;AAKA,SAAS,2BAA2B,OAAqC;AACvE,QAAM,QAAQ,oBAAI,IAAsB;AAExC,aAAW,QAAQ,OAAO;AACxB,UAAM,IAAI,KAAK,IAAI,KAAK,aAAa,CAAC,CAAC;AAAA,EACzC;AAEA,QAAM,UAAU,oBAAI,IAAY;AAChC,QAAM,iBAAiB,oBAAI,IAAY;AACvC,QAAMC,QAAiB,CAAC;AAExB,WAAS,IAAI,QAAiC;AAC5C,YAAQ,IAAI,MAAM;AAClB,mBAAe,IAAI,MAAM;AACzB,IAAAA,MAAK,KAAK,MAAM;AAEhB,UAAM,YAAY,MAAM,IAAI,MAAM,KAAK,CAAC;AACxC,eAAW,YAAY,WAAW;AAChC,UAAI,CAAC,QAAQ,IAAI,QAAQ,GAAG;AAC1B,cAAM,SAAS,IAAI,QAAQ;AAC3B,YAAI,OAAQ,QAAO;AAAA,MACrB,WAAW,eAAe,IAAI,QAAQ,GAAG;AAEvC,cAAM,aAAaA,MAAK,QAAQ,QAAQ;AACxC,eAAO,CAAC,GAAGA,MAAK,MAAM,UAAU,GAAG,QAAQ;AAAA,MAC7C;AAAA,IACF;AAEA,IAAAA,MAAK,IAAI;AACT,mBAAe,OAAO,MAAM;AAC5B,WAAO;AAAA,EACT;AAEA,aAAW,QAAQ,OAAO;AACxB,QAAI,CAAC,QAAQ,IAAI,KAAK,EAAE,GAAG;AACzB,YAAM,QAAQ,IAAI,KAAK,EAAE;AACzB,UAAI,MAAO,QAAO;AAAA,IACpB;AAAA,EACF;AAEA,SAAO,CAAC;AACV;AASO,SAAS,qBACd,SACA,SACQ;AACR,MAAI,CAAC,WAAW,CAAC,QAAS,QAAO;AACjC,MAAI,CAAC,QAAS,QAAO,mBAAmB,QAAS,IAAI;AACrD,MAAI,CAAC,QAAS,QAAO,uBAAuB,QAAQ,IAAI;AAExD,QAAM,UAAoB,CAAC;AAG3B,MAAI,QAAQ,SAAS,QAAQ,MAAM;AACjC,YAAQ,KAAK,YAAY,QAAQ,IAAI,SAAS,QAAQ,IAAI,GAAG;AAAA,EAC/D;AAGA,MAAI,QAAQ,gBAAgB,QAAQ,aAAa;AAC/C,YAAQ,KAAK,uBAAuB;AAAA,EACtC;AAGA,MAAI,QAAQ,aAAa,QAAQ,UAAU;AACzC,YAAQ;AAAA,MACN,gBAAgB,QAAQ,YAAY,MAAM,SAAS,QAAQ,YAAY,MAAM;AAAA,IAC/E;AAAA,EACF;AAGA,QAAM,aAAa,IAAI,IAAI,QAAQ,MAAM,IAAI,CAAC,MAAM,EAAE,EAAE,CAAC;AACzD,QAAM,aAAa,IAAI,IAAI,QAAQ,MAAM,IAAI,CAAC,MAAM,EAAE,EAAE,CAAC;AAGzD,aAAW,QAAQ,QAAQ,OAAO;AAChC,QAAI,CAAC,WAAW,IAAI,KAAK,EAAE,GAAG;AAC5B,cAAQ,KAAK,WAAW,KAAK,IAAI,KAAK,KAAK,EAAE,GAAG;AAAA,IAClD;AAAA,EACF;AAGA,aAAW,QAAQ,QAAQ,OAAO;AAChC,QAAI,CAAC,WAAW,IAAI,KAAK,EAAE,GAAG;AAC5B,cAAQ,KAAK,WAAW,KAAK,IAAI,KAAK,KAAK,EAAE,GAAG;AAAA,IAClD;AAAA,EACF;AAGA,aAAW,WAAW,QAAQ,OAAO;AACnC,UAAM,UAAU,QAAQ,MAAM,KAAK,CAAC,MAAM,EAAE,OAAO,QAAQ,EAAE;AAC7D,QAAI,SAAS;AACX,UACE,QAAQ,SAAS,QAAQ,QACzB,QAAQ,SAAS,QAAQ,QACzB,KAAK,UAAU,QAAQ,MAAM,MAAM,KAAK,UAAU,QAAQ,MAAM,GAChE;AACA,gBAAQ,KAAK,oBAAoB,QAAQ,IAAI,KAAK,QAAQ,EAAE,GAAG;AAAA,MACjE;AAAA,IACF;AAAA,EACF;AAEA,SAAO,QAAQ,SAAS,IACpB,QAAQ,KAAK,IAAI,IACjB;AACN;AAMA,SAAS,WAAW,QAAwB;AAC1C,SAAO,GAAG,MAAM,IAAI,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,GAAG,CAAC,CAAC;AAC1E;AAMO,IAAM,oBAAoB;AAAA,EAC/B,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAsBP,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA6CX,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA4CR;;;ACxeA,SAAS,gBAAAC,qBAAoB;AAiD7B,IAAM,eAAN,MAAmB;AAAA,EACT;AAAA,EACA,UAAU;AAAA,EAElB,YAAY,OAAe;AACzB,SAAK,QAAQ;AAAA,EACf;AAAA,EAEA,MAAc,QACZ,QACAC,OACA,MACY;AACZ,UAAM,WAAW,MAAM,MAAM,GAAG,KAAK,OAAO,GAAGA,KAAI,IAAI;AAAA,MACrD;AAAA,MACA,SAAS;AAAA,QACP,QAAQ;AAAA,QACR,eAAe,UAAU,KAAK,KAAK;AAAA,QACnC,gBAAgB;AAAA,MAClB;AAAA,MACA,MAAM,OAAO,KAAK,UAAU,IAAI,IAAI;AAAA,IACtC,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AAChB,YAAM,QAAQ,MAAM,SAAS,KAAK;AAClC,YAAM,IAAI,MAAM,qBAAqB,SAAS,MAAM,MAAM,KAAK,EAAE;AAAA,IACnE;AAEA,WAAO,SAAS,KAAK;AAAA,EACvB;AAAA,EAEA,MAAM,QACJ,OACA,MACAA,OACA,KAC4B;AAC5B,QAAI;AACF,YAAM,QAAQ,MAAM,QAAQ,GAAG,KAAK;AACpC,aAAO,MAAM,KAAK;AAAA,QAChB;AAAA,QACA,UAAU,KAAK,IAAI,IAAI,aAAaA,KAAI,GAAG,KAAK;AAAA,MAClD;AAAA,IACF,QAAQ;AACN,aAAO;AAAA,IACT;AAAA,EACF;AAAA,EAEA,MAAM,UACJ,OACA,MACAA,OACA,KACuB;AACvB,QAAI;AACF,YAAM,QAAQ,MAAM,QAAQ,GAAG,KAAK;AACpC,YAAM,SAAS,MAAM,KAAK;AAAA,QACxB;AAAA,QACA,UAAU,KAAK,IAAI,IAAI,aAAaA,KAAI,GAAG,KAAK;AAAA,MAClD;AACA,aAAO,MAAM,QAAQ,MAAM,IAAI,SAAS,CAAC,MAAM;AAAA,IACjD,QAAQ;AACN,aAAO,CAAC;AAAA,IACV;AAAA,EACF;AAAA,EAEA,MAAM,mBACJ,OACA,MACAA,OACA,SACA,SACA,KACA,QACgD;AAChD,UAAM,OAAgC;AAAA,MACpC;AAAA,MACA,SAAS,OAAO,KAAK,OAAO,EAAE,SAAS,QAAQ;AAAA,IACjD;AACA,QAAI,IAAK,MAAK,MAAM;AACpB,QAAI,OAAQ,MAAK,SAAS;AAE1B,UAAM,SAAS,MAAM,KAAK,QAGvB,OAAO,UAAU,KAAK,IAAI,IAAI,aAAaA,KAAI,IAAI,IAAI;AAE1D,WAAO;AAAA,MACL,KAAK,OAAO,QAAQ;AAAA,MACpB,QAAQ,OAAO;AAAA,IACjB;AAAA,EACF;AAAA,EAEA,MAAM,WACJ,OACA,MACAA,OACA,KACA,SACA,QACe;AACf,UAAM,OAAgC,EAAE,SAAS,IAAI;AACrD,QAAI,OAAQ,MAAK,SAAS;AAE1B,UAAM,KAAK,QAAQ,UAAU,UAAU,KAAK,IAAI,IAAI,aAAaA,KAAI,IAAI,IAAI;AAAA,EAC/E;AAAA,EAEA,MAAM,gBACJ,OACA,MACA,QACuB;AACvB,UAAM,SAAS,MAAM,KAAK;AAAA,MACxB;AAAA,MACA,UAAU,KAAK,IAAI,IAAI,YAAY,MAAM;AAAA,IAC3C;AACA,WAAO,EAAE,GAAG,OAAO,QAAQ,KAAK,OAAO,IAAI;AAAA,EAC7C;AAAA,EAEA,MAAM,cACJ,OACA,MACA,YACA,QACA,SAAmB,CAAC,QAAQ,cAAc,GACjB;AACzB,WAAO,KAAK,QAAQ,QAAQ,UAAU,KAAK,IAAI,IAAI,UAAU;AAAA,MAC3D,MAAM;AAAA,MACN,QAAQ;AAAA,MACR;AAAA,MACA,QAAQ;AAAA,QACN,KAAK;AAAA,QACL,cAAc;AAAA,QACd;AAAA,MACF;AAAA,IACF,CAAC;AAAA,EACH;AAAA,EAEA,MAAM,cACJ,OACA,MACA,QACe;AACf,UAAM,KAAK,QAAQ,UAAU,UAAU,KAAK,IAAI,IAAI,UAAU,MAAM,EAAE;AAAA,EACxE;AACF;AAMO,IAAM,aAAN,cAAyBC,cAAwB;AAAA,EAC9C;AAAA,EACA,QAAiC,oBAAI,IAAI;AAAA,EACzC,UAAqC,oBAAI,IAAI;AAAA,EAC7C,cAAyC,oBAAI,IAAI;AAAA,EACjD,WAAgC,oBAAI,IAAI;AAAA;AAAA,EAEhD,YAAY,SAAoC,CAAC,GAAG;AAClD,UAAM;AACN,SAAK,SAAS,uBAAuB,MAAM,MAAM;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,YAAY,QAA+C;AAC/D,UAAM,OAAmB;AAAA,MACvB,GAAG;AAAA,MACH,IAAIC,YAAW,MAAM;AAAA,MACrB,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MAClC,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC;AAGA,QAAI,KAAK,aAAa;AACpB,YAAM,SAAS,KAAK,UAAU,IAAI;AAClC,YAAM,OAAO,gBAAgB,KAAK,OAAO,KAAK,MAAM,KAAK,MAAM;AAAA,IACjE;AAEA,SAAK,MAAM,IAAI,KAAK,IAAI,IAAI;AAC5B,SAAK,KAAK,kBAAkB,IAAI;AAGhC,QAAI,KAAK,aAAa;AACpB,YAAM,KAAK,cAAc,KAAK,EAAE;AAAA,IAClC;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,QAA+B;AAClD,UAAM,OAAO,KAAK,MAAM,IAAI,MAAM;AAClC,QAAI,CAAC,KAAM,OAAM,IAAI,MAAM,yBAAyB,MAAM,EAAE;AAE5D,SAAK,MAAM,OAAO,MAAM;AACxB,SAAK,QAAQ,OAAO,MAAM;AAC1B,SAAK,KAAK,qBAAqB,MAAM;AAAA,EACvC;AAAA;AAAA;AAAA;AAAA,EAKA,QAAQ,QAAwC;AAC9C,WAAO,KAAK,MAAM,IAAI,MAAM;AAAA,EAC9B;AAAA;AAAA;AAAA;AAAA,EAKA,YAA0B;AACxB,WAAO,MAAM,KAAK,KAAK,MAAM,OAAO,CAAC;AAAA,EACvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,cAAc,QAA2C;AAC7D,UAAM,OAAO,KAAK,MAAM,IAAI,MAAM;AAClC,QAAI,CAAC,KAAM,OAAM,IAAI,MAAM,yBAAyB,MAAM,EAAE;AAE5D,SAAK,KAAK,gBAAgB,QAAQ,MAAM;AAExC,QAAI;AACF,YAAM,SAAS,KAAK,UAAU,IAAI;AAClC,YAAM,QAAQ,MAAM,OAAO,UAAU,KAAK,OAAO,KAAK,MAAM,KAAK,MAAM,KAAK,MAAM;AAClF,YAAM,UAA4B,CAAC;AAEnC,iBAAW,QAAQ,OAAO;AACxB,YAAI,KAAK,SAAS,WAAW,KAAK,KAAK,SAAS,OAAO,KAAK,KAAK,KAAK,SAAS,MAAM,IAAI;AACvF,gBAAM,WAAW,MAAM,OAAO;AAAA,YAC5B,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,UACP;AAEA,cAAI,UAAU,SAAS;AACrB,kBAAM,UAAU,OAAO,KAAK,SAAS,SAAS,QAAQ,EAAE,SAAS,OAAO;AACxE,kBAAM,cAAc,kBAAkB,OAAO;AAE7C,gBAAI,YAAY,WAAW,YAAY,UAAU;AAE/C,mBAAK,SAAS,IAAI,KAAK,MAAM,SAAS,GAAG;AAEzC,sBAAQ,KAAK;AAAA,gBACX,cAAc,YAAY,SAAS;AAAA,gBACnC,UAAU,KAAK;AAAA,gBACf,YAAY;AAAA;AAAA,gBACZ,SAAS,YAAY;AAAA,cACvB,CAAC;AAED,mBAAK,KAAK,qBAAqB,YAAY,SAAS,MAAM,KAAK,IAAI;AAAA,YACrE;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAGA,YAAM,SAAqB;AAAA,QACzB,IAAIA,YAAW,MAAM;AAAA,QACrB,cAAc;AAAA,QACd,YAAY;AAAA,QACZ,UAAU,KAAK;AAAA,QACf,WAAW;AAAA,QACX,QAAQ;AAAA,QACR,WAAW;AAAA,QACX,SAAS,UAAU,QAAQ,MAAM;AAAA,QACjC,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAEA,WAAK,cAAc,QAAQ,MAAM;AACjC,WAAK,KAAK,kBAAkB,MAAM;AAElC,aAAO;AAAA,IACT,SAAS,OAAO;AACd,YAAM,MAAM,iBAAiB,QAAQ,QAAQ,IAAI,MAAM,OAAO,KAAK,CAAC;AACpE,WAAK,KAAK,eAAe,QAAQ,GAAG;AACpC,YAAM;AAAA,IACR;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aACJ,QACA,UACA,eACqB;AACrB,UAAM,OAAO,KAAK,MAAM,IAAI,MAAM;AAClC,QAAI,CAAC,KAAM,OAAM,IAAI,MAAM,yBAAyB,MAAM,EAAE;AAE5D,SAAK,KAAK,gBAAgB,QAAQ,MAAM;AAExC,QAAI;AACF,YAAM,SAAS,KAAK,UAAU,IAAI;AAClC,YAAM,OAAO,eAAe,QAAQ;AAGpC,YAAM,aAAa,qBAAqB,IAAI;AAC5C,UAAI,CAAC,WAAW,OAAO;AACrB,cAAM,IAAI,MAAM,qBAAqB,WAAW,OAAO,IAAI,CAAC,MAAM,EAAE,OAAO,EAAE,KAAK,IAAI,CAAC,EAAE;AAAA,MAC3F;AAEA,YAAM,UAAU,sBAAsB,IAAI;AAC1C,YAAM,WAAW,GAAG,SAAS,EAAE;AAC/B,YAAM,WAAW,GAAG,KAAK,IAAI,IAAI,QAAQ;AACzC,YAAM,cAAc,KAAK,SAAS,IAAI,QAAQ;AAE9C,YAAM,SAAS,MAAM,OAAO;AAAA,QAC1B,KAAK;AAAA,QACL,KAAK;AAAA,QACL;AAAA,QACA;AAAA,QACA,iBAAiB,oBAAoB,SAAS,IAAI;AAAA,QAClD;AAAA,QACA,KAAK;AAAA,MACP;AAGA,WAAK,SAAS,IAAI,UAAU,OAAO,GAAG;AAEtC,YAAM,SAAqB;AAAA,QACzB,IAAIA,YAAW,MAAM;AAAA,QACrB,cAAc;AAAA,QACd,YAAY,SAAS;AAAA,QACrB;AAAA,QACA,WAAW,OAAO,OAAO;AAAA,QACzB,QAAQ;AAAA,QACR,WAAW;AAAA,QACX,SAAS,oBAAoB,SAAS,IAAI;AAAA,QAC1C,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MACpC;AAEA,WAAK,cAAc,QAAQ,MAAM;AACjC,WAAK,KAAK,kBAAkB,MAAM;AAClC,WAAK,KAAK,qBAAqB,SAAS,IAAI,QAAQ;AAEpD,aAAO;AAAA,IACT,SAAS,OAAO;AACd,YAAM,MAAM,iBAAiB,QAAQ,QAAQ,IAAI,MAAM,OAAO,KAAK,CAAC;AACpE,WAAK,KAAK,eAAe,QAAQ,GAAG;AACpC,YAAM;AAAA,IACR;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,QAAgB,YAAmC;AACtE,UAAM,OAAO,KAAK,MAAM,IAAI,MAAM;AAClC,QAAI,CAAC,KAAM,OAAM,IAAI,MAAM,yBAAyB,MAAM,EAAE;AAE5D,UAAM,SAAS,KAAK,UAAU,IAAI;AAClC,UAAM,WAAW,GAAG,UAAU;AAC9B,UAAM,WAAW,GAAG,KAAK,IAAI,IAAI,QAAQ;AACzC,UAAM,MAAM,KAAK,SAAS,IAAI,QAAQ;AAEtC,QAAI,CAAC,KAAK;AACR,YAAM,IAAI,MAAM,4BAA4B,QAAQ,EAAE;AAAA,IACxD;AAEA,UAAM,OAAO;AAAA,MACX,KAAK;AAAA,MACL,KAAK;AAAA,MACL;AAAA,MACA;AAAA,MACA,oBAAoB,UAAU;AAAA,MAC9B,KAAK;AAAA,IACP;AAEA,SAAK,SAAS,OAAO,QAAQ;AAAA,EAC/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,cACJ,UACA,SACA,WACe;AAEf,UAAM,QAAQ,KAAK,oBAAoB,UAAU,OAAO;AACxD,SAAK,KAAK,oBAAoB,KAAK;AAGnC,UAAM,OAAO,MAAM,KAAK,KAAK,MAAM,OAAO,CAAC,EAAE;AAAA,MAC3C,CAAC,MACC,EAAE,aAAa,YACf,EAAE,UAAU,MAAM,KAAK,SACvB,EAAE,SAAS,MAAM,KAAK;AAAA,IAC1B;AAEA,QAAI,CAAC,QAAQ,CAAC,KAAK,SAAU;AAG7B,QAAI,MAAM,UAAU,UAAU,MAAM,QAAQ,cAAc,KAAK,MAAM,IAAI;AAEvE,YAAM,KAAK,cAAc,KAAK,EAAE;AAAA,IAClC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKQ,oBACN,UACA,SACiB;AACjB,UAAM,IAAI;AAEV,QAAI,aAAa,UAAU;AACzB,YAAM,OAAO,EAAE;AACf,YAAM,SAAS,EAAE;AACjB,YAAM,aAAa,EAAE;AAErB,aAAO;AAAA,QACL,IAAIA,YAAW,SAAS;AAAA,QACxB;AAAA,QACA,OAAQ,EAAE,gBAAgB,KAAgB;AAAA,QAC1C,QAAQ,EAAE;AAAA,QACV,MAAM;AAAA,UACJ,OAAQ,KAAK,OAAmC,SAAmB;AAAA,UACnE,MAAM,KAAK,QAAkB;AAAA,QAC/B;AAAA,QACA,KAAK,EAAE;AAAA,QACP,QAAQ,aACJ;AAAA,UACE,KAAK,WAAW;AAAA,UAChB,SAAS,WAAW;AAAA,UACpB,QAAS,WAAW,QAAoC,QAAkB;AAAA,QAC5E,IACA;AAAA,QACJ,QAAQ;AAAA,UACN,OAAO,QAAQ,SAAmB;AAAA,UAClC,WAAW,QAAQ;AAAA,QACrB;AAAA,QACA,aAAY,oBAAI,KAAK,GAAE,YAAY;AAAA,MACrC;AAAA,IACF;AAGA,UAAM,IAAI,MAAM,yBAAyB,QAAQ,EAAE;AAAA,EACrD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aACJ,QACA,YACgD;AAChD,UAAM,OAAO,KAAK,MAAM,IAAI,MAAM;AAClC,QAAI,CAAC,KAAM,OAAM,IAAI,MAAM,yBAAyB,MAAM,EAAE;AAE5D,UAAM,SAAS,KAAK,UAAU,IAAI;AAClC,UAAM,SAAS,eAAe;AAE9B,UAAM,SAAS,MAAM,OAAO;AAAA,MAC1B,KAAK;AAAA,MACL,KAAK;AAAA,MACL;AAAA,MACA;AAAA,IACF;AAGA,SAAK,gBAAgB;AACrB,SAAK,MAAM,IAAI,QAAQ,IAAI;AAE3B,WAAO,EAAE,WAAW,OAAO,IAAI,OAAO;AAAA,EACxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,eAAe,QAA8B;AAC3C,WAAO,KAAK,YAAY,IAAI,MAAM,KAAK,CAAC;AAAA,EAC1C;AAAA;AAAA;AAAA;AAAA,EAKA,cAAc,QAAwC;AACpD,UAAM,UAAU,KAAK,YAAY,IAAI,MAAM;AAC3C,WAAO,UAAU,QAAQ,SAAS,CAAC;AAAA,EACrC;AAAA,EAEQ,cAAc,QAAgB,QAA0B;AAC9D,UAAM,UAAU,KAAK,YAAY,IAAI,MAAM,KAAK,CAAC;AACjD,YAAQ,KAAK,MAAM;AAEnB,QAAI,QAAQ,SAAS,IAAK,SAAQ,MAAM;AACxC,SAAK,YAAY,IAAI,QAAQ,OAAO;AAAA,EACtC;AAAA;AAAA;AAAA;AAAA,EAMQ,UAAU,MAAgC;AAChD,QAAI,CAAC,KAAK,aAAa;AACrB,YAAM,IAAI,MAAM,2CAA2C;AAAA,IAC7D;AAEA,QAAI,SAAS,KAAK,QAAQ,IAAI,KAAK,EAAE;AACrC,QAAI,CAAC,QAAQ;AACX,eAAS,IAAI,aAAa,KAAK,WAAW;AAC1C,WAAK,QAAQ,IAAI,KAAK,IAAI,MAAM;AAAA,IAClC;AACA,WAAO;AAAA,EACT;AACF;AAMA,IAAIC,YAA8B;AAE3B,SAAS,cAAc,QAAgD;AAC5E,MAAI,CAACA,WAAU;AACb,IAAAA,YAAW,IAAI,WAAW,MAAM;AAAA,EAClC;AACA,SAAOA;AACT;AAEO,SAAS,iBAAiB,QAAgD;AAC/E,SAAO,IAAI,WAAW,MAAM;AAC9B;AAMA,SAASD,YAAW,QAAwB;AAC1C,SAAO,GAAG,MAAM,IAAI,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,GAAG,CAAC,CAAC;AAC1E;AAEA,SAAS,iBAAyB;AAChC,QAAM,QAAQ;AACd,MAAI,SAAS;AACb,WAAS,IAAI,GAAG,IAAI,IAAI,KAAK;AAC3B,cAAU,MAAM,OAAO,KAAK,MAAM,KAAK,OAAO,IAAI,MAAM,MAAM,CAAC;AAAA,EACjE;AACA,SAAO;AACT;;;ACxmBA,SAAS,KAAAE,UAAS;AAMX,IAAM,qBAAqBA,GAAE,KAAK,CAAC,SAAS,WAAW,YAAY,OAAO,CAAC;AAG3E,IAAM,yBAAyBA,GAAE,KAAK;AAAA,EAC3C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAOM,IAAM,yBAAyBA,GAAE,OAAO;AAAA,EAC7C,UAAUA,GAAE,OAAO,EAAE,WAAW,OAAO;AAAA,EACvC,UAAUA,GAAE,OAAO,EAAE,WAAW,OAAO,EAAE,SAAS;AAAA,EAClD,eAAeA,GAAE,OAAO,EAAE,SAAS;AAAA,EACnC,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC9B,cAAcA,GAAE,OAAO,EAAE,SAAS;AACpC,CAAC;AAGM,IAAM,2BAA2BA,GAAE,OAAO;AAAA,EAC/C,UAAUA,GAAE,OAAO;AAAA,EACnB,eAAeA,GAAE,OAAO;AAAA,EACxB,WAAWA,GAAE,OAAO,EAAE,SAAS;AACjC,CAAC;AAGM,IAAM,4BAA4BA,GAAE,OAAO;AAAA,EAChD,UAAUA,GAAE,OAAO;AAAA,EACnB,eAAeA,GAAE,OAAO,EAAE,SAAS;AACrC,CAAC;AAGM,IAAM,yBAAyBA,GAAE,OAAO;AAAA,EAC7C,OAAOA,GAAE,OAAO;AAAA,EAChB,aAAaA,GAAE,OAAO;AAAA,EACtB,UAAUA,GAAE,OAAO,EAAE,SAAS;AAChC,CAAC;AAGM,IAAM,wBAAwBA,GAAE,MAAM;AAAA,EAC3CA,GAAE,OAAO,EAAE,UAAUA,GAAE,QAAQ,OAAO,GAAG,aAAa,uBAAuB,CAAC;AAAA,EAC9EA,GAAE,OAAO,EAAE,UAAUA,GAAE,QAAQ,SAAS,GAAG,aAAa,yBAAyB,CAAC;AAAA,EAClFA,GAAE,OAAO,EAAE,UAAUA,GAAE,QAAQ,UAAU,GAAG,aAAa,0BAA0B,CAAC;AAAA,EACpFA,GAAE,OAAO,EAAE,UAAUA,GAAE,QAAQ,OAAO,GAAG,aAAa,uBAAuB,CAAC;AAChF,CAAC;AAOM,IAAM,oBAAoBA,GAAE,OAAO;AAAA,EACxC,IAAIA,GAAE,OAAO;AAAA,EACb,UAAU;AAAA,EACV,MAAMA,GAAE,OAAO;AAAA,EACf,MAAMA,GAAE,KAAK,CAAC,WAAW,MAAM,SAAS,QAAQ,CAAC;AAAA,EACjD,WAAWA,GAAE,QAAQ,EAAE,QAAQ,KAAK;AAAA,EACpC,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,WAAWA,GAAE,KAAK,EAAE,SAAS;AAC/B,CAAC;AAGM,IAAM,iBAAiBA,GAAE,OAAO;AAAA,EACrC,IAAIA,GAAE,OAAO;AAAA,EACb,UAAU;AAAA,EACV,UAAUA,GAAE,OAAO;AAAA,EACnB,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,OAAOA,GAAE,OAAO,EAAE,MAAM,EAAE,SAAS;AAAA,EACnC,WAAWA,GAAE,OAAO,EAAE,IAAI,EAAE,SAAS;AAAA,EACrC,OAAOA,GAAE,QAAQ,EAAE,QAAQ,KAAK;AAAA,EAChC,UAAUA,GAAE,OAAO,EAAE,SAAS;AAChC,CAAC;AAOM,IAAM,0BAA0BA,GAAE,OAAO;AAAA,EAC9C,MAAMA,GAAE,KAAK,CAAC,SAAS,QAAQ,SAAS,SAAS,MAAM,CAAC;AAAA,EACxD,KAAKA,GAAE,OAAO,EAAE,IAAI;AAAA,EACpB,MAAMA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC1B,MAAMA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC1B,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC9B,cAAcA,GAAE,OAAO,EAAE,IAAI,EAAE,SAAS;AAC1C,CAAC;AAGM,IAAM,qBAAqBA,GAAE,OAAO;AAAA,EACzC,MAAMA,GAAE,KAAK,CAAC,QAAQ,QAAQ,SAAS,WAAW,UAAU,UAAU,QAAQ,CAAC;AAAA,EAC/E,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAC9B,KAAKA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EACzB,SAASA,GAAE,MAAMA,GAAE,OAAO,EAAE,OAAOA,GAAE,OAAO,GAAG,OAAOA,GAAE,OAAO,EAAE,CAAC,CAAC,EAAE,SAAS;AAChF,CAAC;AAGM,IAAM,oBAAoBA,GAAE,OAAO;AAAA,EACxC,IAAIA,GAAE,OAAO;AAAA,EACb,UAAU;AAAA,EACV,WAAWA,GAAE,OAAO;AAAA,EACpB,QAAQA,GAAE,OAAO;AAAA,EACjB,SAASA,GAAE,OAAO;AAAA,EAClB,QAAQA,GAAE,MAAM,kBAAkB,EAAE,SAAS;AAAA,EAC7C,aAAaA,GAAE,MAAM,uBAAuB,EAAE,SAAS;AAAA,EACvD,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC9B,WAAWA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC/B,WAAWA,GAAE,KAAK;AAAA,EAClB,UAAUA,GAAE,KAAK,EAAE,SAAS;AAAA,EAC5B,WAAWA,GAAE,OAAOA,GAAE,MAAMA,GAAE,OAAO,CAAC,CAAC,EAAE,SAAS;AAAA;AACpD,CAAC;AAGM,IAAM,2BAA2BA,GAAE,OAAO;AAAA,EAC/C,WAAWA,GAAE,OAAO;AAAA,EACpB,SAASA,GAAE,OAAO;AAAA,EAClB,QAAQA,GAAE,MAAM,kBAAkB,EAAE,SAAS;AAAA,EAC7C,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC9B,WAAWA,GAAE,QAAQ,EAAE,SAAS;AAAA;AAAA,EAChC,cAAcA,GAAE,OAAO,EAAE,SAAS;AAAA;AACpC,CAAC;AAOM,IAAM,qBAAqBA,GAAE,OAAO;AAAA,EACzC,MAAMA,GAAE,OAAO,EAAE,MAAM,UAAU;AAAA,EACjC,aAAaA,GAAE,OAAO,EAAE,IAAI,GAAG;AAAA,EAC/B,SAASA,GAAE,MAAMA,GAAE,OAAO;AAAA,IACxB,MAAMA,GAAE,OAAO;AAAA,IACf,aAAaA,GAAE,OAAO;AAAA,IACtB,MAAMA,GAAE,KAAK,CAAC,UAAU,WAAW,WAAW,QAAQ,SAAS,CAAC;AAAA,IAChE,UAAUA,GAAE,QAAQ,EAAE,QAAQ,KAAK;AAAA,IACnC,SAASA,GAAE,MAAMA,GAAE,OAAO,EAAE,MAAMA,GAAE,OAAO,GAAG,OAAOA,GAAE,OAAO,EAAE,CAAC,CAAC,EAAE,SAAS;AAAA,EAC/E,CAAC,CAAC,EAAE,SAAS;AAAA,EACb,SAASA,GAAE,OAAO;AAAA;AACpB,CAAC;AAGM,IAAM,0BAA0BA,GAAE,OAAO;AAAA,EAC9C,IAAIA,GAAE,OAAO;AAAA,EACb,SAASA,GAAE,OAAO;AAAA,EAClB,MAAMA,GAAE,OAAOA,GAAE,QAAQ,CAAC;AAAA,EAC1B,QAAQA,GAAE,OAAO;AAAA,EACjB,WAAWA,GAAE,OAAO;AAAA,EACpB,UAAU;AAAA,EACV,WAAWA,GAAE,KAAK;AAAA,EAClB,aAAaA,GAAE,OAAO,EAAE,IAAI,EAAE,SAAS;AACzC,CAAC;AAGM,IAAM,0BAA0BA,GAAE,OAAO;AAAA,EAC9C,IAAIA,GAAE,OAAO;AAAA,EACb,UAAUA,GAAE,OAAO;AAAA,EACnB,OAAOA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC3B,QAAQA,GAAE,OAAO;AAAA,EACjB,WAAWA,GAAE,OAAO;AAAA,EACpB,WAAWA,GAAE,OAAO;AAAA,EACpB,UAAU;AAAA,EACV,WAAWA,GAAE,KAAK;AACpB,CAAC;AAOM,IAAM,yBAAyBA,GAAE,KAAK;AAAA,EAC3C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,6BAA6BA,GAAE,OAAO;AAAA,EACjD,IAAIA,GAAE,OAAO;AAAA,EACb,MAAM;AAAA,EACN,UAAU;AAAA,EACV,OAAOA,GAAE,OAAO;AAAA,EAChB,cAAcA,GAAE,OAAO;AAAA;AAAA,EACvB,OAAOA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAC3B,gBAAgBA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,EACxC,SAASA,GAAE,MAAMA,GAAE,OAAO;AAAA,IACxB,OAAOA,GAAE,OAAO;AAAA,IAChB,UAAUA,GAAE,OAAO;AAAA,IACnB,OAAOA,GAAE,KAAK,CAAC,WAAW,aAAa,QAAQ,CAAC,EAAE,SAAS;AAAA,EAC7D,CAAC,CAAC,EAAE,SAAS;AACf,CAAC;AAGM,IAAM,2BAA2BA,GAAE,OAAO;AAAA,EAC/C,WAAWA,GAAE,OAAO;AAAA,EACpB,UAAU;AAAA,EACV,cAAcA,GAAE,MAAM,sBAAsB;AAAA,EAC5C,cAAcA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,EAC3C,cAAcA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,EAC3C,YAAYA,GAAE,OAAO;AAAA,IACnB,SAASA,GAAE,QAAQ;AAAA,IACnB,OAAOA,GAAE,OAAO;AAAA;AAAA,IAChB,KAAKA,GAAE,OAAO;AAAA,IACd,UAAUA,GAAE,OAAO;AAAA,EACrB,CAAC,EAAE,SAAS;AACd,CAAC;AAOM,IAAM,kBAAkBA,GAAE,OAAO;AAAA,EACtC,IAAIA,GAAE,OAAO;AAAA,EACb,UAAU;AAAA,EACV,MAAMA,GAAE,OAAO;AAAA,EACf,QAAQ;AAAA,EACR,aAAaA,GAAE,QAAQ;AAAA;AAAA,EACvB,UAAUA,GAAE,MAAM,kBAAkB,EAAE,SAAS;AAAA,EAC/C,eAAeA,GAAE,MAAM,wBAAwB,EAAE,SAAS;AAAA,EAC1D,iBAAiBA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,EAC9C,YAAYA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,EACzC,WAAWA,GAAE,KAAK;AAAA,EAClB,WAAWA,GAAE,KAAK;AACpB,CAAC;AAGM,IAAM,0BAA0BA,GAAE,OAAO;AAAA,EAC9C,MAAMA,GAAE,MAAM,eAAe,EAAE,SAAS;AAAA,EACxC,iBAAiB,mBAAmB,SAAS;AAAA,EAC7C,eAAeA,GAAE,OAAO,EAAE,QAAQ,GAAG;AAAA,EACrC,YAAYA,GAAE,OAAO,EAAE,QAAQ,CAAC;AAAA,EAChC,cAAcA,GAAE,OAAO,EAAE,QAAQ,GAAI;AAAA,EACrC,oBAAoBA,GAAE,OAAO,EAAE,QAAQ,EAAE;AAC3C,CAAC;AAgCM,IAAM,iCAAyD;AAAA,EACpE;AAAA,IACE,IAAI;AAAA,IACJ,MAAM;AAAA,IACN,UAAU;AAAA,IACV,OAAO;AAAA,IACP,cAAc;AAAA;AAAA;AAAA;AAAA,IAId,OAAO;AAAA,IACP,gBAAgB;AAAA,EAClB;AAAA,EACA;AAAA,IACE,IAAI;AAAA,IACJ,MAAM;AAAA,IACN,UAAU;AAAA,IACV,OAAO;AAAA,IACP,cAAc;AAAA;AAAA;AAAA;AAAA,IAId,OAAO;AAAA,IACP,gBAAgB;AAAA,IAChB,SAAS;AAAA,MACP,EAAE,OAAO,gBAAgB,UAAU,gBAAgB,OAAO,UAAU;AAAA,IACtE;AAAA,EACF;AAAA,EACA;AAAA,IACE,IAAI;AAAA,IACJ,MAAM;AAAA,IACN,UAAU;AAAA,IACV,OAAO;AAAA,IACP,cAAc;AAAA;AAAA;AAAA;AAAA,IAId,OAAO;AAAA,IACP,gBAAgB;AAAA,IAChB,SAAS;AAAA,MACP,EAAE,OAAO,aAAa,UAAU,aAAa,OAAO,UAAU;AAAA,MAC9D,EAAE,OAAO,SAAS,UAAU,kBAAkB,OAAO,YAAY;AAAA,IACnE;AAAA,EACF;AAAA,EACA;AAAA,IACE,IAAI;AAAA,IACJ,MAAM;AAAA,IACN,UAAU;AAAA,IACV,OAAO;AAAA,IACP,cAAc;AAAA;AAAA;AAAA;AAAA,IAId,OAAO;AAAA,IACP,gBAAgB;AAAA,IAChB,SAAS;AAAA,MACP,EAAE,OAAO,WAAW,UAAU,WAAW,OAAO,UAAU;AAAA,MAC1D,EAAE,OAAO,UAAU,UAAU,UAAU,OAAO,SAAS;AAAA,IACzD;AAAA,EACF;AAAA,EACA;AAAA,IACE,IAAI;AAAA,IACJ,MAAM;AAAA,IACN,UAAU;AAAA,IACV,OAAO;AAAA,IACP,cAAc;AAAA;AAAA;AAAA;AAAA,IAId,OAAO;AAAA,IACP,gBAAgB;AAAA,EAClB;AAAA,EACA;AAAA,IACE,IAAI;AAAA,IACJ,MAAM;AAAA,IACN,UAAU;AAAA,IACV,OAAO;AAAA,IACP,cAAc;AAAA;AAAA;AAAA;AAAA,IAId,OAAO;AAAA,IACP,gBAAgB;AAAA,IAChB,SAAS;AAAA,MACP,EAAE,OAAO,eAAe,UAAU,eAAe,OAAO,UAAU;AAAA,MAClE,EAAE,OAAO,WAAW,UAAU,WAAW,OAAO,YAAY;AAAA,IAC9D;AAAA,EACF;AACF;;;ACnXA,SAAS,gBAAAC,qBAAoB;AAC7B,SAAS,kBAAkB;AA0BpB,IAAM,cAAN,cAA0BC,cAAyB;AAAA,EAChD;AAAA,EACA,OAA+B,oBAAI,IAAI;AAAA,EACvC,cAAmD,oBAAI,IAAI;AAAA,EAC3D,YAA+C,oBAAI,IAAI;AAAA,EACvD,kBAAiF,oBAAI,IAAI;AAAA,EACzF,eAAqC,CAAC;AAAA,EACtC;AAAA,EACA;AAAA,EAER,YAAY,SAAqC,CAAC,GAAG;AACnD,UAAM;AACN,SAAK,SAAS,wBAAwB,MAAM,MAAM;AAClD,SAAK,kBAAkB,KAAK,OAAO;AACnC,SAAK,kBAAkB,KAAK,IAAI;AAGhC,eAAW,YAAY,gCAAgC;AACrD,WAAK,UAAU,IAAI,GAAG,SAAS,IAAI,IAAI,SAAS,QAAQ,IAAI,QAAQ;AAAA,IACtE;AAGA,QAAI,KAAK,OAAO,MAAM;AACpB,iBAAW,OAAO,KAAK,OAAO,MAAM;AAClC,aAAK,KAAK,IAAI,IAAI,IAAI,GAAG;AAAA,MAC3B;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,WAAW,aAAkD;AACjE,UAAM,EAAE,SAAS,IAAI;AAGrB,QAAI,KAAK,YAAY,IAAI,QAAQ,MAAM,aAAa;AAClD,YAAM,IAAI,MAAM,wBAAwB,QAAQ,EAAE;AAAA,IACpD;AAEA,SAAK,YAAY,IAAI,UAAU,YAAY;AAE3C,QAAI;AAEF,YAAM,MAAM,MAAM,KAAK,sBAAsB,WAAW;AAExD,WAAK,KAAK,IAAI,IAAI,IAAI,GAAG;AACzB,WAAK,YAAY,IAAI,UAAU,WAAW;AAE1C,WAAK,KAAK,aAAa,QAAQ;AAE/B,aAAO;AAAA,IACT,SAAS,OAAO;AACd,WAAK,YAAY,IAAI,UAAU,OAAO;AACtC,WAAK,KAAK,SAAS,UAAU,iBAAiB,QAAQ,QAAQ,IAAI,MAAM,OAAO,KAAK,CAAC,CAAC;AACtF,YAAM;AAAA,IACR;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,cAAc,OAA8B;AAChD,UAAM,MAAM,KAAK,KAAK,IAAI,KAAK;AAC/B,QAAI,CAAC,KAAK;AACR,YAAM,IAAI,MAAM,kBAAkB,KAAK,EAAE;AAAA,IAC3C;AAGA,SAAK,KAAK,OAAO,KAAK;AACtB,SAAK,YAAY,IAAI,IAAI,UAAU,cAAc;AAEjD,SAAK,KAAK,gBAAgB,IAAI,UAAU,mBAAmB;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,OAAsC;AACjD,WAAO,KAAK,KAAK,IAAI,KAAK;AAAA,EAC5B;AAAA;AAAA;AAAA;AAAA,EAKA,wBAAwC;AACtC,UAAM,YAA4B,CAAC;AACnC,eAAW,CAAC,UAAU,MAAM,KAAK,KAAK,aAAa;AACjD,UAAI,WAAW,aAAa;AAC1B,kBAAU,KAAK,QAAQ;AAAA,MACzB;AAAA,IACF;AACA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,YAAY,SAA6B,UAA+C;AAC5F,UAAM,iBAAiB,YAAY,KAAK,OAAO;AAC/C,QAAI,CAAC,gBAAgB;AACnB,YAAM,IAAI,MAAM,0DAA0D;AAAA,IAC5E;AAGA,UAAM,KAAK,eAAe;AAE1B,UAAM,UAAuB;AAAA,MAC3B,IAAI,WAAW;AAAA,MACf,UAAU;AAAA,MACV,WAAW,QAAQ;AAAA,MACnB,QAAQ;AAAA,MACR,SAAS,QAAQ;AAAA,MACjB,QAAQ,QAAQ;AAAA,MAChB,UAAU,QAAQ;AAAA,MAClB,WAAW,oBAAI,KAAK;AAAA,IACtB;AAGA,UAAM,KAAK,oBAAoB,gBAAgB,OAAO;AAEtD,SAAK,KAAK,eAAe,OAAO;AAEhC,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,iBACJ,MACA,MACA,QACe;AAEf,UAAM,UAAU,SACZ,CAAC,MAAM,IACP,MAAM,KAAK,KAAK,KAAK,OAAO,CAAC,EAC1B,QAAQ,CAAC,QAAQ,IAAI,iBAAiB,CAAC,CAAC,EACxC,OAAO,CAAC,MAAM,EAAE,aAAa,SAAS,IAAI,CAAC;AAElD,QAAI,QAAQ,WAAW,GAAG;AACxB,cAAQ,KAAK,0CAA0C,IAAI,EAAE;AAC7D;AAAA,IACF;AAEA,eAAW,sBAAsB,SAAS;AACxC,UAAI;AAEF,YAAI,KAAK,eAAe,kBAAkB,GAAG;AAC3C;AAAA,QACF;AAGA,cAAM,cAAc,GAAG,IAAI,IAAI,mBAAmB,QAAQ;AAC1D,cAAM,WAAW,KAAK,UAAU,IAAI,WAAW;AAC/C,YAAI,CAAC,UAAU;AACb,kBAAQ,KAAK,0BAA0B,WAAW,EAAE;AACpD;AAAA,QACF;AAGA,cAAM,UAAU,KAAK,eAAe,SAAS,cAAc,IAAI;AAC/D,cAAM,SAAS,KAAK,wBAAwB,UAAU,IAAI;AAG1D,cAAM,WAAW,KAAK,cAAc,kBAAkB;AACtD,cAAM,eAAe,WAAW,GAAG,QAAQ;AAAA,EAAK,OAAO,KAAK;AAG5D,cAAM,KAAK;AAAA,UACT;AAAA,YACE,WAAW,mBAAmB;AAAA,YAC9B,SAAS;AAAA,YACT;AAAA,UACF;AAAA,UACA,mBAAmB;AAAA,QACrB;AAEA,aAAK,KAAK,oBAAoB,MAAM,mBAAmB,SAAS;AAAA,MAClE,SAAS,OAAO;AACd,aAAK;AAAA,UACH;AAAA,UACA;AAAA,UACA,iBAAiB,QAAQ,QAAQ,IAAI,MAAM,OAAO,KAAK,CAAC;AAAA,QAC1D;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,gBACE,SACA,SACM;AACN,SAAK,gBAAgB,IAAI,QAAQ,MAAM,OAAO;AAG9C,eAAW,OAAO,KAAK,KAAK,OAAO,GAAG;AACpC,UAAI,CAAC,IAAI,UAAU;AACjB,YAAI,WAAW,CAAC;AAAA,MAClB;AACA,UAAI,SAAS,KAAK,OAAO;AAAA,IAC3B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,cAAc,YAA8C;AAChE,SAAK,KAAK,mBAAmB,UAAU;AAEvC,UAAM,UAAU,KAAK,gBAAgB,IAAI,WAAW,OAAO;AAC3D,QAAI,CAAC,SAAS;AACZ,YAAM,KAAK;AAAA,QACT;AAAA,UACE,WAAW,WAAW;AAAA,UACtB,SAAS,oBAAoB,WAAW,OAAO;AAAA,QACjD;AAAA,QACA,WAAW;AAAA,MACb;AACA;AAAA,IACF;AAEA,QAAI;AACF,YAAM,QAAQ,UAAU;AAAA,IAC1B,SAAS,OAAO;AACd,YAAM,KAAK;AAAA,QACT;AAAA,UACE,WAAW,WAAW;AAAA,UACtB,SAAS,4BAA4B,iBAAiB,QAAQ,MAAM,UAAU,eAAe;AAAA,QAC/F;AAAA,QACA,WAAW;AAAA,MACb;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,kBAAkB,aAA+C;AACrE,SAAK,KAAK,iBAAiB,WAAW;AAGtC,YAAQ,YAAY,UAAU;AAAA,MAC5B,KAAK;AACH,cAAM,KAAK,qBAAqB,aAAa,IAAI;AACjD;AAAA,MACF,KAAK;AACH,cAAM,KAAK,qBAAqB,aAAa,KAAK;AAClD;AAAA,MACF,KAAK;AAAA,MACL,KAAK;AACH,cAAM,KAAK,iBAAiB,WAAW;AACvC;AAAA,MACF,KAAK;AACH,cAAM,KAAK,kBAAkB,WAAW;AACxC;AAAA,MACF,KAAK;AACH,cAAM,KAAK,wBAAwB,WAAW;AAC9C;AAAA,MACF,KAAK;AACH,cAAM,KAAK,oBAAoB,WAAW;AAC1C;AAAA,MACF;AACE,gBAAQ,KAAK,mBAAmB,YAAY,QAAQ,EAAE;AAAA,IAC1D;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,YAAY,UAAsC;AAChD,UAAM,MAAM,GAAG,SAAS,IAAI,IAAI,SAAS,QAAQ;AACjD,SAAK,UAAU,IAAI,KAAK,QAAQ;AAAA,EAClC;AAAA;AAAA;AAAA;AAAA,EAKA,YAAY,MAAwB,UAA0D;AAC5F,WAAO,KAAK,UAAU,IAAI,GAAG,IAAI,IAAI,QAAQ,EAAE;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,2BAAiC;AAE/B,SAAK;AAAA,MACH;AAAA,QACE,MAAM;AAAA,QACN,aAAa;AAAA,QACb,SAAS;AAAA,UACP;AAAA,YACE,MAAM;AAAA,YACN,aAAa;AAAA,YACb,MAAM;AAAA,YACN,UAAU;AAAA,YACV,SAAS;AAAA,cACP,EAAE,MAAM,QAAQ,OAAO,OAAO;AAAA,cAC9B,EAAE,MAAM,OAAO,OAAO,MAAM;AAAA,cAC5B,EAAE,MAAM,UAAU,OAAO,SAAS;AAAA,cAClC,EAAE,MAAM,QAAQ,OAAO,OAAO;AAAA,YAChC;AAAA,UACF;AAAA,UACA;AAAA,YACE,MAAM;AAAA,YACN,aAAa;AAAA,YACb,MAAM;AAAA,YACN,UAAU;AAAA,UACZ;AAAA,QACF;AAAA,QACA,SAAS;AAAA,MACX;AAAA,MACA,OAAO,eAAe;AACpB,cAAM,SAAS,WAAW,KAAK;AAC/B,cAAM,aAAa,WAAW,KAAK;AAEnC,gBAAQ,QAAQ;AAAA,UACd,KAAK;AACH,kBAAM,KAAK;AAAA,cACT;AAAA,gBACE,WAAW,WAAW;AAAA,gBACtB,SAAS;AAAA,cACX;AAAA,cACA,WAAW;AAAA,YACb;AACA;AAAA,UACF,KAAK;AACH,gBAAI,CAAC,YAAY;AACf,oBAAM,KAAK;AAAA,gBACT;AAAA,kBACE,WAAW,WAAW;AAAA,kBACtB,SAAS;AAAA,gBACX;AAAA,gBACA,WAAW;AAAA,cACb;AACA;AAAA,YACF;AACA,kBAAM,KAAK;AAAA,cACT;AAAA,gBACE,WAAW,WAAW;AAAA,gBACtB,SAAS,sBAAsB,UAAU;AAAA,cAC3C;AAAA,cACA,WAAW;AAAA,YACb;AAEA;AAAA,UACF,KAAK;AACH,kBAAM,KAAK;AAAA,cACT;AAAA,gBACE,WAAW,WAAW;AAAA,gBACtB,SAAS,aACL,YAAY,UAAU,qBACtB;AAAA,cACN;AAAA,cACA,WAAW;AAAA,YACb;AACA;AAAA,UACF,KAAK;AACH,gBAAI,CAAC,YAAY;AACf,oBAAM,KAAK;AAAA,gBACT;AAAA,kBACE,WAAW,WAAW;AAAA,kBACtB,SAAS;AAAA,gBACX;AAAA,gBACA,WAAW;AAAA,cACb;AACA;AAAA,YACF;AACA,kBAAM,KAAK;AAAA,cACT;AAAA,gBACE,WAAW,WAAW;AAAA,gBACtB,SAAS,sBAAsB,UAAU;AAAA,cAC3C;AAAA,cACA,WAAW;AAAA,YACb;AACA;AAAA,QACJ;AAAA,MACF;AAAA,IACF;AAGA,SAAK;AAAA,MACH;AAAA,QACE,MAAM;AAAA,QACN,aAAa;AAAA,QACb,SAAS,CAAC;AAAA,QACV,SAAS;AAAA,MACX;AAAA,MACA,OAAO,eAAe;AACpB,cAAM,KAAK;AAAA,UACT;AAAA,YACE,WAAW,WAAW;AAAA,YACtB,SAAS;AAAA;AAAA;AAAA;AAAA,YACT,QAAQ;AAAA,cACN,EAAE,MAAM,UAAU,SAAS,kBAAkB;AAAA,cAC7C,EAAE,MAAM,QAAQ,SAAS,6BAA6B;AAAA,cACtD,EAAE,MAAM,QAAQ,SAAS,8BAA8B;AAAA,cACvD,EAAE,MAAM,UAAU;AAAA,cAClB,EAAE,MAAM,QAAQ,SAAS,iCAAiC;AAAA,YAC5D;AAAA,UACF;AAAA,UACA,WAAW;AAAA,QACb;AAAA,MACF;AAAA,IACF;AAGA,SAAK;AAAA,MACH;AAAA,QACE,MAAM;AAAA,QACN,aAAa;AAAA,QACb,SAAS,CAAC;AAAA,QACV,SAAS;AAAA,MACX;AAAA,MACA,OAAO,eAAe;AACpB,cAAM,WAAW,MAAM,KAAK,KAAK,gBAAgB,KAAK,CAAC;AACvD,cAAM,KAAK;AAAA,UACT;AAAA,YACE,WAAW,WAAW;AAAA,YACtB,SAAS;AAAA,EAAwB,SAAS,IAAI,CAAC,MAAM,MAAM,CAAC,EAAE,EAAE,KAAK,IAAI,CAAC;AAAA,UAC5E;AAAA,UACA,WAAW;AAAA,QACb;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,MAAc,sBAAsB,aAAkD;AAGpF,WAAO;AAAA,MACL,IAAI,WAAW;AAAA,MACf,UAAU,YAAY;AAAA,MACtB,MAAM,GAAG,YAAY,QAAQ;AAAA,MAC7B,QAAQ;AAAA,MACR,aAAa,YAAY;AAAA,MACzB,UAAU,CAAC;AAAA,MACX,eAAe,CAAC;AAAA,MAChB,WAAW,oBAAI,KAAK;AAAA,MACpB,WAAW,oBAAI,KAAK;AAAA,IACtB;AAAA,EACF;AAAA,EAEA,MAAc,oBACZ,UACA,SACe;AAOf,YAAQ,IAAI,IAAI,QAAQ,gBAAgB,QAAQ,SAAS,KAAK,QAAQ,OAAO,EAAE;AAAA,EACjF;AAAA,EAEA,MAAc,iBAAgC;AAC5C,UAAM,MAAM,KAAK,IAAI;AACrB,UAAM,UAAU,MAAM,KAAK;AAG3B,QAAI,WAAW,KAAO;AACpB,WAAK,kBAAkB,KAAK,OAAO;AACnC,WAAK,kBAAkB;AAAA,IACzB;AAEA,QAAI,KAAK,mBAAmB,GAAG;AAC7B,YAAM,WAAW,MAAQ;AACzB,YAAM,IAAI,QAAQ,CAAC,YAAY,WAAW,SAAS,QAAQ,CAAC;AAC5D,WAAK,kBAAkB,KAAK,OAAO;AACnC,WAAK,kBAAkB,KAAK,IAAI;AAAA,IAClC;AAEA,SAAK;AAAA,EACP;AAAA,EAEQ,eAAe,QAAqC;AAC1D,QAAI,CAAC,OAAO,YAAY,SAAS;AAC/B,aAAO;AAAA,IACT;AAEA,UAAM,MAAM,oBAAI,KAAK;AACrB,UAAM,CAAC,WAAW,QAAQ,IAAI,OAAO,WAAW,MAAM,MAAM,GAAG,EAAE,IAAI,MAAM;AAC3E,UAAM,CAAC,SAAS,MAAM,IAAI,OAAO,WAAW,IAAI,MAAM,GAAG,EAAE,IAAI,MAAM;AAErE,UAAM,iBAAiB,IAAI,SAAS,IAAI,KAAK,IAAI,WAAW;AAC5D,UAAM,eAAe,YAAY,KAAK;AACtC,UAAM,aAAa,UAAU,KAAK;AAElC,QAAI,gBAAgB,YAAY;AAC9B,aAAO,kBAAkB,gBAAgB,iBAAiB;AAAA,IAC5D,OAAO;AAEL,aAAO,kBAAkB,gBAAgB,iBAAiB;AAAA,IAC5D;AAAA,EACF;AAAA,EAEQ,eAAe,UAAkB,MAAuC;AAC9E,WAAO,SAAS,QAAQ,kBAAkB,CAAC,GAAG,QAAQ;AACpD,YAAM,QAAQ,KAAK,GAAG;AACtB,aAAO,UAAU,SAAY,OAAO,KAAK,IAAI,KAAK,GAAG;AAAA,IACvD,CAAC;AAAA,EACH;AAAA,EAEQ,wBACN,UACA,MACoD;AACpD,UAAM,SAA6D;AAAA,MACjE,EAAE,MAAM,UAAU,SAAS,SAAS,MAAM;AAAA,MAC1C,EAAE,MAAM,QAAQ,SAAS,KAAK,eAAe,SAAS,cAAc,IAAI,EAAE;AAAA,IAC5E;AAEA,QAAI,SAAS,WAAW,SAAS,QAAQ,SAAS,GAAG;AACnD,aAAO,KAAK,EAAE,MAAM,UAAU,CAAC;AAC/B,iBAAW,UAAU,SAAS,SAAS;AACrC,eAAO,KAAK;AAAA,UACV,MAAM;AAAA,UACN,SAAS,OAAO;AAAA,UAChB,KAAK,OAAO;AAAA,QACd,CAAC;AAAA,MACH;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA,EAEQ,cAAc,QAAoC;AACxD,UAAM,WAAqB,CAAC;AAE5B,QAAI,OAAO,cAAc;AACvB,eAAS,KAAK,GAAG,OAAO,aAAa,IAAI,CAAC,MAAM,KAAK,CAAC,GAAG,CAAC;AAAA,IAC5D;AAEA,QAAI,OAAO,cAAc;AACvB,eAAS,KAAK,GAAG,OAAO,aAAa,IAAI,CAAC,MAAM,MAAM,CAAC,GAAG,CAAC;AAAA,IAC7D;AAEA,WAAO,SAAS,KAAK,GAAG;AAAA,EAC1B;AAAA;AAAA,EAGA,MAAc,qBACZ,aACA,UACe;AACf,UAAM,KAAK;AAAA,MACT;AAAA,QACE,WAAW,YAAY;AAAA,QACvB,SAAS,WACL,iBAAiB,YAAY,MAAM,MACnC,iBAAiB,YAAY,MAAM;AAAA,QACvC,UAAU,YAAY;AAAA,MACxB;AAAA,MACA,YAAY;AAAA,IACd;AAAA,EACF;AAAA,EAEA,MAAc,iBAAiB,aAA+C;AAC5E,UAAM,KAAK;AAAA,MACT;AAAA,QACE,WAAW,YAAY;AAAA,QACvB,SAAS,yDAAyD,YAAY,KAAK;AAAA,QACnF,UAAU,YAAY;AAAA,MACxB;AAAA,MACA,YAAY;AAAA,IACd;AAAA,EACF;AAAA,EAEA,MAAc,kBAAkB,aAA+C;AAC7E,UAAM,KAAK;AAAA,MACT;AAAA,QACE,WAAW,YAAY;AAAA,QACvB,SAAS,qCAAqC,YAAY,MAAM;AAAA,QAChE,UAAU,YAAY;AAAA,MACxB;AAAA,MACA,YAAY;AAAA,IACd;AAAA,EACF;AAAA,EAEA,MAAc,wBAAwB,aAA+C;AACnF,UAAM,KAAK;AAAA,MACT;AAAA,QACE,WAAW,YAAY;AAAA,QACvB,SAAS,uCAAuC,YAAY,MAAM;AAAA,QAClE,UAAU,YAAY;AAAA,MACxB;AAAA,MACA,YAAY;AAAA,IACd;AAAA,EACF;AAAA,EAEA,MAAc,oBAAoB,aAA+C;AAC/E,UAAM,KAAK;AAAA,MACT;AAAA,QACE,WAAW,YAAY;AAAA,QACvB,SAAS,kBAAkB,YAAY,MAAM;AAAA,QAC7C,UAAU,YAAY;AAAA,MACxB;AAAA,MACA,YAAY;AAAA,IACd;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,aAKE;AACA,WAAO;AAAA,MACL,oBAAoB,KAAK,sBAAsB;AAAA,MAC/C,WAAW,KAAK,KAAK;AAAA,MACrB,oBAAoB,KAAK,gBAAgB;AAAA,MACzC,gBAAgB,KAAK,UAAU;AAAA,IACjC;AAAA,EACF;AACF;AAMA,IAAI,sBAA0C;AAEvC,SAAS,iBAA8B;AAC5C,MAAI,CAAC,qBAAqB;AACxB,0BAAsB,IAAI,YAAY;AAAA,EACxC;AACA,SAAO;AACT;AAEO,SAAS,kBAAkB,SAAqC,CAAC,GAAgB;AACtF,SAAO,IAAI,YAAY,MAAM;AAC/B;;;ACnrBA,SAAS,KAAAC,UAAS;AAMX,IAAM,8BAA8BA,GAAE,KAAK;AAAA,EAChD;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAOM,IAAM,uBAAuBA,GAAE,OAAO;AAAA,EAC3C,QAAQA,GAAE,OAAO;AAAA,EACjB,SAASA,GAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,+BAA+B;AAAA,EACjE,gBAAgBA,GAAE,OAAO,EAAE,SAAS;AAAA,EACpC,SAASA,GAAE,OAAO,EAAE,QAAQ,EAAE;AAAA,EAC9B,YAAYA,GAAE,OAAO,EAAE,QAAQ,CAAC;AAClC,CAAC;AAOM,IAAM,6BAA6BA,GAAE,OAAO;AAAA,EACjD,MAAMA,GAAE,OAAO;AAAA,EACf,MAAMA,GAAE,KAAK,CAAC,OAAO,aAAa,aAAa,YAAY,MAAM,CAAC;AAAA,EAClE,QAAQA,GAAE,OAAOA,GAAE,QAAQ,CAAC,EAAE,SAAS;AAAA,EACvC,WAAWA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,EACxC,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,SAASA,GAAE,OAAO,EAAE,SAAS;AAC/B,CAAC;AAGM,IAAM,yBAAyBA,GAAE,OAAO;AAAA,EAC7C,MAAMA,GAAE,OAAO;AAAA,EACf,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,OAAOA,GAAE,MAAM,0BAA0B;AAAA,EACzC,WAAWA,GAAE,OAAOA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,EACzC,UAAUA,GAAE,OAAOA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,EACxC,gBAAgBA,GAAE,OAAO,EAAE,SAAS;AAAA,EACpC,gBAAgBA,GAAE,OAAO,EAAE,SAAS;AACtC,CAAC;AAOM,IAAM,yBAAyBA,GAAE,OAAO;AAAA,EAC7C,YAAYA,GAAE,OAAO;AAAA,EACrB,MAAMA,GAAE,OAAO;AAAA,EACf,gBAAgBA,GAAE,OAAO;AAAA,EACzB,UAAUA,GAAE,OAAO,EAAE,QAAQ,KAAK;AAAA,EAClC,SAASA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,EACjC,QAAQA,GAAE,OAAOA,GAAE,QAAQ,CAAC,EAAE,SAAS;AAAA,EACvC,eAAeA,GAAE,OAAO;AAAA,IACtB,WAAWA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,IACxC,WAAWA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,EAC1C,CAAC,EAAE,SAAS;AACd,CAAC;AAOM,IAAM,wBAAwBA,GAAE,OAAO;AAAA,EAC5C,MAAMA,GAAE,OAAO;AAAA,EACf,KAAKA,GAAE,OAAO,EAAE,IAAI;AAAA,EACpB,QAAQA,GAAE,MAAMA,GAAE,OAAO,CAAC;AAAA,EAC1B,QAAQA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,SAASA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,EACjC,SAASA,GAAE,OAAOA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,EACvC,aAAaA,GAAE,OAAO;AAAA,IACpB,YAAYA,GAAE,OAAO;AAAA,IACrB,WAAWA,GAAE,OAAO;AAAA,EACtB,CAAC,EAAE,SAAS;AACd,CAAC;AAOM,IAAM,uBAAuBA,GAAE,OAAO;AAAA,EAC3C,MAAMA,GAAE,OAAO;AAAA,EACf,MAAMA,GAAE,KAAK,CAAC,SAAS,UAAU,WAAW,UAAU,CAAC;AAAA,EACvD,OAAOA,GAAE,OAAO;AAAA,EAChB,UAAUA,GAAE,OAAO,EAAE,QAAQ,KAAK;AAAA,EAClC,YAAYA,GAAE,OAAO,EAAE,SAAS;AAAA,EAChC,iBAAiBA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA;AAAA,EAC9C,SAASA,GAAE,OAAO;AAAA,IAChB,aAAaA,GAAE,KAAK,CAAC,UAAU,YAAY,OAAO,CAAC,EAAE,SAAS;AAAA,IAC9D,YAAYA,GAAE,KAAK,CAAC,UAAU,SAAS,OAAO,CAAC,EAAE,SAAS;AAAA,EAC5D,CAAC,EAAE,SAAS;AACd,CAAC;AAOM,IAAM,6BAA6BA,GAAE,OAAO;AAAA,EACjD,MAAMA,GAAE,OAAO;AAAA,EACf,MAAMA,GAAE,KAAK,CAAC,SAAS,WAAW,SAAS,WAAW,WAAW,CAAC;AAAA,EAClE,QAAQA,GAAE,OAAO;AAAA,IACf,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,IAC7B,KAAKA,GAAE,OAAO,EAAE,SAAS;AAAA,IACzB,QAAQA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,IACrC,gBAAgBA,GAAE,OAAO,EAAE,SAAS;AAAA,EACtC,CAAC;AAAA,EACD,QAAQA,GAAE,MAAMA,GAAE,OAAO,CAAC;AAAA,EAC1B,SAASA,GAAE,OAAO;AAAA,IAChB,UAAUA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,IACvC,WAAWA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,EAC1C,CAAC,EAAE,SAAS;AACd,CAAC;AAOM,IAAM,uBAAuBA,GAAE,OAAO;AAAA,EAC3C,MAAMA,GAAE,OAAO;AAAA,EACf,SAASA,GAAE,OAAO;AAAA,EAClB,SAASA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,EACjC,QAAQA,GAAE,OAAOA,GAAE,QAAQ,CAAC,EAAE,SAAS;AAAA,EACvC,aAAaA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAC5C,CAAC;AAOM,IAAM,sBAAsBA,GAAE,OAAO;AAAA,EAC1C,IAAIA,GAAE,OAAO;AAAA,EACb,MAAM;AAAA,EACN,MAAMA,GAAE,OAAO;AAAA,EACf,YAAYA,GAAE,OAAOA,GAAE,QAAQ,CAAC;AAAA,EAChC,MAAMA,GAAE,OAAO;AAAA,IACb,WAAWA,GAAE,OAAO;AAAA,IACpB,WAAWA,GAAE,OAAO;AAAA,IACpB,SAASA,GAAE,OAAO;AAAA,IAClB,UAAUA,GAAE,OAAO;AAAA,EACrB,CAAC;AAAA,EACD,cAAcA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAC7C,CAAC;AAGM,IAAM,uBAAuBA,GAAE,OAAO;AAAA,EAC3C,SAASA,GAAE,OAAO,EAAE,QAAQ,CAAC;AAAA,EAC7B,QAAQA,GAAE,OAAO;AAAA,EACjB,SAASA,GAAE,OAAO;AAAA,EAClB,WAAWA,GAAE,MAAM,mBAAmB;AAAA,EACtC,SAASA,GAAE,OAAOA,GAAE,OAAO;AAAA,IACzB,OAAOA,GAAE,QAAQ;AAAA,IACjB,MAAMA,GAAE,OAAO;AAAA,IACf,WAAWA,GAAE,QAAQ,EAAE,SAAS;AAAA,EAClC,CAAC,CAAC,EAAE,SAAS;AACf,CAAC;AAOM,IAAM,2BAA2BA,GAAE,KAAK;AAAA,EAC7C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,uBAAuBA,GAAE,OAAO;AAAA,EAC3C,MAAM;AAAA,EACN,MAAMA,GAAE,OAAO;AAAA,EACf,QAAQ;AAAA,EACR,QAAQA,GAAE,OAAOA,GAAE,QAAQ,CAAC,EAAE,SAAS;AAAA,EACvC,OAAOA,GAAE,OAAOA,GAAE,QAAQ,CAAC,EAAE,SAAS;AAAA,EACtC,MAAMA,GAAE,MAAMA,GAAE,OAAO;AAAA,IACrB,MAAMA,GAAE,OAAO;AAAA,IACf,UAAUA,GAAE,QAAQ;AAAA,IACpB,UAAUA,GAAE,QAAQ;AAAA,EACtB,CAAC,CAAC,EAAE,SAAS;AACf,CAAC;AAGM,IAAM,sBAAsBA,GAAE,OAAO;AAAA,EAC1C,SAASA,GAAE,OAAO;AAAA,EAClB,WAAWA,GAAE,OAAO;AAAA,EACpB,SAASA,GAAE,MAAM,oBAAoB;AAAA,EACrC,SAASA,GAAE,OAAO;AAAA,IAChB,UAAUA,GAAE,OAAO;AAAA,IACnB,UAAUA,GAAE,OAAO;AAAA,IACnB,UAAUA,GAAE,OAAO;AAAA,IACnB,WAAWA,GAAE,OAAO;AAAA,IACpB,WAAWA,GAAE,OAAO;AAAA,EACtB,CAAC;AACH,CAAC;AAGM,IAAM,oBAAoBA,GAAE,OAAO;AAAA,EACxC,SAASA,GAAE,QAAQ;AAAA,EACnB,YAAYA,GAAE,OAAO,EAAE,SAAS;AAAA,EAChC,OAAOA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC3B,UAAUA,GAAE,OAAO;AACrB,CAAC;AAGM,IAAM,6BAA6BA,GAAE,OAAO;AAAA,EACjD,SAASA,GAAE,QAAQ;AAAA,EACnB,SAASA,GAAE,MAAMA,GAAE,OAAO;AAAA,IACxB,UAAUA,GAAE,OAAO;AAAA,IACnB,QAAQ;AAAA,IACR,QAAQ;AAAA,EACV,CAAC,CAAC;AAAA,EACF,SAASA,GAAE,OAAO;AAAA,IAChB,SAASA,GAAE,OAAO;AAAA,IAClB,SAASA,GAAE,OAAO;AAAA,IAClB,SAASA,GAAE,OAAO;AAAA,IAClB,QAAQA,GAAE,OAAO;AAAA,EACnB,CAAC;AAAA,EACD,UAAUA,GAAE,OAAO;AACrB,CAAC;AAOM,IAAM,iBAAiBA,GAAE,OAAO;AAAA,EACrC,MAAMA,GAAE,OAAO;AAAA,EACf,QAAQA,GAAE,MAAMA,GAAE,OAAO,CAAC;AAAA,EAC1B,YAAYA,GAAE,OAAOA,GAAE,QAAQ,CAAC;AAAA,EAChC,QAAQA,GAAE,MAAMA,GAAE,KAAK,MAAM,cAAc,CAAC,EAAE,SAAS;AACzD,CAAC;AAGM,IAAM,kBAAkBA,GAAE,OAAO;AAAA,EACtC,WAAWA,GAAE,OAAO;AAAA,IAClB,mBAAmBA,GAAE,OAAOA,GAAE,OAAO;AAAA,MACnC,QAAQA,GAAE,OAAO;AAAA,MACjB,SAASA,GAAE,OAAO;AAAA,IACpB,CAAC,CAAC,EAAE,SAAS;AAAA,EACf,CAAC,EAAE,SAAS;AAAA,EACZ,UAAUA,GAAE,OAAOA,GAAE,OAAOA,GAAE,QAAQ,CAAC,CAAC,EAAE,SAAS;AAAA,EACnD,WAAWA,GAAE,MAAM,cAAc,EAAE,SAAS;AAAA,EAC5C,MAAMA,GAAE,MAAM,cAAc,EAAE,SAAS;AAAA,EACvC,SAASA,GAAE,OAAOA,GAAE,OAAO;AAAA,IACzB,OAAOA,GAAE,OAAO;AAAA,IAChB,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,IACjC,WAAWA,GAAE,QAAQ,EAAE,SAAS;AAAA,EAClC,CAAC,CAAC,EAAE,SAAS;AAAA,EACb,WAAWA,GAAE,OAAOA,GAAE,OAAO;AAAA,IAC3B,MAAMA,GAAE,OAAO,EAAE,SAAS;AAAA,IAC1B,SAASA,GAAE,QAAQ,EAAE,SAAS;AAAA,IAC9B,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,IACjC,WAAWA,GAAE,QAAQ,EAAE,SAAS;AAAA,IAChC,YAAYA,GAAE,OAAO;AAAA,MACnB,WAAWA,GAAE,OAAO;AAAA,MACpB,cAAcA,GAAE,OAAO;AAAA,IACzB,CAAC,EAAE,SAAS;AAAA,EACd,CAAC,CAAC,EAAE,SAAS;AACf,CAAC;AAOM,IAAM,+BAA+BA,GAAE,OAAO;AAAA,EACnD,iBAAiBA,GAAE,OAAO,EAAE,QAAQ,OAAO;AAAA,EAC3C,cAAcA,GAAE,KAAK,CAAC,SAAS,MAAM,OAAO,SAAS,MAAM,CAAC,EAAE,QAAQ,OAAO;AAAA,EAC7E,aAAaA,GAAE,OAAOA,GAAE,QAAQ,CAAC,EAAE,SAAS;AAAA,EAC5C,aAAaA,GAAE,QAAQ,EAAE,QAAQ,KAAK;AAAA,EACtC,aAAaA,GAAE,OAAO,EAAE,QAAQ,EAAE;AAAA,EAClC,eAAeA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AACzC,CAAC;AAmCM,IAAM,2BAA2B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACtUxC,SAAS,gBAAAC,qBAAoB;AAC7B,SAAS,cAAAC,aAAY,cAAAC,mBAAkB;AAsChC,IAAM,mBAAN,cAA+BC,cAA8B;AAAA,EAC1D;AAAA,EACA,iBAAwC;AAAA,EACxC;AAAA,EACA,eAAiF,oBAAI,IAAI;AAAA,EAEjG,YAAY,SAA0C,CAAC,GAAG;AACxD,UAAM;AACN,SAAK,SAAS,6BAA6B,MAAM,MAAM;AAGvD,SAAK,QAAQ;AAAA,MACX,SAAS;AAAA,MACT,QAAQ;AAAA,MACR,SAASC,YAAW;AAAA,MACpB,WAAW,CAAC;AAAA,MACZ,SAAS,CAAC;AAAA,IACZ;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,kBAAkB,QAA8B;AAC9C,SAAK,iBAAiB;AAAA,EACxB;AAAA;AAAA;AAAA;AAAA,EAKQ,iBAAuB;AAC7B,QAAI,CAAC,KAAK,gBAAgB;AACxB,YAAM,IAAI,MAAM,0DAA0D;AAAA,IAC5E;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,eAAe,MAAc,UAAkC;AAC7D,SAAK,aAAa,IAAI,2BAA2B,IAAI,IAAI;AAAA,MACvD,MAAM;AAAA,MACN,MAAM;AAAA,IACR,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,eAAe,MAAc,UAAkC;AAC7D,SAAK,aAAa,IAAI,2BAA2B,IAAI,IAAI;AAAA,MACvD,MAAM;AAAA,MACN,MAAM;AAAA,IACR,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,cAAc,MAAc,UAAiC;AAC3D,SAAK,aAAa,IAAI,0BAA0B,IAAI,IAAI;AAAA,MACtD,MAAM;AAAA,MACN,MAAM;AAAA,IACR,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,MAAc,UAAgC;AACzD,SAAK,aAAa,IAAI,yBAAyB,IAAI,IAAI;AAAA,MACrD,MAAM;AAAA,MACN,MAAM;AAAA,IACR,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,mBAAmB,MAAc,UAAsC;AACrE,SAAK,aAAa,IAAI,+BAA+B,IAAI,IAAI;AAAA,MAC3D,MAAM;AAAA,MACN,MAAM;AAAA,IACR,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,MAAc,UAAgC;AACzD,SAAK,aAAa,IAAI,yBAAyB,IAAI,IAAI;AAAA,MACrD,MAAM;AAAA,MACN,MAAM;AAAA,IACR,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,OAA+B;AACnC,SAAK,eAAe;AACpB,SAAK,KAAK,aAAa;AAEvB,UAAM,UAA4B,CAAC;AACnC,UAAM,mBAAmB,IAAI;AAAA,MAC3B,KAAK,MAAM,UAAU,IAAI,CAAC,MAAM,CAAC,GAAG,EAAE,IAAI,IAAI,EAAE,IAAI,IAAI,CAAC,CAAC;AAAA,IAC5D;AAGA,QAAI,KAAK,OAAO,eAAe;AAC7B,YAAM,KAAK,QAAQ;AAAA,IACrB;AAGA,eAAW,CAAC,KAAK,OAAO,KAAK,KAAK,cAAc;AAC9C,YAAM,UAAU,iBAAiB,IAAI,GAAG;AAExC,UAAI,CAAC,SAAS;AAEZ,gBAAQ,KAAK;AAAA,UACX,MAAM,QAAQ;AAAA,UACd,MAAM,IAAI,MAAM,GAAG,EAAE,CAAC;AAAA,UACtB,QAAQ;AAAA,UACR,OAAO,QAAQ;AAAA,QACjB,CAAC;AAAA,MACH,OAAO;AAEL,cAAM,OAAO,KAAK;AAAA,UAChB,QAAQ;AAAA,UACR,QAAQ;AAAA,QACV;AACA,YAAI,KAAK,SAAS,GAAG;AACnB,kBAAQ,KAAK;AAAA,YACX,MAAM,QAAQ;AAAA,YACd,MAAM,IAAI,MAAM,GAAG,EAAE,CAAC;AAAA,YACtB,QAAQ;AAAA,YACR,QAAQ,QAAQ;AAAA,YAChB,OAAO,QAAQ;AAAA,YACf;AAAA,UACF,CAAC;AAAA,QACH,OAAO;AACL,kBAAQ,KAAK;AAAA,YACX,MAAM,QAAQ;AAAA,YACd,MAAM,IAAI,MAAM,GAAG,EAAE,CAAC;AAAA,YACtB,QAAQ;AAAA,UACV,CAAC;AAAA,QACH;AAAA,MACF;AAEA,uBAAiB,OAAO,GAAG;AAAA,IAC7B;AAGA,eAAW,CAAC,KAAK,OAAO,KAAK,kBAAkB;AAC7C,cAAQ,KAAK;AAAA,QACX,MAAM,QAAQ;AAAA,QACd,MAAM,QAAQ;AAAA,QACd,QAAQ;AAAA,QACR,QAAQ,QAAQ;AAAA,MAClB,CAAC;AAAA,IACH;AAEA,UAAM,OAAsB;AAAA,MAC1B,SAAS;AAAA,MACT,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MAClC;AAAA,MACA,SAAS;AAAA,QACP,UAAU,QAAQ,OAAO,CAAC,MAAM,EAAE,WAAW,QAAQ,EAAE;AAAA,QACvD,UAAU,QAAQ,OAAO,CAAC,MAAM,EAAE,WAAW,QAAQ,EAAE;AAAA,QACvD,UAAU,QAAQ,OAAO,CAAC,MAAM,EAAE,WAAW,QAAQ,EAAE;AAAA,QACvD,WAAW,QAAQ,OAAO,CAAC,MAAM,EAAE,WAAW,SAAS,EAAE;AAAA,QACzD,WAAW,QAAQ,OAAO,CAAC,MAAM,EAAE,WAAW,OAAO,EAAE;AAAA,MACzD;AAAA,IACF;AAEA,SAAK,KAAK,iBAAiB,IAAI;AAC/B,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,MAAM,MAAqD;AAC/D,SAAK,eAAe;AAGpB,UAAM,gBAAgB,QAAS,MAAM,KAAK,KAAK;AAC/C,SAAK,KAAK,gBAAgB,aAAa;AAEvC,UAAM,YAAY,KAAK,IAAI;AAC3B,UAAM,UAA2C,CAAC;AAElD,QAAI,UAAU;AACd,QAAI,UAAU;AACd,QAAI,UAAU;AACd,QAAI,SAAS;AAGb,UAAM,UAAU,cAAc,QAAQ,OAAO,CAAC,MAAM,EAAE,WAAW,QAAQ;AACzE,UAAM,UAAU,cAAc,QAAQ,OAAO,CAAC,MAAM,EAAE,WAAW,QAAQ;AACzE,UAAM,UAAU,cAAc,QAAQ,OAAO,CAAC,MAAM,EAAE,WAAW,QAAQ;AACzE,UAAM,WAAW,cAAc,QAAQ,OAAO,CAAC,MAAM,EAAE,WAAW,SAAS;AAG3E,eAAW,UAAU,SAAS;AAC5B,YAAM,SAAS,MAAM,KAAK,YAAY,MAAM;AAC5C,cAAQ,KAAK,EAAE,UAAU,GAAG,OAAO,IAAI,IAAI,OAAO,IAAI,IAAI,QAAQ,UAAU,OAAO,CAAC;AACpF,UAAI,OAAO,SAAS;AAClB;AAAA,MACF,OAAO;AACL;AAAA,MACF;AAAA,IACF;AAGA,eAAW,UAAU,SAAS;AAC5B,YAAM,SAAS,MAAM,KAAK,YAAY,MAAM;AAC5C,cAAQ,KAAK,EAAE,UAAU,GAAG,OAAO,IAAI,IAAI,OAAO,IAAI,IAAI,QAAQ,UAAU,OAAO,CAAC;AACpF,UAAI,OAAO,SAAS;AAClB;AAAA,MACF,OAAO;AACL;AAAA,MACF;AAAA,IACF;AAGA,eAAW,UAAU,SAAS;AAC5B,YAAM,SAAS,MAAM,KAAK,YAAY,MAAM;AAC5C,cAAQ,KAAK,EAAE,UAAU,GAAG,OAAO,IAAI,IAAI,OAAO,IAAI,IAAI,QAAQ,UAAU,OAAO,CAAC;AACpF,UAAI,OAAO,SAAS;AAClB;AAAA,MACF,OAAO;AACL;AAAA,MACF;AAAA,IACF;AAGA,eAAW,UAAU,UAAU;AAC7B,YAAM,eAAe,MAAM,KAAK,YAAY,MAAM;AAClD,UAAI,aAAa,SAAS;AACxB,cAAM,eAAe,MAAM,KAAK,YAAY,MAAM;AAClD,gBAAQ,KAAK,EAAE,UAAU,GAAG,OAAO,IAAI,IAAI,OAAO,IAAI,IAAI,QAAQ,WAAW,QAAQ,aAAa,CAAC;AACnG,YAAI,aAAa,SAAS;AACxB;AACA;AAAA,QACF,OAAO;AACL;AAAA,QACF;AAAA,MACF,OAAO;AACL,gBAAQ,KAAK,EAAE,UAAU,GAAG,OAAO,IAAI,IAAI,OAAO,IAAI,IAAI,QAAQ,WAAW,QAAQ,aAAa,CAAC;AACnG;AAAA,MACF;AAAA,IACF;AAGA,UAAM,KAAK,UAAU;AAErB,UAAM,cAAoC;AAAA,MACxC,SAAS,WAAW;AAAA,MACpB;AAAA,MACA,SAAS,EAAE,SAAS,SAAS,SAAS,OAAO;AAAA,MAC7C,UAAU,KAAK,IAAI,IAAI;AAAA,IACzB;AAEA,SAAK,KAAK,kBAAkB,WAAW;AACvC,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,UAAyB;AAC7B,SAAK,eAAe;AAIpB,SAAK,KAAK,gBAAgB;AAAA,EAC5B;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OACJ,MACA,MACA,YACwB;AACxB,SAAK,eAAe;AAGpB,UAAM,aAAa,MAAM,KAAK,cAAc,MAAM,UAAU;AAE5D,UAAM,WAA0B;AAAA,MAC9B,IAAI;AAAA,MACJ;AAAA,MACA;AAAA,MACA;AAAA,MACA,MAAM;AAAA,QACJ,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,QAClC,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,QAClC,SAAS;AAAA,QACT,UAAU,KAAK,kBAAkB,UAAU;AAAA,MAC7C;AAAA,IACF;AAEA,SAAK,MAAM,UAAU,KAAK,QAAQ;AAClC,SAAK,MAAM;AAEX,UAAM,KAAK,UAAU;AAErB,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,gBAAgB,MAA6B,MAAuB;AAClE,UAAM,MAAM,GAAG,IAAI,IAAI,IAAI;AAC3B,UAAM,QAAQ,KAAK,MAAM,UAAU;AAAA,MACjC,CAAC,MAAM,GAAG,EAAE,IAAI,IAAI,EAAE,IAAI,OAAO;AAAA,IACnC;AAEA,QAAI,SAAS,GAAG;AACd,WAAK,MAAM,UAAU,OAAO,OAAO,CAAC;AACpC,WAAK,MAAM;AACX,aAAO;AAAA,IACT;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,WAA2B;AACzB,WAAO,EAAE,GAAG,KAAK,MAAM;AAAA,EACzB;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,UAAU,OAAsC;AACpD,SAAK,QAAQ;AAAA,EACf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,SAAS,YAA+B;AAEtC,UAAM,SAAoB;AAAA,MACxB,WAAW,CAAC;AAAA,MACZ,WAAW,CAAC;AAAA,MACZ,SAAS,CAAC;AAAA,IACZ;AAGA,UAAM,iBAAiB,WAAW,MAAM,2DAA2D;AACnG,QAAI,gBAAgB;AAClB,aAAO,YAAY,EAAE,mBAAmB,CAAC,EAAE;AAAA,IAC7C;AAGA,UAAM,gBAAgB;AACtB,QAAI;AACJ,YAAQ,QAAQ,cAAc,KAAK,UAAU,OAAO,MAAM;AACxD,YAAM,CAAC,EAAE,MAAM,MAAM,IAAI,IAAI;AAC7B,aAAO,WAAW,KAAK;AAAA,QACrB,MAAM;AAAA,QACN,QAAQ,CAAC,MAAM,IAAI;AAAA,QACnB,YAAY,KAAK,mBAAmB,IAAI;AAAA,MAC1C,CAAC;AAAA,IACH;AAGA,UAAM,gBAAgB;AACtB,YAAQ,QAAQ,cAAc,KAAK,UAAU,OAAO,MAAM;AACxD,YAAM,CAAC,EAAE,MAAM,IAAI,IAAI;AACvB,YAAM,QAAQ,KAAK,mBAAmB,IAAI;AAC1C,aAAO,UAAW,IAAI,IAAI;AAAA,QACxB,MAAM,MAAM;AAAA,QACZ,SAAS,MAAM;AAAA,QACf,aAAa,MAAM;AAAA,QACnB,WAAW,MAAM;AAAA,MACnB;AAAA,IACF;AAGA,UAAM,cAAc;AACpB,YAAQ,QAAQ,YAAY,KAAK,UAAU,OAAO,MAAM;AACtD,YAAM,CAAC,EAAE,MAAM,IAAI,IAAI;AACvB,YAAM,QAAQ,KAAK,mBAAmB,IAAI;AAC1C,aAAO,QAAS,IAAI,IAAI;AAAA,QACtB,OAAO,MAAM;AAAA,QACb,aAAa,MAAM;AAAA,QACnB,WAAW,MAAM;AAAA,MACnB;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,cAAsB;AACpB,UAAM,QAAkB,CAAC;AAGzB,UAAM,KAAK,aAAa;AACxB,UAAM,KAAK,wBAAwB;AACnC,UAAM,KAAK,wBAAwB;AACnC,UAAM,KAAK,uCAAuC;AAClD,UAAM,KAAK,uBAAuB,KAAK,OAAO,eAAe,GAAG;AAChE,UAAM,KAAK,OAAO;AAClB,UAAM,KAAK,KAAK;AAChB,UAAM,KAAK,GAAG;AACd,UAAM,KAAK,EAAE;AAGb,UAAM,KAAK,6BAA6B;AACxC,QAAI,KAAK,gBAAgB;AACvB,YAAM,KAAK,yBAAyB;AACpC,UAAI,KAAK,eAAe,gBAAgB;AACtC,cAAM,KAAK,wBAAwB,KAAK,eAAe,cAAc,GAAG;AAAA,MAC1E;AAAA,IACF;AACA,UAAM,KAAK,GAAG;AACd,UAAM,KAAK,EAAE;AAGb,eAAW,CAAC,KAAK,EAAE,MAAM,KAAK,CAAC,KAAK,KAAK,cAAc;AACrD,YAAM,OAAO,IAAI,MAAM,GAAG,EAAE,CAAC;AAC7B,YAAM,KAAK,aAAa,IAAI,MAAM,IAAI,KAAK;AAC3C,YAAM,KAAK,KAAK,gBAAgB,MAAiC,CAAC,CAAC;AACnE,YAAM,KAAK,GAAG;AACd,YAAM,KAAK,EAAE;AAAA,IACf;AAEA,WAAO,MAAM,KAAK,IAAI;AAAA,EACxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,WAAiD;AAC/C,UAAM,SAAmB,CAAC;AAG1B,QAAI,CAAC,KAAK,gBAAgB;AACxB,aAAO,KAAK,yBAAyB;AAAA,IACvC;AAGA,UAAM,QAAQ,oBAAI,IAAY;AAC9B,eAAW,OAAO,KAAK,aAAa,KAAK,GAAG;AAC1C,UAAI,MAAM,IAAI,GAAG,GAAG;AAClB,eAAO,KAAK,uBAAuB,GAAG,EAAE;AAAA,MAC1C;AACA,YAAM,IAAI,GAAG;AAAA,IACf;AAGA,eAAW,CAAC,KAAK,EAAE,MAAM,KAAK,CAAC,KAAK,KAAK,cAAc;AACrD,UAAI,SAAS,2BAA2B;AACtC,cAAM,WAAW;AACjB,cAAM,cAAc,2BAA2B,SAAS,UAAU;AAClE,YAAI,CAAC,KAAK,aAAa,IAAI,WAAW,KAAK,CAAC,KAAK,MAAM,UAAU,KAAK,OAAK,EAAE,OAAO,SAAS,UAAU,GAAG;AACxG,iBAAO,KAAK,YAAY,GAAG,iCAAiC,SAAS,UAAU,EAAE;AAAA,QACnF;AAAA,MACF;AAAA,IACF;AAEA,WAAO;AAAA,MACL,OAAO,OAAO,WAAW;AAAA,MACzB;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,MAAc,YAAY,QAA8G;AACtI,UAAM,YAAY,KAAK,IAAI;AAC3B,UAAM,cAAc,GAAG,OAAO,IAAI,IAAI,OAAO,IAAI;AAEjD,SAAK,KAAK,oBAAoB,OAAO,MAAM,OAAO,IAAI;AAEtD,QAAI;AAEF,YAAM,aAAaA,YAAW;AAG9B,YAAM,WAA0B;AAAA,QAC9B,IAAI;AAAA,QACJ,MAAM,OAAO;AAAA,QACb,MAAM,OAAO;AAAA,QACb,YAAY,OAAO,SAAS,CAAC;AAAA,QAC7B,MAAM;AAAA,UACJ,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,UAClC,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,UAClC,SAAS;AAAA,UACT,UAAU,KAAK,kBAAkB,OAAO,SAAS,CAAC,CAAC;AAAA,QACrD;AAAA,MACF;AAEA,WAAK,MAAM,UAAU,KAAK,QAAQ;AAClC,WAAK,MAAM;AAEX,WAAK,KAAK,mBAAmB,OAAO,MAAM,OAAO,MAAM,UAAU;AAEjE,aAAO;AAAA,QACL,SAAS;AAAA,QACT;AAAA,QACA,UAAU,KAAK,IAAI,IAAI;AAAA,MACzB;AAAA,IACF,SAAS,OAAO;AACd,WAAK,KAAK,iBAAiB,OAAO,MAAM,OAAO,MAAM,iBAAiB,QAAQ,QAAQ,IAAI,MAAM,OAAO,KAAK,CAAC,CAAC;AAC9G,aAAO;AAAA,QACL,SAAS;AAAA,QACT,OAAO,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK;AAAA,QAC5D,UAAU,KAAK,IAAI,IAAI;AAAA,MACzB;AAAA,IACF;AAAA,EACF;AAAA,EAEA,MAAc,YAAY,QAAyF;AACjH,UAAM,YAAY,KAAK,IAAI;AAE3B,SAAK,KAAK,oBAAoB,OAAO,MAAM,OAAO,IAAI;AAEtD,QAAI;AAEF,YAAM,QAAQ,KAAK,MAAM,UAAU;AAAA,QACjC,CAAC,MAAM,EAAE,SAAS,OAAO,QAAQ,EAAE,SAAS,OAAO;AAAA,MACrD;AAEA,UAAI,SAAS,GAAG;AACd,aAAK,MAAM,UAAU,KAAK,EAAE,aAAa,OAAO,SAAS,CAAC;AAC1D,aAAK,MAAM,UAAU,KAAK,EAAE,KAAK,aAAY,oBAAI,KAAK,GAAE,YAAY;AACpE,aAAK,MAAM,UAAU,KAAK,EAAE,KAAK;AACjC,aAAK,MAAM,UAAU,KAAK,EAAE,KAAK,WAAW,KAAK,kBAAkB,OAAO,SAAS,CAAC,CAAC;AACrF,aAAK,MAAM;AAAA,MACb;AAEA,WAAK,KAAK,mBAAmB,OAAO,MAAM,OAAO,IAAI;AAErD,aAAO;AAAA,QACL,SAAS;AAAA,QACT,UAAU,KAAK,IAAI,IAAI;AAAA,MACzB;AAAA,IACF,SAAS,OAAO;AACd,WAAK,KAAK,iBAAiB,OAAO,MAAM,OAAO,MAAM,iBAAiB,QAAQ,QAAQ,IAAI,MAAM,OAAO,KAAK,CAAC,CAAC;AAC9G,aAAO;AAAA,QACL,SAAS;AAAA,QACT,OAAO,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK;AAAA,QAC5D,UAAU,KAAK,IAAI,IAAI;AAAA,MACzB;AAAA,IACF;AAAA,EACF;AAAA,EAEA,MAAc,YAAY,QAAyF;AACjH,UAAM,YAAY,KAAK,IAAI;AAE3B,SAAK,KAAK,oBAAoB,OAAO,MAAM,OAAO,IAAI;AAEtD,QAAI;AAEF,YAAM,QAAQ,KAAK,MAAM,UAAU;AAAA,QACjC,CAAC,MAAM,EAAE,SAAS,OAAO,QAAQ,EAAE,SAAS,OAAO;AAAA,MACrD;AAEA,UAAI,SAAS,GAAG;AACd,aAAK,MAAM,UAAU,OAAO,OAAO,CAAC;AACpC,aAAK,MAAM;AAAA,MACb;AAEA,WAAK,KAAK,mBAAmB,OAAO,MAAM,OAAO,IAAI;AAErD,aAAO;AAAA,QACL,SAAS;AAAA,QACT,UAAU,KAAK,IAAI,IAAI;AAAA,MACzB;AAAA,IACF,SAAS,OAAO;AACd,WAAK,KAAK,iBAAiB,OAAO,MAAM,OAAO,MAAM,iBAAiB,QAAQ,QAAQ,IAAI,MAAM,OAAO,KAAK,CAAC,CAAC;AAC9G,aAAO;AAAA,QACL,SAAS;AAAA,QACT,OAAO,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK;AAAA,QAC5D,UAAU,KAAK,IAAI,IAAI;AAAA,MACzB;AAAA,IACF;AAAA,EACF;AAAA,EAEA,MAAc,YAA2B;AAEvC,SAAK,KAAK,YAAY;AAAA,EACxB;AAAA,EAEA,MAAc,cAAc,MAA6B,IAA8C;AAErG,WAAO,EAAE,GAAG;AAAA,EACd;AAAA,EAEQ,cACN,QACA,OAC0D;AAC1D,UAAM,OAAiE,CAAC;AAExE,UAAM,UAAU,oBAAI,IAAI,CAAC,GAAG,OAAO,KAAK,MAAM,GAAG,GAAG,OAAO,KAAK,KAAK,CAAC,CAAC;AAEvE,eAAW,OAAO,SAAS;AACzB,YAAM,WAAW,OAAO,GAAG;AAC3B,YAAM,WAAW,MAAM,GAAG;AAE1B,UAAI,KAAK,UAAU,QAAQ,MAAM,KAAK,UAAU,QAAQ,GAAG;AACzD,aAAK,KAAK,EAAE,MAAM,KAAK,UAAU,SAAS,CAAC;AAAA,MAC7C;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA,EAEQ,kBAAkB,MAAuC;AAC/D,WAAOC,YAAW,QAAQ,EAAE,OAAO,KAAK,UAAU,IAAI,CAAC,EAAE,OAAO,KAAK,EAAE,MAAM,GAAG,EAAE;AAAA,EACpF;AAAA,EAEQ,mBAAmB,MAAuC;AAChE,UAAM,aAAsC,CAAC;AAC7C,UAAM,YAAY;AAClB,QAAI;AAEJ,YAAQ,QAAQ,UAAU,KAAK,IAAI,OAAO,MAAM;AAC9C,YAAM,CAAC,EAAE,KAAK,KAAK,IAAI;AACvB,UAAI,cAAuB,MAAM,KAAK;AAGtC,UAAI,OAAO,gBAAgB,YAAY,YAAY,WAAW,GAAG,KAAK,YAAY,SAAS,GAAG,GAAG;AAC/F,sBAAc,YAAY,MAAM,GAAG,EAAE;AAAA,MACvC,WAES,gBAAgB,QAAQ;AAC/B,sBAAc;AAAA,MAChB,WAAW,gBAAgB,SAAS;AAClC,sBAAc;AAAA,MAChB,WAES,CAAC,MAAM,OAAO,WAAW,CAAC,GAAG;AACpC,sBAAc,OAAO,WAAW;AAAA,MAClC;AAEA,iBAAW,GAAG,IAAI;AAAA,IACpB;AAEA,WAAO;AAAA,EACT;AAAA,EAEQ,gBAAgB,OAAgC,QAAwB;AAC9E,UAAM,SAAS,IAAI,OAAO,MAAM;AAChC,UAAM,QAAkB,CAAC;AAEzB,eAAW,CAAC,KAAK,KAAK,KAAK,OAAO,QAAQ,KAAK,GAAG;AAChD,UAAI,UAAU,UAAa,UAAU,KAAM;AAE3C,UAAI,OAAO,UAAU,UAAU;AAC7B,cAAM,KAAK,GAAG,MAAM,GAAG,GAAG,OAAO,KAAK,GAAG;AAAA,MAC3C,WAAW,OAAO,UAAU,YAAY,OAAO,UAAU,WAAW;AAClE,cAAM,KAAK,GAAG,MAAM,GAAG,GAAG,MAAM,KAAK,EAAE;AAAA,MACzC,WAAW,MAAM,QAAQ,KAAK,GAAG;AAC/B,cAAM,KAAK,GAAG,MAAM,GAAG,GAAG,MAAM,KAAK,UAAU,KAAK,CAAC,EAAE;AAAA,MACzD,WAAW,OAAO,UAAU,UAAU;AACpC,cAAM,KAAK,GAAG,MAAM,GAAG,GAAG,IAAI;AAC9B,cAAM,KAAK,KAAK,gBAAgB,OAAkC,SAAS,CAAC,CAAC;AAC7E,cAAM,KAAK,GAAG,MAAM,GAAG;AAAA,MACzB;AAAA,IACF;AAEA,WAAO,MAAM,KAAK,IAAI;AAAA,EACxB;AAAA;AAAA;AAAA;AAAA,EAKA,aAKE;AACA,WAAO;AAAA,MACL,eAAe,KAAK,MAAM,UAAU;AAAA,MACpC,sBAAsB,KAAK,aAAa;AAAA,MACxC,aAAa,KAAK,MAAM;AAAA,MACxB,oBAAoB,KAAK,mBAAmB;AAAA,IAC9C;AAAA,EACF;AACF;AAMA,IAAI,2BAAoD;AAEjD,SAAS,sBAAwC;AACtD,MAAI,CAAC,0BAA0B;AAC7B,+BAA2B,IAAI,iBAAiB;AAAA,EAClD;AACA,SAAO;AACT;AAEO,SAAS,uBAAuB,SAA0C,CAAC,GAAqB;AACrG,SAAO,IAAI,iBAAiB,MAAM;AACpC;;;AC7wBA,SAAS,KAAAC,UAAS;AAMX,IAAM,uBAAuBA,GAAE,KAAK;AAAA,EACzC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAOM,IAAM,wBAAwBA,GAAE,OAAO;AAAA,EAC5C,QAAQA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,SAASA,GAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,+BAA+B;AAAA,EACjE,gBAAgBA,GAAE,OAAO,EAAE,SAAS;AAAA,EACpC,aAAaA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,EACrC,mBAAmBA,GAAE,OAAO,EAAE,QAAQ,GAAK;AAAA,EAC3C,mBAAmBA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,EAC3C,eAAeA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,EACvC,eAAeA,GAAE,KAAK,CAAC,QAAQ,QAAQ,CAAC,EAAE,QAAQ,QAAQ;AAAA,EAC1D,WAAWA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AACrC,CAAC;AAOM,IAAM,qBAAqBA,GAAE,KAAK;AAAA,EACvC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,sBAAsBA,GAAE,KAAK;AAAA,EACxC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,iBAAiBA,GAAE,OAAO;AAAA,EACrC,IAAIA,GAAE,OAAO;AAAA,EACb,MAAM;AAAA,EACN,OAAOA,GAAE,OAAO;AAAA,EAChB,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,OAAO,oBAAoB,QAAQ,SAAS;AAAA,EAC5C,MAAMA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC1B,cAAcA,GAAE,OAAO,EAAE,SAAS;AAAA,EAClC,UAAUA,GAAE,MAAMA,GAAE,KAAK,MAAM,cAAc,CAAC,EAAE,SAAS;AAAA,EACzD,SAASA,GAAE,OAAO;AAAA,IAChB,SAASA,GAAE,OAAO;AAAA,IAClB,OAAOA,GAAE,OAAO;AAAA,IAChB,WAAWA,GAAE,MAAMA,GAAE,QAAQ,CAAC,EAAE,SAAS;AAAA,EAC3C,CAAC,EAAE,SAAS;AACd,CAAC;AAOM,IAAM,mBAAmBA,GAAE,KAAK;AAAA,EACrC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,oBAAoBA,GAAE,OAAO;AAAA,EACxC,MAAM;AAAA,EACN,YAAYA,GAAE,OAAO,EAAE,SAAS;AAAA,EAChC,SAASA,GAAE,QAAQ,EAAE,QAAQ,KAAK;AAAA,EAClC,SAASA,GAAE,OAAO;AAAA,EAClB,QAAQA,GAAE,OAAO;AAAA,IACf,MAAMA,GAAE,OAAO;AAAA,IACf,QAAQA,GAAE,OAAO;AAAA,EACnB,CAAC,EAAE,SAAS;AAAA,EACZ,WAAWA,GAAE,OAAO;AAAA,IAClB,OAAOA,GAAE,OAAO,EAAE,MAAMA,GAAE,OAAO,GAAG,QAAQA,GAAE,OAAO,EAAE,CAAC;AAAA,IACxD,KAAKA,GAAE,OAAO,EAAE,MAAMA,GAAE,OAAO,GAAG,QAAQA,GAAE,OAAO,EAAE,CAAC;AAAA,EACxD,CAAC,EAAE,SAAS;AACd,CAAC;AAOM,IAAM,2BAA2BA,GAAE,KAAK;AAAA,EAC7C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,mBAAmBA,GAAE,OAAO;AAAA,EACvC,UAAU;AAAA,EACV,SAASA,GAAE,OAAO;AAAA,EAClB,QAAQA,GAAE,OAAO,EAAE,QAAQ,iBAAiB;AAAA,EAC5C,MAAMA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC1B,OAAOA,GAAE,OAAO;AAAA,IACd,WAAWA,GAAE,OAAO;AAAA,IACpB,aAAaA,GAAE,OAAO;AAAA,IACtB,SAASA,GAAE,OAAO;AAAA,IAClB,WAAWA,GAAE,OAAO;AAAA,EACtB,CAAC;AAAA,EACD,oBAAoBA,GAAE,MAAMA,GAAE,OAAO;AAAA,IACnC,UAAUA,GAAE,OAAO;AAAA,MACjB,KAAKA,GAAE,OAAO;AAAA,MACd,OAAOA,GAAE,OAAO;AAAA,QACd,WAAWA,GAAE,OAAO;AAAA,QACpB,aAAaA,GAAE,OAAO;AAAA,QACtB,SAASA,GAAE,OAAO;AAAA,QAClB,WAAWA,GAAE,OAAO;AAAA,MACtB,CAAC;AAAA,IACH,CAAC;AAAA,IACD,SAASA,GAAE,OAAO;AAAA,EACpB,CAAC,CAAC,EAAE,SAAS;AACf,CAAC;AAOM,IAAM,gBAAgBA,GAAE,OAAO;AAAA,EACpC,SAASA,GAAE,OAAO;AAAA,EAClB,OAAOA,GAAE,OAAO;AAAA,EAChB,UAAUA,GAAE,OAAO,EAAE,QAAQ,iBAAiB;AAAA,EAC9C,MAAMA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC1B,YAAYA,GAAE,OAAO,EAAE,SAAS;AAAA,EAChC,YAAYA,GAAE,OAAO;AAAA,IACnB,KAAKA,GAAE,OAAO;AAAA,IACd,KAAKA,GAAE,OAAO,EAAE,SAAS;AAAA,IACzB,MAAMA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,CAAC,EAAE,SAAS;AACd,CAAC;AAOM,IAAM,sBAAsBA,GAAE,OAAO;AAAA,EAC1C,IAAIA,GAAE,OAAO;AAAA,EACb,MAAMA,GAAE,OAAO;AAAA,EACf,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,OAAOA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC3B,iBAAiBA,GAAE,OAAO,EAAE,SAAS;AAAA,EACrC,UAAUA,GAAE,OAAO,EAAE,QAAQ,CAAC;AAAA,EAC9B,WAAWA,GAAE,KAAK,CAAC,QAAQ,OAAO,CAAC,EAAE,QAAQ,MAAM;AACrD,CAAC;AAOM,IAAM,sBAAsBA,GAAE,OAAO;AAAA,EAC1C,OAAOA,GAAE,OAAO;AAAA,EAChB,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,QAAQA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,QAAQA,GAAE,QAAQ,EAAE,SAAS;AAAA,EAC7B,YAAYA,GAAE,QAAQ,EAAE,SAAS;AAAA,EACjC,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC9B,SAASA,GAAE,MAAMA,GAAE,OAAO;AAAA,IACxB,UAAUA,GAAE,OAAO;AAAA,IACnB,SAASA,GAAE,OAAO;AAAA,EACpB,CAAC,CAAC,EAAE,SAAS;AACf,CAAC;AAOM,IAAMC,0BAAyBD,GAAE,KAAK;AAAA,EAC3C;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,2BAA2BA,GAAE,OAAO;AAAA,EAC/C,OAAOA,GAAE,OAAO;AAAA,EAChB,mBAAmBA,GAAE,QAAQ,EAAE,SAAS;AAAA,EACxC,SAASA,GAAE,OAAO,EAAE,SAAS;AAC/B,CAAC;AAGM,IAAM,2BAA2BA,GAAE,OAAO;AAAA,EAC/C,MAAMC;AAAA,EACN,SAASD,GAAE,OAAO;AAAA,EAClB,SAASA,GAAE,MAAM,wBAAwB,EAAE,SAAS;AAAA,EACpD,OAAOA,GAAE,QAAQ,EAAE,SAAS;AAC9B,CAAC;AAOM,IAAM,oBAAoBA,GAAE,KAAK;AAAA,EACtC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,uBAAuBA,GAAE,OAAO;AAAA,EAC3C,MAAMA,GAAE,OAAO;AAAA,EACf,SAASA,GAAE,QAAQ;AACrB,CAAC;AAGM,IAAM,qBAAqBA,GAAE,OAAO;AAAA,EACzC,MAAM;AAAA,EACN,OAAOA,GAAE,OAAO;AAAA,EAChB,YAAYA,GAAE,OAAO,EAAE,SAAS;AAAA,EAChC,OAAOA,GAAE,OAAOA,GAAE,QAAQ,CAAC;AAC7B,CAAC;AAOM,IAAM,2BAA2BA,GAAE,KAAK;AAAA,EAC7C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,uBAAuBA,GAAE,OAAO;AAAA,EAC3C,OAAOA,GAAE,OAAO;AAAA,EAChB,MAAM;AAAA,EACN,QAAQA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,eAAeA,GAAE,OAAO,EAAE,SAAS;AAAA,EACnC,YAAYA,GAAE,OAAO,EAAE,SAAS;AAAA,EAChC,iBAAiBA,GAAE,OAAO,EAAE,SAAS;AAAA,EACrC,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC9B,YAAYA,GAAE,OAAO,EAAE,SAAS;AAAA,EAChC,WAAWA,GAAE,QAAQ,EAAE,SAAS;AAAA,EAChC,kBAAkBA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,EAC/C,qBAAqBA,GAAE,MAAMA,GAAE,OAAO;AAAA,IACpC,OAAOA,GAAE,OAAO;AAAA,MACd,WAAWA,GAAE,OAAO;AAAA,MACpB,aAAaA,GAAE,OAAO;AAAA,MACtB,SAASA,GAAE,OAAO;AAAA,MAClB,WAAWA,GAAE,OAAO;AAAA,IACtB,CAAC;AAAA,IACD,SAASA,GAAE,OAAO;AAAA,EACpB,CAAC,CAAC,EAAE,SAAS;AACf,CAAC;AAOM,IAAM,qBAAqBA,GAAE,OAAO;AAAA,EACzC,UAAUA,GAAE,MAAMA,GAAE,MAAM;AAAA,IACxBA,GAAE,OAAO;AAAA,IACTA,GAAE,OAAO;AAAA,MACP,UAAUA,GAAE,OAAO;AAAA,MACnB,OAAOA,GAAE,OAAO;AAAA,IAClB,CAAC;AAAA,EACH,CAAC,CAAC;AAAA,EACF,OAAOA,GAAE,OAAO;AAAA,IACd,WAAWA,GAAE,OAAO;AAAA,IACpB,aAAaA,GAAE,OAAO;AAAA,IACtB,SAASA,GAAE,OAAO;AAAA,IAClB,WAAWA,GAAE,OAAO;AAAA,EACtB,CAAC,EAAE,SAAS;AACd,CAAC;AAOM,IAAM,uBAAuBA,GAAE,KAAK;AAAA,EACzC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,mBAAmBA,GAAE,OAAO;AAAA,EACvC,OAAOA,GAAE,OAAO;AAAA,EAChB,MAAM;AAAA,EACN,aAAaA,GAAE,MAAM,gBAAgB,EAAE,SAAS;AAAA,EAChD,aAAaA,GAAE,QAAQ,EAAE,SAAS;AAAA,EAClC,UAAUA,GAAE,OAAO,EAAE,QAAQA,GAAE,OAAO,EAAE,CAAC,EAAE,SAAS;AAAA,EACpD,MAAMA,GAAE,OAAO;AAAA,IACb,SAASA,GAAE,OAAOA,GAAE,MAAMA,GAAE,OAAO;AAAA,MACjC,OAAOA,GAAE,OAAO;AAAA,QACd,WAAWA,GAAE,OAAO;AAAA,QACpB,aAAaA,GAAE,OAAO;AAAA,QACtB,SAASA,GAAE,OAAO;AAAA,QAClB,WAAWA,GAAE,OAAO;AAAA,MACtB,CAAC;AAAA,MACD,SAASA,GAAE,OAAO;AAAA,IACpB,CAAC,CAAC,CAAC;AAAA,EACL,CAAC,EAAE,SAAS;AAAA,EACZ,SAASA,GAAE,OAAO;AAAA,IAChB,SAASA,GAAE,OAAO;AAAA,IAClB,OAAOA,GAAE,OAAO;AAAA,IAChB,WAAWA,GAAE,MAAMA,GAAE,QAAQ,CAAC,EAAE,SAAS;AAAA,EAC3C,CAAC,EAAE,SAAS;AACd,CAAC;AAOM,IAAM,4BAA4BA,GAAE,OAAO;AAAA,EAChD,aAAaA,GAAE,OAAO,EAAE,QAAQ,sBAAsB;AAAA,EACtD,SAASA,GAAE,OAAO,EAAE,QAAQ,OAAO;AAAA,EACnC,aAAaA,GAAE,OAAO,EAAE,QAAQ,iBAAiB;AAAA,EACjD,aAAaA,GAAE,OAAO,EAAE,QAAQ,mCAAmC;AAAA,EACnE,oBAAoBA,GAAE,QAAQ,EAAE,QAAQ,KAAK;AAC/C,CAAC;AAuCM,IAAM,mBAA8B;AAAA,EACzC;AAAA,IACE,SAAS;AAAA,IACT,OAAO;AAAA,IACP,UAAU;AAAA,IACV,MAAM;AAAA,IACN,YAAY,EAAE,KAAK,gBAAgB,KAAK,eAAe,MAAM,cAAc;AAAA,EAC7E;AAAA,EACA;AAAA,IACE,SAAS;AAAA,IACT,OAAO;AAAA,IACP,UAAU;AAAA,IACV,MAAM;AAAA,IACN,YAAY,EAAE,KAAK,gBAAgB,KAAK,cAAc;AAAA,EACxD;AAAA,EACA;AAAA,IACE,SAAS;AAAA,IACT,OAAO;AAAA,IACP,UAAU;AAAA,IACV,MAAM;AAAA,EACR;AAAA,EACA;AAAA,IACE,SAAS;AAAA,IACT,OAAO;AAAA,IACP,UAAU;AAAA,IACV,MAAM;AAAA,EACR;AAAA,EACA;AAAA,IACE,SAAS;AAAA,IACT,OAAO;AAAA,IACP,UAAU;AAAA,IACV,MAAM;AAAA,EACR;AAAA,EACA;AAAA,IACE,SAAS;AAAA,IACT,OAAO;AAAA,IACP,UAAU;AAAA,IACV,MAAM;AAAA,EACR;AAAA,EACA;AAAA,IACE,SAAS;AAAA,IACT,OAAO;AAAA,IACP,UAAU;AAAA,IACV,MAAM;AAAA,EACR;AAAA,EACA;AAAA,IACE,SAAS;AAAA,IACT,OAAO;AAAA,IACP,UAAU;AAAA,IACV,MAAM;AAAA,EACR;AAAA,EACA;AAAA,IACE,SAAS;AAAA,IACT,OAAO;AAAA,IACP,UAAU;AAAA,IACV,MAAM;AAAA,EACR;AAAA,EACA;AAAA,IACE,SAAS;AAAA,IACT,OAAO;AAAA,IACP,UAAU;AAAA,IACV,MAAM;AAAA,EACR;AAAA,EACA;AAAA,IACE,SAAS;AAAA,IACT,OAAO;AAAA,IACP,UAAU;AAAA,IACV,MAAM;AAAA,EACR;AAAA,EACA;AAAA,IACE,SAAS;AAAA,IACT,OAAO;AAAA,IACP,UAAU;AAAA,IACV,MAAM;AAAA,EACR;AACF;AAMO,IAAM,oBAAsC;AAAA,EACjD;AAAA,IACE,OAAO;AAAA,IACP,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,eAAe;AAAA,IACf,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUd;AAAA,EACA;AAAA,IACE,OAAO;AAAA,IACP,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,eAAe;AAAA,IACf,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASd;AAAA,EACA;AAAA,IACE,OAAO;AAAA,IACP,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,eAAe;AAAA,IACf,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQd;AAAA,EACA;AAAA,IACE,OAAO;AAAA,IACP,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,eAAe;AAAA,IACf,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOd;AAAA,EACA;AAAA,IACE,OAAO;AAAA,IACP,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,eAAe;AAAA,IACf,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQd;AAAA,EACA;AAAA,IACE,OAAO;AAAA,IACP,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,eAAe;AAAA,IACf,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQd;AAAA,EACA;AAAA,IACE,OAAO;AAAA,IACP,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,eAAe;AAAA,IACf,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,EAKd;AAAA,EACA;AAAA,IACE,OAAO;AAAA,IACP,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,eAAe;AAAA,IACf,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQd;AACF;;;ACtlBA,SAAS,gBAAAE,qBAAoB;AAC7B,SAAS,cAAAC,mBAAkB;AAiCpB,IAAM,gBAAN,cAA4BC,cAA2B;AAAA,EACpD;AAAA,EACA;AAAA,EACA,QAAwB;AAAA,EACxB,WAAoC,oBAAI,IAAI;AAAA,EAC5C,UAAoC,oBAAI,IAAI;AAAA,EAC5C,cAAyC,oBAAI,IAAI;AAAA,EACjD,WAAsC,oBAAI,IAAI;AAAA,EAC9C,iBAA6C,oBAAI,IAAI;AAAA,EACrD,kBAAyC;AAAA,EAEjD,YAAY,SAAuC,CAAC,GAAG;AACrD,UAAM;AACN,SAAK,gBAAgB,0BAA0B,MAAM,MAAM;AAC3D,SAAK,kBAAkB,sBAAsB,MAAM,CAAC,CAAC;AAAA,EACvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,WAA0B;AAC9B,QAAI,KAAK,UAAU,UAAU;AAC3B;AAAA,IACF;AAEA,SAAK,QAAQ;AAEb,QAAI;AAEF,YAAM,KAAK,oBAAoB;AAC/B,YAAM,KAAK,oBAAoB;AAC/B,YAAM,KAAK,iBAAiB;AAC5B,YAAM,KAAK,yBAAyB;AAGpC,UAAI,KAAK,gBAAgB,aAAa;AACpC,aAAK,iBAAiB;AAAA,MACxB;AAEA,WAAK,QAAQ;AACb,WAAK,KAAK,WAAW;AAAA,IACvB,SAAS,OAAO;AACd,WAAK,QAAQ;AACb,WAAK,KAAK,SAAS,iBAAiB,QAAQ,QAAQ,IAAI,MAAM,OAAO,KAAK,CAAC,CAAC;AAC5E,YAAM;AAAA,IACR;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aAA4B;AAChC,QAAI,KAAK,UAAU,UAAU;AAC3B;AAAA,IACF;AAGA,SAAK,gBAAgB;AAGrB,eAAW,CAAC,EAAE,KAAK,KAAK,SAAS;AAC/B,YAAM,KAAK,YAAY,EAAE;AAAA,IAC3B;AAGA,eAAW,CAAC,EAAE,KAAK,KAAK,UAAU;AAChC,YAAM,KAAK,aAAa,EAAE;AAAA,IAC5B;AAGA,SAAK,eAAe,MAAM;AAE1B,SAAK,QAAQ;AACb,SAAK,KAAK,aAAa;AAAA,EACzB;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,QAAwC;AACnD,UAAM,YAAY,KAAK;AACvB,SAAK,kBAAkB,sBAAsB,MAAM;AAAA,MACjD,GAAG,KAAK;AAAA,MACR,GAAG;AAAA,IACL,CAAC;AAGD,QAAI,KAAK,gBAAgB,gBAAgB,UAAU,aAAa;AAC9D,UAAI,KAAK,gBAAgB,aAAa;AACpC,aAAK,iBAAiB;AAAA,MACxB,OAAO;AACL,aAAK,gBAAgB;AAAA,MACvB;AAAA,IACF;AAEA,SAAK,KAAK,iBAAiB,KAAK,eAAe;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,aAAa,QAA4B;AACvC,WAAO,KAAK,SAAS,IAAI,MAAM,KAAK,CAAC;AAAA,EACvC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,gBAAgB,QAAgC;AACpD,QAAI,QAAQ;AACV,YAAM,KAAK,aAAa,MAAM;AAAA,IAChC,OAAO;AAEL,iBAAW,MAAM,KAAK,SAAS,KAAK,GAAG;AACrC,cAAM,KAAK,aAAa,EAAE;AAAA,MAC5B;AAAA,IACF;AACA,SAAK,KAAK,eAAe;AAAA,EAC3B;AAAA;AAAA;AAAA;AAAA,EAKA,eAAe,MAAsB;AACnC,SAAK,KAAK,oBAAoB,IAAI;AAGlC,QAAI,KAAK,SAAS;AAChB,WAAK,eAAe,KAAK,QAAQ,SAAS,KAAK,QAAQ,SAAS;AAAA,IAClE;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,eAAe,MAAsB;AACnC,SAAK,KAAK,oBAAoB,IAAI;AAAA,EACpC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,WAAW,MAAkB,YAAsC;AACvE,UAAM,WAAW,aAAa,GAAG,IAAI,IAAI,UAAU,KAAK,GAAG,IAAI,QAAQC,YAAW,CAAC;AAGnF,UAAM,UAAU,MAAM,KAAK,mBAAmB,MAAM,UAAU;AAE9D,UAAM,cAA2B;AAAA,MAC/B;AAAA,MACA;AAAA,MACA,SAAS;AAAA,MACT;AAAA,IACF;AAEA,SAAK,QAAQ,IAAI,UAAU,WAAW;AACtC,SAAK,KAAK,gBAAgB,MAAM,UAAU;AAE1C,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YAAY,UAAiC;AACjD,UAAM,SAAS,KAAK,QAAQ,IAAI,QAAQ;AACxC,QAAI,CAAC,QAAQ;AACX;AAAA,IACF;AAGA,QAAI,OAAO,SAAS;AAElB,cAAQ,KAAK,UAAU,QAAQ,sBAAsB;AAAA,IACvD;AAEA,SAAK,QAAQ,OAAO,QAAQ;AAC5B,SAAK,KAAK,gBAAgB,OAAO,MAAM,OAAO,UAAU;AAAA,EAC1D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,WAAW,UAAiC;AAChD,UAAM,SAAS,KAAK,QAAQ,IAAI,QAAQ;AACxC,QAAI,CAAC,QAAQ;AACX,YAAM,IAAI,MAAM,qBAAqB,QAAQ,EAAE;AAAA,IACjD;AAGA,UAAM,cAAc,MAAM,KAAK,gBAAgB,OAAO,SAAS,OAAO,IAAI;AAC1E,UAAM,YAAY,YAAY,KAAK,CAAC,MAAM,EAAE,aAAa,OAAO;AAEhE,QAAI,WAAW;AACb,YAAM,IAAI,MAAM,kCAAkC;AAAA,IACpD;AAGA,UAAM,KAAK,kBAAkB,MAAM;AAEnC,WAAO,UAAU;AACjB,SAAK,KAAK,eAAe,OAAO,MAAM,OAAO,YAAY,OAAO,OAAO;AAAA,EACzE;AAAA;AAAA;AAAA;AAAA,EAKA,oBAAoB,UAAkB,SAAuB;AAC3D,UAAM,SAAS,KAAK,QAAQ,IAAI,QAAQ;AACxC,QAAI,CAAC,QAAQ;AACX;AAAA,IACF;AAEA,WAAO,UAAU;AACjB,WAAO,UAAU;AAGjB,SAAK,gBAAgB,SAAS,OAAO,IAAI,EAAE,KAAK,CAAC,gBAAgB;AAC/D,WAAK,YAAY,IAAI,UAAU,WAAW;AAAA,IAC5C,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,eAAe,UAAgC;AAC7C,WAAO,KAAK,YAAY,IAAI,QAAQ,KAAK,CAAC;AAAA,EAC5C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,gBAAgB,SAAiB,MAAyC;AAC9E,UAAM,cAA4B,CAAC;AAEnC,QAAI,SAAS,YAAY;AAEvB,UAAI;AAEF,YAAI,CAAC,QAAQ,SAAS,OAAO,GAAG;AAC9B,sBAAY,KAAK;AAAA,YACf,UAAU;AAAA,YACV,SAAS;AAAA,YACT,QAAQ;AAAA,YACR,OAAO,EAAE,WAAW,GAAG,aAAa,GAAG,SAAS,GAAG,WAAW,EAAE;AAAA,UAClE,CAAC;AAAA,QACH;AAEA,YAAI,CAAC,QAAQ,SAAS,QAAQ,GAAG;AAC/B,sBAAY,KAAK;AAAA,YACf,UAAU;AAAA,YACV,SAAS;AAAA,YACT,QAAQ;AAAA,YACR,OAAO,EAAE,WAAW,GAAG,aAAa,GAAG,SAAS,GAAG,WAAW,EAAE;AAAA,UAClE,CAAC;AAAA,QACH;AAGA,YAAI,QAAQ,SAAS,UAAU,GAAG;AAChC,sBAAY,KAAK;AAAA,YACf,UAAU;AAAA,YACV,SAAS;AAAA,YACT,QAAQ;AAAA,YACR,MAAM;AAAA,YACN,OAAO,EAAE,WAAW,GAAG,aAAa,GAAG,SAAS,GAAG,WAAW,EAAE;AAAA,UAClE,CAAC;AAAA,QACH;AAAA,MACF,QAAQ;AACN,oBAAY,KAAK;AAAA,UACf,UAAU;AAAA,UACV,SAAS;AAAA,UACT,QAAQ;AAAA,UACR,OAAO,EAAE,WAAW,GAAG,aAAa,GAAG,SAAS,GAAG,WAAW,EAAE;AAAA,QAClE,CAAC;AAAA,MACH;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,cAAyB;AACvB,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,SAAiB,MAAoC;AACxE,SAAK,KAAK,mBAAmB,SAAS,IAAI;AAE1C,YAAQ,SAAS;AAAA,MACf,KAAK;AACH,eAAO,KAAK,WAAW,UAAU;AAAA,MAEnC,KAAK;AACH,eAAO,KAAK,YAAY,OAAO,CAAC,CAAW;AAAA,MAE7C,KAAK;AACH,eAAO,KAAK,aAAa,OAAO,CAAC,CAAW;AAAA,MAE9C,KAAK;AACH,eAAO,KAAK,WAAW,YAAY,OAAO,CAAC,CAAW;AAAA,MAExD,KAAK;AACH,eAAO,KAAK,eAAe,OAAO,CAAC,CAAW;AAAA,MAEhD,KAAK;AACH,eAAO,KAAK,gBAAgB;AAAA,MAE9B,KAAK;AACH,eAAO,KAAK,YAAY,gBAAgB;AAAA,MAE1C,KAAK;AACH,eAAO,KAAK,YAAY,gBAAgB;AAAA,MAE1C,KAAK;AACH,eAAO,KAAK,YAAY,mBAAmB,OAAO,CAAC,CAAW;AAAA,MAEhE,KAAK;AACH,eAAO,KAAK,WAAW,UAAU;AAAA,MAEnC,KAAK;AACH,eAAO,KAAK,sBAAsB;AAAA,MAEpC,KAAK;AACH,eAAO,KAAK,sBAAsB;AAAA,MAEpC;AACE,gBAAQ,KAAK,oBAAoB,OAAO,EAAE;AAC1C,eAAO;AAAA,IACX;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,oBAAoB,MAA2B;AAC7C,SAAK,eAAe,IAAI,KAAK,IAAI,IAAI;AAAA,EACvC;AAAA;AAAA;AAAA;AAAA,EAKA,oBAAqC;AACnC,WAAO,MAAM,KAAK,KAAK,eAAe,OAAO,CAAC,EAAE,KAAK,CAAC,GAAG,MAAM,EAAE,WAAW,EAAE,QAAQ;AAAA,EACxF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,cACJ,OACA,SACsD;AAGtD,QAAI,MAAM,WAAW,GAAG;AACtB,aAAO;AAAA,IACT;AAEA,WAAO,SAAS,cAAc,QAAQ,MAAM,CAAC;AAAA,EAC/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,iBAAiB,cAA+D;AACpF,QAAI,CAAC,KAAK,gBAAgB,mBAAmB;AAC3C,aAAO;AAAA,IACT;AAGA,YAAQ,IAAI,IAAI,aAAa,KAAK,YAAY,CAAC,KAAK,aAAa,OAAO,EAAE;AAG1E,WAAO,aAAa,UAAU,CAAC,GAAG;AAAA,EACpC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,YAAY,MAAmB,YAAsC;AACzE,UAAM,YAAY,aAAa,GAAG,IAAI,IAAI,UAAU,KAAK,GAAG,IAAI,IAAIA,YAAW,CAAC;AAEhF,UAAM,eAA6B;AAAA,MACjC;AAAA,MACA,OAAO,KAAK,gBAAgB,IAAI;AAAA,MAChC;AAAA,MACA,OAAO,CAAC;AAAA,IACV;AAEA,SAAK,SAAS,IAAI,WAAW,YAAY;AACzC,SAAK,KAAK,iBAAiB,IAAI;AAE/B,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aAAa,WAAkC;AACnD,UAAM,UAAU,KAAK,SAAS,IAAI,SAAS;AAC3C,QAAI,CAAC,SAAS;AACZ;AAAA,IACF;AAEA,SAAK,SAAS,OAAO,SAAS;AAC9B,SAAK,KAAK,iBAAiB,QAAQ,IAAI;AAAA,EACzC;AAAA;AAAA;AAAA;AAAA,EAKA,qBAAqB,WAAmB,SAA+B;AACrE,UAAM,UAAU,KAAK,SAAS,IAAI,SAAS;AAC3C,QAAI,CAAC,SAAS;AACZ;AAAA,IACF;AAEA,SAAK,KAAK,kBAAkB,QAAQ,MAAM,OAAO;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA,EAKA,qBAAqB,WAAmB,SAA+B;AACrE,UAAM,UAAU,KAAK,SAAS,IAAI,SAAS;AAC3C,QAAI,CAAC,SAAS;AACZ;AAAA,IACF;AAGA,YAAQ,QAAQ,MAAM;AAAA,MACpB,KAAK;AACH,aAAK,kBAAkB,SAAS,QAAQ,OAAO;AAC/C;AAAA,MACF,KAAK;AACH,aAAK,qBAAqB,SAAS,QAAQ,OAAO;AAClD;AAAA,MACF,KAAK;AACH,aAAK,sBAAsB,SAAS,QAAQ,OAAO;AACnD;AAAA,MACF;AACE,aAAK,KAAK,kBAAkB,QAAQ,MAAM,OAAO;AAAA,IACrD;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,eACE,UACA,WACkB;AAElB,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,SACE,SACA,UAC0B;AAE1B,UAAM,QAAQ,QAAQ,MAAM,IAAI;AAChC,UAAM,OAAO,MAAM,SAAS,OAAO,CAAC,KAAK;AAGzC,QAAI,KAAK,SAAS,WAAW,GAAG;AAC9B,aAAO;AAAA,QACL,UAAU;AAAA,UACR,EAAE,UAAU,YAAY,OAAO,eAAe;AAAA,UAC9C;AAAA,UACA;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAEA,QAAI,KAAK,SAAS,iBAAiB,GAAG;AACpC,aAAO;AAAA,QACL,UAAU;AAAA,UACR,EAAE,UAAU,YAAY,OAAO,qBAAqB;AAAA,UACpD;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,eAAe,UAAgC;AAC7C,UAAM,cAAc,KAAK,eAAe,QAAQ;AAChD,UAAM,UAAwB,CAAC;AAE/B,eAAW,cAAc,aAAa;AACpC,UAAI,WAAW,SAAS,sBAAsB;AAC5C,gBAAQ,KAAK;AAAA,UACX,OAAO;AAAA,UACP,MAAM;AAAA,UACN,aAAa,CAAC,UAAU;AAAA,UACxB,aAAa;AAAA,QACf,CAAC;AAAA,MACH;AAEA,UAAI,WAAW,QAAQ,SAAS,kBAAkB,GAAG;AACnD,gBAAQ,KAAK;AAAA,UACX,OAAO;AAAA,UACP,MAAM;AAAA,UACN,aAAa,CAAC,UAAU;AAAA,UACxB,MAAM;AAAA,YACJ,SAAS;AAAA,cACP,CAAC,QAAQ,GAAG;AAAA,gBACV;AAAA,kBACE,OAAO,EAAE,WAAW,GAAG,aAAa,GAAG,SAAS,GAAG,WAAW,EAAE;AAAA,kBAChE,SAAS;AAAA,gBACX;AAAA,cACF;AAAA,YACF;AAAA,UACF;AAAA,QACF,CAAC;AAAA,MACH;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAMA,MAAc,sBAAqC;AAEjD,SAAK,SAAS,IAAI,aAAa,CAAC,CAAC;AACjC,UAAM,KAAK,aAAa,WAAW;AAGnC,SAAK,SAAS,IAAI,aAAa,CAAC,CAAC;AACjC,UAAM,KAAK,aAAa,WAAW;AAGnC,SAAK,SAAS,IAAI,cAAc,CAAC,CAAC;AAClC,UAAM,KAAK,aAAa,YAAY;AAAA,EACtC;AAAA,EAEA,MAAc,aAAa,QAA+B;AAExD,UAAM,QAAoB,CAAC;AAE3B,YAAQ,QAAQ;AAAA,MACd,KAAK;AACH,cAAM;AAAA,UACJ,KAAK,eAAe,YAAY,qBAAqB,qBAAqB,SAAS;AAAA,UACnF,KAAK,eAAe,YAAY,mBAAmB,mBAAmB,SAAS;AAAA,UAC/E,KAAK,eAAe,YAAY,aAAa,sBAAsB,SAAS;AAAA,QAC9E;AACA;AAAA,MAEF,KAAK;AACH,cAAM;AAAA,UACJ,KAAK,eAAe,YAAY,iBAAiB,uBAAuB,SAAS;AAAA,UACjF,KAAK,eAAe,YAAY,iBAAiB,uBAAuB,SAAS;AAAA,QACnF;AACA;AAAA,MAEF,KAAK;AACH,cAAM;AAAA,UACJ,KAAK,eAAe,aAAa,UAAU,0BAA0B,SAAS;AAAA,UAC9E,KAAK,eAAe,aAAa,UAAU,wBAAwB,SAAS;AAAA,UAC5E,KAAK,eAAe,aAAa,UAAU,kBAAkB,OAAO;AAAA,QACtE;AACA;AAAA,IACJ;AAEA,SAAK,SAAS,IAAI,QAAQ,KAAK;AAAA,EACjC;AAAA,EAEQ,eACN,MACA,IACA,OACA,OACU;AACV,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA,cAAc;AAAA,MACd,SAAS;AAAA,QACP,SAAS,sBAAsB,KAAK,OAAO,CAAC,EAAE,YAAY,IAAI,KAAK,MAAM,CAAC,CAAC;AAAA,QAC3E,OAAO,QAAQ,IAAI;AAAA,QACnB,WAAW,CAAC,EAAE;AAAA,MAChB;AAAA,IACF;AAAA,EACF;AAAA,EAEA,MAAc,sBAAqC;AACjD,QAAI,CAAC,KAAK,gBAAgB,eAAe;AACvC;AAAA,IACF;AAEA,SAAK,oBAAoB;AAAA,MACvB,IAAI;AAAA,MACJ,MAAM;AAAA,MACN,SAAS;AAAA,MACT,SAAS;AAAA,MACT,UAAU;AAAA,MACV,WAAW;AAAA,IACb,CAAC;AAED,SAAK,oBAAoB;AAAA,MACvB,IAAI;AAAA,MACJ,MAAM;AAAA,MACN,SAAS;AAAA,MACT,SAAS;AAAA,MACT,UAAU;AAAA,MACV,WAAW;AAAA,IACb,CAAC;AAAA,EACH;AAAA,EAEA,MAAc,mBAAkC;AAAA,EAGhD;AAAA,EAEA,MAAc,2BAA0C;AAAA,EAOxD;AAAA,EAEQ,mBAAyB;AAC/B,QAAI,KAAK,iBAAiB;AACxB;AAAA,IACF;AAEA,SAAK,kBAAkB,YAAY,YAAY;AAC7C,YAAM,KAAK,gBAAgB;AAAA,IAC7B,GAAG,KAAK,gBAAgB,iBAAiB;AAAA,EAC3C;AAAA,EAEQ,kBAAwB;AAC9B,QAAI,KAAK,iBAAiB;AACxB,oBAAc,KAAK,eAAe;AAClC,WAAK,kBAAkB;AAAA,IACzB;AAAA,EACF;AAAA,EAEA,MAAc,mBAAmB,MAAkB,YAAsC;AAEvF,QAAI,CAAC,YAAY;AAEf,cAAQ,MAAM;AAAA,QACZ,KAAK;AACH,iBAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAUT,KAAK;AACH,iBAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAMT;AACE,iBAAO;AAAA,MACX;AAAA,IACF;AAGA,WAAO,SAAS,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAU5B;AAAA,EAEA,MAAc,kBAAkB,SAAqC;AAAA,EAErE;AAAA,EAEA,MAAc,YAAY,YAAmC;AAC3D,UAAM,KAAK,iBAAiB;AAAA,MAC1B,MAAM;AAAA,MACN,SAAS,sBAAsB,UAAU;AAAA,IAC3C,CAAC;AAAA,EACH;AAAA,EAEA,MAAc,aAAa,YAAmC;AAC5D,UAAM,KAAK,iBAAiB;AAAA,MAC1B,MAAM;AAAA,MACN,SAAS,sBAAsB,UAAU;AAAA,IAC3C,CAAC;AAAA,EACH;AAAA,EAEA,MAAc,eAAe,YAAmC;AAC9D,UAAM,KAAK,iBAAiB;AAAA,MAC1B,MAAM;AAAA,MACN,SAAS,qBAAqB,UAAU;AAAA,IAC1C,CAAC;AACD,UAAM,KAAK,gBAAgB,WAAW;AAAA,EACxC;AAAA,EAEA,MAAc,wBAAuC;AAEnD,UAAM,KAAK,iBAAiB;AAAA,MAC1B,MAAM;AAAA,MACN,SAAS;AAAA,IACX,CAAC;AAAA,EACH;AAAA,EAEA,MAAc,wBAAuC;AAEnD,UAAM,KAAK,iBAAiB;AAAA,MAC1B,MAAM;AAAA,MACN,SAAS;AAAA,IACX,CAAC;AAAA,EACH;AAAA,EAEQ,gBAAgB,MAA2B;AACjD,UAAM,SAAsC;AAAA,MAC1C,sBAAsB;AAAA,MACtB,iBAAiB;AAAA,MACjB,gBAAgB;AAAA,MAChB,gBAAgB;AAAA,MAChB,cAAc;AAAA,IAChB;AACA,WAAO,OAAO,IAAI;AAAA,EACpB;AAAA,EAEQ,kBAAkB,UAAwB,UAAyB;AAAA,EAE3E;AAAA,EAEQ,qBAAqB,UAAwB,UAAyB;AAAA,EAE9E;AAAA,EAEQ,sBAAsB,UAAwB,UAAyB;AAAA,EAE/E;AAAA;AAAA;AAAA;AAAA,EAKA,aAME;AACA,WAAO;AAAA,MACL,OAAO,KAAK;AAAA,MACZ,aAAa,KAAK,QAAQ;AAAA,MAC1B,cAAc,KAAK,SAAS;AAAA,MAC5B,oBAAoB,iBAAiB;AAAA,MACrC,oBAAoB,KAAK,gBAAgB;AAAA,IAC3C;AAAA,EACF;AACF;AAMA,IAAI,wBAA8C;AAE3C,SAAS,mBAAkC;AAChD,MAAI,CAAC,uBAAuB;AAC1B,4BAAwB,IAAI,cAAc;AAAA,EAC5C;AACA,SAAO;AACT;AAEO,SAAS,oBAAoB,SAAuC,CAAC,GAAkB;AAC5F,SAAO,IAAI,cAAc,MAAM;AACjC;;;AC12BA,SAAS,KAAAC,UAAS;AAMX,IAAM,eAAeA,GAAE,KAAK;AAAA,EACjC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,qBAAqBA,GAAE,KAAK;AAAA,EACvC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,qBAAqBA,GAAE,OAAO;AAAA,EACzC,IAAIA,GAAE,OAAO;AAAA,EACb,QAAQ;AAAA,EACR,UAAUA,GAAE,OAAO,EAAE,IAAI;AAAA,EACzB,QAAQ;AAAA,EACR,WAAWA,GAAE,QAAQ;AAAA,EACrB,QAAQA,GAAE,OAAO,EAAE,IAAI,CAAC,EAAE,IAAI,GAAG,EAAE,QAAQ,GAAG;AAAA,EAC9C,gBAAgBA,GAAE,OAAO,EAAE,SAAS;AAAA,EACpC,UAAUA,GAAE,OAAOA,GAAE,QAAQ,CAAC,EAAE,SAAS;AAC3C,CAAC;AAOM,IAAM,wBAAwBA,GAAE,KAAK;AAAA,EAC1C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,0BAA0BA,GAAE,OAAO;AAAA,EAC9C,QAAQ;AAAA,EACR,SAASA,GAAE,QAAQ;AAAA,EACnB,WAAWA,GAAE,OAAO;AAAA,EACpB,YAAYA,GAAE,OAAO,EAAE,SAAS;AAAA,EAChC,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,WAAWA,GAAE,OAAO;AAAA,EACpB,qBAAqBA,GAAE,OAAO,EAAE,QAAQ,CAAC;AAAA,EACzC,eAAeA,GAAE,OAAO,EAAE,SAAS;AAAA,EACnC,eAAeA,GAAE,OAAO,EAAE,SAAS;AACrC,CAAC;AAGM,IAAM,0BAA0BA,GAAE,OAAO;AAAA,EAC9C,MAAM;AAAA,EACN,YAAYA,GAAE,OAAO,EAAE,QAAQ,GAAK;AAAA,EACpC,WAAWA,GAAE,OAAO,EAAE,QAAQ,GAAI;AAAA,EAClC,oBAAoBA,GAAE,OAAO,EAAE,QAAQ,CAAC;AAAA,EACxC,kBAAkBA,GAAE,OAAO,EAAE,QAAQ,CAAC;AAAA,EACtC,MAAMA,GAAE,OAAO,EAAE,QAAQ,SAAS;AAAA,EAClC,gBAAgBA,GAAE,OAAO,EAAE,QAAQ,GAAG;AACxC,CAAC;AAOM,IAAM,4BAA4BA,GAAE,KAAK;AAAA,EAC9C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,sBAAsBA,GAAE,OAAO;AAAA,EAC1C,QAAQ;AAAA,EACR,UAAUA,GAAE,OAAO;AAAA,EACnB,QAAQA,GAAE,OAAO;AAAA,EACjB,iBAAiBA,GAAE,MAAM,YAAY;AAAA,EACrC,UAAUA,GAAE,OAAOA,GAAE,QAAQ,CAAC,EAAE,SAAS;AAC3C,CAAC;AAOM,IAAM,qBAAqBA,GAAE,KAAK;AAAA,EACvC;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,sBAAsBA,GAAE,OAAO;AAAA,EAC1C,IAAIA,GAAE,OAAO;AAAA,EACb,YAAY;AAAA,EACZ,UAAU;AAAA,EACV,QAAQA,GAAE,OAAO;AAAA,EACjB,aAAaA,GAAE,KAAK,CAAC,gBAAgB,UAAU,aAAa,UAAU,CAAC;AAAA,EACvE,WAAWA,GAAE,OAAO;AAAA,EACpB,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,QAAQA,GAAE,KAAK,CAAC,eAAe,aAAa,UAAU,aAAa,CAAC;AAAA,EACpE,mBAAmBA,GAAE,OAAO,EAAE,QAAQ,CAAC;AAAA,EACvC,UAAUA,GAAE,OAAOA,GAAE,QAAQ,CAAC,EAAE,SAAS;AAC3C,CAAC;AAGM,IAAM,uBAAuBA,GAAE,OAAO;AAAA,EAC3C,MAAM,mBAAmB,QAAQ,WAAW;AAAA,EAC5C,kBAAkBA,GAAE,OAAO,EAAE,QAAQ,CAAC;AAAA,EACtC,YAAYA,GAAE,OAAO,EAAE,QAAQ,GAAM;AAAA,EACrC,qBAAqBA,GAAE,OAAO,EAAE,QAAQ,CAAC;AAAA,EACzC,kBAAkBA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,EAC1C,iBAAiBA,GAAE,QAAQ,EAAE,QAAQ,KAAK;AAAA,EAC1C,mBAAmBA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAC7C,CAAC;AAOM,IAAM,wBAAwBA,GAAE,KAAK;AAAA,EAC1C;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,0BAA0BA,GAAE,OAAO;AAAA,EAC9C,cAAc;AAAA,EACd,cAAc;AAAA,EACd,MAAM;AAAA,EACN,OAAOA,GAAE,OAAO;AAAA,EAChB,iBAAiBA,GAAE,OAAO;AAAA,EAC1B,kBAAkBA,GAAE,OAAO;AAAA,EAC3B,SAASA,GAAE,QAAQ;AAAA,EACnB,OAAOA,GAAE,OAAO,EAAE,SAAS;AAC7B,CAAC;AAGM,IAAM,0BAA0BA,GAAE,OAAO;AAAA,EAC9C,MAAM,sBAAsB,QAAQ,OAAO;AAAA,EAC3C,eAAeA,GAAE,MAAM,YAAY;AAAA,EACnC,UAAUA,GAAE,OAAO,EAAE,QAAQ,GAAI;AAAA,EACjC,WAAWA,GAAE,OAAO,EAAE,QAAQ,GAAG;AAAA,EACjC,eAAeA,GAAE,OAAO,EAAE,QAAQ,CAAC;AAAA,EACnC,oBAAoBA,GAAE,KAAK,CAAC,mBAAmB,SAAS,QAAQ,CAAC,EAAE,QAAQ,iBAAiB;AAC9F,CAAC;AAOM,IAAM,wBAAwBA,GAAE,OAAO;AAAA,EAC5C,SAASA,GAAE,QAAQ,EAAE,QAAQ,KAAK;AAAA,EAClC,OAAOA,GAAE,OAAO,EAAE,QAAQ,IAAO;AAAA,EACjC,YAAYA,GAAE,OAAO,EAAE,QAAQ,aAAa;AAAA,EAC5C,UAAUA,GAAE,KAAK,CAAC,UAAU,WAAW,QAAQ,CAAC,EAAE,QAAQ,QAAQ;AACpE,CAAC;AAOM,IAAM,wBAAwBA,GAAE,OAAO;AAAA,EAC5C,SAASA,GAAE,MAAM,kBAAkB;AAAA,EACnC,aAAa,wBAAwB,SAAS;AAAA,EAC9C,eAAeA,GAAE,OAAO;AAAA,IACtB,UAAU,0BAA0B,QAAQ,UAAU;AAAA,IACtD,eAAe,sBAAsB,SAAS;AAAA,EAChD,CAAC,EAAE,SAAS;AAAA,EACZ,UAAU,qBAAqB,SAAS;AAAA,EACxC,aAAa,wBAAwB,SAAS;AAAA,EAC9C,YAAYA,GAAE,OAAO;AAAA,IACnB,SAASA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,IACjC,mBAAmBA,GAAE,OAAO,EAAE,QAAQ,GAAK;AAAA,IAC3C,iBAAiBA,GAAE,OAAO;AAAA,MACxB,WAAWA,GAAE,OAAO,EAAE,QAAQ,GAAG;AAAA,MACjC,WAAWA,GAAE,OAAO,EAAE,QAAQ,IAAI;AAAA,MAClC,qBAAqBA,GAAE,OAAO,EAAE,QAAQ,IAAI;AAAA,IAC9C,CAAC,EAAE,SAAS;AAAA,EACd,CAAC,EAAE,SAAS;AACd,CAAC;AAOM,IAAM,gBAAgBA,GAAE,OAAO;AAAA,EACpC,eAAe;AAAA,EACf,eAAeA,GAAE,MAAM,YAAY;AAAA,EACnC,cAAcA,GAAE,OAAO,cAAc,uBAAuB;AAAA,EAC5D,mBAAmBA,GAAE,MAAM,uBAAuB;AAAA,EAClD,cAAc,oBAAoB,SAAS;AAAA,EAC3C,kBAAkBA,GAAE,OAAO,EAAE,QAAQ,CAAC;AAAA,EACtC,iBAAiBA,GAAE,OAAO;AAAA,EAC1B,oBAAoBA,GAAE,OAAO;AAAA,EAC7B,aAAaA,GAAE,OAAO;AACxB,CAAC;AAwBM,IAAM,uBAA+C;AAAA,EAC1D,aAAa;AAAA,EACb,aAAa;AAAA,EACb,aAAa;AAAA,EACb,gBAAgB;AAAA,EAChB,kBAAkB;AAAA,EAClB,kBAAkB;AACpB;AAEO,IAAM,8BAAiD;AAAA,EAC5D,MAAM;AAAA,EACN,YAAY;AAAA,EACZ,WAAW;AAAA,EACX,oBAAoB;AAAA,EACpB,kBAAkB;AAAA,EAClB,MAAM;AAAA,EACN,gBAAgB;AAClB;AAEO,IAAM,0BAA0C;AAAA,EACrD,MAAM;AAAA,EACN,kBAAkB;AAAA,EAClB,YAAY;AAAA,EACZ,qBAAqB;AAAA,EACrB,kBAAkB;AAAA,EAClB,iBAAiB;AAAA,EACjB,mBAAmB;AACrB;;;AC3QA,SAAS,gBAAAC,qBAAoB;AActB,IAAM,gBAAN,cAA4BC,cAAuB;AAAA,EAChD;AAAA,EACA,UAAqC,oBAAI,IAAI;AAAA,EAC7C,UAA0C,oBAAI,IAAI;AAAA,EAClD,gBAAuC;AAAA,EACvC,sBAA2C,oBAAI,IAAI;AAAA,EACnD,uBAA4C,oBAAI,IAAI;AAAA,EAE5D,YAAY,SAAqC,CAAC,GAAG;AACnD,UAAM;AACN,SAAK,SAAS,EAAE,GAAG,6BAA6B,GAAG,OAAO;AAAA,EAC5D;AAAA;AAAA;AAAA;AAAA,EAMA,UAAU,cAAkC;AAC1C,SAAK,QAAQ,IAAI,aAAa,QAAQ,YAAY;AAClD,SAAK,oBAAoB,IAAI,aAAa,QAAQ,CAAC;AACnD,SAAK,qBAAqB,IAAI,aAAa,QAAQ,CAAC;AACpD,YAAQ,IAAI,wCAAwC,aAAa,MAAM,EAAE;AAAA,EAC3E;AAAA,EAEA,aAAa,QAAsB;AACjC,SAAK,QAAQ,OAAO,MAAM;AAC1B,SAAK,QAAQ,OAAO,MAAM;AAC1B,SAAK,oBAAoB,OAAO,MAAM;AACtC,SAAK,qBAAqB,OAAO,MAAM;AACvC,YAAQ,IAAI,2CAA2C,MAAM,EAAE;AAAA,EACjE;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,YAAY,QAA4C;AAC5D,UAAM,eAAe,KAAK,QAAQ,IAAI,MAAM;AAC5C,QAAI,CAAC,cAAc;AACjB,YAAM,IAAI,MAAM,0BAA0B,MAAM,EAAE;AAAA,IACpD;AAEA,UAAM,YAAY,KAAK,IAAI;AAC3B,QAAI,UAAU;AACd,QAAI;AACJ,QAAI;AAEJ,QAAI;AACF,YAAM,iBAAiB,aAAa,kBAClC,GAAG,aAAa,QAAQ,GAAG,KAAK,OAAO,IAAI;AAE7C,YAAM,aAAa,IAAI,gBAAgB;AACvC,YAAM,UAAU,WAAW,MAAM,WAAW,MAAM,GAAG,KAAK,OAAO,SAAS;AAE1E,UAAI;AACF,cAAM,WAAW,MAAM,MAAM,gBAAgB;AAAA,UAC3C,QAAQ;AAAA,UACR,QAAQ,WAAW;AAAA,UACnB,SAAS;AAAA,YACP,cAAc;AAAA,YACd,UAAU;AAAA,UACZ;AAAA,QACF,CAAC;AAED,qBAAa,OAAO;AACpB,qBAAa,SAAS;AACtB,kBAAU,SAAS,WAAW,KAAK,OAAO;AAE1C,YAAI,CAAC,SAAS;AACZ,gBAAM,OAAO,MAAM,SAAS,KAAK,EAAE,MAAM,MAAM,EAAE;AACjD,oBAAU,sBAAsB,SAAS,MAAM,KAAK,KAAK,MAAM,GAAG,GAAG,CAAC;AAAA,QACxE;AAAA,MACF,SAAS,YAAY;AACnB,qBAAa,OAAO;AACpB,YAAI,sBAAsB,OAAO;AAC/B,cAAI,WAAW,SAAS,cAAc;AACpC,sBAAU,iBAAiB,KAAK,OAAO,SAAS;AAAA,UAClD,OAAO;AACL,sBAAU,WAAW;AAAA,UACvB;AAAA,QACF;AAAA,MACF;AAAA,IACF,SAAS,OAAO;AACd,gBAAU,iBAAiB,QAAQ,MAAM,UAAU;AAAA,IACrD;AAEA,UAAM,YAAY,KAAK,IAAI,IAAI;AAC/B,UAAM,aAAa,KAAK,QAAQ,IAAI,MAAM;AAC1C,UAAM,eAAe,KAAK,oBAAoB,IAAI,MAAM,KAAK;AAG7D,QAAI,SAAS;AACX,WAAK,oBAAoB,IAAI,QAAQ,CAAC;AACtC,WAAK,qBAAqB,IAAI,SAAS,KAAK,qBAAqB,IAAI,MAAM,KAAK,KAAK,CAAC;AAAA,IACxF,OAAO;AACL,WAAK,qBAAqB,IAAI,QAAQ,CAAC;AACvC,WAAK,oBAAoB,IAAI,QAAQ,eAAe,CAAC;AAAA,IACvD;AAEA,UAAM,SAA4B;AAAA,MAChC;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MAClC,qBAAqB,KAAK,oBAAoB,IAAI,MAAM,KAAK;AAAA,MAC7D,eAAe,WAAU,oBAAI,KAAK,GAAE,YAAY,IAAI,YAAY;AAAA,MAChE,eAAe,CAAC,WAAU,oBAAI,KAAK,GAAE,YAAY,IAAI,YAAY;AAAA,IACnE;AAEA,SAAK,QAAQ,IAAI,QAAQ,MAAM;AAG/B,QAAI,YAAY,WAAW,CAAC,SAAS;AAEnC,UAAI,OAAO,uBAAuB,KAAK,OAAO,oBAAoB;AAChE,aAAK,KAAK,mBAAmB,QAAQ,MAAM;AAC3C,gBAAQ,IAAI,eAAe,MAAM,iBAAiB,OAAO,mBAAmB,YAAY;AAAA,MAC1F;AAAA,IACF,WAAW,CAAC,YAAY,WAAW,SAAS;AAE1C,YAAM,YAAY,KAAK,qBAAqB,IAAI,MAAM,KAAK;AAC3D,UAAI,aAAa,KAAK,OAAO,kBAAkB;AAC7C,aAAK,KAAK,oBAAoB,QAAQ,MAAM;AAC5C,gBAAQ,IAAI,eAAe,MAAM,YAAY;AAAA,MAC/C;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA,EAEA,MAAM,kBAAgD;AACpD,UAAM,UAAU,MAAM,KAAK,KAAK,QAAQ,KAAK,CAAC;AAC9C,UAAM,UAAU,MAAM,QAAQ;AAAA,MAC5B,QAAQ,IAAI,YAAU,KAAK,YAAY,MAAM,EAAE,MAAM,YAAU;AAAA,QAC7D;AAAA,QACA,SAAS;AAAA,QACT,WAAW;AAAA,QACX,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,QAClC,sBAAsB,KAAK,oBAAoB,IAAI,MAAM,KAAK,KAAK;AAAA,QACnE,SAAS,iBAAiB,QAAQ,MAAM,UAAU;AAAA,MACpD,EAAuB,CAAC;AAAA,IAC1B;AAEA,SAAK,KAAK,kBAAkB,OAAO;AACnC,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAMA,QAAc;AACZ,QAAI,KAAK,eAAe;AACtB,cAAQ,IAAI,qCAAqC;AACjD;AAAA,IACF;AAEA,YAAQ,IAAI,2CAA2C,KAAK,OAAO,UAAU,KAAK;AAGlF,SAAK,gBAAgB,EAAE,MAAM,SAAO;AAClC,cAAQ,MAAM,qCAAqC,GAAG;AAAA,IACxD,CAAC;AAGD,SAAK,gBAAgB,YAAY,MAAM;AACrC,WAAK,gBAAgB,EAAE,MAAM,SAAO;AAClC,gBAAQ,MAAM,6BAA6B,GAAG;AAAA,MAChD,CAAC;AAAA,IACH,GAAG,KAAK,OAAO,UAAU;AAAA,EAC3B;AAAA,EAEA,OAAa;AACX,QAAI,KAAK,eAAe;AACtB,oBAAc,KAAK,aAAa;AAChC,WAAK,gBAAgB;AACrB,cAAQ,IAAI,6BAA6B;AAAA,IAC3C;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,UAAU,QAA+C;AACvD,WAAO,KAAK,QAAQ,IAAI,MAAM;AAAA,EAChC;AAAA,EAEA,gBAAgD;AAC9C,WAAO,IAAI,IAAI,KAAK,OAAO;AAAA,EAC7B;AAAA,EAEA,oBAA8B;AAC5B,WAAO,MAAM,KAAK,KAAK,QAAQ,QAAQ,CAAC,EACrC,OAAO,CAAC,CAAC,GAAG,MAAM,MAAM,OAAO,OAAO,EACtC,IAAI,CAAC,CAAC,MAAM,MAAM,MAAM;AAAA,EAC7B;AAAA,EAEA,sBAAgC;AAC9B,WAAO,MAAM,KAAK,KAAK,QAAQ,QAAQ,CAAC,EACrC,OAAO,CAAC,CAAC,GAAG,MAAM,MAAM,CAAC,OAAO,OAAO,EACvC,IAAI,CAAC,CAAC,MAAM,MAAM,MAAM;AAAA,EAC7B;AAAA,EAEA,gBAAgB,QAAyB;AACvC,UAAM,SAAS,KAAK,QAAQ,IAAI,MAAM;AACtC,WAAO,QAAQ,WAAW;AAAA,EAC5B;AAAA,EAEA,oBAA4B;AAC1B,UAAM,UAAU,MAAM,KAAK,KAAK,QAAQ,OAAO,CAAC,EAAE,OAAO,OAAK,EAAE,OAAO;AACvE,QAAI,QAAQ,WAAW,EAAG,QAAO;AACjC,WAAO,QAAQ,OAAO,CAAC,KAAK,MAAM,MAAM,EAAE,WAAW,CAAC,IAAI,QAAQ;AAAA,EACpE;AAAA,EAEA,wBAAgC;AAC9B,UAAM,QAAQ,KAAK,QAAQ;AAC3B,QAAI,UAAU,EAAG,QAAO;AACxB,UAAM,UAAU,KAAK,kBAAkB,EAAE;AACzC,WAAQ,UAAU,QAAS;AAAA,EAC7B;AACF;AAMA,IAAI,wBAA8C;AAE3C,SAAS,mBAAkC;AAChD,MAAI,CAAC,uBAAuB;AAC1B,4BAAwB,IAAI,cAAc;AAAA,EAC5C;AACA,SAAO;AACT;AAEO,SAAS,oBAAoB,QAAoD;AACtF,0BAAwB,IAAI,cAAc,MAAM;AAChD,SAAO;AACT;;;AClPO,IAAM,eAAN,MAAmB;AAAA,EAChB;AAAA,EACA,UAAqC,oBAAI,IAAI;AAAA,EAC7C,gBAAgD,oBAAI,IAAI;AAAA,EACxD,kBAA0B;AAAA,EAC1B,mBAAwC,oBAAI,IAAI;AAAA,EAChD,kBAA0C;AAAA,EAC1C,aAAkC,oBAAI,IAAI;AAAA,EAElD,YAAY,WAAgC,YAAY;AACtD,SAAK,WAAW;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA,EAMA,YAAY,UAAqC;AAC/C,SAAK,WAAW;AAChB,YAAQ,IAAI,yBAAyB,QAAQ,EAAE;AAAA,EACjD;AAAA,EAEA,mBAAmB,UAAwC;AACzD,SAAK,kBAAkB;AACvB,QAAI,UAAU,SAAS;AACrB,cAAQ,IAAI,uCAAuC,SAAS,KAAK,KAAK;AAAA,IACxE;AAAA,EACF;AAAA,EAEA,UAAU,QAA4B;AACpC,SAAK,QAAQ,IAAI,OAAO,QAAQ,MAAM;AACtC,SAAK,iBAAiB,IAAI,OAAO,QAAQ,CAAC;AAAA,EAC5C;AAAA,EAEA,aAAa,QAAsB;AACjC,SAAK,QAAQ,OAAO,MAAM;AAC1B,SAAK,iBAAiB,OAAO,MAAM;AAAA,EACrC;AAAA,EAEA,aAAa,QAAgB,QAAiC;AAC5D,SAAK,cAAc,IAAI,QAAQ,MAAM;AAAA,EACvC;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,SAKmB;AACvB,UAAM,mBAAmB,KAAK,oBAAoB,SAAS,cAAc;AAEzE,QAAI,iBAAiB,WAAW,GAAG;AACjC,cAAQ,KAAK,uCAAuC;AACpD,aAAO;AAAA,IACT;AAGA,QAAI,KAAK,iBAAiB,WAAW,SAAS,WAAW;AACvD,YAAM,gBAAgB,KAAK,WAAW,IAAI,QAAQ,SAAS;AAC3D,UAAI,iBAAiB,iBAAiB,SAAS,aAAa,GAAG;AAC7D,cAAMC,UAAS,KAAK,QAAQ,IAAI,aAAa;AAC7C,eAAO;AAAA,UACL,QAAQ;AAAA,UACR,UAAUA,QAAO;AAAA,UACjB,QAAQ;AAAA,UACR,iBAAiB,KAAK,mBAAmB,eAAe,gBAAgB;AAAA,QAC1E;AAAA,MACF;AAAA,IACF;AAGA,QAAI,SAAS,mBAAmB,iBAAiB,SAAS,QAAQ,eAAe,GAAG;AAClF,YAAMA,UAAS,KAAK,QAAQ,IAAI,QAAQ,eAAe;AACvD,aAAO;AAAA,QACL,QAAQ,QAAQ;AAAA,QAChB,UAAUA,QAAO;AAAA,QACjB,QAAQ;AAAA,QACR,iBAAiB,KAAK,mBAAmB,QAAQ,iBAAiB,gBAAgB;AAAA,MACpF;AAAA,IACF;AAGA,QAAI;AACJ,QAAI;AAEJ,YAAQ,KAAK,UAAU;AAAA,MACrB,KAAK;AACH,yBAAiB,KAAK,iBAAiB,gBAAgB;AACvD,iBAAS;AACT;AAAA,MAEF,KAAK;AACH,yBAAiB,KAAK,eAAe,gBAAgB;AACrD,iBAAS;AACT;AAAA,MAEF,KAAK;AACH,yBAAiB,KAAK,uBAAuB,gBAAgB;AAC7D,iBAAS;AACT;AAAA,MAEF,KAAK;AACH,yBAAiB,KAAK,mBAAmB,gBAAgB;AACzD,iBAAS;AACT;AAAA,MAEF,KAAK;AACH,yBAAiB,KAAK,mBAAmB,kBAAkB,SAAS,QAAQ;AAC5E,iBAAS;AACT;AAAA,MAEF,KAAK;AACH,yBAAiB,KAAK,eAAe,gBAAgB;AACrD,iBAAS;AACT;AAAA,MAEF;AACE,yBAAiB,iBAAiB,CAAC;AACnC,iBAAS;AAAA,IACb;AAGA,QAAI,KAAK,iBAAiB,WAAW,SAAS,WAAW;AACvD,WAAK,WAAW,IAAI,QAAQ,WAAW,cAAc;AAErD,iBAAW,MAAM;AACf,aAAK,WAAW,OAAO,QAAQ,SAAU;AAAA,MAC3C,GAAG,KAAK,gBAAgB,KAAK;AAAA,IAC/B;AAEA,UAAM,SAAS,KAAK,QAAQ,IAAI,cAAc;AAC9C,WAAO;AAAA,MACL,QAAQ;AAAA,MACR,UAAU,OAAO;AAAA,MACjB;AAAA,MACA,iBAAiB,KAAK,mBAAmB,gBAAgB,gBAAgB;AAAA,IAC3E;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMQ,iBAAiB,SAA2B;AAClD,UAAM,SAAS,QAAQ,KAAK,kBAAkB,QAAQ,MAAM;AAC5D,SAAK;AACL,WAAO;AAAA,EACT;AAAA,EAEQ,eAAe,SAA2B;AAChD,UAAM,cAAc,QAAQ,OAAO,CAAC,KAAK,MAAM;AAC7C,YAAM,SAAS,KAAK,QAAQ,IAAI,CAAC;AACjC,aAAO,OAAO,QAAQ,UAAU;AAAA,IAClC,GAAG,CAAC;AAEJ,QAAI,SAAS,KAAK,OAAO,IAAI;AAE7B,eAAW,UAAU,SAAS;AAC5B,YAAM,SAAS,KAAK,QAAQ,IAAI,MAAM;AACtC,YAAM,SAAS,QAAQ,UAAU;AACjC,gBAAU;AACV,UAAI,UAAU,GAAG;AACf,eAAO;AAAA,MACT;AAAA,IACF;AAEA,WAAO,QAAQ,CAAC;AAAA,EAClB;AAAA,EAEQ,uBAAuB,SAA2B;AACxD,QAAI,iBAAiB;AACrB,QAAI,iBAAiB,QAAQ,CAAC;AAE9B,eAAW,UAAU,SAAS;AAC5B,YAAM,cAAc,KAAK,iBAAiB,IAAI,MAAM,KAAK;AACzD,UAAI,cAAc,gBAAgB;AAChC,yBAAiB;AACjB,yBAAiB;AAAA,MACnB;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA,EAEQ,mBAAmB,SAA2B;AACpD,QAAI,aAAa;AACjB,QAAI,iBAAiB,QAAQ,CAAC;AAE9B,eAAW,UAAU,SAAS;AAC5B,YAAM,SAAS,KAAK,cAAc,IAAI,MAAM;AAC5C,YAAM,UAAU,QAAQ,aAAa;AACrC,UAAI,UAAU,YAAY;AACxB,qBAAa;AACb,yBAAiB;AAAA,MACnB;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA,EAEQ,mBAAmB,SAAmB,UAA2B;AAGvE,QAAI,CAAC,UAAU;AACb,aAAO,KAAK,mBAAmB,OAAO;AAAA,IACxC;AAGA,UAAM,WAAqC;AAAA,MACzC,OAAO,CAAC,aAAa,WAAW;AAAA,MAChC,QAAQ,CAAC,aAAa,cAAc;AAAA,MACpC,YAAY,CAAC,kBAAkB,gBAAgB;AAAA,IACjD;AAEA,eAAW,CAAC,QAAQ,gBAAgB,KAAK,OAAO,QAAQ,QAAQ,GAAG;AACjE,UAAI,SAAS,WAAW,MAAM,GAAG;AAC/B,cAAM,QAAQ,iBAAiB,KAAK,OAAK,QAAQ,SAAS,CAAW,CAAC;AACtE,YAAI,MAAO,QAAO;AAAA,MACpB;AAAA,IACF;AAEA,WAAO,KAAK,mBAAmB,OAAO;AAAA,EACxC;AAAA,EAEQ,eAAe,SAA2B;AAEhD,UAAM,UAAU,MAAM,KAAK,KAAK,QAAQ,OAAO,CAAC,EAC7C,OAAO,OAAK,EAAE,aAAa,QAAQ,SAAS,EAAE,MAAM,CAAC,EACrD,KAAK,CAAC,GAAG,MAAM,EAAE,SAAS,EAAE,MAAM;AAErC,QAAI,QAAQ,SAAS,GAAG;AACtB,aAAO,QAAQ,CAAC,EAAE;AAAA,IACpB;AAGA,UAAM,UAAU,MAAM,KAAK,KAAK,QAAQ,OAAO,CAAC,EAC7C,OAAO,OAAK,QAAQ,SAAS,EAAE,MAAM,CAAC,EACtC,KAAK,CAAC,GAAG,MAAM,EAAE,SAAS,EAAE,MAAM;AAErC,WAAO,QAAQ,CAAC,GAAG,UAAU,QAAQ,CAAC;AAAA,EACxC;AAAA;AAAA;AAAA;AAAA,EAMQ,oBAAoB,gBAAqC;AAC/D,UAAM,UAAU,IAAI,IAAI,kBAAkB,CAAC,CAAC;AAE5C,WAAO,MAAM,KAAK,KAAK,QAAQ,OAAO,CAAC,EACpC,OAAO,YAAU;AAEhB,UAAI,QAAQ,IAAI,OAAO,MAAM,EAAG,QAAO;AAGvC,UAAI,OAAO,WAAW,aAAa,OAAO,WAAW,WAAY,QAAO;AAGxE,YAAM,SAAS,KAAK,cAAc,IAAI,OAAO,MAAM;AACnD,UAAI,UAAU,CAAC,OAAO,QAAS,QAAO;AAEtC,aAAO;AAAA,IACT,CAAC,EACA,IAAI,YAAU,OAAO,MAAM;AAAA,EAChC;AAAA,EAEQ,mBAAmB,UAAkB,WAA+B;AAC1E,WAAO,UACJ,OAAO,OAAK,MAAM,QAAQ,EAC1B,KAAK,CAAC,GAAG,MAAM;AACd,YAAM,UAAU,KAAK,cAAc,IAAI,CAAC;AACxC,YAAM,UAAU,KAAK,cAAc,IAAI,CAAC;AACxC,cAAQ,SAAS,aAAa,aAAa,SAAS,aAAa;AAAA,IACnE,CAAC,EACA,MAAM,GAAG,CAAC;AAAA,EACf;AAAA;AAAA;AAAA;AAAA,EAMA,qBAAqB,QAAsB;AACzC,UAAM,UAAU,KAAK,iBAAiB,IAAI,MAAM,KAAK;AACrD,SAAK,iBAAiB,IAAI,QAAQ,UAAU,CAAC;AAAA,EAC/C;AAAA,EAEA,qBAAqB,QAAsB;AACzC,UAAM,UAAU,KAAK,iBAAiB,IAAI,MAAM,KAAK;AACrD,SAAK,iBAAiB,IAAI,QAAQ,KAAK,IAAI,GAAG,UAAU,CAAC,CAAC;AAAA,EAC5D;AAAA,EAEA,mBAAmB,QAAwB;AACzC,WAAO,KAAK,iBAAiB,IAAI,MAAM,KAAK;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA,EAMA,WAME;AACA,WAAO;AAAA,MACL,UAAU,KAAK;AAAA,MACf,aAAa,KAAK,QAAQ;AAAA,MAC1B,gBAAgB,KAAK,oBAAoB,EAAE;AAAA,MAC3C,qBAAqB,OAAO,YAAY,KAAK,gBAAgB;AAAA,MAC7D,cAAc,KAAK,WAAW;AAAA,IAChC;AAAA,EACF;AACF;AAMA,IAAI,uBAA4C;AAEzC,SAAS,kBAAgC;AAC9C,MAAI,CAAC,sBAAsB;AACzB,2BAAuB,IAAI,aAAa;AAAA,EAC1C;AACA,SAAO;AACT;AAEO,SAAS,mBAAmB,UAA8C;AAC/E,yBAAuB,IAAI,aAAa,QAAQ;AAChD,SAAO;AACT;;;AC7VA,SAAS,gBAAAC,sBAAoB;AAetB,IAAM,kBAAN,cAA8BC,eAAuB;AAAA,EAClD;AAAA,EACA,UAAqC,oBAAI,IAAI;AAAA,EAC7C,gBAA+B;AAAA,EAC/B,kBAAmC,CAAC;AAAA,EACpC,mBAA2B;AAAA,EAC3B,mBAA+C,oBAAI,IAAI;AAAA,EACvD,gBAAqC,oBAAI,IAAI;AAAA,EAErD,YAAY,SAAkC,CAAC,GAAG;AAChD,UAAM;AACN,SAAK,SAAS,EAAE,GAAG,yBAAyB,GAAG,OAAO;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA,EAMA,UAAU,QAAuC;AAC/C,SAAK,SAAS,EAAE,GAAG,KAAK,QAAQ,GAAG,OAAO;AAC1C,YAAQ,IAAI,kCAAkC;AAAA,EAChD;AAAA,EAEA,UAAU,cAAkC;AAC1C,SAAK,QAAQ,IAAI,aAAa,QAAQ,YAAY;AAClD,SAAK,cAAc,IAAI,aAAa,QAAQ,CAAC;AAE7C,QAAI,aAAa,WAAW;AAC1B,WAAK,gBAAgB,aAAa;AAClC,cAAQ,IAAI,kCAAkC,aAAa,MAAM,EAAE;AAAA,IACrE;AAAA,EACF;AAAA,EAEA,aAAa,QAAsB;AACjC,UAAM,SAAS,KAAK,QAAQ,IAAI,MAAM;AACtC,SAAK,QAAQ,OAAO,MAAM;AAC1B,SAAK,cAAc,OAAO,MAAM;AAEhC,QAAI,QAAQ,aAAa,KAAK,kBAAkB,QAAQ;AAEtD,YAAM,aAAa,MAAM,KAAK,KAAK,QAAQ,OAAO,CAAC,EAChD,OAAO,OAAK,EAAE,WAAW,YAAY,EAAE,WAAW,SAAS,EAC3D,KAAK,CAAC,GAAG,MAAM,EAAE,SAAS,EAAE,MAAM;AAErC,UAAI,WAAW,SAAS,GAAG;AACzB,aAAK,gBAAgB,WAAW,CAAC,EAAE;AACnC,mBAAW,CAAC,EAAE,YAAY;AAC1B,gBAAQ,IAAI,mCAAmC,KAAK,aAAa,EAAE;AAAA,MACrE,OAAO;AACL,aAAK,gBAAgB;AACrB,gBAAQ,KAAK,iDAAiD;AAAA,MAChE;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,oBAAoB,QAAgB,QAAiC;AACnE,QAAI,OAAO,SAAS;AAElB,WAAK,cAAc,IAAI,QAAQ,CAAC;AAAA,IAClC,OAAO;AAEL,YAAM,UAAU,KAAK,cAAc,IAAI,MAAM,KAAK;AAClD,YAAM,WAAW,UAAU;AAC3B,WAAK,cAAc,IAAI,QAAQ,QAAQ;AAEvC,cAAQ,IAAI,cAAc,MAAM,mBAAmB,QAAQ,IAAI,KAAK,OAAO,gBAAgB,EAAE;AAG7F,UAAI,YAAY,KAAK,OAAO,oBAAoB,WAAW,KAAK,eAAe;AAC7E,aAAK,iBAAiB,QAAQ,cAAc;AAAA,MAC9C;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,iBACJ,YACA,aAC+B;AAE/B,UAAM,MAAM,KAAK,IAAI;AACrB,QAAI,MAAM,KAAK,mBAAmB,KAAK,OAAO,YAAY;AACxD,cAAQ,IAAI,0DAA0D;AACtE,aAAO;AAAA,IACT;AAGA,UAAM,kBAAkB,KAAK,gBAAgB;AAAA,MAC3C,OAAK,MAAM,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,IAAI;AAAA,IAC/C;AACA,QAAI,gBAAgB,UAAU,KAAK,OAAO,qBAAqB;AAC7D,cAAQ,KAAK,sCAAsC,KAAK,OAAO,mBAAmB,WAAW;AAC7F,aAAO;AAAA,IACT;AAGA,UAAM,eAAe,KAAK,qBAAqB,UAAU;AACzD,QAAI,CAAC,cAAc;AACjB,cAAQ,MAAM,8CAA8C;AAC5D,aAAO;AAAA,IACT;AAGA,UAAM,QAAuB;AAAA,MAC3B,IAAI,MAAM,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,GAAG,CAAC,CAAC;AAAA,MAC9D;AAAA,MACA,UAAU;AAAA,MACV,QAAQ,GAAG,WAAW,YAAY,UAAU;AAAA,MAC5C;AAAA,MACA,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MAClC,QAAQ;AAAA,MACR,mBAAmB;AAAA,IACrB;AAGA,QAAI,KAAK,OAAO,mBAAmB,KAAK,OAAO,SAAS,aAAa;AACnE,YAAM,SAAS;AACf,WAAK,iBAAiB,IAAI,MAAM,IAAI,KAAK;AACzC,cAAQ,IAAI,8CAA8C,MAAM,EAAE,EAAE;AAEpE,UAAI,KAAK,OAAO,kBAAkB;AAChC,aAAK,KAAK,oBAAoB,KAAK;AAAA,MACrC;AAEA,aAAO;AAAA,IACT;AAGA,WAAO,KAAK,gBAAgB,KAAK;AAAA,EACnC;AAAA,EAEA,MAAM,gBAAgB,OAA8C;AAClE,YAAQ,IAAI,kCAAkC,MAAM,UAAU,OAAO,MAAM,QAAQ,EAAE;AAErF,SAAK,KAAK,oBAAoB,KAAK;AAEnC,QAAI;AAEF,YAAM,aAAa,KAAK,QAAQ,IAAI,MAAM,UAAU;AACpD,YAAM,WAAW,KAAK,QAAQ,IAAI,MAAM,QAAQ;AAEhD,UAAI,YAAY;AACd,mBAAW,SAAS;AACpB,mBAAW,YAAY;AAAA,MACzB;AAEA,UAAI,UAAU;AACZ,iBAAS,SAAS;AAClB,iBAAS,YAAY;AACrB,aAAK,gBAAgB,MAAM;AAAA,MAC7B;AAGA,UAAI,YAAY;AACd,aAAK,KAAK,yBAAyB,MAAM,YAAY,UAAU,SAAS;AAAA,MAC1E;AACA,UAAI,UAAU;AACZ,aAAK,KAAK,yBAAyB,MAAM,UAAU,SAAS,QAAQ,QAAQ;AAAA,MAC9E;AAGA,YAAM,SAAS;AACf,YAAM,eAAc,oBAAI,KAAK,GAAE,YAAY;AAG3C,WAAK,mBAAmB,KAAK,IAAI;AACjC,WAAK,gBAAgB,KAAK,KAAK;AAC/B,WAAK,iBAAiB,OAAO,MAAM,EAAE;AAErC,cAAQ,IAAI,yBAAyB,MAAM,QAAQ,iBAAiB;AACpE,WAAK,KAAK,sBAAsB,KAAK;AAErC,aAAO;AAAA,IACT,SAAS,OAAO;AACd,YAAM,SAAS;AACf,YAAM,eAAc,oBAAI,KAAK,GAAE,YAAY;AAE3C,cAAQ,MAAM,sBAAsB,KAAK;AAGzC,UAAI,KAAK,OAAO,mBAAmB;AACjC,cAAM,KAAK,iBAAiB,KAAK;AAAA,MACnC;AAEA,WAAK,KAAK,mBAAmB,OAAO,iBAAiB,QAAQ,QAAQ,IAAI,MAAM,OAAO,KAAK,CAAC,CAAC;AAC7F,aAAO;AAAA,IACT;AAAA,EACF;AAAA,EAEA,MAAM,iBAAiB,OAAqC;AAC1D,YAAQ,IAAI,oCAAoC,MAAM,EAAE,EAAE;AAE1D,UAAM,aAAa,KAAK,QAAQ,IAAI,MAAM,UAAU;AACpD,UAAM,WAAW,KAAK,QAAQ,IAAI,MAAM,QAAQ;AAGhD,QAAI,YAAY;AACd,iBAAW,SAAS;AACpB,iBAAW,YAAY;AACvB,WAAK,gBAAgB,MAAM;AAAA,IAC7B;AAEA,QAAI,UAAU;AACZ,eAAS,SAAS;AAClB,eAAS,YAAY;AAAA,IACvB;AAEA,UAAM,SAAS;AACf,UAAM,eAAc,oBAAI,KAAK,GAAE,YAAY;AAE3C,YAAQ,IAAI,kCAAkC,MAAM,UAAU,sBAAsB;AAAA,EACtF;AAAA;AAAA;AAAA;AAAA,EAMA,gBAAgB,YAA0C;AACxD,UAAM,QAAQ,KAAK,iBAAiB,IAAI,UAAU;AAClD,QAAI,CAAC,OAAO;AACV,cAAQ,KAAK,kCAAkC,UAAU,EAAE;AAC3D,aAAO;AAAA,IACT;AAGA,SAAK,gBAAgB,KAAK,EAAE,MAAM,SAAO;AACvC,cAAQ,MAAM,kDAAkD,GAAG;AAAA,IACrE,CAAC;AAED,WAAO;AAAA,EACT;AAAA,EAEA,eAAe,YAAoB,QAAuC;AACxE,UAAM,QAAQ,KAAK,iBAAiB,IAAI,UAAU;AAClD,QAAI,CAAC,OAAO;AACV,cAAQ,KAAK,kCAAkC,UAAU,EAAE;AAC3D,aAAO;AAAA,IACT;AAEA,UAAM,SAAS;AACf,UAAM,eAAc,oBAAI,KAAK,GAAE,YAAY;AAC3C,UAAM,WAAW,EAAE,GAAG,MAAM,UAAU,iBAAiB,OAAO;AAE9D,SAAK,iBAAiB,OAAO,UAAU;AACvC,SAAK,gBAAgB,KAAK,KAAK;AAE/B,YAAQ,IAAI,wBAAwB,UAAU,aAAa,UAAU,oBAAoB,EAAE;AAE3F,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,eAAe,UAAkB,QAAgD;AACrF,QAAI,CAAC,KAAK,eAAe;AACvB,cAAQ,MAAM,+CAA+C;AAC7D,aAAO;AAAA,IACT;AAEA,QAAI,aAAa,KAAK,eAAe;AACnC,cAAQ,KAAK,6CAA6C;AAC1D,aAAO;AAAA,IACT;AAEA,UAAM,eAAe,KAAK,QAAQ,IAAI,QAAQ;AAC9C,QAAI,CAAC,cAAc;AACjB,cAAQ,MAAM,4CAA4C,QAAQ,EAAE;AACpE,aAAO;AAAA,IACT;AAEA,UAAM,QAAuB;AAAA,MAC3B,IAAI,MAAM,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,GAAG,CAAC,CAAC;AAAA,MAC9D,YAAY,KAAK;AAAA,MACjB;AAAA,MACA,QAAQ,UAAU;AAAA,MAClB,aAAa;AAAA,MACb,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MAClC,QAAQ;AAAA,MACR,mBAAmB;AAAA,IACrB;AAEA,WAAO,KAAK,gBAAgB,KAAK;AAAA,EACnC;AAAA;AAAA;AAAA;AAAA,EAMQ,qBAAqB,eAAsC;AACjE,UAAM,aAAa,MAAM,KAAK,KAAK,QAAQ,OAAO,CAAC,EAChD,OAAO,OAAK;AACX,UAAI,EAAE,WAAW,cAAe,QAAO;AACvC,UAAI,EAAE,WAAW,aAAa,EAAE,WAAW,WAAY,QAAO;AAE9D,YAAM,WAAW,KAAK,cAAc,IAAI,EAAE,MAAM,KAAK;AACrD,UAAI,YAAY,KAAK,OAAO,iBAAkB,QAAO;AACrD,aAAO;AAAA,IACT,CAAC,EACA,KAAK,CAAC,GAAG,MAAM,EAAE,SAAS,EAAE,MAAM;AAErC,WAAO,WAAW,CAAC,GAAG,UAAU;AAAA,EAClC;AAAA;AAAA;AAAA;AAAA,EAMA,mBAAkC;AAChC,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,mBAAmB,QAAgB,IAAqB;AACtD,WAAO,KAAK,gBAAgB,MAAM,CAAC,KAAK;AAAA,EAC1C;AAAA,EAEA,sBAAuC;AACrC,WAAO,MAAM,KAAK,KAAK,iBAAiB,OAAO,CAAC;AAAA,EAClD;AAAA,EAEA,sBAA8B;AAC5B,UAAM,MAAM,KAAK,IAAI;AACrB,WAAO,KAAK,gBAAgB;AAAA,MAC1B,OAAK,MAAM,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,IAAI;AAAA,IAC/C,EAAE;AAAA,EACJ;AAAA,EAEA,YAA4B;AAC1B,WAAO,EAAE,GAAG,KAAK,OAAO;AAAA,EAC1B;AAAA,EAEA,WAOE;AACA,UAAM,MAAM,KAAK,IAAI;AACrB,UAAM,oBAAoB,KAAK,IAAI,GAAG,KAAK,OAAO,cAAc,MAAM,KAAK,iBAAiB;AAE5F,WAAO;AAAA,MACL,eAAe,KAAK;AAAA,MACpB,kBAAkB,KAAK,oBAAoB;AAAA,MAC3C,cAAc,KAAK,gBAAgB,KAAK,gBAAgB,SAAS,CAAC,KAAK;AAAA,MACvE,kBAAkB,KAAK,iBAAiB;AAAA,MACxC,gBAAgB,oBAAoB;AAAA,MACpC,qBAAqB;AAAA,IACvB;AAAA,EACF;AACF;AAMA,IAAI,0BAAkD;AAE/C,SAAS,qBAAsC;AACpD,MAAI,CAAC,yBAAyB;AAC5B,8BAA0B,IAAI,gBAAgB;AAAA,EAChD;AACA,SAAO;AACT;AAEO,SAAS,sBAAsB,QAAmD;AACvF,4BAA0B,IAAI,gBAAgB,MAAM;AACpD,SAAO;AACT;;;ACxYA,SAAS,gBAAAC,sBAAoB;AAoBtB,IAAM,YAAN,cAAwBC,eAAuB;AAAA,EAC5C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,oBAAoD,oBAAI,IAAI;AAAA,EAC5D,kBAAyC;AAAA,EACzC,UAAmB;AAAA,EAE3B,YAAY,QAAyB;AACnC,UAAM;AACN,SAAK,SAAS;AAGd,SAAK,gBAAgB,oBAAoB,OAAO,WAAW;AAC3D,SAAK,eAAe,mBAAmB,OAAO,eAAe,QAAQ;AACrE,SAAK,kBAAkB,sBAAsB,OAAO,QAAQ;AAE5D,QAAI,OAAO,eAAe,eAAe;AACvC,WAAK,aAAa,mBAAmB,OAAO,cAAc,aAAa;AAAA,IACzE;AAGA,SAAK,mBAAmB;AAGxB,eAAW,gBAAgB,OAAO,SAAS;AACzC,WAAK,UAAU,YAAY;AAAA,IAC7B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMQ,qBAA2B;AAEjC,SAAK,cAAc,GAAG,kBAAkB,CAAC,YAAY;AACnD,WAAK,KAAK,kBAAkB,OAAO;AAGnC,iBAAW,UAAU,SAAS;AAC5B,aAAK,aAAa,aAAa,OAAO,QAAQ,MAAM;AACpD,aAAK,gBAAgB,oBAAoB,OAAO,QAAQ,MAAM;AAAA,MAChE;AAAA,IACF,CAAC;AAED,SAAK,cAAc,GAAG,mBAAmB,CAAC,QAAQ,WAAW;AAC3D,WAAK,KAAK,mBAAmB,QAAQ,MAAM;AAC3C,WAAK,mBAAmB,QAAQ,UAAU;AAAA,IAC5C,CAAC;AAED,SAAK,cAAc,GAAG,oBAAoB,CAAC,QAAQ,WAAW;AAC5D,WAAK,KAAK,oBAAoB,QAAQ,MAAM;AAC5C,WAAK,mBAAmB,QAAQ,QAAQ;AAAA,IAC1C,CAAC;AAGD,SAAK,gBAAgB,GAAG,oBAAoB,CAAC,UAAU;AACrD,WAAK,KAAK,oBAAoB,KAAK;AAAA,IACrC,CAAC;AAED,SAAK,gBAAgB,GAAG,sBAAsB,CAAC,UAAU;AACvD,WAAK,KAAK,sBAAsB,KAAK;AAAA,IACvC,CAAC;AAED,SAAK,gBAAgB,GAAG,mBAAmB,CAAC,OAAO,UAAU;AAC3D,WAAK,KAAK,mBAAmB,OAAO,KAAK;AAAA,IAC3C,CAAC;AAED,SAAK,gBAAgB,GAAG,yBAAyB,CAAC,QAAQ,WAAW,cAAc;AACjF,WAAK,KAAK,yBAAyB,QAAQ,WAAW,SAAS;AAAA,IACjE,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAMA,UAAU,cAAkC;AAC1C,SAAK,cAAc,UAAU,YAAY;AACzC,SAAK,aAAa,UAAU,YAAY;AACxC,SAAK,gBAAgB,UAAU,YAAY;AAE3C,SAAK,KAAK,gBAAgB,YAAY;AACtC,YAAQ,IAAI,sBAAsB,aAAa,MAAM,KAAK,aAAa,MAAM,GAAG;AAAA,EAClF;AAAA,EAEA,aAAa,QAAsB;AACjC,SAAK,cAAc,aAAa,MAAM;AACtC,SAAK,aAAa,aAAa,MAAM;AACrC,SAAK,gBAAgB,aAAa,MAAM;AAExC,SAAK,KAAK,kBAAkB,MAAM;AAClC,YAAQ,IAAI,wBAAwB,MAAM,EAAE;AAAA,EAC9C;AAAA,EAEA,mBAAmB,QAAgB,QAA4B;AAC7D,UAAM,eAAe,KAAK,OAAO,QAAQ,KAAK,OAAK,EAAE,WAAW,MAAM;AACtE,QAAI,cAAc;AAChB,YAAM,YAAY,aAAa;AAC/B,mBAAa,SAAS;AACtB,WAAK,KAAK,yBAAyB,QAAQ,WAAW,MAAM;AAAA,IAC9D;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,SAKH;AACD,WAAO,KAAK,aAAa,MAAM,OAAO;AAAA,EACxC;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,gBAAgB,UAAkB,QAAgD;AACtF,WAAO,KAAK,gBAAgB,eAAe,UAAU,MAAM;AAAA,EAC7D;AAAA,EAEA,gBAAgB,YAA0C;AACxD,WAAO,KAAK,gBAAgB,gBAAgB,UAAU;AAAA,EACxD;AAAA,EAEA,eAAe,YAAoB,QAAuC;AACxE,WAAO,KAAK,gBAAgB,eAAe,YAAY,MAAM;AAAA,EAC/D;AAAA;AAAA;AAAA;AAAA,EAMA,wBAAwB,QAAiC;AACvD,UAAM,MAAM,GAAG,OAAO,YAAY,KAAK,OAAO,YAAY;AAC1D,SAAK,kBAAkB,IAAI,KAAK,MAAM;AAGtC,UAAM,SAAS,KAAK,OAAO,aAAa,YAAY;AACpD,QAAI,OAAO,QAAQ,QAAQ;AACzB,WAAK,KAAK,mBAAmB,MAAM;AACnC,cAAQ,KAAK,kCAAkC,OAAO,YAAY,OAAO,OAAO,YAAY,KAAK,OAAO,KAAK,KAAK;AAAA,IACpH;AAAA,EACF;AAAA,EAEA,uBAA4C;AAC1C,WAAO,MAAM,KAAK,KAAK,kBAAkB,OAAO,CAAC;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA,EAMA,QAAc;AACZ,QAAI,KAAK,SAAS;AAChB,cAAQ,IAAI,8BAA8B;AAC1C;AAAA,IACF;AAEA,YAAQ,IAAI,yCAAyC;AACrD,SAAK,UAAU;AAGf,SAAK,cAAc,MAAM;AAGzB,QAAI,KAAK,OAAO,YAAY,SAAS;AACnC,WAAK,uBAAuB;AAAA,IAC9B;AAAA,EACF;AAAA,EAEA,OAAa;AACX,QAAI,CAAC,KAAK,SAAS;AACjB;AAAA,IACF;AAEA,YAAQ,IAAI,yCAAyC;AACrD,SAAK,UAAU;AAEf,SAAK,cAAc,KAAK;AACxB,SAAK,sBAAsB;AAAA,EAC7B;AAAA,EAEQ,yBAA+B;AACrC,UAAM,WAAW,KAAK,OAAO,YAAY,qBAAqB;AAE9D,SAAK,kBAAkB,YAAY,MAAM;AACvC,YAAM,QAAQ,KAAK,SAAS;AAG5B,YAAM,aAAa,KAAK,OAAO,YAAY;AAC3C,UAAI,YAAY;AACd,YAAI,MAAM,kBAAkB,WAAW,WAAW;AAChD,kBAAQ,KAAK,+BAA+B,MAAM,eAAe,0BAA0B,WAAW,SAAS,KAAK;AAAA,QACtH;AACA,YAAI,MAAM,qBAAqB,WAAW,qBAAqB;AAC7D,kBAAQ,KAAK,6BAA6B,MAAM,kBAAkB,uBAAuB,WAAW,mBAAmB,IAAI;AAAA,QAC7H;AAAA,MACF;AAAA,IACF,GAAG,QAAQ;AAAA,EACb;AAAA,EAEQ,wBAA8B;AACpC,QAAI,KAAK,iBAAiB;AACxB,oBAAc,KAAK,eAAe;AAClC,WAAK,kBAAkB;AAAA,IACzB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,WAAoB;AAClB,UAAM,gBAAgB,KAAK,cAAc,cAAc;AACvD,UAAM,eAAkD,CAAC;AAEzD,eAAW,CAAC,QAAQ,MAAM,KAAK,eAAe;AAC5C,mBAAa,MAAM,IAAI;AAAA,IACzB;AAEA,WAAO;AAAA,MACL,eAAe,KAAK,gBAAgB,iBAAiB,KAAM;AAAA,MAC3D,eAAe,KAAK,cAAc,kBAAkB;AAAA,MACpD;AAAA,MACA,mBAAmB,KAAK,qBAAqB;AAAA,MAC7C,cAAc,KAAK,gBAAgB,mBAAmB,CAAC,EAAE,CAAC;AAAA,MAC1D,kBAAkB,KAAK,gBAAgB,oBAAoB;AAAA,MAC3D,iBAAiB,KAAK,cAAc,kBAAkB;AAAA,MACtD,oBAAoB,KAAK,cAAc,sBAAsB;AAAA,MAC7D,cAAa,oBAAI,KAAK,GAAE,YAAY;AAAA,IACtC;AAAA,EACF;AAAA,EAEA,YAA6B;AAC3B,WAAO,EAAE,GAAG,KAAK,OAAO;AAAA,EAC1B;AAAA,EAEA,YAAqB;AACnB,WAAO,KAAK;AAAA,EACd;AAAA;AAAA;AAAA;AAAA,EAMA,mBAAkC;AAChC,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,kBAAgC;AAC9B,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,qBAAsC;AACpC,WAAO,KAAK;AAAA,EACd;AACF;AAMA,IAAI,oBAAsC;AAEnC,SAAS,eAAiC;AAC/C,SAAO;AACT;AAEO,SAAS,gBAAgB,QAAoC;AAClE,sBAAoB,IAAI,UAAU,MAAM;AACxC,SAAO;AACT;AAMO,IAAM,oBAAqC;AAAA,EAChD,SAAS;AAAA,IACP;AAAA,MACE,IAAI;AAAA,MACJ,QAAQ;AAAA,MACR,UAAU;AAAA,MACV,QAAQ;AAAA,MACR,WAAW;AAAA,MACX,QAAQ;AAAA,IACV;AAAA,IACA;AAAA,MACE,IAAI;AAAA,MACJ,QAAQ;AAAA,MACR,UAAU;AAAA,MACV,QAAQ;AAAA,MACR,WAAW;AAAA,MACX,QAAQ;AAAA,IACV;AAAA,IACA;AAAA,MACE,IAAI;AAAA,MACJ,QAAQ;AAAA,MACR,UAAU;AAAA,MACV,QAAQ;AAAA,MACR,WAAW;AAAA,MACX,QAAQ;AAAA,IACV;AAAA,EACF;AAAA,EACA,aAAa;AAAA,IACX,MAAM;AAAA,IACN,YAAY;AAAA,IACZ,WAAW;AAAA,IACX,oBAAoB;AAAA,IACpB,kBAAkB;AAAA,IAClB,MAAM;AAAA,IACN,gBAAgB;AAAA,EAClB;AAAA,EACA,eAAe;AAAA,IACb,UAAU;AAAA,IACV,eAAe;AAAA,MACb,SAAS;AAAA,MACT,OAAO;AAAA,MACP,YAAY;AAAA,MACZ,UAAU;AAAA,IACZ;AAAA,EACF;AAAA,EACA,UAAU;AAAA,IACR,MAAM;AAAA,IACN,kBAAkB;AAAA,IAClB,YAAY;AAAA,IACZ,qBAAqB;AAAA,IACrB,kBAAkB;AAAA,IAClB,iBAAiB;AAAA,IACjB,mBAAmB;AAAA,EACrB;AAAA,EACA,aAAa;AAAA,IACX,MAAM;AAAA,IACN,eAAe,CAAC,aAAa,gBAAgB;AAAA,IAC7C,UAAU;AAAA,IACV,WAAW;AAAA,IACX,eAAe;AAAA,IACf,oBAAoB;AAAA,EACtB;AAAA,EACA,YAAY;AAAA,IACV,SAAS;AAAA,IACT,mBAAmB;AAAA,IACnB,iBAAiB;AAAA,MACf,WAAW;AAAA,MACX,WAAW;AAAA,MACX,qBAAqB;AAAA,IACvB;AAAA,EACF;AACF;;;ACvXA,SAAS,KAAAC,UAAS;AAMX,IAAM,mBAAmBA,GAAE,KAAK;AAAA,EACrC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,qBAAqBA,GAAE,KAAK;AAAA,EACvC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,sBAAsBA,GAAE,KAAK;AAAA,EACxC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAOM,IAAM,uBAAuBA,GAAE,OAAO;AAAA,EAC3C,SAASA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,EACjC,MAAMA,GAAE,OAAO,EAAE,QAAQ,WAAW;AAAA;AAAA,EACpC,MAAM,iBAAiB,QAAQ,aAAa;AAAA,EAC5C,eAAeA,GAAE,OAAO,EAAE,QAAQ,EAAE;AAAA,EACpC,YAAYA,GAAE,OAAO,EAAE,QAAQ,GAAG;AACpC,CAAC;AAGM,IAAM,sBAAsBA,GAAE,OAAO;AAAA,EAC1C,MAAM;AAAA,EACN,QAAQA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,QAAQA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,MAAMA,GAAE,OAAO,EAAE,QAAQ,UAAU;AAAA,EACnC,WAAWA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC/B,WAAWA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC/B,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC9B,YAAYA,GAAE,OAAO;AAAA,IACnB,SAASA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,IACjC,WAAWA,GAAE,KAAK,CAAC,eAAe,aAAa,CAAC,EAAE,QAAQ,aAAa;AAAA,IACvE,OAAOA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,CAAC,EAAE,SAAS;AACd,CAAC;AAOM,IAAM,mBAAmBA,GAAE,OAAO;AAAA,EACvC,UAAUA,GAAE,OAAO;AAAA,EACnB,MAAMA,GAAE,OAAO;AAAA,EACf,OAAOA,GAAE,OAAO;AAAA,EAChB,WAAWA,GAAE,OAAO;AAAA,EACpB,UAAUA,GAAE,OAAO;AACrB,CAAC;AAGM,IAAM,uBAAuBA,GAAE,OAAO;AAAA,EAC3C,IAAIA,GAAE,OAAO;AAAA,EACb,MAAM;AAAA,EACN,QAAQ;AAAA,EACR,WAAWA,GAAE,OAAO;AAAA,EACpB,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,WAAWA,GAAE,OAAO,EAAE,QAAQ,CAAC;AAAA,EAC/B,OAAOA,GAAE,MAAM,gBAAgB,EAAE,QAAQ,CAAC,CAAC;AAAA,EAC3C,gBAAgBA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EACpC,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC9B,iBAAiBA,GAAE,OAAO,EAAE,SAAS;AAAA,EACrC,iBAAiBA,GAAE,OAAO;AAAA,EAC1B,UAAUA,GAAE,OAAOA,GAAE,QAAQ,CAAC,EAAE,SAAS;AAAA,EACzC,SAASA,GAAE,OAAO,EAAE,QAAQ,OAAO;AACrC,CAAC;AAOM,IAAM,sBAAsBA,GAAE,KAAK;AAAA,EACxC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,oBAAoBA,GAAE,KAAK;AAAA,EACtC;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AACF,CAAC;AAGM,IAAM,uBAAuBA,GAAE,OAAO;AAAA,EAC3C,MAAM,kBAAkB,QAAQ,MAAM;AAAA,EACtC,gBAAgBA,GAAE,OAAO;AAAA,EACzB,WAAWA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA;AAAA,EACxC,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,gBAAgBA,GAAE,QAAQ,EAAE,QAAQ,KAAK;AAAA,EACzC,gBAAgBA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA;AAAA,EACxC,QAAQA,GAAE,QAAQ,EAAE,QAAQ,KAAK;AACnC,CAAC;AAGM,IAAM,wBAAwBA,GAAE,OAAO;AAAA,EAC5C,IAAIA,GAAE,OAAO;AAAA,EACb,QAAQ;AAAA,EACR,UAAUA,GAAE,OAAO;AAAA,EACnB,MAAM;AAAA,EACN,WAAWA,GAAE,OAAO;AAAA,EACpB,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,YAAYA,GAAE,OAAO;AAAA,EACrB,gBAAgBA,GAAE,OAAO;AAAA,EACzB,aAAaA,GAAE,OAAO;AAAA,EACtB,iBAAiBA,GAAE,OAAO,EAAE,SAAS;AAAA,EACrC,QAAQA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,QAAQ,CAAC,CAAC;AAAA,EACtC,YAAYA,GAAE,OAAO,EAAE,SAAS;AAAA;AAClC,CAAC;AAOM,IAAM,iBAAiBA,GAAE,OAAO;AAAA,EACrC,IAAIA,GAAE,OAAO;AAAA,EACb,WAAWA,GAAE,OAAO;AAAA,EACpB,UAAUA,GAAE,OAAO;AAAA,EACnB,WAAWA,GAAE,KAAK,CAAC,UAAU,UAAU,QAAQ,CAAC;AAAA,EAChD,MAAMA,GAAE,QAAQ;AAAA,EAChB,UAAUA,GAAE,OAAO;AACrB,CAAC;AAGM,IAAM,sBAAsBA,GAAE,OAAO;AAAA,EAC1C,IAAIA,GAAE,OAAO;AAAA,EACb,WAAWA,GAAE,OAAO;AAAA,EACpB,UAAUA,GAAE,OAAO;AAAA,EACnB,YAAYA,GAAE,OAAO;AAAA,EACrB,aAAaA,GAAE,OAAO,EAAE,SAAS;AACnC,CAAC;AAOM,IAAM,2BAA2BA,GAAE,KAAK;AAAA,EAC7C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,2BAA2BA,GAAE,OAAO;AAAA,EAC/C,UAAUA,GAAE,OAAO;AAAA,EACnB,QAAQ;AAAA,EACR,WAAWA,GAAE,OAAO;AAAA,EACpB,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,eAAeA,GAAE,QAAQ;AAAA,EACzB,eAAeA,GAAE,OAAO;AAAA,EACxB,aAAaA,GAAE,OAAO;AAAA,EACtB,QAAQA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,QAAQ,CAAC,CAAC;AAAA,EACtC,UAAUA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,QAAQ,CAAC,CAAC;AAAA,EACxC,UAAUA,GAAE,OAAOA,GAAE,QAAQ,CAAC,EAAE,SAAS;AAC3C,CAAC;AAOM,IAAM,wBAAwBA,GAAE,OAAO;AAAA,EAC5C,SAAS;AAAA,EACT,UAAU,qBAAqB,SAAS;AAAA,EACxC,cAAcA,GAAE,OAAO;AAAA,IACrB,SAASA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,IACjC,aAAaA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,IACrC,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA;AAAA,EAChC,CAAC,EAAE,SAAS;AAAA,EACZ,KAAKA,GAAE,OAAO;AAAA,IACZ,SAASA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,IACjC,gBAAgBA,GAAE,OAAO,EAAE,QAAQ,GAAG;AAAA;AAAA,IACtC,iBAAiBA,GAAE,OAAO,EAAE,QAAQ,GAAI;AAAA,EAC1C,CAAC,EAAE,SAAS;AAAA,EACZ,QAAQA,GAAE,OAAO;AAAA,IACf,iBAAiBA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,IACzC,uBAAuBA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,IAC/C,cAAcA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,IACtC,yBAAyBA,GAAE,OAAO,EAAE,QAAQ,EAAE;AAAA,EAChD,CAAC,EAAE,SAAS;AACd,CAAC;AAOM,IAAM,gBAAgBA,GAAE,OAAO;AAAA,EACpC,YAAY,qBAAqB,SAAS;AAAA,EAC1C,kBAAkB,yBAAyB,SAAS;AAAA,EACpD,qBAAqBA,GAAE,OAAO,EAAE,SAAS;AAAA,EACzC,cAAcA,GAAE,OAAO;AAAA,EACvB,gBAAgBA,GAAE,OAAO;AAAA,EACzB,cAAcA,GAAE,OAAO,EAAE,SAAS;AAAA,EAClC,cAAcA,GAAE,OAAO,EAAE,SAAS;AAAA,EAClC,oBAAoBA,GAAE,OAAO;AAAA,EAC7B,YAAYA,GAAE,QAAQ;AAAA,EACtB,aAAaA,GAAE,OAAO;AACxB,CAAC;AA2BM,IAAM,0BAA0C;AAAA,EACrD,SAAS;AAAA,EACT,MAAM;AAAA;AAAA,EACN,MAAM;AAAA,EACN,eAAe;AAAA,EACf,YAAY;AACd;AAEO,IAAM,mBAAmB;AAAA,EAC9B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;;;ACrRA,SAAS,gBAAAC,sBAAoB;AAC7B,SAAS,cAAAC,mBAAkB;AAiBpB,IAAM,gBAAN,cAA4BC,eAAuB;AAAA,EAChD;AAAA,EACA;AAAA,EACA,UAAuC,oBAAI,IAAI;AAAA,EAC/C,mBAA0C;AAAA,EAC1C,mBAAkC;AAAA;AAAA,EAGlC,gBAA+D,oBAAI,IAAI;AAAA,EAE/E,YAAY,eAA8B,UAAoC;AAC5E,UAAM;AACN,SAAK,gBAAgB;AACrB,SAAK,WAAW,EAAE,GAAG,yBAAyB,GAAG,SAAS;AAAA,EAC5D;AAAA;AAAA;AAAA;AAAA,EAMA,qBAAqB,UAA0B,UAA0C;AACvF,SAAK,cAAc,IAAI,UAAU,QAAQ;AACzC,YAAQ,IAAI,0CAA0C,QAAQ,EAAE;AAAA,EAClE;AAAA,EAEA,uBAAuB,UAAgC;AACrD,SAAK,cAAc,OAAO,QAAQ;AAAA,EACpC;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,aACJ,OAAmB,QACnB,WACyB;AACzB,UAAM,WAAW,UAAU,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,GAAG,CAAC,CAAC;AAC/E,UAAM,oBAAoB,aAAa,CAAC,GAAG,gBAAgB;AAE3D,UAAM,SAAyB;AAAA,MAC7B,IAAI;AAAA,MACJ;AAAA,MACA,QAAQ;AAAA,MACR,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MAClC,WAAW;AAAA,MACX,OAAO,CAAC;AAAA,MACR,iBAAiB,KAAK,mBAAmB,QAAQ;AAAA,MACjD,SAAS;AAAA,IACX;AAGA,QAAI,SAAS,iBAAiB,SAAS,gBAAgB;AACrD,aAAO,iBAAiB,KAAK,oBAAoB;AAAA,IACnD;AAEA,SAAK,QAAQ,IAAI,UAAU,MAAM;AACjC,SAAK,KAAK,kBAAkB,MAAM;AAElC,QAAI;AACF,UAAI,YAAY;AAChB,UAAI,qBAAqB;AAEzB,iBAAW,YAAY,mBAAmB;AACxC,cAAM,WAAW,KAAK,cAAc,IAAI,QAAQ;AAChD,YAAI,CAAC,UAAU;AACb,kBAAQ,IAAI,4BAA4B,QAAQ,YAAY;AAC5D;AAAA,QACF;AAEA,YAAI;AACF,gBAAM,OAAO,MAAM,SAAS;AAC5B,gBAAM,aAAa,KAAK,UAAU,IAAI;AACtC,gBAAM,YAAY,OAAO,WAAW,YAAY,MAAM;AACtD,gBAAM,WAAW,KAAK,kBAAkB,UAAU;AAElD,gBAAM,OAAmB;AAAA,YACvB;AAAA,YACA,MAAM;AAAA,YACN,OAAO,MAAM,QAAQ,IAAI,IAAI,KAAK,SAAS;AAAA,YAC3C;AAAA,YACA;AAAA,UACF;AAEA,iBAAO,MAAM,KAAK,IAAI;AACtB,uBAAa;AAGb,gBAAM,KAAK,eAAe,UAAU,UAAU,UAAU;AAExD;AACA,gBAAM,UAAU,KAAK,MAAO,qBAAqB,kBAAkB,SAAU,GAAG;AAChF,eAAK,KAAK,mBAAmB,QAAQ,OAAO;AAAA,QAC9C,SAAS,KAAK;AACZ,kBAAQ,MAAM,6BAA6B,QAAQ,KAAK,GAAG;AAAA,QAC7D;AAAA,MACF;AAGA,aAAO,YAAY;AACnB,aAAO,WAAW,KAAK,0BAA0B,MAAM;AACvD,aAAO,SAAS;AAChB,aAAO,eAAc,oBAAI,KAAK,GAAE,YAAY;AAE5C,UAAI,SAAS,QAAQ;AACnB,aAAK,mBAAmB;AAAA,MAC1B;AAEA,WAAK,KAAK,oBAAoB,MAAM;AACpC,cAAQ,IAAI,uBAAuB,QAAQ,KAAK,KAAK,YAAY,SAAS,CAAC,GAAG;AAE9E,aAAO;AAAA,IACT,SAAS,OAAO;AACd,aAAO,SAAS;AAChB,aAAO,eAAc,oBAAI,KAAK,GAAE,YAAY;AAC5C,WAAK,KAAK,iBAAiB,QAAQ,iBAAiB,QAAQ,QAAQ,IAAI,MAAM,OAAO,KAAK,CAAC,CAAC;AAC5F,YAAM;AAAA,IACR;AAAA,EACF;AAAA,EAEA,MAAM,eAAe,aAA+C;AAClE,UAAM,WAAW,MAAM,KAAK,aAAa,UAAU;AACnD,aAAS,WAAW,EAAE,GAAG,SAAS,UAAU,YAAY;AACxD,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAMA,UAAU,UAA8C;AACtD,WAAO,KAAK,QAAQ,IAAI,QAAQ;AAAA,EAClC;AAAA,EAEA,YAAY,SAMS;AACnB,QAAI,UAAU,MAAM,KAAK,KAAK,QAAQ,OAAO,CAAC;AAE9C,QAAI,SAAS,MAAM;AACjB,gBAAU,QAAQ,OAAO,OAAK,EAAE,SAAS,QAAQ,IAAI;AAAA,IACvD;AACA,QAAI,SAAS,QAAQ;AACnB,gBAAU,QAAQ,OAAO,OAAK,EAAE,WAAW,QAAQ,MAAM;AAAA,IAC3D;AACA,QAAI,SAAS,UAAU;AACrB,gBAAU,QAAQ,OAAO,OAAK,IAAI,KAAK,EAAE,SAAS,KAAK,QAAQ,QAAS;AAAA,IAC1E;AACA,QAAI,SAAS,QAAQ;AACnB,gBAAU,QAAQ,OAAO,OAAK,IAAI,KAAK,EAAE,SAAS,KAAK,QAAQ,MAAO;AAAA,IACxE;AAGA,YAAQ,KAAK,CAAC,GAAG,MAAM,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,IAAI,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,CAAC;AAExF,QAAI,SAAS,OAAO;AAClB,gBAAU,QAAQ,MAAM,GAAG,QAAQ,KAAK;AAAA,IAC1C;AAEA,WAAO;AAAA,EACT;AAAA,EAEA,gBAAgB,MAA+C;AAC7D,UAAM,UAAU,KAAK,YAAY,EAAE,MAAM,QAAQ,aAAa,OAAO,EAAE,CAAC;AACxE,WAAO,QAAQ,CAAC;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,aAAa,UAAoC;AACrD,UAAM,SAAS,KAAK,QAAQ,IAAI,QAAQ;AACxC,QAAI,CAAC,QAAQ;AACX,aAAO;AAAA,IACT;AAGA,UAAM,mBAAmB,MAAM,KAAK,KAAK,QAAQ,OAAO,CAAC,EACtD,OAAO,OAAK,EAAE,mBAAmB,QAAQ;AAE5C,QAAI,iBAAiB,SAAS,GAAG;AAC/B,YAAM,IAAI,MAAM,wBAAwB,QAAQ,KAAK,iBAAiB,MAAM,uBAAuB;AAAA,IACrG;AAGA,UAAM,KAAK,kBAAkB,QAAQ;AAErC,SAAK,QAAQ,OAAO,QAAQ;AAC5B,YAAQ,IAAI,qBAAqB,QAAQ,EAAE;AAE3C,WAAO;AAAA,EACT;AAAA,EAEA,MAAM,iBAAwE;AAC5E,UAAM,MAAM,KAAK,IAAI;AACrB,UAAM,cAAc,KAAK,SAAS,gBAAgB,KAAK,KAAK,KAAK;AACjE,QAAI,eAAe;AACnB,QAAI,aAAa;AAEjB,UAAM,kBAA4B,CAAC;AAEnC,eAAW,CAAC,IAAI,MAAM,KAAK,KAAK,SAAS;AACvC,YAAM,YAAY,MAAM,IAAI,KAAK,OAAO,SAAS,EAAE,QAAQ;AAC3D,UAAI,YAAY,eAAe,OAAO,WAAW,aAAa;AAE5D,cAAM,WAAW,MAAM,KAAK,KAAK,QAAQ,OAAO,CAAC,EAC9C,KAAK,OAAK,EAAE,mBAAmB,EAAE;AAEpC,YAAI,CAAC,UAAU;AACb,0BAAgB,KAAK,EAAE;AACvB,wBAAc,OAAO;AAAA,QACvB;AAAA,MACF;AAAA,IACF;AAGA,UAAM,mBAAmB,KAAK,YAAY,EAAE,QAAQ,YAAY,CAAC;AACjE,QAAI,iBAAiB,SAAS,KAAK,SAAS,YAAY;AACtD,YAAM,SAAS,iBAAiB,MAAM,KAAK,SAAS,UAAU;AAC9D,iBAAW,UAAU,QAAQ;AAC3B,YAAI,CAAC,gBAAgB,SAAS,OAAO,EAAE,GAAG;AACxC,0BAAgB,KAAK,OAAO,EAAE;AAC9B,wBAAc,OAAO;AAAA,QACvB;AAAA,MACF;AAAA,IACF;AAGA,eAAW,MAAM,iBAAiB;AAChC,UAAI;AACF,cAAM,KAAK,aAAa,EAAE;AAC1B;AAAA,MACF,SAAS,KAAK;AACZ,gBAAQ,MAAM,6BAA6B,EAAE,KAAK,GAAG;AAAA,MACvD;AAAA,IACF;AAEA,QAAI,eAAe,GAAG;AACpB,WAAK,KAAK,qBAAqB,cAAc,UAAU;AACvD,cAAQ,IAAI,6BAA6B,YAAY,mBAAmB,KAAK,YAAY,UAAU,CAAC,EAAE;AAAA,IACxG;AAEA,WAAO,EAAE,cAAc,WAAW;AAAA,EACpC;AAAA;AAAA;AAAA;AAAA,EAMA,iBAAuB;AACrB,QAAI,CAAC,KAAK,SAAS,SAAS;AAC1B,cAAQ,IAAI,6BAA6B;AACzC;AAAA,IACF;AAGA,UAAM,aAAa,KAAK,KAAK,KAAK;AAElC,YAAQ,IAAI,+BAA+B,KAAK,SAAS,IAAI,aAAa,KAAK,SAAS,aAAa,iBAAiB;AAEtH,SAAK,mBAAmB,YAAY,YAAY;AAC9C,UAAI;AACF,cAAM,KAAK,aAAa,KAAK,SAAS,IAAI;AAC1C,cAAM,KAAK,eAAe;AAAA,MAC5B,SAAS,KAAK;AACZ,gBAAQ,MAAM,qCAAqC,GAAG;AAAA,MACxD;AAAA,IACF,GAAG,UAAU;AAAA,EACf;AAAA,EAEA,gBAAsB;AACpB,QAAI,KAAK,kBAAkB;AACzB,oBAAc,KAAK,gBAAgB;AACnC,WAAK,mBAAmB;AACxB,cAAQ,IAAI,4BAA4B;AAAA,IAC1C;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMQ,mBAAmB,UAA0B;AACnD,UAAM,EAAE,MAAM,QAAQ,MAAAC,MAAK,IAAI,KAAK;AACpC,YAAQ,MAAM;AAAA,MACZ,KAAK;AACH,eAAO,QAAQ,MAAM,GAAGA,KAAI,IAAI,QAAQ;AAAA,MAC1C,KAAK;AACH,eAAO,QAAQ,MAAM,GAAGA,KAAI,IAAI,QAAQ;AAAA,MAC1C,KAAK;AACH,eAAO,WAAW,MAAM,GAAGA,KAAI,IAAI,QAAQ;AAAA,MAC7C,KAAK;AACH,eAAO,QAAQ,MAAM,GAAGA,KAAI,IAAI,QAAQ;AAAA,MAC1C;AACE,eAAO,GAAGA,KAAI,IAAI,QAAQ;AAAA,IAC9B;AAAA,EACF;AAAA,EAEA,MAAc,eAAe,UAAkB,UAAkB,MAA6B;AAG5F,UAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,EAAE,CAAC;AAAA,EACtD;AAAA,EAEA,MAAc,kBAAkB,UAAiC;AAE/D,UAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,EAAE,CAAC;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA,EAMQ,kBAAkB,MAAsB;AAC9C,WAAOC,YAAW,QAAQ,EAAE,OAAO,IAAI,EAAE,OAAO,KAAK,EAAE,MAAM,GAAG,EAAE;AAAA,EACpE;AAAA,EAEQ,0BAA0B,UAAkC;AAClE,UAAM,gBAAgB,SAAS,MAAM,IAAI,OAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,KAAK,EAAE;AACxE,WAAO,KAAK,kBAAkB,aAAa;AAAA,EAC7C;AAAA,EAEQ,YAAY,OAAuB;AACzC,QAAI,QAAQ,KAAM,QAAO,GAAG,KAAK;AACjC,QAAI,QAAQ,OAAO,KAAM,QAAO,IAAI,QAAQ,MAAM,QAAQ,CAAC,CAAC;AAC5D,QAAI,QAAQ,OAAO,OAAO,KAAM,QAAO,IAAI,QAAQ,OAAO,MAAM,QAAQ,CAAC,CAAC;AAC1E,WAAO,IAAI,QAAQ,OAAO,OAAO,MAAM,QAAQ,CAAC,CAAC;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA,EAMA,WAOE;AACA,UAAM,UAAU,MAAM,KAAK,KAAK,QAAQ,OAAO,CAAC;AAChD,UAAM,mBAAmB,QAAQ,OAAO,OAAK,EAAE,WAAW,WAAW;AAErE,UAAM,SAAiC,CAAC;AACxC,UAAM,WAAmC,CAAC;AAE1C,eAAW,UAAU,SAAS;AAC5B,aAAO,OAAO,IAAI,KAAK,OAAO,OAAO,IAAI,KAAK,KAAK;AACnD,eAAS,OAAO,MAAM,KAAK,SAAS,OAAO,MAAM,KAAK,KAAK;AAAA,IAC7D;AAEA,UAAM,QAAQ,iBAAiB,IAAI,OAAK,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,CAAC;AAEvE,WAAO;AAAA,MACL,cAAc,QAAQ;AAAA,MACtB,gBAAgB,iBAAiB,OAAO,CAAC,KAAK,MAAM,MAAM,EAAE,WAAW,CAAC;AAAA,MACxE,cAAc,MAAM,SAAS,IAAI,IAAI,KAAK,KAAK,IAAI,GAAG,KAAK,CAAC,EAAE,YAAY,IAAI;AAAA,MAC9E,cAAc,MAAM,SAAS,IAAI,IAAI,KAAK,KAAK,IAAI,GAAG,KAAK,CAAC,EAAE,YAAY,IAAI;AAAA,MAC9E,eAAe;AAAA,MACf,iBAAiB;AAAA,IACnB;AAAA,EACF;AACF;AAMA,IAAI,wBAA8C;AAE3C,SAAS,mBAAyC;AACvD,SAAO;AACT;AAEO,SAAS,oBACd,eACA,UACe;AACf,0BAAwB,IAAI,cAAc,eAAe,QAAQ;AACjE,SAAO;AACT;;;ACpZA,SAAS,gBAAAC,sBAAoB;AAetB,IAAM,iBAAN,cAA6BC,eAAuB;AAAA,EACjD;AAAA,EACA,iBAA+C,oBAAI,IAAI;AAAA,EACvD,iBAAyC;AAAA;AAAA,EAGzC,eAAwE,oBAAI,IAAI;AAAA,EAExF,YAAY,eAA8B;AACxC,UAAM;AACN,SAAK,gBAAgB;AAAA,EACvB;AAAA;AAAA;AAAA;AAAA,EAMA,oBAAoB,UAA0B,SAAmD;AAC/F,SAAK,aAAa,IAAI,UAAU,OAAO;AACvC,YAAQ,IAAI,0CAA0C,QAAQ,EAAE;AAAA,EAClE;AAAA,EAEA,sBAAsB,UAAgC;AACpD,SAAK,aAAa,OAAO,QAAQ;AAAA,EACnC;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,QAAQ,SAAmD;AAC/D,QAAI,KAAK,kBAAkB,KAAK,eAAe,WAAW,eAAe;AACvE,YAAM,IAAI,MAAM,4CAA4C;AAAA,IAC9D;AAEA,UAAM,SAAS,KAAK,cAAc,UAAU,QAAQ,cAAc;AAClE,QAAI,CAAC,QAAQ;AACX,YAAM,IAAI,MAAM,qBAAqB,QAAQ,cAAc,EAAE;AAAA,IAC/D;AAEA,QAAI,OAAO,WAAW,aAAa;AACjC,YAAM,IAAI,MAAM,2CAA2C,OAAO,MAAM,EAAE;AAAA,IAC5E;AAEA,UAAM,YAAY,WAAW,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,GAAG,CAAC,CAAC;AAEjF,UAAM,WAA4B;AAAA,MAChC,IAAI;AAAA,MACJ,QAAQ;AAAA,MACR,UAAU,QAAQ;AAAA,MAClB,MAAM,QAAQ;AAAA,MACd,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MAClC,YAAY,OAAO,MAAM;AAAA,MACzB,gBAAgB;AAAA,MAChB,aAAa;AAAA,MACb,QAAQ,CAAC;AAAA,IACX;AAEA,SAAK,iBAAiB;AACtB,SAAK,eAAe,IAAI,WAAW,QAAQ;AAG3C,QAAI,QAAQ,gBAAgB;AAC1B,UAAI;AACF,iBAAS,SAAS;AAClB,cAAM,WAAW,MAAM,KAAK,cAAc,eAAe,sBAAsB;AAC/E,iBAAS,aAAa,SAAS;AAC/B,gBAAQ,IAAI,2CAA2C,SAAS,EAAE,EAAE;AAAA,MACtE,SAAS,KAAK;AACZ,gBAAQ,KAAK,oDAAoD,GAAG;AAAA,MACtE;AAAA,IACF;AAGA,QAAI,QAAQ,QAAQ;AAClB,eAAS,SAAS;AAClB,eAAS,eAAc,oBAAI,KAAK,GAAE,YAAY;AAC9C,cAAQ,IAAI,0CAA0C,QAAQ,cAAc,EAAE;AAC9E,aAAO;AAAA,IACT;AAEA,SAAK,KAAK,mBAAmB,QAAQ;AAErC,QAAI;AACF,eAAS,SAAS;AAGlB,YAAM,qBAAqB,QAAQ,SAAS,eAAe,QAAQ,YAC/D,QAAQ,YACR,OAAO,MAAM,IAAI,UAAQ,KAAK,QAA0B;AAE5D,iBAAW,YAAY,oBAAoB;AACzC,cAAM,aAAa,OAAO,MAAM,KAAK,UAAQ,KAAK,aAAa,QAAQ;AACvE,YAAI,CAAC,YAAY;AACf,kBAAQ,KAAK,2CAA2C,QAAQ,EAAE;AAClE;AAAA,QACF;AAEA,cAAM,UAAU,KAAK,aAAa,IAAI,QAAQ;AAC9C,YAAI,CAAC,SAAS;AACZ,kBAAQ,KAAK,sCAAsC,QAAQ,EAAE;AAC7D,mBAAS;AACT,mBAAS,OAAO,KAAK,4BAA4B,QAAQ,EAAE;AAC3D;AAAA,QACF;AAEA,iBAAS,kBAAkB;AAC3B,aAAK,KAAK,oBAAoB,QAAQ;AAEtC,YAAI;AAGF,gBAAM,OAAO,MAAM,KAAK,gBAAgB,OAAO,IAAI,QAAQ;AAC3D,gBAAM,QAAQ,IAAI;AAElB,mBAAS;AACT,kBAAQ,IAAI,sBAAsB,QAAQ,KAAK,WAAW,KAAK,SAAS;AAAA,QAC1E,SAAS,KAAK;AACZ,mBAAS;AACT,gBAAM,WAAW,eAAe,QAAQ,IAAI,UAAU,OAAO,GAAG;AAChE,mBAAS,OAAO,KAAK,qBAAqB,QAAQ,KAAK,QAAQ,EAAE;AACjE,kBAAQ,MAAM,+BAA+B,QAAQ,KAAK,GAAG;AAAA,QAC/D;AAAA,MACF;AAEA,eAAS,SAAS,SAAS,gBAAgB,IAAI,cAAc;AAC7D,eAAS,eAAc,oBAAI,KAAK,GAAE,YAAY;AAC9C,eAAS,kBAAkB;AAE3B,WAAK,KAAK,qBAAqB,QAAQ;AACvC,cAAQ,IAAI,wBAAwB,SAAS,cAAc,IAAI,SAAS,UAAU,iBAAiB;AAEnG,aAAO;AAAA,IACT,SAAS,OAAO;AACd,eAAS,SAAS;AAClB,eAAS,eAAc,oBAAI,KAAK,GAAE,YAAY;AAC9C,eAAS,OAAO,KAAK,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK,CAAC;AAE3E,WAAK,KAAK,kBAAkB,UAAU,iBAAiB,QAAQ,QAAQ,IAAI,MAAM,OAAO,KAAK,CAAC,CAAC;AAG/F,UAAI,SAAS,YAAY;AACvB,gBAAQ,IAAI,6CAA6C,SAAS,UAAU,EAAE;AAE9E,iBAAS,SAAS;AAAA,MACpB;AAEA,YAAM;AAAA,IACR,UAAE;AACA,WAAK,iBAAiB;AAAA,IACxB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,mBAAmB,WAAgD;AACjE,WAAO,KAAK,eAAe,IAAI,SAAS;AAAA,EAC1C;AAAA,EAEA,oBAA4C;AAC1C,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,aAAa,QAAgB,IAAuB;AAClD,WAAO,MAAM,KAAK,KAAK,eAAe,OAAO,CAAC,EAC3C,KAAK,CAAC,GAAG,MAAM,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,IAAI,IAAI,KAAK,EAAE,SAAS,EAAE,QAAQ,CAAC,EAChF,MAAM,GAAG,KAAK;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,qBAAqB,YAA4C;AAErE,UAAM,UAAU,KAAK,cAAc,YAAY,EAAE,QAAQ,YAAY,CAAC;AACtE,UAAM,kBAAkB,QAAQ,OAAO,OAAK,IAAI,KAAK,EAAE,SAAS,KAAK,UAAU;AAE/E,QAAI,gBAAgB,WAAW,GAAG;AAChC,YAAM,IAAI,MAAM,2BAA2B,WAAW,YAAY,CAAC,EAAE;AAAA,IACvE;AAEA,UAAM,eAAe,gBAAgB,CAAC;AAEtC,YAAQ,IAAI,uCAAuC,WAAW,YAAY,CAAC,EAAE;AAC7E,YAAQ,IAAI,0BAA0B,aAAa,EAAE,SAAS,aAAa,SAAS,EAAE;AAEtF,WAAO,KAAK,QAAQ;AAAA,MAClB,MAAM;AAAA,MACN,gBAAgB,aAAa;AAAA,MAC7B,aAAa,WAAW,YAAY;AAAA,MACpC,gBAAgB;AAAA,IAClB,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAMA,MAAc,gBAAgB,UAAkB,UAAsC;AAGpF,UAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,EAAE,CAAC;AACpD,WAAO,CAAC;AAAA,EACV;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,eAAe,UAIlB;AACD,UAAM,SAAS,KAAK,cAAc,UAAU,QAAQ;AACpD,QAAI,CAAC,QAAQ;AACX,aAAO;AAAA,QACL,OAAO;AAAA,QACP,QAAQ,CAAC,qBAAqB,QAAQ,EAAE;AAAA,QACxC,UAAU,CAAC;AAAA,MACb;AAAA,IACF;AAEA,UAAM,SAAmB,CAAC;AAC1B,UAAM,WAAqB,CAAC;AAG5B,QAAI,OAAO,WAAW,aAAa;AACjC,aAAO,KAAK,oBAAoB,OAAO,MAAM,iBAAiB;AAAA,IAChE;AAGA,QAAI,OAAO,MAAM,WAAW,GAAG;AAC7B,eAAS,KAAK,0BAA0B;AAAA,IAC1C;AAGA,eAAW,QAAQ,OAAO,OAAO;AAC/B,UAAI,CAAC,KAAK,aAAa,IAAI,KAAK,QAA0B,GAAG;AAC3D,iBAAS,KAAK,uCAAuC,KAAK,QAAQ,EAAE;AAAA,MACtE;AAAA,IACF;AAGA,QAAI,OAAO,gBAAgB;AACzB,YAAM,SAAS,KAAK,cAAc,UAAU,OAAO,cAAc;AACjE,UAAI,CAAC,QAAQ;AACX,eAAO,KAAK,4BAA4B,OAAO,cAAc,EAAE;AAAA,MACjE,WAAW,OAAO,WAAW,aAAa;AACxC,eAAO,KAAK,2BAA2B,OAAO,MAAM,EAAE;AAAA,MACxD;AAAA,IACF;AAEA,WAAO;AAAA,MACL,OAAO,OAAO,WAAW;AAAA,MACzB;AAAA,MACA;AAAA,IACF;AAAA,EACF;AACF;AAMA,IAAI,yBAAgD;AAE7C,SAAS,oBAA2C;AACzD,SAAO;AACT;AAEO,SAAS,qBAAqB,eAA+C;AAClF,QAAM,MAAM,iBAAiB,iBAAiB;AAC9C,MAAI,CAAC,KAAK;AACR,UAAM,IAAI,MAAM,qCAAqC;AAAA,EACvD;AACA,2BAAyB,IAAI,eAAe,GAAG;AAC/C,SAAO;AACT;;;ACxSA,SAAS,KAAAC,UAAS;AAMX,IAAM,qBAAqBA,GAAE,OAAO;AAAA,EACzC,SAASA,GAAE,OAAO,EAAE,SAAS,sCAAsC;AAAA,EACnE,QAAQA,GAAE,OAAO,EAAE,SAAS,yBAAyB;AAAA,EACrD,cAAcA,GAAE,OAAO,EAAE,SAAS,EAAE,SAAS,wBAAwB;AAAA,EACrE,YAAYA,GAAE,OAAO,EAAE,QAAQ,CAAC,EAAE,SAAS,yBAAyB;AAAA,EACpE,YAAYA,GAAE,OAAO,EAAE,SAAS,EAAE,SAAS,6BAA6B;AAC1E,CAAC;AAOM,IAAM,uBAAuBA,GAAE,KAAK;AAAA,EACzC;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,mBAAmBA,GAAE,OAAO;AAAA,EACvC,MAAM;AAAA,EACN,SAASA,GAAE,OAAO,EAAE,SAAS;AAC/B,CAAC;AAOM,IAAM,iBAAiBA,GAAE,KAAK;AAAA,EACnC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAOM,IAAM,kBAAkBA,GAAE,OAAO;AAAA,EACtC,MAAMA,GAAE,OAAO;AAAA,EACf,WAAWA,GAAE,OAAO;AAAA,EACpB,YAAYA,GAAE,OAAOA,GAAE,MAAM,CAACA,GAAE,OAAO,GAAGA,GAAE,OAAO,GAAGA,GAAE,QAAQ,CAAC,CAAC,CAAC,EAAE,SAAS;AAChF,CAAC;AAOM,IAAM,iBAAiBA,GAAE,OAAO;AAAA,EACrC,SAASA,GAAE,OAAO;AAAA,EAClB,QAAQA,GAAE,OAAO;AAAA,EACjB,YAAYA,GAAE,OAAOA,GAAE,MAAM,CAACA,GAAE,OAAO,GAAGA,GAAE,OAAO,GAAGA,GAAE,QAAQ,CAAC,CAAC,CAAC,EAAE,SAAS;AAChF,CAAC;AAOM,IAAM,aAAaA,GAAE,OAAO;AAAA,EACjC,SAASA,GAAE,OAAO;AAAA,EAClB,QAAQA,GAAE,OAAO;AAAA,EACjB,cAAcA,GAAE,OAAO,EAAE,SAAS;AAAA,EAClC,MAAMA,GAAE,OAAO;AAAA,EACf,MAAM,eAAe,QAAQ,UAAU;AAAA,EACvC,WAAWA,GAAE,OAAO;AAAA,EACpB,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,UAAUA,GAAE,OAAO,EAAE,SAAS,EAAE,SAAS,gBAAgB;AAAA,EACzD,QAAQ,iBAAiB,QAAQ,EAAE,MAAM,QAAQ,CAAC;AAAA,EAClD,YAAYA,GAAE,OAAOA,GAAE,MAAM,CAACA,GAAE,OAAO,GAAGA,GAAE,OAAO,GAAGA,GAAE,QAAQ,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;AAAA,EAC/E,QAAQA,GAAE,MAAM,eAAe,EAAE,QAAQ,CAAC,CAAC;AAAA,EAC3C,OAAOA,GAAE,MAAM,cAAc,EAAE,QAAQ,CAAC,CAAC;AAAA,EACzC,UAAUA,GAAE,OAAO;AAAA,IACjB,aAAaA,GAAE,OAAO;AAAA,IACtB,gBAAgBA,GAAE,OAAO,EAAE,SAAS;AAAA,IACpC,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,IACjC,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA,IAC9B,YAAYA,GAAE,OAAO,EAAE,SAAS;AAAA,EAClC,CAAC;AACH,CAAC;AAOM,IAAM,cAAcA,GAAE,OAAO;AAAA,EAClC,SAASA,GAAE,OAAO;AAAA,EAClB,UAAU;AAAA,EACV,OAAOA,GAAE,MAAM,UAAU;AAAA,EACzB,WAAWA,GAAE,OAAO;AAAA,EACpB,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC9B,WAAWA,GAAE,OAAO;AAAA,EACpB,YAAYA,GAAE,OAAO,EAAE,QAAQ,CAAC;AAAA,EAChC,aAAaA,GAAE,OAAO;AAAA,EACtB,eAAeA,GAAE,OAAO;AAC1B,CAAC;AAOM,IAAM,mBAAmBA,GAAE,KAAK;AAAA,EACrC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,mBAAmBA,GAAE,KAAK;AAAA,EACrC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAOM,IAAM,oBAAoBA,GAAE,OAAO;AAAA,EACxC,WAAWA,GAAE,OAAO;AAAA,EACpB,OAAOA,GAAE,OAAO;AAAA,EAChB,QAAQA,GAAE,OAAOA,GAAE,OAAO,CAAC,EAAE,QAAQ,CAAC,CAAC;AACzC,CAAC;AAOM,IAAM,yBAAyBA,GAAE,OAAO;AAAA,EAC7C,YAAYA,GAAE,MAAMA,GAAE,OAAO,CAAC;AAAA,EAC9B,QAAQA,GAAE,MAAMA,GAAE,OAAO,CAAC;AAAA,EAC1B,KAAKA,GAAE,OAAO;AAAA,EACd,OAAOA,GAAE,OAAO;AAAA,EAChB,KAAKA,GAAE,OAAO,EAAE,SAAS;AAAA,EACzB,KAAKA,GAAE,OAAO,EAAE,SAAS;AAC3B,CAAC;AAOM,IAAM,yBAAyBA,GAAE,OAAO;AAAA,EAC7C,MAAMA,GAAE,OAAO;AAAA,EACf,MAAM;AAAA,EACN,MAAM,iBAAiB,QAAQ,MAAM;AAAA,EACrC,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,QAAQA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,QAAQ,CAAC,CAAC;AAAA,EACtC,SAASA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,SAAS,EAAE,SAAS,gBAAgB;AACnE,CAAC;AAOM,IAAM,mBAAmBA,GAAE,OAAO;AAAA,EACvC,MAAMA,GAAE,OAAO;AAAA,EACf,MAAM;AAAA,EACN,MAAM;AAAA,EACN,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,QAAQA,GAAE,MAAM,iBAAiB;AAAA,EACjC,WAAW,uBAAuB,SAAS;AAAA,EAC3C,UAAUA,GAAE,OAAO;AAAA,IACjB,aAAaA,GAAE,OAAO;AAAA,IACtB,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACnC,CAAC;AACH,CAAC;AAOM,IAAM,oBAAoBA,GAAE,KAAK;AAAA,EACtC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAOM,IAAM,kBAAkBA,GAAE,OAAO;AAAA,EACtC,WAAWA,GAAE,OAAO;AAAA,EACpB,UAAU;AAAA,EACV,MAAMA,GAAE,OAAO;AAAA,EACf,YAAYA,GAAE,OAAOA,GAAE,MAAM,CAACA,GAAE,OAAO,GAAGA,GAAE,OAAO,GAAGA,GAAE,QAAQ,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;AAAA,EAC/E,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,QAAQA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,UAAUA,GAAE,OAAO;AAAA,IACjB,aAAaA,GAAE,OAAO;AAAA,IACtB,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACnC,CAAC;AACH,CAAC;AAOM,IAAM,qBAAqBA,GAAE,KAAK;AAAA,EACvC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,uBAAuBA,GAAE,OAAO;AAAA,EAC3C,MAAM;AAAA,EACN,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC9B,SAASA,GAAE,OAAOA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,EACvC,aAAaA,GAAE,KAAK,CAAC,QAAQ,MAAM,CAAC,EAAE,QAAQ,MAAM;AAAA,EACpD,SAASA,GAAE,OAAO,EAAE,QAAQ,GAAK;AAAA,EACjC,WAAWA,GAAE,OAAO,EAAE,QAAQ,GAAG;AAAA,EACjC,eAAeA,GAAE,OAAO,EAAE,QAAQ,GAAI;AACxC,CAAC;AAOM,IAAM,oBAAoBA,GAAE,KAAK;AAAA,EACtC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAC;AAGM,IAAM,sBAAsBA,GAAE,OAAO;AAAA,EAC1C,MAAM,kBAAkB,QAAQ,WAAW;AAAA,EAC3C,OAAOA,GAAE,OAAO,EAAE,IAAI,CAAC,EAAE,IAAI,CAAC,EAAE,QAAQ,CAAC;AAAA,EACzC,aAAaA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AACvC,CAAC;AAOM,IAAM,4BAA4BA,GAAE,OAAO;AAAA,EAChD,aAAaA,GAAE,OAAO,EAAE,QAAQ,iBAAiB;AAAA,EACjD,gBAAgBA,GAAE,OAAO,EAAE,SAAS;AAAA,EACpC,aAAaA,GAAE,OAAO,EAAE,QAAQ,aAAa;AAAA;AAAA,EAG7C,SAASA,GAAE,OAAO;AAAA,IAChB,SAASA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,IACjC,SAAS,oBAAoB,QAAQ,CAAC,CAAC;AAAA,IACvC,UAAU,qBAAqB,SAAS;AAAA,IACxC,mBAAmBA,GAAE,OAAO,EAAE,QAAQ,GAAG;AAAA,IACzC,eAAeA,GAAE,OAAO,EAAE,QAAQ,GAAG;AAAA,IACrC,cAAcA,GAAE,OAAO,EAAE,QAAQ,GAAG;AAAA,EACtC,CAAC,EAAE,QAAQ,CAAC,CAAC;AAAA;AAAA,EAGb,SAASA,GAAE,OAAO;AAAA,IAChB,SAASA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,IACjC,UAAU,qBAAqB,SAAS;AAAA,IACxC,iBAAiBA,GAAE,OAAO,EAAE,QAAQ,GAAK;AAAA,IACzC,gBAAgBA,GAAE,MAAMA,GAAE,OAAO,CAAC,EAAE,QAAQ,CAAC,GAAG,IAAI,IAAI,IAAI,KAAK,KAAK,KAAK,KAAM,MAAM,KAAM,GAAK,CAAC;AAAA,EACrG,CAAC,EAAE,QAAQ,CAAC,CAAC;AAAA;AAAA,EAGb,SAASA,GAAE,OAAO;AAAA,IAChB,SAASA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,IACjC,aAAa,kBAAkB,QAAQ,MAAM;AAAA,IAC7C,UAAU,qBAAqB,SAAS;AAAA,IACxC,qBAAqBA,GAAE,QAAQ,EAAE,QAAQ,IAAI;AAAA,EAC/C,CAAC,EAAE,QAAQ,CAAC,CAAC;AAAA;AAAA,EAGb,UAAUA,GAAE,OAAO;AAAA,IACjB,UAAUA,GAAE,OAAO,EAAE,SAAS;AAAA,IAC9B,YAAYA,GAAE,OAAO,EAAE,SAAS;AAAA,IAChC,YAAYA,GAAE,OAAOA,GAAE,OAAO,CAAC,EAAE,QAAQ,CAAC,CAAC;AAAA,EAC7C,CAAC,EAAE,QAAQ,CAAC,CAAC;AAAA;AAAA,EAGb,WAAWA,GAAE,OAAO;AAAA,IAClB,QAAQA,GAAE,OAAO,EAAE,QAAQ,KAAK,KAAK,KAAK,GAAI;AAAA;AAAA,IAC9C,SAASA,GAAE,OAAO,EAAE,QAAQ,IAAI,KAAK,KAAK,KAAK,GAAI;AAAA;AAAA,IACnD,MAAMA,GAAE,OAAO,EAAE,QAAQ,KAAK,KAAK,KAAK,GAAI;AAAA;AAAA,EAC9C,CAAC,EAAE,QAAQ,CAAC,CAAC;AACf,CAAC;AAOM,IAAM,mBAAmBA,GAAE,OAAO;AAAA,EACvC,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,eAAeA,GAAE,OAAO,EAAE,SAAS;AAAA,EACnC,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,MAAMA,GAAE,OAAOA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,EACpC,WAAWA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC/B,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,OAAOA,GAAE,OAAO,EAAE,QAAQ,GAAG;AAC/B,CAAC;AAGM,IAAM,oBAAoBA,GAAE,OAAO;AAAA,EACxC,MAAMA,GAAE,OAAO;AAAA,EACf,QAAQA,GAAE,OAAOA,GAAE,OAAO,CAAC,EAAE,SAAS;AAAA,EACtC,WAAWA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC/B,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,MAAMA,GAAE,OAAO,EAAE,SAAS,EAAE,SAAS,wBAAwB;AAAA,EAC7D,aAAaA,GAAE,KAAK,CAAC,OAAO,OAAO,OAAO,OAAO,SAAS,MAAM,CAAC,EAAE,SAAS;AAC9E,CAAC;AAGM,IAAM,iBAAiBA,GAAE,OAAO;AAAA,EACrC,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,QAAQA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,aAAaA,GAAE,OAAO,EAAE,SAAS;AAAA,EACjC,UAAU,kBAAkB,SAAS;AAAA,EACrC,cAAcA,GAAE,OAAO,EAAE,SAAS;AAAA,EAClC,WAAWA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC/B,SAASA,GAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,OAAOA,GAAE,OAAO,EAAE,QAAQ,GAAG;AAC/B,CAAC;AAOM,IAAM,qBAAqBA,GAAE,OAAO;AAAA,EACzC,aAAaA,GAAE,OAAO;AAAA,EACtB,YAAYA,GAAE,OAAO;AAAA,EACrB,WAAWA,GAAE,OAAO;AAAA,EACpB,aAAaA,GAAE,OAAO;AAAA,EACtB,aAAaA,GAAE,OAAO;AAAA,EACtB,aAAaA,GAAE,OAAO;AAAA,EACtB,aAAaA,GAAE,OAAO;AAAA,EACtB,aAAaA,GAAE,MAAMA,GAAE,OAAO;AAAA,IAC5B,MAAMA,GAAE,OAAO;AAAA,IACf,YAAYA,GAAE,OAAO;AAAA,IACrB,aAAaA,GAAE,OAAO;AAAA,EACxB,CAAC,CAAC;AAAA,EACF,eAAeA,GAAE,MAAMA,GAAE,OAAO;AAAA,IAC9B,MAAMA,GAAE,OAAO;AAAA,IACf,YAAYA,GAAE,OAAO;AAAA,IACrB,aAAaA,GAAE,OAAO;AAAA,IACtB,WAAWA,GAAE,OAAO;AAAA,EACtB,CAAC,CAAC;AACJ,CAAC;AAGM,IAAM,uBAAuBA,GAAE,OAAO;AAAA,EAC3C,cAAcA,GAAE,OAAO;AAAA,EACvB,aAAaA,GAAE,OAAO;AAAA,EACtB,eAAeA,GAAE,OAAOA,GAAE,OAAO,CAAC;AAAA,EAClC,YAAYA,GAAE,MAAMA,GAAE,OAAO;AAAA,IAC3B,MAAMA,GAAE,OAAO;AAAA,IACf,MAAM;AAAA,IACN,YAAYA,GAAE,OAAO;AAAA,IACrB,WAAWA,GAAE,OAAO;AAAA,EACtB,CAAC,CAAC;AACJ,CAAC;AAGM,IAAM,6BAA6BA,GAAE,OAAO;AAAA,EACjD,QAAQ;AAAA,EACR,SAAS;AAAA,EACT,QAAQA,GAAE,OAAO;AAAA,EACjB,aAAaA,GAAE,OAAO;AACxB,CAAC;AAkCM,IAAM,kBAAsC;AAAA;AAAA,EAEjD;AAAA,IACE,MAAM;AAAA,IACN,MAAM;AAAA,IACN,MAAM;AAAA,IACN,aAAa;AAAA,IACb,QAAQ,CAAC,UAAU,QAAQ,QAAQ;AAAA,EACrC;AAAA,EACA;AAAA,IACE,MAAM;AAAA,IACN,MAAM;AAAA,IACN,MAAM;AAAA,IACN,aAAa;AAAA,IACb,QAAQ,CAAC,UAAU,MAAM;AAAA,IACzB,SAAS,CAAC,GAAG,IAAI,IAAI,IAAI,KAAK,KAAK,KAAK,KAAM,MAAM,GAAI;AAAA,EAC1D;AAAA,EACA;AAAA,IACE,MAAM;AAAA,IACN,MAAM;AAAA,IACN,MAAM;AAAA,IACN,aAAa;AAAA,IACb,QAAQ,CAAC,UAAU,MAAM;AAAA,IACzB,SAAS,CAAC,KAAK,KAAM,KAAO,KAAQ,GAAO;AAAA,EAC7C;AAAA,EACA;AAAA,IACE,MAAM;AAAA,IACN,MAAM;AAAA,IACN,MAAM;AAAA,IACN,aAAa;AAAA,IACb,QAAQ,CAAC,UAAU,MAAM;AAAA,IACzB,SAAS,CAAC,KAAK,KAAM,KAAO,KAAQ,GAAO;AAAA,EAC7C;AAAA;AAAA,EAGA;AAAA,IACE,MAAM;AAAA,IACN,MAAM;AAAA,IACN,MAAM;AAAA,IACN,aAAa;AAAA,IACb,QAAQ,CAAC,YAAY,QAAQ;AAAA,EAC/B;AAAA,EACA;AAAA,IACE,MAAM;AAAA,IACN,MAAM;AAAA,IACN,MAAM;AAAA,IACN,aAAa;AAAA,IACb,QAAQ,CAAC,UAAU;AAAA,IACnB,SAAS,CAAC,KAAK,KAAK,KAAM,KAAM,KAAO,KAAO,KAAO,GAAM;AAAA,EAC7D;AAAA,EACA;AAAA,IACE,MAAM;AAAA,IACN,MAAM;AAAA,IACN,MAAM;AAAA,IACN,aAAa;AAAA,IACb,QAAQ,CAAC,YAAY,QAAQ,QAAQ;AAAA,EACvC;AAAA;AAAA,EAGA;AAAA,IACE,MAAM;AAAA,IACN,MAAM;AAAA,IACN,MAAM;AAAA,IACN,aAAa;AAAA,IACb,QAAQ,CAAC,SAAS,QAAQ;AAAA,EAC5B;AAAA,EACA;AAAA,IACE,MAAM;AAAA,IACN,MAAM;AAAA,IACN,MAAM;AAAA,IACN,aAAa;AAAA,IACb,QAAQ,CAAC,OAAO;AAAA,EAClB;AAAA,EACA;AAAA,IACE,MAAM;AAAA,IACN,MAAM;AAAA,IACN,MAAM;AAAA,IACN,aAAa;AAAA,IACb,QAAQ,CAAC,OAAO;AAAA,IAChB,SAAS,CAAC,KAAK,KAAK,KAAM,KAAM,KAAO,GAAK;AAAA,EAC9C;AAAA;AAAA,EAGA;AAAA,IACE,MAAM;AAAA,IACN,MAAM;AAAA,IACN,MAAM;AAAA,IACN,aAAa;AAAA,IACb,QAAQ,CAAC,MAAM;AAAA,EACjB;AAAA,EACA;AAAA,IACE,MAAM;AAAA,IACN,MAAM;AAAA,IACN,MAAM;AAAA,IACN,aAAa;AAAA,IACb,QAAQ,CAAC;AAAA,EACX;AAAA,EACA;AAAA,IACE,MAAM;AAAA,IACN,MAAM;AAAA,IACN,MAAM;AAAA,IACN,aAAa;AAAA,IACb,QAAQ,CAAC,MAAM;AAAA,EACjB;AACF;AAMO,IAAM,kBAAkB;AAAA;AAAA,EAE7B,aAAa;AAAA,EACb,UAAU;AAAA,EACV,aAAa;AAAA,EACb,WAAW;AAAA,EACX,aAAa;AAAA,EACb,kBAAkB;AAAA,EAClB,6BAA6B;AAAA,EAC7B,8BAA8B;AAAA,EAC9B,iBAAiB;AAAA;AAAA,EAGjB,WAAW;AAAA,EACX,sBAAsB;AAAA,EACtB,SAAS;AAAA,EACT,SAAS;AAAA,EACT,cAAc;AAAA,EACd,cAAc;AAAA;AAAA,EAGd,aAAa;AAAA,EACb,eAAe;AAAA,EACf,eAAe;AAAA,EACf,iBAAiB;AAAA;AAAA,EAGjB,YAAY;AAAA,EACZ,cAAc;AAAA,EACd,gBAAgB;AAAA;AAAA,EAGhB,YAAY;AAAA,EACZ,eAAe;AAAA,EACf,aAAa;AAAA;AAAA,EAGb,QAAQ;AAAA,EACR,SAAS;AAAA,EACT,YAAY;AACd;;;AC3kBA,SAAS,gBAAAC,sBAAoB;AAC7B,SAAS,cAAAC,mBAAkB;AAmBpB,IAAM,cAAN,MAAkB;AAAA,EACf;AAAA,EACA;AAAA,EAER,YAAY,QAAgB,MAAc,UAAuB,CAAC,GAAG;AACnE,UAAM,MAAM,KAAK,IAAI;AACrB,UAAM,UAAU,QAAQ,SAAS,WAAW,gBAAgB;AAC5D,UAAM,SAAS,eAAe;AAE9B,SAAK,SAAS;AACd,SAAK,OAAO;AAAA,MACV;AAAA,MACA;AAAA,MACA,cAAc,QAAQ,SAAS,UAAU,QAAQ;AAAA,MACjD;AAAA,MACA,MAAM,QAAQ,QAAQ;AAAA,MACtB,WAAW,QAAQ,aAAa;AAAA,MAChC,QAAQ,EAAE,MAAM,QAAQ;AAAA,MACxB,YAAY,EAAE,GAAG,QAAQ,WAAW;AAAA,MACpC,QAAQ,CAAC;AAAA,MACT,OAAO,QAAQ,SAAS,CAAC;AAAA,MACzB,UAAU,OAAO,YAAY;AAAA,IAC/B;AAAA,EACF;AAAA,EAEA,aAAa,KAAa,OAAwC;AAChE,SAAK,KAAK,WAAY,GAAG,IAAI;AAC7B,WAAO;AAAA,EACT;AAAA,EAEA,cAAc,OAAwD;AACpE,WAAO,OAAO,KAAK,KAAK,YAAa,KAAK;AAC1C,WAAO;AAAA,EACT;AAAA,EAEA,SAAS,MAAc,YAA8D;AACnF,SAAK,KAAK,OAAQ,KAAK;AAAA,MACrB;AAAA,MACA,WAAW,KAAK,IAAI;AAAA,MACpB;AAAA,IACF,CAAC;AACD,WAAO;AAAA,EACT;AAAA,EAEA,QAAQ,SAAiB,QAAgB,YAA8D;AACrG,SAAK,KAAK,MAAO,KAAK,EAAE,SAAS,QAAQ,WAAW,CAAC;AACrD,WAAO;AAAA,EACT;AAAA,EAEA,UAAU,MAAsB,SAAwB;AACtD,SAAK,KAAK,SAAS,EAAE,MAAM,QAAQ;AACnC,WAAO;AAAA,EACT;AAAA,EAEA,SAAS,OAAoB;AAC3B,SAAK,KAAK,SAAS,EAAE,MAAM,SAAS,SAAS,MAAM,QAAQ;AAC3D,SAAK,SAAS,aAAa;AAAA,MACzB,kBAAkB,MAAM;AAAA,MACxB,qBAAqB,MAAM;AAAA,MAC3B,wBAAwB,MAAM,SAAS;AAAA,IACzC,CAAC;AACD,WAAO;AAAA,EACT;AAAA,EAEA,UAAgB;AACd,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,aAA2B;AACzB,WAAO;AAAA,MACL,SAAS,KAAK,KAAK;AAAA,MACnB,QAAQ,KAAK,KAAK;AAAA,MAClB,cAAc,KAAK,KAAK;AAAA,MACxB,YAAY;AAAA,IACd;AAAA,EACF;AAAA,EAEA,IAAI,SAAwB;AAC1B,UAAM,MAAM,WAAW,KAAK,IAAI;AAChC,SAAK,KAAK,UAAU;AACpB,SAAK,KAAK,WAAW,MAAM,KAAK,KAAK;AAErC,UAAM,gBAAgB,KAAK;AAC3B,SAAK,OAAO,WAAW,aAAa;AAEpC,WAAO;AAAA,EACT;AACF;AAmBO,IAAM,SAAN,cAAqBD,eAAkC;AAAA,EACpD;AAAA,EACA,QAA2B,oBAAI,IAAI;AAAA,EACnC,SAA8B,oBAAI,IAAI;AAAA,EACtC,cAAwC,oBAAI,IAAI;AAAA,EAChD;AAAA,EAER,YAAY,SAAuC,CAAC,GAAG;AACrD,UAAM;AACN,SAAK,SAAS;AAAA,MACZ,aAAa,OAAO,eAAe;AAAA,MACnC,gBAAgB,OAAO;AAAA,MACvB,aAAa,OAAO,eAAe;AAAA,MACnC,SAAS;AAAA,QACP,SAAS;AAAA,QACT,SAAS,EAAE,MAAM,aAAa,OAAO,GAAG,aAAa,KAAK;AAAA,QAC1D,mBAAmB;AAAA,QACnB,eAAe;AAAA,QACf,cAAc;AAAA,QACd,GAAG,OAAO;AAAA,MACZ;AAAA,MACA,SAAS,EAAE,SAAS,MAAM,iBAAiB,KAAO,gBAAgB,CAAC,GAAG,GAAG,OAAO,QAAQ;AAAA,MACxF,SAAS,EAAE,SAAS,MAAM,aAAa,QAAQ,qBAAqB,MAAM,GAAG,OAAO,QAAQ;AAAA,MAC5F,UAAU,EAAE,YAAY,CAAC,GAAG,GAAG,OAAO,SAAS;AAAA,MAC/C,WAAW,EAAE,QAAQ,OAAU,SAAS,QAAW,MAAM,OAAU,GAAG,OAAO,UAAU;AAAA,IACzF;AACA,SAAK,UAAU,IAAI,QAAQ,KAAK,OAAO,QAAQ,OAAO;AAGtD,gBAAY,MAAM,KAAK,QAAQ,GAAG,GAAK;AAAA,EACzC;AAAA,EAEA,cAAc;AACZ,WAAO;AAAA,MACL,aAAa,KAAK,OAAO;AAAA,MACzB,gBAAgB,KAAK,OAAO;AAAA,MAC5B,aAAa,KAAK,OAAO;AAAA,MACzB,UAAU,KAAK,OAAO,SAAS;AAAA,MAC/B,YAAY,KAAK,OAAO,SAAS;AAAA,IACnC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,UAAU,MAAc,UAAuB,CAAC,GAAgB;AAC9D,QAAI,CAAC,KAAK,OAAO,QAAQ,SAAS;AAEhC,aAAO,IAAI,gBAAgB,MAAM,IAAI;AAAA,IACvC;AAGA,UAAM,eAAe,KAAK,QAAQ,aAAa,QAAQ,OAAO;AAC9D,QAAI,CAAC,cAAc;AACjB,aAAO,IAAI,gBAAgB,MAAM,IAAI;AAAA,IACvC;AAEA,UAAM,UAAU,IAAI,YAAY,MAAM,MAAM,OAAO;AACnD,SAAK,YAAY,IAAI,QAAQ,WAAW,EAAE,QAAQ,OAAO;AACzD,SAAK,KAAK,gBAAgB,QAAQ,QAAQ,CAAC;AAE3C,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,eAAe,MAAc,eAA6B,UAAwC,CAAC,GAAgB;AACjH,WAAO,KAAK,UAAU,MAAM,EAAE,GAAG,SAAS,SAAS,cAAc,CAAC;AAAA,EACpE;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,MACJ,MACA,IACA,UAAuB,CAAC,GACZ;AACZ,UAAM,OAAO,KAAK,UAAU,MAAM,OAAO;AAEzC,QAAI;AACF,YAAM,SAAS,MAAM,GAAG,IAAI;AAC5B,WAAK,UAAU,IAAI;AACnB,aAAO;AAAA,IACT,SAAS,OAAO;AACd,WAAK,SAAS,KAAc;AAC5B,YAAM;AAAA,IACR,UAAE;AACA,WAAK,IAAI;AAAA,IACX;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,WAAW,MAAkB;AAE3B,QAAI,OAAO,KAAK,KAAK,UAAU,EAAE,SAAS,KAAK,OAAO,QAAQ,mBAAmB;AAC/E,YAAM,UAAU,OAAO,QAAQ,KAAK,UAAU,EAAE,MAAM,GAAG,KAAK,OAAO,QAAQ,iBAAiB;AAC9F,WAAK,aAAa,OAAO,YAAY,OAAO;AAAA,IAC9C;AAEA,QAAI,KAAK,OAAO,SAAS,KAAK,OAAO,QAAQ,eAAe;AAC1D,WAAK,SAAS,KAAK,OAAO,MAAM,GAAG,KAAK,OAAO,QAAQ,aAAa;AAAA,IACtE;AAEA,QAAI,KAAK,MAAM,SAAS,KAAK,OAAO,QAAQ,cAAc;AACxD,WAAK,QAAQ,KAAK,MAAM,MAAM,GAAG,KAAK,OAAO,QAAQ,YAAY;AAAA,IACnE;AAGA,SAAK,MAAM,IAAI,KAAK,QAAQ,IAAI;AAGhC,UAAM,aAAa,KAAK,OAAO,IAAI,KAAK,OAAO,KAAK,CAAC;AACrD,eAAW,KAAK,IAAI;AACpB,SAAK,OAAO,IAAI,KAAK,SAAS,UAAU;AAGxC,SAAK,YAAY,OAAO,KAAK,MAAM;AAEnC,SAAK,KAAK,cAAc,IAAI;AAG5B,QAAI,CAAC,KAAK,cAAc;AACtB,WAAK,mBAAmB,KAAK,OAAO;AAAA,IACtC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKQ,mBAAmB,SAAuB;AAChD,UAAM,QAAQ,KAAK,OAAO,IAAI,OAAO;AACrC,QAAI,CAAC,SAAS,MAAM,WAAW,EAAG;AAGlC,UAAM,WAAW,MAAM,KAAK,OAAK,CAAC,EAAE,YAAY;AAChD,QAAI,CAAC,YAAY,CAAC,SAAS,QAAS;AAGpC,UAAM,QAAe;AAAA,MACnB;AAAA,MACA;AAAA,MACA;AAAA,MACA,WAAW,SAAS;AAAA,MACpB,SAAS,SAAS;AAAA,MAClB,UAAU,SAAS;AAAA,MACnB,WAAW,MAAM;AAAA,MACjB,YAAY,MAAM,OAAO,OAAK,EAAE,OAAO,SAAS,OAAO,EAAE;AAAA,MACzD,aAAa,SAAS,SAAS;AAAA,MAC/B,eAAe,SAAS;AAAA,IAC1B;AAEA,SAAK,KAAK,mBAAmB,KAAK;AAAA,EACpC;AAAA;AAAA;AAAA;AAAA,EAKA,QAAQ,QAAkC;AACxC,WAAO,KAAK,MAAM,IAAI,MAAM;AAAA,EAC9B;AAAA;AAAA;AAAA;AAAA,EAKA,cAAc,SAAyB;AACrC,WAAO,KAAK,OAAO,IAAI,OAAO,KAAK,CAAC;AAAA,EACtC;AAAA;AAAA;AAAA;AAAA,EAKA,SAAS,SAA+B;AACtC,UAAM,QAAQ,KAAK,OAAO,IAAI,OAAO;AACrC,QAAI,CAAC,SAAS,MAAM,WAAW,EAAG,QAAO;AAEzC,UAAM,WAAW,MAAM,KAAK,OAAK,CAAC,EAAE,YAAY;AAChD,QAAI,CAAC,SAAU,QAAO;AAEtB,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA,WAAW,SAAS;AAAA,MACpB,SAAS,SAAS;AAAA,MAClB,UAAU,SAAS;AAAA,MACnB,WAAW,MAAM;AAAA,MACjB,YAAY,MAAM,OAAO,OAAK,EAAE,OAAO,SAAS,OAAO,EAAE;AAAA,MACzD,aAAa,SAAS,SAAS;AAAA,MAC/B,eAAe,SAAS;AAAA,IAC1B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,OASD;AACV,UAAM,UAAmB,CAAC;AAC1B,UAAM,QAAQ,MAAM,SAAS;AAE7B,eAAW,WAAW,KAAK,OAAO,KAAK,GAAG;AACxC,UAAI,QAAQ,UAAU,MAAO;AAE7B,YAAM,QAAQ,KAAK,SAAS,OAAO;AACnC,UAAI,CAAC,SAAS,CAAC,MAAM,SAAS,QAAS;AAGvC,UAAI,MAAM,eAAe,MAAM,gBAAgB,MAAM,YAAa;AAClE,UAAI,MAAM,iBAAiB,MAAM,kBAAkB,MAAM,cAAe;AACxE,UAAI,MAAM,gBAAgB,MAAM,YAAY,KAAK,MAAM,YAAa;AACpE,UAAI,MAAM,gBAAgB,MAAM,YAAY,KAAK,MAAM,YAAa;AACpE,UAAI,MAAM,aAAa,MAAM,YAAY,MAAM,UAAW;AAC1D,UAAI,MAAM,WAAW,MAAM,YAAY,MAAM,QAAS;AAGtD,UAAI,MAAM,MAAM;AACd,cAAM,aAAa,OAAO,QAAQ,MAAM,IAAI,EAAE;AAAA,UAC5C,CAAC,CAAC,KAAK,KAAK,MAAM,MAAM,SAAS,WAAW,GAAG,MAAM;AAAA,QACvD;AACA,YAAI,CAAC,WAAY;AAAA,MACnB;AAEA,cAAQ,KAAK,KAAK;AAAA,IACpB;AAEA,WAAO,QAAQ,KAAK,CAAC,GAAG,MAAM,EAAE,YAAY,EAAE,SAAS;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA,EAKA,WAME;AACA,UAAM,SAAS,MAAM,KAAK,KAAK,OAAO,OAAO,CAAC;AAC9C,UAAM,WAAW,OAAO,KAAK;AAC7B,UAAM,kBAAkB,OAAO,OAAO,WAAS;AAC7C,YAAM,OAAO,MAAM,KAAK,OAAK,CAAC,EAAE,YAAY;AAC5C,aAAO,MAAM;AAAA,IACf,CAAC;AAED,UAAM,YAAY,gBACf,IAAI,WAAS,MAAM,KAAK,OAAK,CAAC,EAAE,YAAY,GAAG,YAAY,CAAC,EAC5D,OAAO,OAAK,IAAI,CAAC;AAEpB,UAAM,cAAc,UAAU,SAAS,IACnC,UAAU,OAAO,CAAC,GAAG,MAAM,IAAI,GAAG,CAAC,IAAI,UAAU,SACjD;AAEJ,UAAM,aAAa,SAAS,OAAO,OAAK,EAAE,OAAO,SAAS,OAAO,EAAE;AAEnE,WAAO;AAAA,MACL,aAAa,KAAK,OAAO;AAAA,MACzB,YAAY,SAAS;AAAA,MACrB,aAAa,KAAK,YAAY;AAAA,MAC9B;AAAA,MACA,WAAW,SAAS,SAAS,IAAI,aAAa,SAAS,SAAS;AAAA,IAClE;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKQ,UAAgB;AACtB,UAAM,SAAS,KAAK,IAAI,IAAI,KAAK,OAAO,UAAU;AAElD,eAAW,CAAC,QAAQ,IAAI,KAAK,KAAK,OAAO;AACvC,UAAI,KAAK,YAAY,QAAQ;AAC3B,aAAK,MAAM,OAAO,MAAM;AAAA,MAC1B;AAAA,IACF;AAEA,eAAW,CAAC,SAAS,KAAK,KAAK,KAAK,QAAQ;AAC1C,YAAM,OAAO,MAAM,KAAK,OAAK,CAAC,EAAE,YAAY;AAC5C,UAAI,QAAQ,KAAK,YAAY,QAAQ;AACnC,aAAK,OAAO,OAAO,OAAO;AAAA,MAC5B;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,QAAc;AACZ,SAAK,MAAM,MAAM;AACjB,SAAK,OAAO,MAAM;AAClB,SAAK,YAAY,MAAM;AAAA,EACzB;AACF;AAMA,IAAM,kBAAN,cAA8B,YAAY;AAAA,EACxC,aAAa,MAAc,QAAyC;AAClE,WAAO;AAAA,EACT;AAAA,EAEA,cAAc,QAAyD;AACrE,WAAO;AAAA,EACT;AAAA,EAEA,SAAS,OAAe,aAA+D;AACrF,WAAO;AAAA,EACT;AAAA,EAEA,QAAQ,UAAkB,SAAiB,aAA+D;AACxG,WAAO;AAAA,EACT;AAAA,EAEA,UAAU,OAAuB,UAAyB;AACxD,WAAO;AAAA,EACT;AAAA,EAEA,SAAS,QAAqB;AAC5B,WAAO;AAAA,EACT;AAAA,EAEA,IAAI,UAAyB;AAC3B,WAAO,KAAK,QAAQ;AAAA,EACtB;AACF;AAMA,IAAM,UAAN,MAAc;AAAA,EACJ;AAAA,EAER,YAAY,QAAuB;AACjC,SAAK,SAAS;AAAA,EAChB;AAAA,EAEA,aAAa,eAAuC;AAClD,YAAQ,KAAK,OAAO,MAAM;AAAA,MACxB,KAAK;AACH,eAAO;AAAA,MAET,KAAK;AACH,eAAO;AAAA,MAET,KAAK;AAEH,eAAO,KAAK,OAAO,IAAI,KAAK,OAAO;AAAA,MAErC,KAAK;AACH,YAAI,iBAAiB,KAAK,OAAO,aAAa;AAE5C,kBAAQ,cAAc,aAAa,OAAO;AAAA,QAC5C;AACA,eAAO,KAAK,OAAO,IAAI,KAAK,OAAO;AAAA,MAErC;AACE,eAAO;AAAA,IACX;AAAA,EACF;AACF;AAMA,SAAS,kBAA0B;AACjC,SAAOC,YAAW,EAAE,QAAQ,MAAM,EAAE;AACtC;AAEA,SAAS,iBAAyB;AAChC,SAAOA,YAAW,EAAE,QAAQ,MAAM,EAAE,EAAE,UAAU,GAAG,EAAE;AACvD;AAMA,IAAI,iBAAgC;AAE7B,SAAS,YAA2B;AACzC,SAAO;AACT;AAEO,SAAS,aAAa,QAA+C;AAC1E,mBAAiB,IAAI,OAAO,MAAM;AAClC,SAAO;AACT;;;AC/gBA,SAAS,gBAAAC,sBAAoB;AAmBtB,IAAM,UAAN,MAAc;AAAA,EACX;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,SAA8B,oBAAI,IAAI;AAAA,EACtC,SAAqC,oBAAI,IAAI;AAAA,EAC7C;AAAA,EAER,YAAY,WAA6B,YAA8B;AACrE,SAAK,YAAY;AACjB,SAAK,OAAO,WAAW;AACvB,SAAK,OAAO,WAAW,QAAQ;AAC/B,SAAK,cAAc,WAAW,eAAe;AAC7C,SAAK,SAAS,WAAW,UAAU,CAAC;AAAA,EACtC;AAAA,EAEQ,OAAO,QAAwC;AACrD,WAAO,KAAK,UAAU,MAAM;AAAA,EAC9B;AAAA,EAEA,IAAI,SAAiC,CAAC,GAAG,QAAgB,GAAS;AAChE,UAAM,MAAM,KAAK,OAAO,MAAM;AAC9B,UAAM,UAAU,KAAK,OAAO,IAAI,GAAG,KAAK;AACxC,UAAM,WAAW,UAAU;AAC3B,SAAK,OAAO,IAAI,KAAK,QAAQ;AAE7B,UAAM,QAAqB;AAAA,MACzB,WAAW,KAAK,IAAI;AAAA,MACpB,OAAO;AAAA,MACP;AAAA,IACF;AAEA,UAAM,aAAa,KAAK,OAAO,IAAI,GAAG,KAAK,CAAC;AAC5C,eAAW,KAAK,KAAK;AACrB,SAAK,OAAO,IAAI,KAAK,UAAU;AAE/B,SAAK,UAAU,aAAa,KAAK,QAAQ,CAAC;AAAA,EAC5C;AAAA,EAEA,SAAS,SAAiC,CAAC,GAAW;AACpD,WAAO,KAAK,OAAO,IAAI,KAAK,OAAO,MAAM,CAAC,KAAK;AAAA,EACjD;AAAA,EAEA,UAAsB;AACpB,UAAM,YAA2B,CAAC;AAClC,eAAW,UAAU,KAAK,OAAO,OAAO,GAAG;AACzC,gBAAU,KAAK,GAAG,MAAM;AAAA,IAC1B;AAEA,WAAO;AAAA,MACL,MAAM,KAAK;AAAA,MACX,MAAM;AAAA,MACN,MAAM,KAAK;AAAA,MACX,aAAa,KAAK;AAAA,MAClB,QAAQ;AAAA,MACR,UAAU,KAAK,UAAU,YAAY;AAAA,IACvC;AAAA,EACF;AAAA,EAEA,QAAc;AACZ,SAAK,OAAO,MAAM;AAClB,SAAK,OAAO,MAAM;AAAA,EACpB;AACF;AAMO,IAAM,QAAN,MAAY;AAAA,EACT;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,SAA8B,oBAAI,IAAI;AAAA,EACtC,SAAqC,oBAAI,IAAI;AAAA,EAC7C;AAAA,EAER,YAAY,WAA6B,YAA8B;AACrE,SAAK,YAAY;AACjB,SAAK,OAAO,WAAW;AACvB,SAAK,OAAO,WAAW,QAAQ;AAC/B,SAAK,cAAc,WAAW,eAAe;AAC7C,SAAK,SAAS,WAAW,UAAU,CAAC;AAAA,EACtC;AAAA,EAEQ,OAAO,QAAwC;AACrD,WAAO,KAAK,UAAU,MAAM;AAAA,EAC9B;AAAA,EAEA,IAAI,OAAe,SAAiC,CAAC,GAAS;AAC5D,UAAM,MAAM,KAAK,OAAO,MAAM;AAC9B,SAAK,OAAO,IAAI,KAAK,KAAK;AAE1B,UAAM,QAAqB;AAAA,MACzB,WAAW,KAAK,IAAI;AAAA,MACpB;AAAA,MACA;AAAA,IACF;AAEA,UAAM,aAAa,KAAK,OAAO,IAAI,GAAG,KAAK,CAAC;AAC5C,eAAW,KAAK,KAAK;AACrB,SAAK,OAAO,IAAI,KAAK,UAAU;AAE/B,SAAK,UAAU,aAAa,KAAK,QAAQ,CAAC;AAAA,EAC5C;AAAA,EAEA,IAAI,SAAiC,CAAC,GAAG,QAAgB,GAAS;AAChE,UAAM,UAAU,KAAK,SAAS,MAAM;AACpC,SAAK,IAAI,UAAU,OAAO,MAAM;AAAA,EAClC;AAAA,EAEA,IAAI,SAAiC,CAAC,GAAG,QAAgB,GAAS;AAChE,UAAM,UAAU,KAAK,SAAS,MAAM;AACpC,SAAK,IAAI,UAAU,OAAO,MAAM;AAAA,EAClC;AAAA,EAEA,SAAS,SAAiC,CAAC,GAAW;AACpD,WAAO,KAAK,OAAO,IAAI,KAAK,OAAO,MAAM,CAAC,KAAK;AAAA,EACjD;AAAA,EAEA,UAAsB;AACpB,UAAM,YAA2B,CAAC;AAClC,eAAW,UAAU,KAAK,OAAO,OAAO,GAAG;AACzC,gBAAU,KAAK,GAAG,MAAM;AAAA,IAC1B;AAEA,WAAO;AAAA,MACL,MAAM,KAAK;AAAA,MACX,MAAM;AAAA,MACN,MAAM,KAAK;AAAA,MACX,aAAa,KAAK;AAAA,MAClB,QAAQ;AAAA,MACR,UAAU,KAAK,UAAU,YAAY;AAAA,IACvC;AAAA,EACF;AAAA,EAEA,QAAc;AACZ,SAAK,OAAO,MAAM;AAClB,SAAK,OAAO,MAAM;AAAA,EACpB;AACF;AAMO,IAAM,YAAN,MAAgB;AAAA,EACb;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,OAAmC,oBAAI,IAAI;AAAA,EAC3C,SAAqC,oBAAI,IAAI;AAAA,EAC7C;AAAA,EAER,YAAY,WAA6B,YAA8B;AACrE,SAAK,YAAY;AACjB,SAAK,OAAO,WAAW;AACvB,SAAK,OAAO,WAAW,QAAQ;AAC/B,SAAK,cAAc,WAAW,eAAe;AAC7C,SAAK,SAAS,WAAW,UAAU,CAAC;AACpC,SAAK,UAAU,WAAW,WAAW,CAAC,GAAG,IAAI,IAAI,IAAI,KAAK,KAAK,KAAK,KAAM,MAAM,KAAM,GAAK;AAAA,EAC7F;AAAA,EAEQ,OAAO,QAAwC;AACrD,WAAO,KAAK,UAAU,MAAM;AAAA,EAC9B;AAAA,EAEQ,gBAAgB,KAA4B;AAClD,QAAI,OAAO,KAAK,KAAK,IAAI,GAAG;AAC5B,QAAI,CAAC,MAAM;AACT,aAAO;AAAA,QACL,KAAK;AAAA,QACL,OAAO;AAAA,QACP,KAAK;AAAA,QACL,KAAK;AAAA,QACL,QAAQ,IAAI,MAAM,KAAK,QAAQ,SAAS,CAAC,EAAE,KAAK,CAAC;AAAA,MACnD;AACA,WAAK,KAAK,IAAI,KAAK,IAAI;AAAA,IACzB;AACA,WAAO;AAAA,EACT;AAAA,EAEA,QAAQ,OAAe,SAAiC,CAAC,GAAS;AAChE,UAAM,MAAM,KAAK,OAAO,MAAM;AAC9B,UAAM,OAAO,KAAK,gBAAgB,GAAG;AAErC,SAAK,OAAO;AACZ,SAAK;AACL,SAAK,MAAM,KAAK,IAAI,KAAK,KAAK,KAAK;AACnC,SAAK,MAAM,KAAK,IAAI,KAAK,KAAK,KAAK;AAGnC,aAAS,IAAI,GAAG,IAAI,KAAK,QAAQ,QAAQ,KAAK;AAC5C,UAAI,SAAS,KAAK,QAAQ,CAAC,GAAG;AAC5B,aAAK,OAAO,CAAC;AACb;AAAA,MACF;AAAA,IACF;AAEA,QAAI,QAAQ,KAAK,QAAQ,KAAK,QAAQ,SAAS,CAAC,GAAG;AACjD,WAAK,OAAO,KAAK,QAAQ,MAAM;AAAA,IACjC;AAEA,UAAM,QAAqB;AAAA,MACzB,WAAW,KAAK,IAAI;AAAA,MACpB;AAAA,MACA;AAAA,IACF;AAEA,UAAM,aAAa,KAAK,OAAO,IAAI,GAAG,KAAK,CAAC;AAC5C,eAAW,KAAK,KAAK;AACrB,SAAK,OAAO,IAAI,KAAK,UAAU;AAE/B,SAAK,UAAU,aAAa,KAAK,QAAQ,CAAC;AAAA,EAC5C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,KAAQ,IAAsB,SAAiC,CAAC,GAAe;AACnF,UAAM,QAAQ,YAAY,IAAI;AAC9B,QAAI;AACF,aAAO,MAAM,GAAG;AAAA,IAClB,UAAE;AACA,YAAM,WAAW,YAAY,IAAI,IAAI;AACrC,WAAK,QAAQ,UAAU,MAAM;AAAA,IAC/B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,WAAW,SAAiC,CAAC,GAAiB;AAC5D,UAAM,QAAQ,YAAY,IAAI;AAC9B,WAAO,MAAM;AACX,YAAM,WAAW,YAAY,IAAI,IAAI;AACrC,WAAK,QAAQ,UAAU,MAAM;AAC7B,aAAO;AAAA,IACT;AAAA,EACF;AAAA,EAEA,WAAW,SAAiC,CAAC,GAA4B;AACvE,UAAM,MAAM,KAAK,OAAO,MAAM;AAC9B,UAAM,OAAO,KAAK,KAAK,IAAI,GAAG;AAC9B,QAAI,CAAC,KAAM,QAAO;AAElB,WAAO;AAAA,MACL,YAAY,KAAK;AAAA,MACjB,QAAQ,KAAK;AAAA,MACb,KAAK,KAAK;AAAA,MACV,OAAO,KAAK;AAAA,MACZ,KAAK,KAAK,QAAQ,WAAW,SAAY,KAAK;AAAA,MAC9C,KAAK,KAAK,QAAQ,YAAY,SAAY,KAAK;AAAA,IACjD;AAAA,EACF;AAAA,EAEA,cAAc,YAAoB,SAAiC,CAAC,GAAkB;AACpF,UAAM,MAAM,KAAK,OAAO,MAAM;AAC9B,UAAM,OAAO,KAAK,KAAK,IAAI,GAAG;AAC9B,QAAI,CAAC,QAAQ,KAAK,UAAU,EAAG,QAAO;AAEtC,UAAM,cAAc,KAAK,KAAM,aAAa,MAAO,KAAK,KAAK;AAC7D,QAAI,aAAa;AAEjB,aAAS,IAAI,GAAG,IAAI,KAAK,OAAO,QAAQ,KAAK;AAC3C,oBAAc,KAAK,OAAO,CAAC;AAC3B,UAAI,cAAc,aAAa;AAC7B,eAAO,IAAI,KAAK,QAAQ,SAAS,KAAK,QAAQ,CAAC,IAAI,KAAK,QAAQ,KAAK,QAAQ,SAAS,CAAC;AAAA,MACzF;AAAA,IACF;AAEA,WAAO,KAAK,QAAQ,KAAK,QAAQ,SAAS,CAAC;AAAA,EAC7C;AAAA,EAEA,UAAsB;AACpB,UAAM,YAA2B,CAAC;AAClC,eAAW,UAAU,KAAK,OAAO,OAAO,GAAG;AACzC,gBAAU,KAAK,GAAG,MAAM;AAAA,IAC1B;AAGA,UAAM,WAAW,KAAK,KAAK,KAAK,EAAE,KAAK,EAAE;AACzC,UAAM,YAAY,WAAW,KAAK,WAAW,KAAK,MAAM,QAAQ,CAAC,KAAK,SAAY;AAElF,WAAO;AAAA,MACL,MAAM,KAAK;AAAA,MACX,MAAM;AAAA,MACN,MAAM,KAAK;AAAA,MACX,aAAa,KAAK;AAAA,MAClB,QAAQ;AAAA,MACR;AAAA,MACA,UAAU,KAAK,UAAU,YAAY;AAAA,IACvC;AAAA,EACF;AAAA,EAEA,QAAc;AACZ,SAAK,KAAK,MAAM;AAChB,SAAK,OAAO,MAAM;AAAA,EACpB;AACF;AAcO,IAAM,mBAAN,cAA+BC,eAAkC;AAAA,EAC9D;AAAA,EACA,cAA6C,oBAAI,IAAI;AAAA,EACrD,WAAiC,oBAAI,IAAI;AAAA,EACzC,SAA6B,oBAAI,IAAI;AAAA,EACrC,aAAqC,oBAAI,IAAI;AAAA,EAC7C,aAAsC,oBAAI,IAAI;AAAA,EAC9C;AAAA,EAER,YAAY,SAAuC,CAAC,GAAG;AACrD,UAAM;AACN,SAAK,SAAS;AAAA,MACZ,aAAa,OAAO,eAAe;AAAA,MACnC,gBAAgB,OAAO;AAAA,MACvB,aAAa,OAAO,eAAe;AAAA,MACnC,SAAS,EAAE,SAAS,MAAM,SAAS,EAAE,MAAM,aAAa,OAAO,GAAG,aAAa,KAAK,GAAG,mBAAmB,KAAK,eAAe,KAAK,cAAc,KAAK,GAAG,OAAO,QAAQ;AAAA,MACxK,SAAS;AAAA,QACP,SAAS;AAAA,QACT,iBAAiB;AAAA,QACjB,gBAAgB,CAAC,GAAG,IAAI,IAAI,IAAI,KAAK,KAAK,KAAK,KAAM,MAAM,KAAM,GAAK;AAAA,QACtE,GAAG,OAAO;AAAA,MACZ;AAAA,MACA,SAAS,EAAE,SAAS,MAAM,aAAa,QAAQ,qBAAqB,MAAM,GAAG,OAAO,QAAQ;AAAA,MAC5F,UAAU,EAAE,YAAY,CAAC,GAAG,GAAG,OAAO,SAAS;AAAA,MAC/C,WAAW,EAAE,QAAQ,OAAU,SAAS,QAAW,MAAM,OAAU,GAAG,OAAO,UAAU;AAAA,IACzF;AAGA,eAAW,UAAU,iBAAiB;AACpC,WAAK,SAAS,MAAM;AAAA,IACtB;AAGA,QAAI,KAAK,OAAO,QAAQ,SAAS;AAC/B,WAAK,gBAAgB;AAAA,IACvB;AAAA,EACF;AAAA,EAEA,cAAc;AACZ,WAAO;AAAA,MACL,aAAa,KAAK,OAAO;AAAA,MACzB,aAAa,KAAK,OAAO;AAAA,IAC3B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,SAAS,YAAoC;AAC3C,SAAK,YAAY,IAAI,WAAW,MAAM,UAAU;AAAA,EAClD;AAAA;AAAA;AAAA;AAAA,EAKA,QAAQ,MAAc,UAAqC,CAAC,GAAY;AACtE,QAAI,UAAU,KAAK,SAAS,IAAI,IAAI;AACpC,QAAI,CAAC,SAAS;AACZ,YAAM,aAA+B;AAAA,QACnC;AAAA,QACA,MAAM;AAAA,QACN,MAAM,QAAQ,QAAQ;AAAA,QACtB,aAAa,QAAQ;AAAA,QACrB,QAAQ,QAAQ,UAAU,CAAC;AAAA,MAC7B;AACA,WAAK,SAAS,UAAU;AACxB,gBAAU,IAAI,QAAQ,MAAM,UAAU;AACtC,WAAK,SAAS,IAAI,MAAM,OAAO;AAAA,IACjC;AACA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,MAAc,UAAqC,CAAC,GAAU;AAClE,QAAI,QAAQ,KAAK,OAAO,IAAI,IAAI;AAChC,QAAI,CAAC,OAAO;AACV,YAAM,aAA+B;AAAA,QACnC;AAAA,QACA,MAAM;AAAA,QACN,MAAM,QAAQ,QAAQ;AAAA,QACtB,aAAa,QAAQ;AAAA,QACrB,QAAQ,QAAQ,UAAU,CAAC;AAAA,MAC7B;AACA,WAAK,SAAS,UAAU;AACxB,cAAQ,IAAI,MAAM,MAAM,UAAU;AAClC,WAAK,OAAO,IAAI,MAAM,KAAK;AAAA,IAC7B;AACA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,UAAU,MAAc,UAAqC,CAAC,GAAc;AAC1E,QAAI,YAAY,KAAK,WAAW,IAAI,IAAI;AACxC,QAAI,CAAC,WAAW;AACd,YAAM,aAA+B;AAAA,QACnC;AAAA,QACA,MAAM;AAAA,QACN,MAAM,QAAQ,QAAQ;AAAA,QACtB,aAAa,QAAQ;AAAA,QACrB,QAAQ,QAAQ,UAAU,CAAC;AAAA,QAC3B,SAAS,QAAQ,WAAW,KAAK,OAAO,QAAQ;AAAA,MAClD;AACA,WAAK,SAAS,UAAU;AACxB,kBAAY,IAAI,UAAU,MAAM,UAAU;AAC1C,WAAK,WAAW,IAAI,MAAM,SAAS;AAAA,IACrC;AACA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,MAAwB;AACnC,SAAK,WAAW,IAAI,KAAK,MAAM,IAAI;AACnC,SAAK,KAAK,mBAAmB,IAAI;AAAA,EACnC;AAAA;AAAA;AAAA;AAAA,EAKA,gBAA8B;AAC5B,WAAO,MAAM,KAAK,KAAK,WAAW,OAAO,CAAC;AAAA,EAC5C;AAAA;AAAA;AAAA;AAAA,EAKA,UAAU,MAAsC;AAC9C,WAAO,KAAK,WAAW,IAAI,IAAI;AAAA,EACjC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAmC;AACvC,UAAM,SAAS,KAAK,WAAW,IAAI,MAAM,IAAI;AAC7C,QAAI,CAAC,OAAQ,QAAO,CAAC;AAErB,QAAI,SAAS,OAAO;AAGpB,QAAI,MAAM,QAAQ;AAChB,eAAS,OAAO,OAAO,OAAK;AAC1B,eAAO,OAAO,QAAQ,MAAM,MAAO,EAAE;AAAA,UACnC,CAAC,CAAC,KAAK,KAAK,MAAM,EAAE,OAAO,GAAG,MAAM;AAAA,QACtC;AAAA,MACF,CAAC;AAAA,IACH;AAGA,QAAI,MAAM,WAAW;AACnB,eAAS,OAAO,OAAO,OAAK,EAAE,aAAa,MAAM,SAAU;AAAA,IAC7D;AACA,QAAI,MAAM,SAAS;AACjB,eAAS,OAAO,OAAO,OAAK,EAAE,aAAa,MAAM,OAAQ;AAAA,IAC3D;AAGA,QAAI,MAAM,eAAe,MAAM,MAAM;AACnC,eAAS,KAAK,gBAAgB,QAAQ,MAAM,aAAa,MAAM,IAAI;AAAA,IACrE;AAEA,WAAO;AAAA,EACT;AAAA,EAEQ,gBACN,QACA,aACA,MACe;AACf,QAAI,OAAO,WAAW,EAAG,QAAO,CAAC;AAGjC,UAAM,UAAsC,oBAAI,IAAI;AACpD,eAAW,SAAS,QAAQ;AAC1B,YAAM,SAAS,KAAK,MAAM,MAAM,YAAY,IAAI,IAAI;AACpD,YAAM,eAAe,QAAQ,IAAI,MAAM,KAAK,CAAC;AAC7C,mBAAa,KAAK,KAAK;AACvB,cAAQ,IAAI,QAAQ,YAAY;AAAA,IAClC;AAGA,UAAM,UAAyB,CAAC;AAChC,eAAW,CAAC,WAAW,YAAY,KAAK,SAAS;AAC/C,YAAM,SAAS,aAAa,IAAI,OAAK,EAAE,KAAK;AAC5C,UAAI;AAEJ,cAAQ,aAAa;AAAA,QACnB,KAAK;AACH,kBAAQ,OAAO,OAAO,CAAC,GAAG,MAAM,IAAI,GAAG,CAAC;AACxC;AAAA,QACF,KAAK;AACH,kBAAQ,OAAO,OAAO,CAAC,GAAG,MAAM,IAAI,GAAG,CAAC,IAAI,OAAO;AACnD;AAAA,QACF,KAAK;AACH,kBAAQ,KAAK,IAAI,GAAG,MAAM;AAC1B;AAAA,QACF,KAAK;AACH,kBAAQ,KAAK,IAAI,GAAG,MAAM;AAC1B;AAAA,QACF,KAAK;AACH,kBAAQ,OAAO;AACf;AAAA,QACF,KAAK;AACH,kBAAQ,OAAO,OAAO,CAAC,GAAG,MAAM,IAAI,GAAG,CAAC,KAAK,OAAO;AACpD;AAAA,MACJ;AAEA,cAAQ,KAAK;AAAA,QACX;AAAA,QACA;AAAA,QACA,QAAQ,CAAC;AAAA,MACX,CAAC;AAAA,IACH;AAEA,WAAO,QAAQ,KAAK,CAAC,GAAG,MAAM,EAAE,YAAY,EAAE,SAAS;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA,EAKA,aAA6B;AAC3B,UAAM,UAAU,KAAK,cAAc;AACnC,UAAM,SAAiC,CAAC;AAExC,eAAW,UAAU,SAAS;AAC5B,aAAO,OAAO,IAAI,KAAK,OAAO,OAAO,IAAI,KAAK,KAAK;AAAA,IACrD;AAEA,UAAM,aAAa,QAChB,IAAI,QAAM;AAAA,MACT,MAAM,EAAE;AAAA,MACR,MAAM,EAAE;AAAA,MACR,YAAY,EAAE,OAAO;AAAA,MACrB,WAAW,EAAE,OAAO,SAAS,IAAI,EAAE,OAAO,EAAE,OAAO,SAAS,CAAC,EAAE,QAAQ;AAAA,IACzE,EAAE,EACD,KAAK,CAAC,GAAG,MAAM,EAAE,aAAa,EAAE,UAAU,EAC1C,MAAM,GAAG,EAAE;AAEd,WAAO;AAAA,MACL,cAAc,QAAQ;AAAA,MACtB,aAAa,QAAQ,OAAO,CAAC,KAAK,MAAM,MAAM,EAAE,OAAO,QAAQ,CAAC;AAAA,MAChE,eAAe;AAAA,MACf;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKQ,kBAAwB;AAC9B,SAAK,kBAAkB,YAAY,MAAM;AACvC,WAAK,qBAAqB;AAAA,IAC5B,GAAG,KAAK,OAAO,QAAQ,eAAe;AAAA,EACxC;AAAA;AAAA;AAAA;AAAA,EAKQ,uBAA6B;AAEnC,QAAI,OAAO,YAAY,eAAe,QAAQ,aAAa;AACzD,YAAM,SAAS,QAAQ,YAAY;AACnC,YAAM,cAAc,KAAK,MAAM,oBAAoB;AACnD,kBAAY,IAAI,OAAO,UAAU,EAAE,MAAM,YAAY,CAAC;AACtD,kBAAY,IAAI,OAAO,WAAW,EAAE,MAAM,aAAa,CAAC;AACxD,kBAAY,IAAI,OAAO,UAAU,EAAE,MAAM,WAAW,CAAC;AACrD,kBAAY,IAAI,OAAO,KAAK,EAAE,MAAM,MAAM,CAAC;AAAA,IAC7C;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,OAAa;AACX,QAAI,KAAK,iBAAiB;AACxB,oBAAc,KAAK,eAAe;AAClC,WAAK,kBAAkB;AAAA,IACzB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,QAAc;AACZ,eAAW,WAAW,KAAK,SAAS,OAAO,GAAG;AAC5C,cAAQ,MAAM;AAAA,IAChB;AACA,eAAW,SAAS,KAAK,OAAO,OAAO,GAAG;AACxC,YAAM,MAAM;AAAA,IACd;AACA,eAAW,aAAa,KAAK,WAAW,OAAO,GAAG;AAChD,gBAAU,MAAM;AAAA,IAClB;AACA,SAAK,WAAW,MAAM;AAAA,EACxB;AAAA;AAAA;AAAA;AAAA,EAKA,eAAuB;AACrB,UAAM,QAAkB,CAAC;AAEzB,eAAW,UAAU,KAAK,cAAc,GAAG;AAEzC,UAAI,OAAO,aAAa;AACtB,cAAM,KAAK,UAAU,OAAO,IAAI,IAAI,OAAO,WAAW,EAAE;AAAA,MAC1D;AAGA,YAAM,KAAK,UAAU,OAAO,IAAI,IAAI,OAAO,IAAI,EAAE;AAGjD,UAAI,OAAO,SAAS,eAAe,OAAO,WAAW;AACnD,cAAM,IAAI,OAAO;AACjB,iBAAS,IAAI,GAAG,IAAI,EAAE,WAAW,QAAQ,KAAK;AAC5C,gBAAM,KAAK,GAAG,OAAO,IAAI,eAAe,EAAE,WAAW,CAAC,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,EAAE;AAAA,QAC5E;AACA,cAAM,KAAK,GAAG,OAAO,IAAI,sBAAsB,EAAE,OAAO,EAAE,WAAW,MAAM,CAAC,EAAE;AAC9E,cAAM,KAAK,GAAG,OAAO,IAAI,QAAQ,EAAE,GAAG,EAAE;AACxC,cAAM,KAAK,GAAG,OAAO,IAAI,UAAU,EAAE,KAAK,EAAE;AAAA,MAC9C,OAAO;AACL,mBAAW,SAAS,OAAO,QAAQ;AACjC,gBAAM,SAAS,OAAO,QAAQ,MAAM,MAAM,EACvC,IAAI,CAAC,CAAC,GAAG,CAAC,MAAM,GAAG,CAAC,KAAK,CAAC,GAAG,EAC7B,KAAK,GAAG;AACX,gBAAM,WAAW,SAAS,IAAI,MAAM,MAAM;AAC1C,gBAAM,KAAK,GAAG,OAAO,IAAI,GAAG,QAAQ,IAAI,MAAM,KAAK,EAAE;AAAA,QACvD;AAAA,MACF;AAEA,YAAM,KAAK,EAAE;AAAA,IACf;AAEA,WAAO,MAAM,KAAK,IAAI;AAAA,EACxB;AACF;AAMA,IAAI,kBAA2C;AAExC,SAAS,sBAA+C;AAC7D,SAAO;AACT;AAEO,SAAS,uBAAuB,QAAyD;AAC9F,oBAAkB,IAAI,iBAAiB,MAAM;AAC7C,SAAO;AACT;;;ACnrBA,SAAS,gBAAAC,sBAAoB;AAc7B,IAAMC,mBAA+C;AAAA,EACnD,OAAO;AAAA,EACP,OAAO;AAAA,EACP,MAAM;AAAA,EACN,MAAM;AAAA,EACN,OAAO;AAAA,EACP,OAAO;AACT;AAMO,IAAM,SAAN,MAAM,gBAAeD,eAAkC;AAAA,EACpD;AAAA,EACA,OAAoB,CAAC;AAAA,EACrB,UAAkB;AAAA,EAClB;AAAA,EAER,YAAY,SAAuC,CAAC,GAAG;AACrD,UAAM;AACN,SAAK,SAAS;AAAA,MACZ,aAAa,OAAO,eAAe;AAAA,MACnC,gBAAgB,OAAO;AAAA,MACvB,aAAa,OAAO,eAAe;AAAA,MACnC,SAAS,EAAE,SAAS,MAAM,SAAS,EAAE,MAAM,aAAa,OAAO,GAAG,aAAa,KAAK,GAAG,mBAAmB,KAAK,eAAe,KAAK,cAAc,KAAK,GAAG,OAAO,QAAQ;AAAA,MACxK,SAAS,EAAE,SAAS,MAAM,iBAAiB,KAAO,gBAAgB,CAAC,GAAG,GAAG,OAAO,QAAQ;AAAA,MACxF,SAAS;AAAA,QACP,SAAS;AAAA,QACT,aAAa;AAAA,QACb,qBAAqB;AAAA,QACrB,GAAG,OAAO;AAAA,MACZ;AAAA,MACA,UAAU,EAAE,YAAY,CAAC,GAAG,GAAG,OAAO,SAAS;AAAA,MAC/C,WAAW,EAAE,QAAQ,OAAU,SAAS,QAAW,MAAM,OAAU,GAAG,OAAO,UAAU;AAAA,IACzF;AAGA,gBAAY,MAAM,KAAK,QAAQ,GAAG,GAAK;AAAA,EACzC;AAAA;AAAA;AAAA;AAAA,EAKA,WAAW,SAAyC;AAClD,SAAK,iBAAiB;AAAA,EACxB;AAAA;AAAA;AAAA;AAAA,EAKA,YAAY,SAA+B;AACzC,UAAM,QAAQ,IAAI,QAAO;AAAA,MACvB,GAAG,KAAK;AAAA,MACR,aAAa,KAAK,OAAO;AAAA,IAC3B,CAAC;AACD,UAAM,WAAW,OAAO;AACxB,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,IACE,UACA,SACA,aAAwD,CAAC,GACnD;AACN,QAAI,CAAC,KAAK,OAAO,QAAQ,QAAS;AAGlC,UAAM,WAAWC,iBAAgB,KAAK,OAAO,QAAQ,WAAW;AAChE,UAAM,eAAeA,iBAAgB,QAAQ;AAC7C,QAAI,eAAe,SAAU;AAE7B,UAAM,SAAoB;AAAA,MACxB,WAAW,KAAK,IAAI;AAAA,MACpB;AAAA,MACA,MAAM;AAAA,MACN;AAAA,MACA,UAAU;AAAA,QACR,aAAa,KAAK,OAAO;AAAA,QACzB,aAAa,KAAK,OAAO;AAAA,MAC3B;AAAA,IACF;AAGA,QAAI,KAAK,OAAO,QAAQ,uBAAuB,KAAK,gBAAgB;AAClE,aAAO,UAAU,KAAK,eAAe;AACrC,aAAO,SAAS,KAAK,eAAe;AAAA,IACtC;AAGA,SAAK,KAAK,KAAK,MAAM;AAGrB,QAAI,KAAK,KAAK,SAAS,KAAK,SAAS;AACnC,WAAK,OAAO,KAAK,KAAK,MAAM,CAAC,KAAK,OAAO;AAAA,IAC3C;AAEA,SAAK,KAAK,gBAAgB,MAAM;AAGhC,QAAI,KAAK,OAAO,gBAAgB,eAAe;AAC7C,WAAK,gBAAgB,MAAM;AAAA,IAC7B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,SAAiB,aAAwD,CAAC,GAAS;AACvF,SAAK,IAAI,SAAS,SAAS,UAAU;AAAA,EACvC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,SAAiB,aAAwD,CAAC,GAAS;AACvF,SAAK,IAAI,SAAS,SAAS,UAAU;AAAA,EACvC;AAAA;AAAA;AAAA;AAAA,EAKA,KAAK,SAAiB,aAAwD,CAAC,GAAS;AACtF,SAAK,IAAI,QAAQ,SAAS,UAAU;AAAA,EACtC;AAAA;AAAA;AAAA;AAAA,EAKA,KAAK,SAAiB,aAAwD,CAAC,GAAS;AACtF,SAAK,IAAI,QAAQ,SAAS,UAAU;AAAA,EACtC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,SAAiB,OAAe,aAAwD,CAAC,GAAS;AACtG,UAAM,QAAQ,EAAE,GAAG,WAAW;AAC9B,QAAI,OAAO;AACT,YAAM,YAAY,IAAI,MAAM;AAC5B,YAAM,eAAe,IAAI,MAAM;AAC/B,YAAM,aAAa,IAAI,MAAM,SAAS;AAAA,IACxC;AACA,SAAK,IAAI,SAAS,SAAS,KAAK;AAAA,EAClC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,SAAiB,OAAe,aAAwD,CAAC,GAAS;AACtG,UAAM,QAAQ,EAAE,GAAG,WAAW;AAC9B,QAAI,OAAO;AACT,YAAM,YAAY,IAAI,MAAM;AAC5B,YAAM,eAAe,IAAI,MAAM;AAC/B,YAAM,aAAa,IAAI,MAAM,SAAS;AAAA,IACxC;AACA,SAAK,IAAI,SAAS,SAAS,KAAK;AAAA,EAClC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAA8B;AAClC,QAAI,UAAU,KAAK;AAGnB,QAAI,MAAM,SAAS;AACjB,gBAAU,QAAQ,OAAO,OAAK,EAAE,YAAY,MAAM,OAAO;AAAA,IAC3D;AAGA,QAAI,MAAM,QAAQ;AAChB,gBAAU,QAAQ,OAAO,OAAK,EAAE,WAAW,MAAM,MAAM;AAAA,IACzD;AAGA,QAAI,MAAM,aAAa;AACrB,gBAAU,QAAQ,OAAO,OAAK,EAAE,SAAS,gBAAgB,MAAM,WAAW;AAAA,IAC5E;AAGA,QAAI,MAAM,UAAU;AAClB,YAAM,WAAWA,iBAAgB,MAAM,QAAQ;AAC/C,gBAAU,QAAQ,OAAO,OAAKA,iBAAgB,EAAE,QAAQ,KAAK,QAAQ;AAAA,IACvE;AAGA,QAAI,MAAM,cAAc;AACtB,YAAM,SAAS,MAAM,aAAa,YAAY;AAC9C,gBAAU,QAAQ,OAAO,OAAK,EAAE,KAAK,YAAY,EAAE,SAAS,MAAM,CAAC;AAAA,IACrE;AAGA,QAAI,MAAM,WAAW;AACnB,gBAAU,QAAQ,OAAO,OAAK,EAAE,aAAa,MAAM,SAAU;AAAA,IAC/D;AACA,QAAI,MAAM,SAAS;AACjB,gBAAU,QAAQ,OAAO,OAAK,EAAE,aAAa,MAAM,OAAQ;AAAA,IAC7D;AAGA,UAAM,QAAQ,MAAM,SAAS;AAC7B,WAAO,QAAQ,MAAM,CAAC,KAAK;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,SAA8B;AACzC,WAAO,KAAK,KAAK,OAAO,OAAK,EAAE,YAAY,OAAO;AAAA,EACpD;AAAA;AAAA;AAAA;AAAA,EAKA,aAA0B;AACxB,WAAO,CAAC,GAAG,KAAK,IAAI;AAAA,EACtB;AAAA;AAAA;AAAA;AAAA,EAKA,WAIE;AACA,UAAM,aAA0C;AAAA,MAC9C,OAAO;AAAA,MACP,OAAO;AAAA,MACP,MAAM;AAAA,MACN,MAAM;AAAA,MACN,OAAO;AAAA,MACP,OAAO;AAAA,IACT;AAEA,UAAM,eAAe,KAAK,IAAI,IAAI;AAClC,QAAI,cAAc;AAElB,eAAW,OAAO,KAAK,MAAM;AAC3B,iBAAW,IAAI,QAAQ;AACvB,UAAI,IAAI,aAAa,cAAc;AACjC;AAAA,MACF;AAAA,IACF;AAEA,WAAO;AAAA,MACL,WAAW,KAAK,KAAK;AAAA,MACrB;AAAA,MACA,eAAe;AAAA,IACjB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKQ,gBAAgB,QAAyB;AAC/C,UAAM,YAAY,IAAI,KAAK,OAAO,SAAS,EAAE,YAAY;AACzD,UAAM,SAAS,IAAI,SAAS,MAAM,OAAO,QAAQ;AACjD,UAAM,YAAY,OAAO,UAAU,WAAW,OAAO,QAAQ,UAAU,GAAG,CAAC,CAAC,MAAM;AAElF,YAAQ,OAAO,UAAU;AAAA,MACvB,KAAK;AAAA,MACL,KAAK;AACH,gBAAQ,MAAM,GAAG,MAAM,GAAG,SAAS,IAAI,OAAO,IAAI,IAAI,OAAO,UAAU;AACvE;AAAA,MACF,KAAK;AACH,gBAAQ,KAAK,GAAG,MAAM,GAAG,SAAS,IAAI,OAAO,IAAI,IAAI,OAAO,UAAU;AACtE;AAAA,MACF,KAAK;AACH,gBAAQ,KAAK,GAAG,MAAM,GAAG,SAAS,IAAI,OAAO,IAAI,IAAI,OAAO,UAAU;AACtE;AAAA,MACF,KAAK;AAAA,MACL,KAAK;AACH,gBAAQ,MAAM,GAAG,MAAM,GAAG,SAAS,IAAI,OAAO,IAAI,IAAI,OAAO,UAAU;AACvE;AAAA,IACJ;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKQ,UAAgB;AACtB,UAAM,SAAS,KAAK,IAAI,IAAI,KAAK,OAAO,UAAU;AAClD,SAAK,OAAO,KAAK,KAAK,OAAO,OAAK,EAAE,aAAa,MAAM;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA,EAKA,QAAc;AACZ,SAAK,OAAO,CAAC;AAAA,EACf;AAAA;AAAA;AAAA;AAAA,EAKA,SAAsB;AACpB,WAAO,CAAC,GAAG,KAAK,IAAI;AAAA,EACtB;AAAA;AAAA;AAAA;AAAA,EAKA,WAAmB;AACjB,WAAO,KAAK,KAAK,IAAI,OAAK,KAAK,UAAU,CAAC,CAAC,EAAE,KAAK,IAAI;AAAA,EACxD;AACF;AAMA,IAAI,iBAAgC;AAE7B,SAAS,YAA2B;AACzC,SAAO;AACT;AAEO,SAAS,aAAa,QAA+C;AAC1E,mBAAiB,IAAI,OAAO,MAAM;AAClC,SAAO;AACT;;;ACnVA,SAAS,gBAAAC,sBAAoB;AAqBtB,IAAM,uBAAN,cAAmCC,eAAkC;AAAA,EAClE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EAER,YAAY,SAAuC,CAAC,GAAG;AACrD,UAAM;AAEN,SAAK,YAAY,KAAK,IAAI;AAC1B,SAAK,SAAS;AAAA,MACZ,aAAa,OAAO,eAAe;AAAA,MACnC,gBAAgB,OAAO;AAAA,MACvB,aAAa,OAAO,eAAe;AAAA,MACnC,SAAS;AAAA,QACP,SAAS;AAAA,QACT,SAAS,EAAE,MAAM,aAAa,OAAO,GAAG,aAAa,KAAK;AAAA,QAC1D,mBAAmB;AAAA,QACnB,eAAe;AAAA,QACf,cAAc;AAAA,QACd,GAAG,OAAO;AAAA,MACZ;AAAA,MACA,SAAS;AAAA,QACP,SAAS;AAAA,QACT,iBAAiB;AAAA,QACjB,gBAAgB,CAAC,GAAG,IAAI,IAAI,IAAI,KAAK,KAAK,KAAK,KAAM,MAAM,KAAM,GAAK;AAAA,QACtE,GAAG,OAAO;AAAA,MACZ;AAAA,MACA,SAAS;AAAA,QACP,SAAS;AAAA,QACT,aAAa;AAAA,QACb,qBAAqB;AAAA,QACrB,GAAG,OAAO;AAAA,MACZ;AAAA,MACA,UAAU,EAAE,YAAY,CAAC,GAAG,GAAG,OAAO,SAAS;AAAA,MAC/C,WAAW;AAAA,QACT,QAAQ,KAAK,KAAK,KAAK;AAAA,QACvB,SAAS,IAAI,KAAK,KAAK,KAAK;AAAA,QAC5B,MAAM,KAAK,KAAK,KAAK;AAAA,QACrB,GAAG,OAAO;AAAA,MACZ;AAAA,IACF;AAGA,SAAK,SAAS,aAAa,KAAK,MAAM;AACtC,SAAK,UAAU,uBAAuB,KAAK,MAAM;AACjD,SAAK,SAAS,aAAa,KAAK,MAAM;AAGtC,SAAK,OAAO,GAAG,gBAAgB,CAAC,SAAS,KAAK,KAAK,gBAAgB,IAAI,CAAC;AACxE,SAAK,OAAO,GAAG,cAAc,CAAC,SAAS,KAAK,KAAK,cAAc,IAAI,CAAC;AACpE,SAAK,OAAO,GAAG,mBAAmB,CAAC,UAAU,KAAK,KAAK,mBAAmB,KAAK,CAAC;AAEhF,SAAK,QAAQ,GAAG,mBAAmB,CAAC,WAAW,KAAK,KAAK,mBAAmB,MAAM,CAAC;AAEnF,SAAK,OAAO,GAAG,gBAAgB,CAAC,QAAQ,KAAK,KAAK,gBAAgB,GAAG,CAAC;AAGtE,SAAK,OAAO,KAAK,iCAAiC;AAAA,MAChD,aAAa,KAAK,OAAO;AAAA,MACzB,aAAa,KAAK,OAAO;AAAA,IAC3B,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,UAAU,MAAc,SAAoC;AAC1D,WAAO,KAAK,OAAO,UAAU,MAAM,OAAO;AAAA,EAC5C;AAAA;AAAA;AAAA;AAAA,EAKA,eAAe,MAAc,eAA6B,SAAqD;AAC7G,WAAO,KAAK,OAAO,eAAe,MAAM,eAAe,OAAO;AAAA,EAChE;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,MACJ,MACA,IACA,SACY;AACZ,WAAO,KAAK,OAAO,MAAM,MAAM,IAAI,OAAO;AAAA,EAC5C;AAAA;AAAA;AAAA;AAAA,EAKA,SAAS,SAA+B;AACtC,WAAO,KAAK,OAAO,SAAS,OAAO;AAAA,EACrC;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,OAA6C;AACxD,WAAO,KAAK,OAAO,aAAa,KAAK;AAAA,EACvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,QAAQ,MAAc,SAA+E;AACnG,WAAO,KAAK,QAAQ,QAAQ,MAAM,OAAc;AAAA,EAClD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,MAAc,SAA6E;AAC/F,WAAO,KAAK,QAAQ,MAAM,MAAM,OAAc;AAAA,EAChD;AAAA;AAAA;AAAA;AAAA,EAKA,UAAU,MAAc,SAAqG;AAC3H,WAAO,KAAK,QAAQ,UAAU,MAAM,OAAc;AAAA,EACpD;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,MAAc,OAAe,SAAiC,CAAC,GAAS;AACnF,UAAM,UAAU,KAAK,QAAQ,QAAQ,IAAI;AACzC,YAAQ,IAAI,QAAQ,KAAK;AAAA,EAC3B;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,OAA4C;AACvD,WAAO,KAAK,QAAQ,UAAU,MAAM,IAAI;AAAA,EAC1C;AAAA;AAAA;AAAA;AAAA,EAKA,gBAA8B;AAC5B,WAAO,KAAK,QAAQ,cAAc;AAAA,EACpC;AAAA;AAAA;AAAA;AAAA,EAKA,uBAA+B;AAC7B,WAAO,KAAK,QAAQ,aAAa;AAAA,EACnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,cAAc,SAAyC;AACrD,SAAK,OAAO,WAAW,OAAO;AAAA,EAChC;AAAA;AAAA;AAAA;AAAA,EAKA,SAAS,SAAiB,YAA8D;AACtF,SAAK,OAAO,MAAM,SAAS,UAAU;AAAA,EACvC;AAAA;AAAA;AAAA;AAAA,EAKA,SAAS,SAAiB,YAA8D;AACtF,SAAK,OAAO,MAAM,SAAS,UAAU;AAAA,EACvC;AAAA;AAAA;AAAA;AAAA,EAKA,QAAQ,SAAiB,YAA8D;AACrF,SAAK,OAAO,KAAK,SAAS,UAAU;AAAA,EACtC;AAAA;AAAA;AAAA;AAAA,EAKA,QAAQ,SAAiB,YAA8D;AACrF,SAAK,OAAO,KAAK,SAAS,UAAU;AAAA,EACtC;AAAA;AAAA;AAAA;AAAA,EAKA,SAAS,SAAiB,OAAe,YAA8D;AACrG,SAAK,OAAO,MAAM,SAAS,OAAO,UAAU;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA,EAKA,SAAS,SAAiB,OAAe,YAA8D;AACrG,SAAK,OAAO,MAAM,SAAS,OAAO,UAAU;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA,EAKA,UAAU,OAA8B;AACtC,WAAO,KAAK,OAAO,MAAM,KAAK;AAAA,EAChC;AAAA;AAAA;AAAA;AAAA,EAKA,aAA0B;AACxB,WAAO,KAAK,OAAO,WAAW;AAAA,EAChC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,aAAmC;AACjC,UAAM,aAAa,KAAK,OAAO,SAAS;AACxC,UAAM,iBAAiB,KAAK,QAAQ,WAAW;AAG/C,UAAM,SAAS,KAAK,aAAa,EAAE,OAAO,IAAK,CAAC;AAChD,UAAM,YAAY,OAAO,IAAI,OAAK,EAAE,YAAY,CAAC,EAAE,OAAO,OAAK,IAAI,CAAC;AACpE,UAAM,kBAAkB,UAAU,KAAK,CAAC,GAAG,MAAM,IAAI,CAAC;AAEtD,UAAM,gBAAgB,CAAC,KAAe,MAAc;AAClD,UAAI,IAAI,WAAW,EAAG,QAAO;AAC7B,YAAM,QAAQ,KAAK,KAAM,IAAI,MAAO,IAAI,MAAM,IAAI;AAClD,aAAO,IAAI,KAAK,IAAI,GAAG,KAAK,CAAC;AAAA,IAC/B;AAGA,UAAM,aAAa,oBAAI,IAAsD;AAC7E,eAAW,SAAS,QAAQ;AAC1B,YAAM,QAAQ,WAAW,IAAI,MAAM,WAAW,KAAK,EAAE,OAAO,GAAG,eAAe,EAAE;AAChF,YAAM;AACN,YAAM,iBAAiB,MAAM,YAAY;AACzC,iBAAW,IAAI,MAAM,aAAa,KAAK;AAAA,IACzC;AAEA,UAAM,cAAc,MAAM,KAAK,WAAW,QAAQ,CAAC,EAChD,IAAI,CAAC,CAAC,MAAM,IAAI,OAAO;AAAA,MACtB;AAAA,MACA,YAAY,KAAK;AAAA,MACjB,aAAa,KAAK,QAAQ,IAAI,KAAK,gBAAgB,KAAK,QAAQ;AAAA,IAClE,EAAE,EACD,KAAK,CAAC,GAAG,MAAM,EAAE,aAAa,EAAE,UAAU,EAC1C,MAAM,GAAG,EAAE;AAGd,UAAM,QAAQ,oBAAI,IAAsE;AACxF,eAAW,SAAS,QAAQ;AAC1B,YAAM,QAAQ,MAAM,IAAI,MAAM,aAAa,KAAK,EAAE,OAAO,GAAG,eAAe,GAAG,QAAQ,EAAE;AACxF,YAAM;AACN,YAAM,iBAAiB,MAAM,YAAY;AACzC,YAAM,UAAU,MAAM;AACtB,YAAM,IAAI,MAAM,eAAe,KAAK;AAAA,IACtC;AAEA,UAAM,gBAAgB,MAAM,KAAK,MAAM,QAAQ,CAAC,EAC7C,IAAI,CAAC,CAAC,MAAM,IAAI,OAAO;AAAA,MACtB;AAAA,MACA,YAAY,KAAK;AAAA,MACjB,aAAa,KAAK,QAAQ,IAAI,KAAK,gBAAgB,KAAK,QAAQ;AAAA,MAChE,WAAW,KAAK,QAAQ,IAAI,KAAK,SAAS,KAAK,QAAQ;AAAA,IACzD,EAAE,EACD,KAAK,CAAC,GAAG,MAAM,EAAE,aAAa,EAAE,UAAU,EAC1C,MAAM,GAAG,EAAE;AAEd,WAAO;AAAA,MACL,QAAQ;AAAA,QACN,aAAa,WAAW;AAAA,QACxB,YAAY,WAAW;AAAA,QACvB,WAAW,WAAW;AAAA,QACtB,aAAa,WAAW;AAAA,QACxB,aAAa,cAAc,iBAAiB,EAAE;AAAA,QAC9C,aAAa,cAAc,iBAAiB,EAAE;AAAA,QAC9C,aAAa,cAAc,iBAAiB,EAAE;AAAA,QAC9C;AAAA,QACA;AAAA,MACF;AAAA,MACA,SAAS;AAAA,MACT,QAAQ,KAAK,IAAI,IAAI,KAAK;AAAA,MAC1B,aAAa,KAAK,IAAI;AAAA,IACxB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,YAKE;AACA,UAAM,aAAa,KAAK,OAAO,SAAS;AACxC,UAAM,iBAAiB,KAAK,QAAQ,WAAW;AAC/C,UAAM,WAAW,KAAK,OAAO,SAAS;AAEtC,WAAO;AAAA,MACL,SAAS;AAAA,MACT,SAAS;AAAA,QACP,SAAS,KAAK,OAAO,QAAQ;AAAA,QAC7B,aAAa,WAAW;AAAA,MAC1B;AAAA,MACA,SAAS;AAAA,QACP,SAAS,KAAK,OAAO,QAAQ;AAAA,QAC7B,aAAa,eAAe;AAAA,MAC9B;AAAA,MACA,SAAS;AAAA,QACP,SAAS,KAAK,OAAO,QAAQ;AAAA,QAC7B,UAAU,SAAS;AAAA,MACrB;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,WAAiB;AACf,SAAK,OAAO,KAAK,qCAAqC;AACtD,SAAK,QAAQ,KAAK;AAClB,SAAK,mBAAmB;AAAA,EAC1B;AAAA;AAAA;AAAA;AAAA,EAKA,QAAc;AACZ,SAAK,OAAO,MAAM;AAClB,SAAK,QAAQ,MAAM;AACnB,SAAK,OAAO,MAAM;AAAA,EACpB;AAAA;AAAA;AAAA;AAAA,EAKA,YAAiC;AAC/B,WAAO,EAAE,GAAG,KAAK,OAAO;AAAA,EAC1B;AACF;AAMA,IAAI,wBAAqD;AAElD,SAAS,0BAAuD;AACrE,SAAO;AACT;AAEO,SAAS,2BAA2B,QAA6D;AACtG,0BAAwB,IAAI,qBAAqB,MAAM;AACvD,SAAO;AACT;;;AClZA,OAAO,aAAuC;AAC9C,OAAO,iBAAiB;AACxB,OAAO,sBAAsB;;;ACQ7B,eAAsB,sBACpB,SACA,KACe;AACf,QAAM,UAAU,kBAAkB;AAClC,QAAM,QAAQ,WAAW;AASzB,UAAQ,KAEL,uBAAuB,OAAO,KAAK,UAAU;AAC9C,UAAM,YAAY,IAAI;AAEtB,QAAI,CAAC,UAAU,UAAU,CAAC,UAAU,QAAQ,CAAC,UAAU,OAAO;AAC5D,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,+CAA+C;AAAA,IAC5E;AAEA,UAAM,QAAqB;AAAA,MACzB,GAAG;AAAA,MACH,IAAI,UAAU,MAAM,OAAO,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,GAAG,CAAC,CAAC;AAAA,MAC/E,WAAW,UAAU,cAAa,oBAAI,KAAK,GAAE,YAAY;AAAA,IAC3D;AAEA,UAAM,QAAQ,gBAAgB,KAAK;AACnC,QAAI,YAAY,EAAE,QAAQ,MAAM,QAAQ,MAAM,MAAM,KAAK;AAEzD,WAAO,EAAE,IAAI,MAAM,IAAI,MAAM,GAAG;AAAA,EAClC,CAAC;AAKD,UAAQ,IAEL,uBAAuB,OAAO,KAAK,UAAU;AAC9C,UAAM,WAAW,IAAI,MAAM;AAC3B,UAAM,QAAQ,WAAW,IAAI,KAAK,QAAQ,IAAI,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,KAAK,GAAI;AAEvF,QAAI,MAAM,MAAM,QAAQ,CAAC,GAAG;AAC1B,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,kCAAkC;AAAA,IAC/D;AAEA,QAAI,SAAS,MAAM,QAAQ,qBAAqB,KAAK;AAGrD,QAAI,IAAI,MAAM,QAAQ;AACpB,eAAS,OAAO,OAAO,CAAC,MAAM,EAAE,WAAW,IAAI,MAAM,MAAM;AAAA,IAC7D;AAGA,QAAI,IAAI,MAAM,MAAM;AAClB,eAAS,OAAO,OAAO,CAAC,MAAM,EAAE,SAAS,IAAI,MAAM,IAAI;AAAA,IACzD;AAGA,UAAM,QAAQ,SAAS,IAAI,MAAM,SAAS,OAAO,EAAE;AACnD,aAAS,OAAO,MAAM,GAAG,KAAK;AAE9B,WAAO,EAAE,IAAI,MAAM,OAAO,OAAO,QAAQ,OAAO;AAAA,EAClD,CAAC;AAGD,UAAQ,KAEL,2BAA2B,OAAO,KAAK,UAAU;AAClD,UAAM,YAAY,IAAI;AACtB,QAAI,CAAC,UAAU,UAAU,CAAC,UAAU,QAAQ,CAAC,UAAU,OAAO;AAC5D,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,+CAA+C;AAAA,IAC5E;AACA,UAAM,QAAqB;AAAA,MACzB,GAAG;AAAA,MACH,IAAI,UAAU,MAAM,OAAO,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,GAAG,CAAC,CAAC;AAAA,MAC/E,WAAW,UAAU,cAAa,oBAAI,KAAK,GAAE,YAAY;AAAA,IAC3D;AACA,UAAM,QAAQ,gBAAgB,KAAK;AACnC,QAAI,YAAY,EAAE,QAAQ,MAAM,QAAQ,MAAM,MAAM,KAAK;AACzD,WAAO,EAAE,IAAI,MAAM,IAAI,MAAM,GAAG;AAAA,EAClC,CAAC;AAED,UAAQ,IAAyC,2BAA2B,OAAO,QAAQ;AACzF,UAAM,WAAW,IAAI,MAAM;AAC3B,UAAM,QAAQ,WAAW,IAAI,KAAK,QAAQ,IAAI,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,KAAK,GAAI;AACvF,QAAI,MAAM,MAAM,QAAQ,CAAC,GAAG;AAC1B,aAAO,EAAE,IAAI,OAAO,OAAO,kCAAkC;AAAA,IAC/D;AACA,UAAM,SAAS,MAAM,QAAQ,qBAAqB,KAAK;AACvD,WAAO,EAAE,IAAI,MAAM,OAAO,OAAO,QAAQ,OAAO;AAAA,EAClD,CAAC;AASD,UAAQ,KAEL,qBAAqB,OAAO,KAAK,UAAU;AAC5C,UAAM,UAAU,IAAI;AAEpB,QAAI,CAAC,QAAQ,YAAY,CAAC,QAAQ,SAAS,QAAQ,UAAU,QAAW;AACtE,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,kDAAkD;AAAA,IAC/E;AAEA,UAAM,MAAiB;AAAA,MACrB,GAAG;AAAA,MACH,IAAI,QAAQ,MAAM,OAAO,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,GAAG,CAAC,CAAC;AAAA,MAC7E,WAAW,QAAQ,cAAa,oBAAI,KAAK,GAAE,YAAY;AAAA,IACzD;AAEA,UAAM,QAAQ,cAAc,GAAG;AAE/B,WAAO,EAAE,IAAI,MAAM,IAAI,IAAI,GAAG;AAAA,EAChC,CAAC;AAKD,UAAQ,IAEL,qBAAqB,OAAO,KAAK,UAAU;AAC5C,UAAM,WAAW,IAAI,MAAM;AAC3B,UAAM,QAAQ,WAAW,IAAI,KAAK,QAAQ,IAAI,IAAI,KAAK,KAAK,IAAI,IAAI,IAAI,KAAK,KAAK,KAAK,GAAI;AAE3F,QAAI,MAAM,MAAM,QAAQ,CAAC,GAAG;AAC1B,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,kCAAkC;AAAA,IAC/D;AAEA,QAAI,OAAO,MAAM,QAAQ,mBAAmB,KAAK;AAEjD,QAAI,IAAI,MAAM,UAAU;AACtB,aAAO,KAAK,OAAO,CAAC,MAAM,EAAE,aAAa,IAAI,MAAM,QAAQ;AAAA,IAC7D;AAEA,UAAM,QAAQ,SAAS,IAAI,MAAM,SAAS,MAAM,EAAE;AAClD,WAAO,KAAK,MAAM,GAAG,KAAK;AAE1B,WAAO,EAAE,IAAI,MAAM,OAAO,KAAK,QAAQ,KAAK;AAAA,EAC9C,CAAC;AASD,UAAQ,KAEL,uBAAuB,OAAO,KAAK,UAAU;AAC9C,UAAM,YAAY,IAAI;AAEtB,QAAI,CAAC,UAAU,WAAW,CAAC,UAAU,gBAAgB;AACnD,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,mDAAmD;AAAA,IAChF;AAEA,UAAM,QAAsB;AAAA,MAC1B,GAAG;AAAA,MACH,IAAI,UAAU,MAAM,SAAS,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,GAAG,CAAC,CAAC;AAAA,MACjF,WAAW,UAAU,cAAa,oBAAI,KAAK,GAAE,YAAY;AAAA,IAC3D;AAEA,UAAM,QAAQ,iBAAiB,KAAK;AAEpC,WAAO,EAAE,IAAI,MAAM,IAAI,MAAM,IAAI,MAAM;AAAA,EACzC,CAAC;AAKD,UAAQ,IAEL,uBAAuB,OAAO,QAAQ;AAEvC,UAAM,SAAS,MAAM,QAAQ,kBAAkB;AAG/C,QAAI,WAAW;AACf,QAAI,IAAI,MAAM,WAAW;AACvB,iBAAW,SAAS,OAAO,CAAC,MAAM,EAAE,mBAAmB,IAAI,MAAM,SAAS;AAAA,IAC5E;AAEA,UAAM,QAAQ,SAAS,IAAI,MAAM,SAAS,MAAM,EAAE;AAClD,eAAW,SAAS,MAAM,GAAG,KAAK;AAElC,WAAO,EAAE,IAAI,MAAM,OAAO,SAAS,QAAQ,QAAQ,SAAS;AAAA,EAC9D,CAAC;AAKD,UAAQ,IAAgC,2BAA2B,OAAO,KAAK,UAAU;AACvF,UAAM,QAAQ,MAAM,QAAQ,SAAS,IAAI,OAAO,EAAE;AAElD,QAAI,CAAC,OAAO;AACV,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,kBAAkB;AAAA,IAC/C;AAEA,WAAO,EAAE,IAAI,MAAM,MAAM;AAAA,EAC3B,CAAC;AASD,UAAQ,IAEL,yBAAyB,OAAO,QAAQ;AAEzC,UAAM,gBAAgB,MAAM,QAAQ,kBAAkB;AACtD,UAAM,WAA6B,CAAC;AAEpC,eAAW,SAAS,eAAe;AACjC,YAAM,UAAU,MAAM,QAAQ,oBAAoB,MAAM,EAAE;AAC1D,UAAI,SAAS;AACX,YAAI,CAAC,IAAI,MAAM,UAAU,QAAQ,WAAW,IAAI,MAAM,QAAQ;AAC5D,mBAAS,KAAK,OAAO;AAAA,QACvB;AAAA,MACF;AAAA,IACF;AAEA,UAAM,QAAQ,SAAS,IAAI,MAAM,SAAS,MAAM,EAAE;AAClD,WAAO,EAAE,IAAI,MAAM,OAAO,SAAS,QAAQ,UAAU,SAAS,MAAM,GAAG,KAAK,EAAE;AAAA,EAChF,CAAC;AAKD,UAAQ;AAAA,IACN;AAAA,IACA,OAAO,KAAK,UAAU;AACpB,YAAM,UAAU,MAAM,QAAQ,oBAAoB,IAAI,OAAO,OAAO;AAEpE,UAAI,CAAC,SAAS;AACZ,cAAM,KAAK,GAAG;AACd,eAAO,EAAE,IAAI,OAAO,OAAO,mCAAmC;AAAA,MAChE;AAEA,aAAO,EAAE,IAAI,MAAM,QAAQ;AAAA,IAC7B;AAAA,EACF;AAKA,UAAQ,MAGL,oCAAoC,OAAO,KAAK,UAAU;AAC3D,UAAM,EAAE,QAAQ,cAAc,IAAI,IAAI;AACtC,UAAM,gBAAgB,CAAC,SAAS,oBAAoB,qBAAqB,WAAW;AAEpF,QAAI,CAAC,cAAc,SAAS,MAAM,GAAG;AACnC,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,mCAAmC,cAAc,KAAK,IAAI,CAAC,GAAG;AAAA,IAC3F;AAIA,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,SAAS,6BAA6B,MAAM;AAAA,MAC5C,eAAe,iBAAiB;AAAA,IAClC;AAAA,EACF,CAAC;AASD,UAAQ,KAGL,sCAAsC,OAAO,KAAK,UAAU;AAC7D,UAAM,EAAE,UAAU,IAAI,IAAI;AAC1B,UAAM,EAAE,UAAU,OAAO,IAAI,IAAI;AAGjC,UAAM,SAAS,MAAM,QAAQ,iCAAiC,SAAS;AACvE,QAAI,CAAC,QAAQ;AACX,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,iDAAiD;AAAA,IAC9E;AAGA,UAAM,sBAAsB,uBAAuB,EAAE,OAAO,CAAC;AAC7D,UAAM,UAAU,MAAM,oBAAoB,WAAW,QAAQ,QAAQ;AAGrE,UAAM,aAAa,QAAQ,OAAO,CAAC,MAAM,EAAE,OAAO;AAClD,UAAM,SAAS,QAAQ,OAAO,CAAC,MAAM,CAAC,EAAE,OAAO;AAE/C,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,SAAS,2BAA2B,WAAW,MAAM,gBAAgB,OAAO,MAAM;AAAA,MAClF;AAAA,MACA;AAAA,MACA,OAAO;AAAA,QACL,WAAW,QAAQ;AAAA,UAAO,CAAC,MACzB,CAAC,QAAQ,YAAY,UAAU,UAAU,SAAS,YAAY,UAAU,OAAO,OAAO,EAAE,SAAS,EAAE,OAAO;AAAA,QAC5G;AAAA,MACF;AAAA,MACA,OAAO;AAAA,QACL,mBAAmB,QAAQ;AAAA,UAAO,CAAC,MACjC,CAAC,WAAW,YAAY,QAAQ,EAAE,SAAS,EAAE,OAAO;AAAA,QACtD;AAAA,MACF;AAAA,IACF;AAAA,EACF,CAAC;AAKD,UAAQ;AAAA,IACN;AAAA,IACA,OAAO,KAAK,UAAU;AACpB,YAAM,EAAE,UAAU,IAAI,IAAI;AAG1B,YAAM,SAAS,MAAM,QAAQ,iCAAiC,SAAS;AACvE,UAAI,CAAC,QAAQ;AACX,cAAM,KAAK,GAAG;AACd,eAAO,EAAE,IAAI,OAAO,OAAO,gCAAgC;AAAA,MAC7D;AAGA,YAAM,sBAAsB,uBAAuB;AACnD,YAAM,WAAW,oBAAoB,YAAY,OAAO,EAAE;AAE1D,aAAO;AAAA,QACL,IAAI;AAAA,QACJ;AAAA,QACA,UAAU,OAAO;AAAA,QACjB,QAAQ,OAAO;AAAA,QACf;AAAA,QACA,UAAU;AAAA,UACR,gBAAgB,CAAC,QAAQ,YAAY,UAAU,UAAU,SAAS,YAAY,UAAU,OAAO,OAAO;AAAA,UACtG,eAAe,CAAC,WAAW,YAAY,QAAQ;AAAA,QACjD;AAAA,MACF;AAAA,IACF;AAAA,EACF;AASA,UAAQ,KAAK,qCAAqC,YAAY;AAC5D,QAAI;AACF,YAAM,2BAA2B;AACjC,aAAO,EAAE,IAAI,MAAM,SAAS,qCAAqC;AAAA,IACnE,SAAS,OAAO;AACd,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO;AAAA,QACP,SAAS,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK;AAAA,MAChE;AAAA,IACF;AAAA,EACF,CAAC;AAKD,UAAQ,KAAK,mCAAmC,YAAY;AAC1D,QAAI;AACF,YAAM,6BAA6B;AACnC,aAAO,EAAE,IAAI,MAAM,SAAS,+BAA+B;AAAA,IAC7D,SAAS,OAAO;AACd,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO;AAAA,QACP,SAAS,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK;AAAA,MAChE;AAAA,IACF;AAAA,EACF,CAAC;AAKD,UAAQ,KAAK,sCAAsC,YAAY;AAC7D,QAAI;AAEF,YAAM,2BAA2B;AAGjC,YAAM,6BAA6B;AAEnC,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,SAAS;AAAA,QACT,OAAO,CAAC,oBAAoB,sBAAsB,oBAAoB;AAAA,MACxE;AAAA,IACF,SAAS,OAAO;AACd,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO;AAAA,QACP,SAAS,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK;AAAA,MAChE;AAAA,IACF;AAAA,EACF,CAAC;AASD,UAAQ,IAEL,wBAAwB,OAAO,QAAQ;AACxC,UAAM,SAAS,IAAI,MAAM,UAAU;AACnC,UAAM,UAAU,IAAI,MAAM;AAG1B,WAAO;AAAA,MACL,IAAI;AAAA,MACJ;AAAA,MACA,SAAS,WAAW;AAAA,MACpB,SAAS;AAAA,QACP,eAAe;AAAA,QACf,YAAY;AAAA,QACZ,iBAAiB;AAAA,QACjB,mBAAmB;AAAA,QACnB,uBAAuB,CAAC;AAAA,QACxB,uBAAuB,CAAC;AAAA,MAC1B;AAAA,MACA,MAAM;AAAA,IACR;AAAA,EACF,CAAC;AAKD,UAAQ,IAAI,gCAAgC,YAAY;AACtD,UAAM,gBAAgB,MAAM,QAAQ,kBAAkB;AACtD,UAAM,UAAU,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,KAAK,GAAI;AACzD,UAAM,eAAe,MAAM,QAAQ,qBAAqB,OAAO;AAE/D,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,UAAU;AAAA,QACR,eAAe,aAAa;AAAA,QAC5B,eAAe,cAAc;AAAA,QAC7B,eAAe;AAAA;AAAA,QACf,gBAAgB;AAAA,QAChB,WAAW;AAAA,QACX,oBAAoB;AAAA,MACtB;AAAA,MACA,UAAU;AAAA,QACR,gBAAgB,CAAC,QAAQ,YAAY,UAAU,UAAU,SAAS,YAAY,UAAU,OAAO,OAAO;AAAA,QACtG,eAAe,CAAC,WAAW,YAAY,QAAQ;AAAA,MACjD;AAAA,IACF;AAAA,EACF,CAAC;AACH;;;AC9cA,eAAe,YACb,SACA,OACe;AAEf,QAAM,SAAS,QAAQ,QAAQ,WAAW;AAE1C,MAAI,CAAC,QAAQ;AACX,UAAM,KAAK,GAAG,EAAE,KAAK,EAAE,IAAI,OAAO,OAAO,0BAA0B,CAAC;AACpE;AAAA,EACF;AAEA,UAAQ,SAAS;AACnB;AAEA,eAAe,qBACb,SACA,OACe;AACf,QAAM,YAAY,SAAS,KAAK;AAChC,MAAI,MAAM,KAAM;AAEhB,QAAM,QAAS,QAAQ,OAAe,SAAS,QAAQ,QAAQ,UAAU;AAEzE,MAAI,CAAC,OAAO;AACV,UAAM,KAAK,GAAG,EAAE,KAAK,EAAE,IAAI,OAAO,OAAO,2BAA2B,CAAC;AACrE;AAAA,EACF;AAEA,QAAM,OAAO,eAAe;AAC5B,QAAM,SAAS,KAAK,UAAU,OAAO,QAAQ,MAAO;AAEpD,MAAI,CAAC,QAAQ;AACX,UAAM,KAAK,GAAG,EAAE,KAAK,EAAE,IAAI,OAAO,OAAO,oCAAoC,CAAC;AAC9E;AAAA,EACF;AAEA,UAAQ,QAAQ;AAClB;AAEA,SAAS,kBAAkB,YAAwB;AACjD,SAAO,OAAO,SAA+B,UAAuC;AAClF,UAAM,qBAAqB,SAAS,KAAK;AACzC,QAAI,MAAM,KAAM;AAEhB,UAAM,OAAO,eAAe;AAC5B,UAAM,gBAAgB,KAAK,cAAc,QAAQ,QAAS,QAAQ,OAAQ,UAAU;AAEpF,QAAI,CAAC,eAAe;AAClB,YAAM,KAAK,GAAG,EAAE,KAAK;AAAA,QACnB,IAAI;AAAA,QACJ,OAAO,sBAAsB,UAAU;AAAA,MACzC,CAAC;AAAA,IACH;AAAA,EACF;AACF;AAuBA,eAAsB,kBAAkB,SAAyC;AAC/E,QAAM,OAAO,eAAe;AAS5B,UAAQ,KAOL,aAAa;AAAA,IACd,YAAY;AAAA,EACd,GAAG,OAAO,SAA+B,UAAU;AACjD,QAAI;AACF,YAAM,QAAQ,gBAAgB,MAAM,QAAQ,IAAI;AAChD,YAAM,MAAM,MAAM,KAAK,mBAAmB;AAAA,QACxC,GAAG;AAAA,QACH,WAAW,QAAQ;AAAA,MACrB,GAAG,QAAQ,MAAO;AAElB,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,cAAc;AAAA,UACZ,IAAI,IAAI;AAAA,UACR,MAAM,IAAI;AAAA,UACV,MAAM,IAAI;AAAA,UACV,aAAa,IAAI;AAAA,UACjB,MAAM,IAAI;AAAA,UACV,WAAW,IAAI;AAAA,QACjB;AAAA,MACF;AAAA,IACF,SAAS,OAAO;AACd,YAAM,KAAK,GAAG;AACd,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO,iBAAiB,QAAQ,MAAM,UAAU;AAAA,MAClD;AAAA,IACF;AAAA,EACF,CAAC;AAKD,UAAQ,IAAI,aAAa;AAAA,IACvB,YAAY;AAAA,EACd,GAAG,OAAO,YAAkC;AAC1C,UAAM,OAAO,KAAK,qBAAqB,QAAQ,MAAO;AAEtD,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,OAAO,KAAK;AAAA,MACZ,eAAe,KAAK,IAAI,CAAC,SAAS;AAAA,QAChC,IAAI,IAAI;AAAA,QACR,MAAM,IAAI;AAAA,QACV,MAAM,IAAI;AAAA,QACV,MAAM,IAAI;AAAA,QACV,WAAW,IAAI;AAAA,MACjB,EAAE;AAAA,IACJ;AAAA,EACF,CAAC;AAKD,UAAQ,IAAmC,oBAAoB;AAAA,IAC7D,YAAY;AAAA,EACd,GAAG,OAAO,SAA+B,UAAU;AACjD,UAAM,MAAM,KAAK,gBAAgB,QAAQ,KAAM;AAE/C,QAAI,CAAC,KAAK;AACR,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,yBAAyB;AAAA,IACtD;AAEA,UAAM,SAAS,KAAK,UAAU,QAAQ,OAAQ,QAAQ,MAAO;AAE7D,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,cAAc;AAAA,QACZ,IAAI,IAAI;AAAA,QACR,MAAM,IAAI;AAAA,QACV,MAAM,IAAI;AAAA,QACV,aAAa,IAAI;AAAA,QACjB,MAAM,IAAI;AAAA,QACV,UAAU,IAAI;AAAA,QACd,WAAW,IAAI;AAAA,QACf,WAAW,IAAI;AAAA,MACjB;AAAA,MACA,YAAY;AAAA,QACV,MAAM,QAAQ;AAAA,QACd,UAAU,QAAQ;AAAA,MACpB;AAAA,IACF;AAAA,EACF,CAAC;AAKD,UAAQ,MASL,oBAAoB;AAAA,IACrB,YAAY,kBAAkB,qBAAqB;AAAA,EACrD,GAAG,OAAO,SAA+B,UAAU;AACjD,QAAI;AACF,YAAM,UAAU,gBAAgB,MAAM,QAAQ,IAAI;AAClD,YAAM,MAAM,MAAM,KAAK,mBAAmB,QAAQ,OAAQ,OAAO;AAEjE,UAAI,CAAC,KAAK;AACR,cAAM,KAAK,GAAG;AACd,eAAO,EAAE,IAAI,OAAO,OAAO,yBAAyB;AAAA,MACtD;AAEA,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,cAAc;AAAA,UACZ,IAAI,IAAI;AAAA,UACR,MAAM,IAAI;AAAA,UACV,MAAM,IAAI;AAAA,UACV,aAAa,IAAI;AAAA,UACjB,WAAW,IAAI;AAAA,QACjB;AAAA,MACF;AAAA,IACF,SAAS,OAAO;AACd,YAAM,KAAK,GAAG;AACd,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO,iBAAiB,QAAQ,MAAM,UAAU;AAAA,MAClD;AAAA,IACF;AAAA,EACF,CAAC;AAKD,UAAQ,OAAsC,oBAAoB;AAAA,IAChE,YAAY,kBAAkB,qBAAqB;AAAA,EACrD,GAAG,OAAO,SAA+B,UAAU;AACjD,UAAM,UAAU,MAAM,KAAK,mBAAmB,QAAQ,KAAM;AAE5D,QAAI,CAAC,SAAS;AACZ,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,yBAAyB;AAAA,IACtD;AAEA,WAAO,EAAE,IAAI,MAAM,SAAS,uBAAuB;AAAA,EACrD,CAAC;AASD,UAAQ,IAAmC,4BAA4B;AAAA,IACrE,YAAY,kBAAkB,aAAa;AAAA,EAC7C,GAAG,OAAO,YAAkC;AAC1C,UAAM,UAAU,KAAK,cAAc,QAAQ,KAAM;AAEjD,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,OAAO,QAAQ;AAAA,MACf,SAAS,QAAQ,IAAI,CAAC,OAAO;AAAA,QAC3B,IAAI,EAAE;AAAA,QACN,QAAQ,EAAE;AAAA,QACV,OAAO,EAAE;AAAA,QACT,aAAa,EAAE;AAAA,QACf,WAAW,EAAE;AAAA,QACb,MAAM,EAAE;AAAA,QACR,UAAU,EAAE;AAAA,QACZ,cAAc,EAAE;AAAA,MAClB,EAAE;AAAA,IACJ;AAAA,EACF,CAAC;AAKD,UAAQ;AAAA,IACN;AAAA,IACA,EAAE,YAAY,kBAAkB,aAAa,EAAE;AAAA,IAC/C,OAAO,SAA+B,UAAU;AAC9C,YAAM,SAAS,KAAK,UAAU,QAAQ,OAAQ,QAAQ,OAAO,MAAM;AAEnE,UAAI,CAAC,QAAQ;AACX,cAAM,KAAK,GAAG;AACd,eAAO,EAAE,IAAI,OAAO,OAAO,mBAAmB;AAAA,MAChD;AAEA,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,QAAQ;AAAA,UACN,IAAI,OAAO;AAAA,UACX,QAAQ,OAAO;AAAA,UACf,OAAO,OAAO;AAAA,UACd,aAAa,OAAO;AAAA,UACpB,WAAW,OAAO;AAAA,UAClB,MAAM,OAAO;AAAA,UACb,mBAAmB,OAAO;AAAA,UAC1B,QAAQ,OAAO;AAAA,UACf,WAAW,OAAO;AAAA,UAClB,UAAU,OAAO;AAAA,UACjB,cAAc,OAAO;AAAA,QACvB;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAKA,UAAQ;AAAA,IAIN;AAAA,IACA,EAAE,YAAY,kBAAkB,eAAe,EAAE;AAAA,IACjD,OAAO,SAA+B,UAAU;AAC9C,UAAI;AAEF,YACE,QAAQ,OAAO,WAAW,QAAQ,UAClC,QAAQ,KAAK,QACb,QAAQ,KAAK,SAAS,SACtB;AACA,gBAAMC,UAAS,KAAK,UAAU,QAAQ,OAAQ,QAAQ,MAAO;AAC7D,cAAIA,SAAQ,SAAS,SAAS;AAC5B,kBAAM,KAAK,GAAG;AACd,mBAAO,EAAE,IAAI,OAAO,OAAO,oDAAoD;AAAA,UACjF;AAAA,QACF;AAEA,cAAM,UAAU,mBAAmB,MAAM,QAAQ,IAAI;AACrD,cAAM,SAAS,MAAM,KAAK;AAAA,UACxB,QAAQ;AAAA,UACR,QAAQ,OAAO;AAAA,UACf;AAAA,QACF;AAEA,YAAI,CAAC,QAAQ;AACX,gBAAM,KAAK,GAAG;AACd,iBAAO,EAAE,IAAI,OAAO,OAAO,mBAAmB;AAAA,QAChD;AAEA,eAAO;AAAA,UACL,IAAI;AAAA,UACJ,QAAQ;AAAA,YACN,IAAI,OAAO;AAAA,YACX,QAAQ,OAAO;AAAA,YACf,MAAM,OAAO;AAAA,YACb,mBAAmB,OAAO;AAAA,UAC5B;AAAA,QACF;AAAA,MACF,SAAS,OAAO;AACd,cAAM,KAAK,GAAG;AACd,eAAO;AAAA,UACL,IAAI;AAAA,UACJ,OAAO,iBAAiB,QAAQ,MAAM,UAAU;AAAA,QAClD;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,EAAE,YAAY,kBAAkB,eAAe,EAAE;AAAA,IACjD,OAAO,SAA+B,UAAU;AAE9C,UAAI,QAAQ,OAAO,WAAW,QAAQ,QAAQ;AAC5C,cAAM,KAAK,GAAG;AACd,eAAO,EAAE,IAAI,OAAO,OAAO,0DAA0D;AAAA,MACvF;AAEA,UAAI;AACF,cAAM,UAAU,MAAM,KAAK,aAAa,QAAQ,OAAQ,QAAQ,OAAO,MAAM;AAE7E,YAAI,CAAC,SAAS;AACZ,gBAAM,KAAK,GAAG;AACd,iBAAO,EAAE,IAAI,OAAO,OAAO,mBAAmB;AAAA,QAChD;AAEA,eAAO,EAAE,IAAI,MAAM,SAAS,iBAAiB;AAAA,MAC/C,SAAS,OAAO;AACd,cAAM,KAAK,GAAG;AACd,eAAO;AAAA,UACL,IAAI;AAAA,UACJ,OAAO,iBAAiB,QAAQ,MAAM,UAAU;AAAA,QAClD;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAKA,UAAQ,KAAoC,0BAA0B;AAAA,IACpE,YAAY;AAAA,EACd,GAAG,OAAO,SAA+B,UAAU;AACjD,QAAI;AACF,YAAM,UAAU,MAAM,KAAK,aAAa,QAAQ,OAAQ,QAAQ,MAAO;AAEvE,UAAI,CAAC,SAAS;AACZ,cAAM,KAAK,GAAG;AACd,eAAO,EAAE,IAAI,OAAO,OAAO,+BAA+B;AAAA,MAC5D;AAEA,aAAO,EAAE,IAAI,MAAM,SAAS,oBAAoB;AAAA,IAClD,SAAS,OAAO;AACd,YAAM,KAAK,GAAG;AACd,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO,iBAAiB,QAAQ,MAAM,UAAU;AAAA,MAClD;AAAA,IACF;AAAA,EACF,CAAC;AASD,UAAQ,IAAmC,4BAA4B;AAAA,IACrE,YAAY,kBAAkB,aAAa;AAAA,EAC7C,GAAG,OAAO,YAAkC;AAC1C,UAAM,UAAU,KAAK,cAAc,QAAQ,OAAQ,IAAI;AAEvD,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,OAAO,QAAQ;AAAA,MACf,SAAS,QAAQ,IAAI,CAAC,OAAO;AAAA,QAC3B,IAAI,EAAE;AAAA,QACN,OAAO,EAAE;AAAA,QACT,MAAM,EAAE;AAAA,QACR,QAAQ,EAAE;AAAA,QACV,WAAW,EAAE;AAAA,QACb,WAAW,EAAE;AAAA,QACb,SAAS,EAAE;AAAA,MACb,EAAE;AAAA,IACJ;AAAA,EACF,CAAC;AAKD,UAAQ;AAAA,IAIN;AAAA,IACA,EAAE,YAAY,kBAAkB,eAAe,EAAE;AAAA,IACjD,OAAO,SAA+B,UAAU;AAC9C,UAAI;AACF,cAAM,QAAQ,mBAAmB,MAAM,QAAQ,IAAI;AACnD,cAAM,SAAS,MAAM,KAAK;AAAA,UACxB,QAAQ;AAAA,UACR;AAAA,UACA,QAAQ;AAAA,QACV;AAIA,eAAO;AAAA,UACL,IAAI;AAAA,UACJ,QAAQ;AAAA,YACN,IAAI,OAAO;AAAA,YACX,OAAO,OAAO;AAAA,YACd,MAAM,OAAO;AAAA,YACb,WAAW,OAAO;AAAA;AAAA,YAElB,WAAW,+BAA+B,OAAO,KAAK;AAAA,UACxD;AAAA,QACF;AAAA,MACF,SAAS,OAAO;AACd,cAAM,KAAK,GAAG;AACd,eAAO;AAAA,UACL,IAAI;AAAA,UACJ,OAAO,iBAAiB,QAAQ,MAAM,UAAU;AAAA,QAClD;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,EAAE,YAAY,kBAAkB,eAAe,EAAE;AAAA,IACjD,OAAO,SAA+B,UAAU;AAC9C,YAAM,UAAU,MAAM,KAAK,aAAa,QAAQ,OAAO,QAAQ;AAE/D,UAAI,CAAC,SAAS;AACZ,cAAM,KAAK,GAAG;AACd,eAAO,EAAE,IAAI,OAAO,OAAO,wCAAwC;AAAA,MACrE;AAEA,aAAO,EAAE,IAAI,MAAM,SAAS,iBAAiB;AAAA,IAC/C;AAAA,EACF;AAKA,UAAQ,KAEL,uBAAuB;AAAA,IACxB,YAAY;AAAA,EACd,GAAG,OAAO,SAA+B,UAAU;AACjD,UAAM,EAAE,OAAO,YAAY,IAAI,QAAQ;AAEvC,QAAI,CAAC,OAAO;AACV,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,iBAAiB;AAAA,IAC9C;AAEA,QAAI;AAEF,YAAM,SAAS,KAAK,iBAAiB,KAAK;AAC1C,UAAI,CAAC,QAAQ;AACX,cAAM,KAAK,GAAG;AACd,eAAO,EAAE,IAAI,OAAO,OAAO,4BAA4B;AAAA,MACzD;AAEA,YAAM,SAAS,MAAM,KAAK;AAAA,QACxB;AAAA,QACA,QAAQ;AAAA,QACR,OAAO;AAAA,QACP;AAAA,MACF;AAEA,YAAM,MAAM,KAAK,gBAAgB,OAAO,KAAK;AAE7C,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,SAAS;AAAA,QACT,cAAc;AAAA,UACZ,IAAI,KAAK;AAAA,UACT,MAAM,KAAK;AAAA,UACX,MAAM,KAAK;AAAA,QACb;AAAA,QACA,YAAY;AAAA,UACV,MAAM,OAAO;AAAA,UACb,UAAU,OAAO;AAAA,QACnB;AAAA,MACF;AAAA,IACF,SAAS,OAAO;AACd,YAAM,KAAK,GAAG;AACd,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO,iBAAiB,QAAQ,MAAM,UAAU;AAAA,MAClD;AAAA,IACF;AAAA,EACF,CAAC;AASD,UAAQ;AAAA,IAIN;AAAA,IACA,EAAE,YAAY,qBAAqB;AAAA,IACnC,OAAO,YAAkC;AACvC,YAAM,EAAE,WAAW,IAAI,QAAQ;AAC/B,YAAM,gBAAgB,KAAK;AAAA,QACzB,QAAQ;AAAA,QACR,QAAQ;AAAA,QACR;AAAA,MACF;AAEA,aAAO;AAAA,QACL,IAAI;AAAA,QACJ;AAAA,QACA,SAAS;AAAA,MACX;AAAA,IACF;AAAA,EACF;AASA,UAAQ,IAAmC,4BAA4B;AAAA,IACrE,YAAY;AAAA,EACd,GAAG,OAAO,SAA+B,UAAU;AACjD,UAAM,UAAU,KAAK,eAAe,QAAQ,QAAS,QAAQ,KAAM;AAEnE,QAAI,CAAC,SAAS;AACZ,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,oCAAoC;AAAA,IACjE;AAEA,WAAO;AAAA,MACL,IAAI;AAAA,MACJ;AAAA,IACF;AAAA,EACF,CAAC;AASD,UAAQ,IAAI,yBAAyB;AAAA,IACnC,YAAY;AAAA,EACd,GAAG,YAAY;AAEb,UAAM,QAAQ,KAAK,SAAS;AAE5B,WAAO;AAAA,MACL,IAAI;AAAA,MACJ;AAAA,IACF;AAAA,EACF,CAAC;AACH;;;ACroBA,SAAS,KAAAC,WAAS;AAyBlB,IAAM,oBAAoBC,IAAE,OAAO;AAAA,EACjC,UAAUA,IAAE,OAAO,EAAE,SAAS;AAAA,EAC9B,QAAQA,IAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,UAAUA,IAAE,OAAO,EAAE,SAAS;AAAA,EAC9B,QAAQA,IAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,QAAQA,IAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,cAAcA,IAAE,OAAO,EAAE,SAAS;AAAA,EAClC,YAAYA,IAAE,OAAO,EAAE,SAAS;AAAA,EAChC,WAAWA,IAAE,OAAO,EAAE,SAAS;AAAA,EAC/B,SAASA,IAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,QAAQA,IAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,OAAOA,IAAE,OAAO,EAAE,SAAS;AAAA,EAC3B,QAAQA,IAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,QAAQA,IAAE,KAAK,CAAC,aAAa,YAAY,UAAU,CAAC,EAAE,SAAS;AAAA,EAC/D,WAAWA,IAAE,KAAK,CAAC,OAAO,MAAM,CAAC,EAAE,SAAS;AAC9C,CAAC;AAED,IAAM,mBAAmBA,IAAE,OAAO;AAAA,EAChC,QAAQA,IAAE,KAAK,CAAC,QAAQ,OAAO,KAAK,CAAC;AAAA,EACrC,WAAWA,IAAE,OAAO,EAAE,SAAS;AAAA,EAC/B,SAASA,IAAE,OAAO,EAAE,SAAS;AAAA,EAC7B,UAAUA,IAAE,OAAO,EAAE,SAAS;AAAA,EAC9B,gBAAgBA,IAAE,QAAQ,EAAE,SAAS;AAAA,EACrC,gBAAgBA,IAAE,QAAQ,EAAE,SAAS;AAAA,EACrC,iBAAiBA,IAAE,QAAQ,EAAE,SAAS;AACxC,CAAC;AAED,IAAM,wBAAwBA,IAAE,OAAO;AAAA,EACrC,UAAUA,IAAE,OAAO;AAAA,EACnB,eAAeA,IAAE,OAAO,EAAE,IAAI,CAAC,EAAE,IAAI,IAAI;AAAA,EACzC,kBAAkBA,IAAE,OAAO,EAAE,SAAS;AAAA,EACtC,oBAAoBA,IAAE,QAAQ,EAAE,SAAS;AAC3C,CAAC;AAMD,eAAe,mBACb,SACA,OACe;AACf,QAAM,MAAM;AAEZ,MAAI,CAAC,IAAI,UAAU,CAAC,IAAI,OAAO;AAC7B,UAAM,KAAK,GAAG,EAAE,KAAK,EAAE,OAAO,eAAe,CAAC;AAC9C;AAAA,EACF;AAGA,MAAI,CAAC,CAAC,SAAS,OAAO,EAAE,SAAS,IAAI,QAAQ,GAAG;AAC9C,UAAM,KAAK,GAAG,EAAE,KAAK;AAAA,MACnB,OAAO;AAAA,MACP,SAAS;AAAA,IACX,CAAC;AACD;AAAA,EACF;AACF;AAMA,eAAsB,oBAAoB,SAAyC;AACjF,QAAM,cAAc,eAAe;AAKnC,UAAQ;AAAA,IACN;AAAA,IACA,EAAE,YAAY,mBAAmB;AAAA,IACjC,OAAO,SAAyB,UAAwB;AACtD,YAAM,MAAM;AAEZ,UAAI;AACF,cAAM,SAAS,kBAAkB,MAAM,QAAQ,KAAK;AAEpD,cAAM,QAAQ;AAAA,UACZ,OAAO,IAAI;AAAA,UACX,UAAU,OAAO;AAAA,UACjB,QAAQ,OAAO;AAAA,UACf,UAAU,OAAO;AAAA,UACjB,QAAQ,OAAO;AAAA,UACf,QAAQ,OAAO;AAAA,UACf,cAAc,OAAO;AAAA,UACrB,YAAY,OAAO;AAAA,UACnB,WAAW,OAAO,YAAY,IAAI,KAAK,OAAO,SAAS,IAAI;AAAA,UAC3D,SAAS,OAAO,UAAU,IAAI,KAAK,OAAO,OAAO,IAAI;AAAA,UACrD,QAAQ,OAAO;AAAA,UACf,OAAO,OAAO,QAAQ,SAAS,OAAO,OAAO,EAAE,IAAI;AAAA,UACnD,QAAQ,OAAO,SAAS,SAAS,OAAO,QAAQ,EAAE,IAAI;AAAA,UACtD,QAAQ,OAAO,UAAU;AAAA,UACzB,WAAW,OAAO,aAAa;AAAA,QACjC;AAEA,cAAM,SAAS,MAAM,YAAY,MAAM,KAAK;AAG5C,cAAM,YAAY;AAAA,UAChB;AAAA,UACA;AAAA,UACA,uBAAuB,OAAO,KAAK;AAAA,UACnC,EAAE,QAAQ,IAAI,QAAQ,OAAO,IAAI,MAAM;AAAA,QACzC;AAEA,cAAM,KAAK,MAAM;AAAA,MACnB,SAAS,OAAO;AACd,YAAI,iBAAiBA,IAAE,UAAU;AAC/B,gBAAM,KAAK,GAAG,EAAE,KAAK,EAAE,OAAO,4BAA4B,SAAS,MAAM,OAAO,CAAC;AAAA,QACnF,OAAO;AACL,gBAAM;AAAA,QACR;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,EAAE,YAAY,mBAAmB;AAAA,IACjC,OAAO,SAAqD,UAAwB;AAClF,YAAM,MAAM;AAEZ,YAAM,QAAQ,MAAM,YAAY,SAAS,IAAI,OAAO,EAAE;AAEtD,UAAI,CAAC,OAAO;AACV,cAAM,KAAK,GAAG,EAAE,KAAK,EAAE,OAAO,kBAAkB,CAAC;AACjD;AAAA,MACF;AAGA,UAAI,MAAM,QAAQ,SAAS,MAAM,QAAQ,UAAU,IAAI,OAAO;AAC5D,cAAM,KAAK,GAAG,EAAE,KAAK,EAAE,OAAO,YAAY,CAAC;AAC3C;AAAA,MACF;AAEA,YAAM,KAAK,KAAK;AAAA,IAClB;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,EAAE,YAAY,mBAAmB;AAAA,IACjC,OAAO,SAAyB,UAAwB;AACtD,YAAM,MAAM;AACZ,YAAM,EAAE,KAAK,IAAI,QAAQ;AAEzB,YAAM,QAAQ,MAAM,YAAY;AAAA,QAC9B,IAAI;AAAA,QACJ,OAAO,SAAS,MAAM,EAAE,IAAI;AAAA,MAC9B;AAEA,YAAM,KAAK,KAAK;AAAA,IAClB;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,EAAE,YAAY,mBAAmB;AAAA,IACjC,OAAO,SAAyB,UAAwB;AACtD,YAAM,MAAM;AACZ,YAAM,EAAE,UAAU,MAAM,IAAI,QAAQ;AAEpC,YAAM,SAAS,MAAM,YAAY;AAAA,QAC/B,IAAI;AAAA,QACJ;AAAA,QACA,QAAQ,SAAS,OAAO,EAAE,IAAI;AAAA,MAChC;AAEA,YAAM,KAAK,EAAE,QAAQ,OAAO,OAAO,OAAO,CAAC;AAAA,IAC7C;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,EAAE,YAAY,mBAAmB;AAAA,IACjC,OAAO,SAAyB,UAAwB;AACtD,YAAM,MAAM;AAEZ,UAAI;AACF,cAAM,OAAO,iBAAiB,MAAM,QAAQ,IAAI;AAEhD,cAAM,UAAU;AAAA,UACd,QAAQ,KAAK;AAAA,UACb,OAAO;AAAA,YACL,OAAO,IAAI;AAAA,YACX,WAAW,KAAK,YAAY,IAAI,KAAK,KAAK,SAAS,IAAI;AAAA,YACvD,SAAS,KAAK,UAAU,IAAI,KAAK,KAAK,OAAO,IAAI;AAAA,YACjD,UAAU,KAAK;AAAA,YACf,OAAO;AAAA;AAAA,UACT;AAAA,UACA,gBAAgB,KAAK,kBAAkB;AAAA,UACvC,gBAAgB,KAAK,kBAAkB;AAAA,UACvC,iBAAiB,KAAK,mBAAmB;AAAA,QAC3C;AAEA,cAAM,SAAS,MAAM,YAAY,OAAO,OAAO;AAG/C,cAAM,YAAY;AAAA,UAChB;AAAA,UACA;AAAA,UACA,0BAA0B,KAAK,MAAM;AAAA,UACrC,EAAE,QAAQ,IAAI,QAAQ,OAAO,IAAI,MAAM;AAAA,QACzC;AAGA,cAAM,cAAc;AAAA,UAClB,MAAM;AAAA,UACN,KAAK;AAAA,UACL,KAAK;AAAA,QACP,EAAE,KAAK,MAAM;AAEb,cAAM,WAAW,iBAAgB,oBAAI,KAAK,GAAE,YAAY,EAAE,MAAM,GAAG,EAAE,CAAC,CAAC,IAAI,KAAK,MAAM;AAEtF,cACG,OAAO,gBAAgB,WAAW,EAClC,OAAO,uBAAuB,yBAAyB,QAAQ,GAAG,EAClE,KAAK,MAAM;AAAA,MAChB,SAAS,OAAO;AACd,YAAI,iBAAiBA,IAAE,UAAU;AAC/B,gBAAM,KAAK,GAAG,EAAE,KAAK,EAAE,OAAO,0BAA0B,SAAS,MAAM,OAAO,CAAC;AAAA,QACjF,OAAO;AACL,gBAAM;AAAA,QACR;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,EAAE,YAAY,mBAAmB;AAAA,IACjC,OAAO,SAAyB,UAAwB;AACtD,YAAM,MAAM;AAGZ,YAAM,WAAW;AAAA,QACf,EAAE,UAAU,QAAQ,eAAe,IAAI;AAAA,QACvC,EAAE,UAAU,gBAAgB,eAAe,IAAI;AAAA,QAC/C,EAAE,UAAU,UAAU,eAAe,IAAI;AAAA,QACzC,EAAE,UAAU,YAAY,eAAe,GAAG;AAAA,QAC1C,EAAE,UAAU,YAAY,eAAe,GAAG;AAAA,QAC1C,EAAE,UAAU,UAAU,eAAe,IAAI;AAAA,QACzC,EAAE,UAAU,WAAW,eAAe,GAAG;AAAA,QACzC,EAAE,UAAU,YAAY,eAAe,IAAI;AAAA,QAC3C,EAAE,UAAU,OAAO,eAAe,GAAG;AAAA,QACrC,EAAE,UAAU,YAAY,eAAe,IAAI;AAAA,QAC3C,EAAE,UAAU,UAAU,eAAe,IAAI;AAAA,MAC3C;AAEA,YAAM,KAAK,EAAE,SAAS,CAAC;AAAA,IACzB;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,EAAE,YAAY,mBAAmB;AAAA,IACjC,OAAO,SAAyB,UAAwB;AACtD,YAAM,MAAM;AAEZ,UAAI;AACF,cAAM,SAAS,sBAAsB,MAAM,QAAQ,IAAI;AAGvD,cAAM,YAAY;AAAA,UAChB;AAAA,UACA;AAAA,UACA,gCAAgC,OAAO,QAAQ,KAAK,OAAO,aAAa;AAAA,UACxE,EAAE,QAAQ,IAAI,QAAQ,OAAO,IAAI,MAAM;AAAA,UACvC,EAAE,MAAM,oBAAoB,IAAI,OAAO,SAAS;AAAA,QAClD;AAGA,cAAM,KAAK,EAAE,SAAS,MAAM,OAAO,CAAC;AAAA,MACtC,SAAS,OAAO;AACd,YAAI,iBAAiBA,IAAE,UAAU;AAC/B,gBAAM,KAAK,GAAG,EAAE,KAAK,EAAE,OAAO,kBAAkB,SAAS,MAAM,OAAO,CAAC;AAAA,QACzE,OAAO;AACL,gBAAM;AAAA,QACR;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,EAAE,YAAY,mBAAmB;AAAA,IACjC,OAAO,SAAyB,UAAwB;AACtD,YAAM,MAAM;AAGZ,YAAM,SAAS,MAAM,YAAY,MAAM;AAAA,QACrC,OAAO,IAAI;AAAA,QACX,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,WAAW;AAAA,MACb,CAAC;AAED,YAAM,YAAY,MAAM,YAAY,gBAAgB,OAAO,MAAM;AAGjE,YAAM,YAAY;AAAA,QAChB;AAAA,QACA;AAAA,QACA,mCAAmC,UAAU,QAAQ,UAAU,SAAS;AAAA,QACxE,EAAE,QAAQ,IAAI,QAAQ,OAAO,IAAI,MAAM;AAAA,MACzC;AAEA,YAAM,KAAK;AAAA,QACT,aAAa,OAAO;AAAA,QACpB,OAAO,UAAU;AAAA,QACjB,cAAc,UAAU,cAAc;AAAA,QACtC,eAAe,UAAU,cAAc,MAAM,GAAG,EAAE;AAAA;AAAA,MACpD,CAAC;AAAA,IACH;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,EAAE,YAAY,mBAAmB;AAAA,IACjC,OAAO,SAAyD,UAAwB;AACtF,YAAM,MAAM;AAEZ,YAAM,SAAS,MAAM,YAAY,cAAc,IAAI,OAAO,QAAQ,GAAG;AAGrE,YAAM,YAAY,OAAO,OAAO,OAAK,EAAE,QAAQ,UAAU,IAAI,KAAK;AAElE,YAAM,KAAK,EAAE,QAAQ,WAAW,OAAO,UAAU,OAAO,CAAC;AAAA,IAC3D;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,EAAE,YAAY,mBAAmB;AAAA,IACjC,OAAO,SAAyB,UAAwB;AACtD,YAAM,MAAM;AAGZ,UAAI,IAAI,aAAa,SAAS;AAC5B,cAAM,KAAK,GAAG,EAAE,KAAK,EAAE,OAAO,wCAAwC,CAAC;AACvE;AAAA,MACF;AAEA,YAAM,SAAS,MAAM,YAAY,eAAe;AAGhD,YAAM,YAAY;AAAA,QAChB;AAAA,QACA;AAAA,QACA,iCAAiC,OAAO,OAAO,cAAc,OAAO,QAAQ;AAAA,QAC5E,EAAE,QAAQ,IAAI,QAAQ,OAAO,IAAI,MAAM;AAAA,MACzC;AAEA,YAAM,KAAK,MAAM;AAAA,IACnB;AAAA,EACF;AACF;;;ACzYA,eAAsB,UAAU,SAAyC;AACvE,QAAM,aAAa,cAAc;AAUjC,UAAQ,IAAI,kBAAkB,OAAO,UAAU,UAAU;AACvD,UAAM,QAAQ,WAAW,UAAU;AACnC,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,MACN,OAAO,MAAM;AAAA,IACf,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,YAAM,OAAO,WAAW,QAAQ,QAAQ,OAAO,EAAE;AACjD,UAAI,CAAC,MAAM;AACT,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AACA,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,MACR,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,SAAS,uBAAuB,MAAM,QAAQ,IAAI;AACxD,cAAM,OAAO,MAAM,WAAW,YAAY,MAAM;AAChD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,MAAM;AAAA,QACR,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,WAAW,eAAe,QAAQ,OAAO,EAAE;AACjD,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAUA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,UAAU,MAAM,WAAW,cAAc,QAAQ,OAAO,EAAE;AAChE,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,MAAM;AAAA,YACJ;AAAA,YACA,OAAO,QAAQ;AAAA,UACjB;AAAA,QACF,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAuBA,UACG;AACH,UAAI;AACF,cAAM,EAAE,UAAU,cAAc,IAAI,QAAQ;AAC5C,cAAM,SAAS,MAAM,WAAW;AAAA,UAC9B,QAAQ,OAAO;AAAA,UACf;AAAA,UACA;AAAA,QACF;AACA,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,MAAM;AAAA,QACR,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAGA,UACG;AACH,UAAI;AACF,cAAM,WAAW;AAAA,UACf,QAAQ,OAAO;AAAA,UACf,QAAQ,OAAO;AAAA,QACjB;AACA,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAUA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,YAAM,UAAU,WAAW,eAAe,QAAQ,OAAO,EAAE;AAC3D,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,QACN,OAAO,QAAQ;AAAA,MACjB,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,YAAM,SAAS,WAAW,cAAc,QAAQ,OAAO,EAAE;AACzD,UAAI,CAAC,QAAQ;AACX,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AACA,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,MACR,CAAC;AAAA,IACH;AAAA,EACF;AAUA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAIA,UACG;AACH,UAAI;AACF,cAAM,EAAE,WAAW,IAAI,QAAQ;AAC/B,cAAM,SAAS,MAAM,WAAW;AAAA,UAC9B,QAAQ,OAAO;AAAA,UACf;AAAA,QACF;AACA,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,MAAM;AAAA,QACR,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAKA,UACG;AACH,UAAI;AACF,cAAM,WAAW,QAAQ,OAAO;AAChC,cAAM,YAAY,QAAQ,QAAQ,qBAAqB;AAEvD,cAAM,WAAW,cAAc,UAAU,QAAQ,MAAM,SAAS;AAEhE,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAUA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,EAAE,KAAK,IAAI,QAAQ;AACzB,cAAM,SAAS,kBAAkB,IAAI;AACrC,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS,OAAO;AAAA,UAChB,MAAM,OAAO;AAAA,UACb,QAAQ,OAAO;AAAA,QACjB,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,EAAE,KAAK,IAAI,QAAQ;AACzB,cAAM,cAAc,kBAAkB,IAAI;AAE1C,YAAI,CAAC,YAAY,WAAW,CAAC,YAAY,UAAU;AACjD,iBAAO,MAAM,KAAK;AAAA,YAChB,SAAS;AAAA,YACT,OAAO;AAAA,YACP,QAAQ,YAAY,QAAQ,IAAI,CAAC,OAAO;AAAA,cACtC,MAAM;AAAA,cACN,SAAS;AAAA,cACT,UAAU;AAAA,YACZ,EAAE;AAAA,YACF,UAAU,CAAC;AAAA,UACb,CAAC;AAAA,QACH;AAEA,cAAM,aAAa,qBAAqB,YAAY,QAAQ;AAC5D,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,OAAO,WAAW;AAAA,UAClB,QAAQ,WAAW;AAAA,UACnB,UAAU,WAAW;AAAA,QACvB,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ,IAAI,0BAA0B,OAAO,UAAU,UAAU;AAC/D,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,IACR,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,YAAM,OAAO,QAAQ,OAAO;AAC5B,YAAM,UAAU,kBAAkB,IAAI;AAEtC,UAAI,CAAC,SAAS;AACZ,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO,sBAAsB,IAAI,gBAAgB,OAAO,KAAK,iBAAiB,EAAE,KAAK,IAAI,CAAC;AAAA,QAC5F,CAAC;AAAA,MACH;AAEA,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,UACJ;AAAA,UACA,MAAM;AAAA,QACR;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF;AACF;;;ACpcA,eAAsB,UAAU,SAAyC;AACvE,QAAM,cAAc,eAAe;AAUnC,UAAQ,IAAI,oBAAoB,OAAO,UAAU,UAAU;AACzD,UAAM,SAAS,YAAY,oBAAoB;AAC/C,UAAM,OAAO,YAAY,QAAQ;AAEjC,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,QACJ,aAAa,OAAO,YAAY,MAAM;AAAA,QACtC,MAAM,KAAK,IAAI,CAAC,OAAO;AAAA,UACrB,IAAI,EAAE;AAAA,UACN,MAAM,EAAE;AAAA,UACR,UAAU,EAAE;AAAA,UACZ,SAAS,EAAE;AAAA,QACb,EAAE;AAAA,MACJ;AAAA,IACF,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,YAAM,WAAW,QAAQ,OAAO;AAChC,YAAM,SAAS,YAAY,oBAAoB,EAAE,IAAI,QAAQ;AAE7D,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,UACJ;AAAA,UACA,QAAQ,UAAU;AAAA,QACpB;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF;AAUA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAMA,UACG;AACH,UAAI;AACF,cAAM,EAAE,UAAU,YAAY,IAAI,QAAQ;AAE1C,cAAM,MAAM,MAAM,YAAY,WAAW;AAAA,UACvC;AAAA,UACA,GAAG;AAAA,QACL,CAAQ;AAER,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,MAAM;AAAA,YACJ,IAAI,IAAI;AAAA,YACR,MAAM,IAAI;AAAA,YACV,UAAU,IAAI;AAAA,UAChB;AAAA,QACF,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,YAAY,cAAc,QAAQ,OAAO,EAAE;AACjD,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAUA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SASA,UACG;AACH,UAAI;AACF,cAAM,EAAE,UAAU,WAAW,SAAS,QAAQ,YAAY,IAAI,QAAQ;AAEtE,cAAM,UAA8B;AAAA,UAClC;AAAA,UACA;AAAA,UACA,SAAS;AAAA,UACT;AAAA,UACA;AAAA,QACF;AAEA,cAAM,YAAY,YAAY,OAAO;AAErC,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAOA,UACG;AACH,UAAI;AACF,cAAM,EAAE,MAAM,MAAM,SAAS,IAAI,QAAQ;AAEzC,cAAM,YAAY,iBAAiB,MAAM,IAAI;AAE7C,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAUA,UAAQ,IAAI,2BAA2B,OAAO,UAAU,UAAU;AAChE,UAAM,gBAAgB,YAAY,uBAAuB;AAEzD,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,MACN,OAAO,cAAc;AAAA,IACvB,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAQA,UACG;AACH,UAAI;AACF,cAAM,EAAE,UAAU,WAAW,OAAO,YAAY,IAAI,QAAQ;AAE5D,oBAAY,uBAAuB;AAAA,UACjC;AAAA,UACA;AAAA,UACA;AAAA,UACA,aAAa,eAAe;AAAA,UAC5B,SAAS;AAAA,QACX,CAAC;AAED,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAGA,UACG;AACH,UAAI;AAEF,oBAAY,uBAAuB;AAAA,UACjC,UAAU,QAAQ,OAAO;AAAA,UACzB,WAAW,QAAQ,OAAO;AAAA,UAC1B,OAAO,CAAC;AAAA,UACR,SAAS;AAAA,QACX,CAAC;AAED,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAUA,UAAQ,IAAI,sBAAsB,OAAO,UAAU,UAAU;AAC3D,UAAM,WAAW,YAAY,sBAAsB;AAEnD,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,MACN,OAAO,SAAS;AAAA,IAClB,CAAC;AAAA,EACH,CAAC;AAUD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAWA,UACG;AACH,YAAM,EAAE,MAAM,WAAW,OAAO,SAAS,MAAM,SAAS,WAAW,IAAI,QAAQ;AAG/E,UAAI,SAAS,sBAAsB,WAAW;AAC5C,eAAO,MAAM,KAAK,EAAE,UAAU,CAAC;AAAA,MACjC;AAGA,UAAI,SAAS;AACX,cAAM,YAAY,cAAc;AAAA,UAC9B,UAAU;AAAA,UACV,SAAS,QAAQ,QAAQ,KAAK,EAAE;AAAA,UAChC,MAAM,QAAQ;AAAA,UACd,QAAQ,WAAW;AAAA,UACnB,WAAW,cAAc;AAAA,UACzB,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,QACpC,CAAC;AAED,eAAO,MAAM,KAAK,EAAE,IAAI,KAAK,CAAC;AAAA,MAChC;AAGA,UAAI,SAAS,oBAAoB,OAAO;AAEtC,gBAAQ,IAAI,mCAAmC,KAAK;AAAA,MACtD;AAEA,aAAO,MAAM,KAAK,EAAE,IAAI,KAAK,CAAC;AAAA,IAChC;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAWA,UACG;AACH,YAAM,EAAE,MAAM,MAAM,QAAQ,WAAW,IAAI,QAAQ;AAGnD,UAAI,SAAS,GAAG;AACd,eAAO,MAAM,KAAK,EAAE,MAAM,EAAE,CAAC;AAAA,MAC/B;AAGA,UAAI,SAAS,KAAK,MAAM,MAAM;AAC5B,cAAM,OAAO,KAAK,SAAS,IAAI,CAAC,MAAM,GAAG,EAAE,IAAI,IAAI,EAAE,KAAK,EAAE,EAAE,KAAK,GAAG,KAAK;AAE3E,cAAM,YAAY,cAAc;AAAA,UAC9B,UAAU;AAAA,UACV,SAAS,KAAK;AAAA,UACd;AAAA,UACA,QAAQ,QAAQ,MAAM,MAAM;AAAA,UAC5B,WAAW,cAAc;AAAA,UACzB,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,QACpC,CAAC;AAED,eAAO,MAAM,KAAK;AAAA,UAChB,MAAM;AAAA;AAAA,UACN,MAAM,EAAE,SAAS,mBAAmB;AAAA,QACtC,CAAC;AAAA,MACH;AAGA,UAAI,SAAS,GAAG;AACd,gBAAQ,IAAI,yCAAyC,IAAI;AACzD,eAAO,MAAM,KAAK;AAAA,UAChB,MAAM;AAAA;AAAA,QACR,CAAC;AAAA,MACH;AAEA,aAAO,MAAM,KAAK,EAAE,MAAM,EAAE,CAAC;AAAA,IAC/B;AAAA,EACF;AAUA,UAAQ,IAAI,uBAAuB,OAAO,UAAU,UAAU;AAC5D,UAAM,YAAY,YAAY,aAAa;AAE3C,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,MACN,OAAO,UAAU;AAAA,IACnB,CAAC;AAAA,EACH,CAAC;AACH;;;ACpcA,eAAsB,gBAAgB,SAAyC;AAC7E,QAAM,mBAAmB,oBAAoB;AAU7C,UAAQ,IAAI,wBAAwB,OAAO,UAAU,UAAU;AAC7D,UAAM,QAAQ,iBAAiB,SAAS;AACxC,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,IACR,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,EAAE,QAAQ,OAAO,IAAI,QAAQ;AACnC,cAAM,iBAAiB,UAAU,QAAQ,MAAM;AAC/C,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,EAAE,OAAO,IAAI,QAAQ;AAC3B,cAAM,iBAAiB,YAAY,MAAM;AACzC,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAUA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,EAAE,OAAO,IAAI,QAAQ;AAC3B,cAAM,OAAO,MAAM,iBAAiB,KAAK,MAAM;AAC/C,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,MAAM;AAAA,QACR,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,EAAE,QAAQ,YAAY,IAAI,QAAQ;AACxC,cAAM,SAAS,MAAM,iBAAiB,MAAM,QAAQ,WAAW;AAC/D,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,MAAM;AAAA,QACR,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAGA,UACG;AACH,UAAI;AACF,cAAM,EAAE,mBAAmB,YAAY,IAAI,QAAQ;AACnD,cAAM,SAAS,MAAM,iBAAiB,QAAQ,mBAAmB,WAAW;AAC5E,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,MAAM;AAAA,QACR,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAUA,UAAQ,IAAI,4BAA4B,OAAO,UAAU,UAAU;AACjE,UAAM,QAAQ,iBAAiB,SAAS;AACxC,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM,MAAM;AAAA,MACZ,OAAO,MAAM,UAAU;AAAA,IACzB,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,YAAM,QAAQ,iBAAiB,SAAS;AACxC,YAAM,WAAW,MAAM,UAAU;AAAA,QAC/B,CAAC,MAAM,GAAG,EAAE,IAAI,IAAI,EAAE,IAAI,OAAO,QAAQ,OAAO;AAAA,MAClD;AAEA,UAAI,CAAC,UAAU;AACb,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAEA,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,MACR,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAGA,UACG;AACH,UAAI;AACF,cAAM,EAAE,MAAM,IAAI,QAAQ,IAAI,QAAQ;AACtC,cAAM,iBAAiB,eAAe,MAAa,IAAI,OAAO;AAC9D,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,iBAAiB,cAAc,QAAQ,OAAO,OAAO;AAC3D,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,iBAAiB,gBAAgB,QAAQ,OAAO,OAAO;AAC7D,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAUA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAcA,UACG;AACH,YAAM,EAAE,MAAM,aAAa,aAAa,MAAM,IAAI,QAAQ;AAE1D,YAAM,MAAM,oBAAoB,MAAM,aAAa,aAAa,KAAK;AAErE,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM,EAAE,IAAI;AAAA,MACd,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAUA,UACG;AACH,YAAM,EAAE,MAAM,aAAa,aAAa,MAAM,UAAU,OAAO,IAAI,QAAQ;AAE3E,YAAM,MAAM,oBAAoB,MAAM,aAAa,aAAa,MAAM,UAAU,MAAM;AAEtF,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM,EAAE,IAAI;AAAA,MACd,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ,IAAI,yBAAyB,OAAO,UAAU,UAAU;AAC9D,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,QACJ,UAAU;AAAA,UACR,SAAS,EAAE,MAAM,UAAU,UAAU,KAAK;AAAA,UAC1C,SAAS,EAAE,MAAM,UAAU,UAAU,MAAM,WAAW,KAAK;AAAA,UAC3D,iBAAiB,EAAE,MAAM,UAAU,UAAU,MAAM;AAAA,QACrD;AAAA,QACA,WAAW;AAAA,UACT,eAAe;AAAA,YACb,MAAM,EAAE,MAAM,UAAU,UAAU,KAAK;AAAA,YACvC,aAAa,EAAE,MAAM,SAAS;AAAA,YAC9B,SAAS,EAAE,MAAM,QAAQ,SAAS,KAAK;AAAA,YACvC,OAAO,EAAE,MAAM,QAAQ,UAAU,KAAK;AAAA,YACtC,MAAM,EAAE,MAAM,cAAc;AAAA,UAC9B;AAAA,UACA,eAAe;AAAA,YACb,MAAM,EAAE,MAAM,UAAU,UAAU,KAAK;AAAA,YACvC,aAAa,EAAE,MAAM,UAAU,UAAU,KAAK;AAAA,YAC9C,MAAM,EAAE,MAAM,UAAU,UAAU,KAAK;AAAA,YACvC,UAAU,EAAE,MAAM,UAAU,SAAS,MAAM;AAAA,YAC3C,SAAS,EAAE,MAAM,QAAQ,SAAS,KAAK;AAAA,YACvC,QAAQ,EAAE,MAAM,WAAW;AAAA,UAC7B;AAAA,UACA,cAAc;AAAA,YACZ,MAAM,EAAE,MAAM,UAAU,UAAU,KAAK;AAAA,YACvC,KAAK,EAAE,MAAM,UAAU,UAAU,KAAK;AAAA,YACtC,QAAQ,EAAE,MAAM,gBAAgB,UAAU,KAAK;AAAA,YAC/C,SAAS,EAAE,MAAM,QAAQ,SAAS,KAAK;AAAA,YACvC,aAAa,EAAE,MAAM,UAAU,SAAS,EAAE;AAAA,YAC1C,YAAY,EAAE,MAAM,UAAU,SAAS,IAAK;AAAA,UAC9C;AAAA,UACA,aAAa;AAAA,YACX,MAAM,EAAE,MAAM,UAAU,UAAU,KAAK;AAAA,YACvC,aAAa,EAAE,MAAM,SAAS;AAAA,YAC9B,cAAc,EAAE,MAAM,SAAS;AAAA,YAC/B,eAAe,EAAE,MAAM,SAAS;AAAA,YAChC,YAAY,EAAE,MAAM,UAAU,SAAS,SAAS;AAAA,YAChD,SAAS,EAAE,MAAM,QAAQ,SAAS,KAAK;AAAA,YACvC,SAAS,EAAE,MAAM,QAAQ,SAAS,MAAM;AAAA,YACxC,kBAAkB,EAAE,MAAM,gBAAgB,SAAS,CAAC,IAAI,IAAI,IAAI,GAAG,EAAE;AAAA,UACvE;AAAA,QACF;AAAA,MACF;AAAA,IACF,CAAC;AAAA,EACH,CAAC;AACH;AAMA,SAAS,oBACP,MACA,aACA,aACA,OAOQ;AACR,QAAM,QAAkB,CAAC;AACzB,QAAM,KAAK,6BAA6B,IAAI,KAAK;AACjD,QAAM,KAAK,oBAAoB,WAAW,GAAG;AAC7C,MAAI,aAAa;AACf,UAAM,KAAK,oBAAoB,WAAW,GAAG;AAAA,EAC/C;AACA,QAAM,KAAK,sBAAsB;AACjC,QAAM,KAAK,EAAE;AAEb,aAAW,QAAQ,OAAO;AACxB,UAAM,KAAK,UAAU;AACrB,UAAM,KAAK,eAAe,KAAK,EAAE,GAAG;AACpC,UAAM,KAAK,eAAe,KAAK,IAAI,GAAG;AACtC,UAAM,KAAK,eAAe,KAAK,IAAI,GAAG;AACtC,QAAI,KAAK,UAAU,OAAO,KAAK,KAAK,MAAM,EAAE,SAAS,GAAG;AACtD,YAAM,KAAK,gBAAgB;AAC3B,iBAAW,CAAC,KAAK,KAAK,KAAK,OAAO,QAAQ,KAAK,MAAM,GAAG;AACtD,cAAM,iBAAiB,OAAO,UAAU,WAAW,IAAI,KAAK,MAAM,KAAK,UAAU,KAAK;AACtF,cAAM,KAAK,SAAS,GAAG,MAAM,cAAc,EAAE;AAAA,MAC/C;AACA,YAAM,KAAK,OAAO;AAAA,IACpB;AACA,QAAI,KAAK,aAAa,KAAK,UAAU,SAAS,GAAG;AAC/C,YAAM,KAAK,sBAAsB,KAAK,UAAU,KAAK,MAAM,CAAC,IAAI;AAAA,IAClE;AACA,UAAM,KAAK,KAAK;AAChB,UAAM,KAAK,EAAE;AAAA,EACf;AAEA,QAAM,KAAK,GAAG;AACd,SAAO,MAAM,KAAK,IAAI;AACxB;AAEA,SAAS,oBACP,MACA,aACA,aACA,MACA,UACA,QACQ;AACR,QAAM,QAAkB,CAAC;AACzB,QAAM,KAAK,6BAA6B,IAAI,KAAK;AACjD,QAAM,KAAK,oBAAoB,WAAW,GAAG;AAC7C,QAAM,KAAK,mBAAmB,WAAW,EAAE;AAC3C,QAAM,KAAK,oBAAoB,IAAI,GAAG;AACtC,QAAM,KAAK,oBAAoB,YAAY,KAAK,GAAG;AACnD,QAAM,KAAK,sBAAsB;AAEjC,MAAI,UAAU,OAAO,KAAK,MAAM,EAAE,SAAS,GAAG;AAC5C,UAAM,KAAK,EAAE;AACb,UAAM,KAAK,cAAc;AACzB,eAAW,CAAC,KAAK,KAAK,KAAK,OAAO,QAAQ,MAAM,GAAG;AACjD,YAAM,iBAAiB,OAAO,UAAU,WAAW,IAAI,KAAK,MAAM,KAAK,UAAU,KAAK;AACtF,YAAM,KAAK,OAAO,GAAG,MAAM,cAAc,EAAE;AAAA,IAC7C;AACA,UAAM,KAAK,KAAK;AAAA,EAClB;AAEA,QAAM,KAAK,GAAG;AACd,SAAO,MAAM,KAAK,IAAI;AACxB;;;ACjeA,eAAsB,aAAa,SAAyC;AAC1E,QAAM,gBAAgB,iBAAiB;AAUvC,UAAQ,IAAI,qBAAqB,OAAO,UAAU,UAAU;AAC1D,UAAM,QAAQ,cAAc,SAAS;AACrC,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,IACR,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAGA,UACG;AACH,UAAI;AACF,cAAM,EAAE,aAAa,SAAS,UAAU,IAAI,QAAQ;AACpD,cAAM,cAAc,QAAQ,aAAa,SAAS,SAAS;AAC3D,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ,KAAK,0BAA0B,OAAO,UAAU,UAAU;AAChE,UAAM,cAAc,WAAW;AAC/B,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,SAAS;AAAA,IACX,CAAC;AAAA,EACH,CAAC;AAUD,UAAQ,IAAI,8BAA8B,OAAO,UAAU,UAAU;AACnE,UAAM,QAAQ,MAAM,cAAc,qBAAqB;AACvD,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,MACN,OAAO,MAAM;AAAA,IACf,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ,IAAI,8BAA8B,OAAO,UAAU,UAAU;AACnE,UAAM,QAAQ,MAAM,cAAc,qBAAqB;AACvD,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,MACN,OAAO,MAAM;AAAA,IACf,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,YAAM,QAAQ,SAAS,QAAQ,MAAM,SAAS,MAAM,EAAE;AACtD,YAAM,QAAQ,MAAM,cAAc,sBAAsB,KAAK;AAC7D,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,QACN,OAAO,MAAM;AAAA,MACf,CAAC;AAAA,IACH;AAAA,EACF;AAUA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAOA,UACG;AACH,YAAM,EAAE,UAAU,UAAU,iBAAiB,IAAI,QAAQ;AACzD,YAAM,cAAc,MAAM,cAAc;AAAA,QACtC;AAAA,QACA;AAAA,QACA;AAAA,MACF;AACA,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,MACR,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAMA,UACG;AACH,YAAM,EAAE,UAAU,SAAS,IAAI,QAAQ;AACvC,YAAM,QAAQ,MAAM,cAAc,aAAa,UAAU,QAAQ;AACjE,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,MACR,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,YAAM,EAAE,UAAU,IAAI,IAAI,QAAQ;AAClC,YAAM,cAAc,MAAM,cAAc,eAAe,UAAU,GAAG;AACpE,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,QACN,OAAO,YAAY;AAAA,MACrB,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAUA,UACG;AACH,YAAM,EAAE,UAAU,OAAO,YAAY,IAAI,QAAQ;AACjD,YAAM,UAAU,MAAM,cAAc,eAAe,UAAU,OAAO,WAAW;AAC/E,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,MACR,CAAC;AAAA,IACH;AAAA,EACF;AAUA,UAAQ,IAAI,wBAAwB,OAAO,UAAU,UAAU;AAC7D,UAAM,WAAW,cAAc,YAAY;AAC3C,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,MACN,OAAO,SAAS;AAAA,IAClB,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAIA,UACG;AACH,UAAI;AACF,cAAM,EAAE,QAAQ,IAAI,QAAQ;AAC5B,cAAM,EAAE,KAAK,IAAI,QAAQ;AACzB,cAAM,SAAS,MAAM,cAAc,eAAe,SAAS,IAAI;AAC/D,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,MAAM;AAAA,QACR,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAUA,UAAQ,IAAI,wBAAwB,OAAO,UAAU,UAAU;AAC7D,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,IACR,CAAC;AAAA,EACH,CAAC;AAUD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAOA,UACG;AACH,UAAI;AACF,cAAM,EAAE,MAAM,SAAS,QAAQ,IAAI,QAAQ;AAC3C,cAAM,cAAc,iBAAiB;AAAA,UACnC,IAAI,SAAS,KAAK,IAAI,CAAC;AAAA,UACvB;AAAA,UACA;AAAA,UACA,SAAS,SAAS,IAAI,CAAC,OAAO;AAAA,YAC5B,OAAO,EAAE;AAAA,YACT,SAAS,EAAE;AAAA,UACb,EAAE;AAAA,UACF,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,QACpC,CAAC;AACD,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAUA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAGA,UACG;AACH,UAAI;AACF,cAAM,EAAE,MAAM,SAAS,KAAK,IAAI,QAAQ;AACxC,cAAM,WAAW,MAAM,cAAc,qBAAqB;AAAA,UACxD;AAAA,UACA;AAAA,UACA;AAAA,QACF,CAAC;AACD,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,MAAM;AAAA,QACR,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,YAAM,QAAQ,MAAM,cAAc,gBAAgB,QAAQ,OAAO,IAAW;AAC5E,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,MACR,CAAC;AAAA,IACH;AAAA,EACF;AAUA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,EAAE,SAAS,IAAI,QAAQ;AAC7B,cAAM,QAAQ,MAAM,cAAc,cAAc,QAAQ;AACxD,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,MAAM;AAAA,UACN,OAAO,MAAM;AAAA,QACf,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,EAAE,SAAS,SAAS,IAAI,QAAQ;AACtC,cAAM,SAAS,MAAM,cAAc,qBAAqB,SAAS,QAAQ;AACzE,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,MAAM;AAAA,QACR,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AACF;;;ACtbA,eAAsB,SAAS,SAAyC;AAEtE,MAAI,YAAY,aAAa;AAC7B,MAAI,CAAC,WAAW;AACd,gBAAY,gBAAgB,iBAAiB;AAAA,EAC/C;AAUA,UAAQ,IAAI,kBAAkB,OAAO,UAAU,UAAU;AACvD,UAAM,QAAQ,UAAW,SAAS;AAClC,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,QACJ,SAAS,UAAW,UAAU;AAAA,QAC9B,eAAe,MAAM;AAAA,QACrB,eAAe,MAAM;AAAA,QACrB,iBAAiB,MAAM;AAAA,QACvB,oBAAoB,MAAM;AAAA,QAC1B,kBAAkB,MAAM;AAAA,QACxB,aAAa,MAAM;AAAA,MACrB;AAAA,IACF,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ,IAAI,iBAAiB,OAAO,UAAU,UAAU;AACtD,UAAM,QAAQ,UAAW,SAAS;AAClC,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,IACR,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ,KAAK,iBAAiB,OAAO,UAAU,UAAU;AACvD,cAAW,MAAM;AACjB,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,SAAS;AAAA,IACX,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ,KAAK,gBAAgB,OAAO,UAAU,UAAU;AACtD,cAAW,KAAK;AAChB,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,SAAS;AAAA,IACX,CAAC;AAAA,EACH,CAAC;AAUD,UAAQ,IAAI,mBAAmB,OAAO,UAAU,UAAU;AACxD,UAAM,SAAS,UAAW,UAAU;AACpC,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM,OAAO;AAAA,MACb,OAAO,OAAO,QAAQ;AAAA,IACxB,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,YAAM,SAAS,UAAW,UAAU;AACpC,YAAM,SAAS,OAAO,QAAQ,KAAK,OAAK,EAAE,WAAW,QAAQ,OAAO,MAAM;AAE1E,UAAI,CAAC,QAAQ;AACX,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAEA,YAAM,QAAQ,UAAW,SAAS;AAClC,YAAM,SAAS,MAAM,aAAa,QAAQ,OAAO,MAAgB;AAEjE,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,UACJ,GAAG;AAAA,UACH;AAAA,QACF;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,kBAAW,UAAU,QAAQ,IAAI;AACjC,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,UACT,MAAM,QAAQ;AAAA,QAChB,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,kBAAW,aAAa,QAAQ,OAAO,MAAgB;AACvD,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAUA,UAAQ,IAAI,kBAAkB,OAAO,UAAU,UAAU;AACvD,UAAM,QAAQ,UAAW,SAAS;AAClC,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM,MAAM;AAAA,IACd,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ,KAAK,wBAAwB,OAAO,UAAU,UAAU;AAC9D,QAAI;AACF,YAAM,gBAAgB,UAAW,iBAAiB;AAClD,YAAM,UAAU,MAAM,cAAc,gBAAgB;AACpD,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,MACR,CAAC;AAAA,IACH,SAAS,OAAO;AACd,YAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,aAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,QAC5B,SAAS;AAAA,QACT,OAAO;AAAA,MACT,CAAC;AAAA,IACH;AAAA,EACF,CAAC;AAMD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,gBAAgB,UAAW,iBAAiB;AAClD,cAAM,SAAS,MAAM,cAAc,YAAY,QAAQ,OAAO,MAAgB;AAC9E,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,MAAM;AAAA,QACR,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAUA,UAAQ,IAAI,oBAAoB,OAAO,UAAU,UAAU;AACzD,UAAM,eAAe,UAAW,gBAAgB;AAChD,UAAM,QAAQ,aAAa,SAAS;AACpC,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,IACR,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAQA,UACG;AACH,YAAM,WAAW,UAAW,MAAM;AAAA,QAChC,UAAU,QAAQ,KAAK;AAAA,QACvB,WAAW,QAAQ,KAAK;AAAA,QACxB,iBAAiB,QAAQ,KAAK;AAAA,QAC9B,gBAAgB,QAAQ,KAAK;AAAA,MAC/B,CAAC;AAED,UAAI,CAAC,UAAU;AACb,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAEA,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,MACR,CAAC;AAAA,IACH;AAAA,EACF;AAUA,UAAQ,IAAI,2BAA2B,OAAO,UAAU,UAAU;AAChE,UAAM,kBAAkB,UAAW,mBAAmB;AACtD,UAAM,QAAQ,gBAAgB,SAAS;AACvC,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,IACR,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,YAAM,QAAQ,SAAS,QAAQ,MAAM,SAAS,MAAM,EAAE;AACtD,YAAM,kBAAkB,UAAW,mBAAmB;AACtD,YAAM,UAAU,gBAAgB,mBAAmB,KAAK;AACxD,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,QACN,OAAO,QAAQ;AAAA,MACjB,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,QAAQ,MAAM,UAAW;AAAA,UAC7B,QAAQ,KAAK;AAAA,UACb,QAAQ,KAAK;AAAA,QACf;AAEA,YAAI,CAAC,OAAO;AACV,iBAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,YAC5B,SAAS;AAAA,YACT,OAAO;AAAA,UACT,CAAC;AAAA,QACH;AAEA,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,UACT,MAAM;AAAA,QACR,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ,IAAI,4BAA4B,OAAO,UAAU,UAAU;AACjE,UAAM,kBAAkB,UAAW,mBAAmB;AACtD,UAAM,UAAU,gBAAgB,oBAAoB;AACpD,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,MACN,OAAO,QAAQ;AAAA,IACjB,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,YAAM,QAAQ,UAAW,gBAAgB,QAAQ,OAAO,EAAE;AAE1D,UAAI,CAAC,OAAO;AACV,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAEA,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,SAAS;AAAA,QACT,MAAM;AAAA,MACR,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAIA,UACG;AACH,YAAM,QAAQ,UAAW;AAAA,QACvB,QAAQ,OAAO;AAAA,QACf,QAAQ,KAAK;AAAA,MACf;AAEA,UAAI,CAAC,OAAO;AACV,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAEA,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,SAAS;AAAA,QACT,MAAM;AAAA,MACR,CAAC;AAAA,IACH;AAAA,EACF;AAUA,UAAQ,IAAI,uBAAuB,OAAO,UAAU,UAAU;AAC5D,UAAM,QAAQ,UAAW,SAAS;AAClC,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM,MAAM;AAAA,IACd,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAWA,UACG;AACH,UAAI;AACF,kBAAW,wBAAwB;AAAA,UACjC,cAAc,QAAQ,KAAK;AAAA,UAC3B,cAAc,QAAQ,KAAK;AAAA,UAC3B,MAAM,QAAQ,KAAK;AAAA,UACnB,OAAO,QAAQ,KAAK;AAAA,UACpB,iBAAiB,QAAQ,KAAK;AAAA,UAC9B,mBAAkB,oBAAI,KAAK,GAAE,YAAY;AAAA,UACzC,SAAS,QAAQ,KAAK;AAAA,UACtB,OAAO,QAAQ,KAAK;AAAA,QACtB,CAAC;AAED,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAUA,UAAQ,IAAI,kBAAkB,OAAO,UAAU,UAAU;AACvD,UAAM,SAAS,UAAW,UAAU;AACpC,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,QACJ,aAAa,OAAO;AAAA,QACpB,eAAe,OAAO;AAAA,QACtB,UAAU,OAAO;AAAA,QACjB,aAAa,OAAO;AAAA,QACpB,YAAY,OAAO;AAAA,MACrB;AAAA,IACF,CAAC;AAAA,EACH,CAAC;AACH;;;ACzgBA,eAAsB,SAAS,SAAyC;AAEtE,MAAI,gBAAgB,iBAAiB;AACrC,MAAI,CAAC,eAAe;AAClB,oBAAgB,oBAAoB;AAAA,MAClC,MAAM;AAAA,MACN,MAAM;AAAA,IACR,CAAC;AAAA,EACH;AAEA,MAAI,iBAAiB,kBAAkB;AACvC,MAAI,CAAC,gBAAgB;AACnB,qBAAiB,qBAAqB,aAAa;AAAA,EACrD;AAUA,UAAQ,IAAI,kBAAkB,OAAO,UAAU,UAAU;AACvD,UAAM,QAAQ,cAAe,SAAS;AACtC,UAAM,WAAW,eAAgB,aAAa,CAAC;AAE/C,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,QACJ,SAAS;AAAA,QACT,gBAAgB,SAAS;AAAA,QACzB,gBAAgB,eAAgB,kBAAkB;AAAA,MACpD;AAAA,IACF,CAAC;AAAA,EACH,CAAC;AAUD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAOA,UACG;AACH,YAAM,QAAQ,SAAS,QAAQ,MAAM,SAAS,MAAM,EAAE;AACtD,YAAM,UAAU,cAAe,YAAY;AAAA,QACzC,MAAM,QAAQ,MAAM;AAAA,QACpB,QAAQ,QAAQ,MAAM;AAAA,QACtB;AAAA,MACF,CAAC;AAED,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,QACN,OAAO,QAAQ;AAAA,MACjB,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,YAAM,SAAS,cAAe,UAAU,QAAQ,OAAO,EAAE;AAEzD,UAAI,CAAC,QAAQ;AACX,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAEA,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,MACR,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAMA,UACG;AACH,UAAI;AACF,cAAM,SAAS,MAAM,cAAe;AAAA,UACjC,QAAQ,KAAK,QAAQ;AAAA,UACtB,QAAQ,KAAK;AAAA,QACf;AAEA,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,UACT,MAAM;AAAA,QACR,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,WAAW,MAAM,cAAe,eAAe,QAAQ,KAAK,WAAW;AAE7E,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,UACT,MAAM;AAAA,QACR,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,UAAU,MAAM,cAAe,aAAa,QAAQ,OAAO,EAAE;AAEnE,YAAI,CAAC,SAAS;AACZ,iBAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,YAC5B,SAAS;AAAA,YACT,OAAO;AAAA,UACT,CAAC;AAAA,QACH;AAEA,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,QACX,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ,KAAK,2BAA2B,OAAO,UAAU,UAAU;AACjE,QAAI;AACF,YAAM,SAAS,MAAM,cAAe,eAAe;AAEnD,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,SAAS;AAAA,QACT,MAAM;AAAA,MACR,CAAC;AAAA,IACH,SAAS,OAAO;AACd,YAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,aAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,QAC5B,SAAS;AAAA,QACT,OAAO;AAAA,MACT,CAAC;AAAA,IACH;AAAA,EACF,CAAC;AAUD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,WAAW,MAAM,eAAgB,QAAQ,QAAQ,IAAI;AAE3D,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,UACT,MAAM;AAAA,QACR,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,aAAa,IAAI,KAAK,QAAQ,KAAK,UAAU;AACnD,cAAM,WAAW,MAAM,eAAgB,qBAAqB,UAAU;AAEtE,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,SAAS;AAAA,UACT,MAAM;AAAA,QACR,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,YAAM,WAAW,eAAgB,mBAAmB,QAAQ,OAAO,EAAE;AAErE,UAAI,CAAC,UAAU;AACb,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAEA,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,MACR,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ,IAAI,2BAA2B,OAAO,UAAU,UAAU;AAChE,UAAM,UAAU,eAAgB,kBAAkB;AAElD,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,IACR,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,YAAM,QAAQ,SAAS,QAAQ,MAAM,SAAS,MAAM,EAAE;AACtD,YAAM,WAAW,eAAgB,aAAa,KAAK;AAEnD,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,QACN,OAAO,SAAS;AAAA,MAClB,CAAC;AAAA,IACH;AAAA,EACF;AAUA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,UAAI;AACF,cAAM,SAAS,MAAM,eAAgB,eAAe,QAAQ,OAAO,EAAE;AAErE,eAAO,MAAM,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,MAAM;AAAA,QACR,CAAC;AAAA,MACH,SAAS,OAAO;AACd,cAAM,UAAU,iBAAiB,QAAQ,MAAM,UAAU;AACzD,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAUA,UAAQ,KAAK,2BAA2B,OAAO,UAAU,UAAU;AACjE,kBAAe,eAAe;AAC9B,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,SAAS;AAAA,IACX,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ,KAAK,0BAA0B,OAAO,UAAU,UAAU;AAChE,kBAAe,cAAc;AAC7B,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,SAAS;AAAA,IACX,CAAC;AAAA,EACH,CAAC;AAUD,UAAQ,IAAI,iBAAiB,OAAO,UAAU,UAAU;AACtD,UAAM,QAAQ,cAAe,SAAS;AAEtC,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,IACR,CAAC;AAAA,EACH,CAAC;AACH;;;AChaA,eAAsB,oBAAoB,SAAyC;AAEjF,MAAI,gBAAgB,wBAAwB;AAC5C,MAAI,CAAC,eAAe;AAClB,oBAAgB,2BAA2B;AAAA,MACzC,aAAa;AAAA,MACb,aAAa,QAAQ,IAAI,YAAY;AAAA,IACvC,CAAC;AAAA,EACH;AAUA,UAAQ,IAAI,6BAA6B,OAAO,UAAU,UAAU;AAClE,UAAM,SAAS,cAAe,UAAU;AAExC,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,IACR,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ,IAAI,8BAA8B,OAAO,UAAU,UAAU;AACnE,UAAM,UAAU,cAAe,WAAW;AAE1C,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,IACR,CAAC;AAAA,EACH,CAAC;AAUD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAYA,UACG;AACH,YAAM,QAAqC;AAAA,QACzC,aAAa,QAAQ,MAAM;AAAA,QAC3B,eAAe,QAAQ,MAAM;AAAA,QAC7B,aAAa,QAAQ,MAAM,cAAc,SAAS,QAAQ,MAAM,aAAa,EAAE,IAAI;AAAA,QACnF,aAAa,QAAQ,MAAM,cAAc,SAAS,QAAQ,MAAM,aAAa,EAAE,IAAI;AAAA,QACnF,WAAW,QAAQ,MAAM,YAAY,SAAS,QAAQ,MAAM,WAAW,EAAE,IAAI;AAAA,QAC7E,SAAS,QAAQ,MAAM,UAAU,SAAS,QAAQ,MAAM,SAAS,EAAE,IAAI;AAAA,QACvE,OAAO,QAAQ,MAAM,QAAQ,SAAS,QAAQ,MAAM,OAAO,EAAE,IAAI;AAAA,MACnE;AAGA,UAAI,QAAQ,MAAM,MAAM;AACtB,YAAI;AACF,gBAAM,OAAO,KAAK,MAAM,QAAQ,MAAM,IAAI;AAAA,QAC5C,QAAQ;AAAA,QAER;AAAA,MACF;AAEA,YAAM,SAAS,cAAe,aAAa,KAAK;AAEhD,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,QACN,OAAO,OAAO;AAAA,MAChB,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,YAAM,QAAQ,cAAe,SAAS,QAAQ,OAAO,OAAO;AAE5D,UAAI,CAAC,OAAO;AACV,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAEA,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,MACR,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SACA,UACG;AACH,YAAM,OAAO,cAAe,UAAU;AAAA,QACpC,SAAS,QAAQ,OAAO;AAAA,MAC1B,CAAC;AAED,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,QACN,OAAO,KAAK;AAAA,MACd,CAAC;AAAA,IACH;AAAA,EACF;AAUA,UAAQ,IAAI,8BAA8B,OAAO,UAAU,UAAU;AACnE,UAAM,UAAU,cAAe,cAAc;AAE7C,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,MACN,OAAO,QAAQ;AAAA,IACjB,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAUA,UACG;AACH,YAAM,QAAqB;AAAA,QACzB,MAAM,QAAQ,OAAO;AAAA,QACrB,WAAW,QAAQ,MAAM,YAAY,SAAS,QAAQ,MAAM,WAAW,EAAE,IAAI;AAAA,QAC7E,SAAS,QAAQ,MAAM,UAAU,SAAS,QAAQ,MAAM,SAAS,EAAE,IAAI;AAAA,QACvE,MAAM,QAAQ,MAAM,OAAO,SAAS,QAAQ,MAAM,MAAM,EAAE,IAAI;AAAA,QAC9D,aAAa,QAAQ,MAAM;AAAA,MAC7B;AAGA,UAAI,QAAQ,MAAM,QAAQ;AACxB,YAAI;AACF,gBAAM,SAAS,KAAK,MAAM,QAAQ,MAAM,MAAM;AAAA,QAChD,QAAQ;AAAA,QAER;AAAA,MACF;AAEA,YAAM,SAAS,cAAe,aAAa,KAAK;AAEhD,UAAI,CAAC,QAAQ;AACX,eAAO,MAAM,OAAO,GAAG,EAAE,KAAK;AAAA,UAC5B,SAAS;AAAA,UACT,OAAO;AAAA,QACT,CAAC;AAAA,MACH;AAEA,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,MACR,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ,IAAI,yCAAyC,OAAO,UAAU,UAAU;AAC9E,UAAM,aAAa,cAAe,qBAAqB;AAEvD,WAAO,MACJ,OAAO,gBAAgB,0CAA0C,EACjE,KAAK,UAAU;AAAA,EACpB,CAAC;AAMD,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAOA,UACG;AACH,oBAAe;AAAA,QACb,QAAQ,KAAK;AAAA,QACb,QAAQ,KAAK;AAAA,QACb,QAAQ,KAAK;AAAA,MACf;AAEA,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,SAAS;AAAA,MACX,CAAC;AAAA,IACH;AAAA,EACF;AAUA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAYA,UACG;AACH,YAAM,QAAkB;AAAA,QACtB,SAAS,QAAQ,MAAM;AAAA,QACvB,QAAQ,QAAQ,MAAM;AAAA,QACtB,aAAa,QAAQ,MAAM;AAAA,QAC3B,UAAU,QAAQ,MAAM;AAAA,QACxB,cAAc,QAAQ,MAAM;AAAA,QAC5B,WAAW,QAAQ,MAAM,YAAY,SAAS,QAAQ,MAAM,WAAW,EAAE,IAAI;AAAA,QAC7E,SAAS,QAAQ,MAAM,UAAU,SAAS,QAAQ,MAAM,SAAS,EAAE,IAAI;AAAA,QACvE,OAAO,QAAQ,MAAM,QAAQ,SAAS,QAAQ,MAAM,OAAO,EAAE,IAAI;AAAA,MACnE;AAEA,YAAM,OAAO,cAAe,UAAU,KAAK;AAE3C,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,QACN,OAAO,KAAK;AAAA,MACd,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SAOA,UACG;AACH,YAAM,EAAE,UAAU,SAAS,WAAW,IAAI,QAAQ;AAElD,cAAQ,UAAU;AAAA,QAChB,KAAK;AACH,wBAAe,SAAS,SAAS,UAAU;AAC3C;AAAA,QACF,KAAK;AACH,wBAAe,SAAS,SAAS,UAAU;AAC3C;AAAA,QACF,KAAK;AACH,wBAAe,QAAQ,SAAS,UAAU;AAC1C;AAAA,QACF,KAAK;AACH,wBAAe,QAAQ,SAAS,UAAU;AAC1C;AAAA,QACF,KAAK;AACH,wBAAe,SAAS,SAAS,QAAW,UAAU;AACtD;AAAA,QACF,KAAK;AACH,wBAAe,SAAS,SAAS,QAAW,UAAU;AACtD;AAAA,MACJ;AAEA,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,SAAS;AAAA,MACX,CAAC;AAAA,IACH;AAAA,EACF;AAUA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SASA,UACG;AACH,YAAM,EAAE,MAAM,MAAM,eAAe,cAAc,WAAW,IAAI,QAAQ;AAExE,YAAM,OAAO,cAAe,UAAU,MAAM;AAAA,QAC1C;AAAA,QACA,SAAS,iBAAiB,eACtB,EAAE,SAAS,eAAe,QAAQ,cAAc,YAAY,EAAE,IAC9D;AAAA,QACJ;AAAA,MACF,CAAC;AAED,YAAM,UAAU,KAAK,WAAW;AAEhC,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,MAAM;AAAA,UACJ,SAAS,QAAQ;AAAA,UACjB,QAAQ,QAAQ;AAAA,UAChB,cAAc,QAAQ;AAAA,QACxB;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF;AAMA,UAAQ;AAAA,IACN;AAAA,IACA,OACE,SASA,UACG;AAIH,aAAO,MAAM,KAAK;AAAA,QAChB,SAAS;AAAA,QACT,SAAS;AAAA,MACX,CAAC;AAAA,IACH;AAAA,EACF;AAUA,UAAQ,KAAK,4BAA4B,OAAO,UAAU,UAAU;AAClE,kBAAe,MAAM;AAErB,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,SAAS;AAAA,IACX,CAAC;AAAA,EACH,CAAC;AAMD,UAAQ,IAAI,6BAA6B,OAAO,UAAU,UAAU;AAClE,UAAM,SAAS,cAAe,UAAU;AAGxC,UAAM,aAAa;AAAA,MACjB,aAAa,OAAO;AAAA,MACpB,gBAAgB,OAAO;AAAA,MACvB,aAAa,OAAO;AAAA,MACpB,SAAS;AAAA,QACP,SAAS,OAAO,QAAQ;AAAA,QACxB,SAAS,OAAO,QAAQ;AAAA,MAC1B;AAAA,MACA,SAAS;AAAA,QACP,SAAS,OAAO,QAAQ;AAAA,QACxB,iBAAiB,OAAO,QAAQ;AAAA,MAClC;AAAA,MACA,SAAS;AAAA,QACP,SAAS,OAAO,QAAQ;AAAA,QACxB,aAAa,OAAO,QAAQ;AAAA,MAC9B;AAAA,MACA,WAAW,OAAO;AAAA,IACpB;AAEA,WAAO,MAAM,KAAK;AAAA,MAChB,SAAS;AAAA,MACT,MAAM;AAAA,IACR,CAAC;AAAA,EACH,CAAC;AACH;;;ACrdA,SAAS,mBAAmB;AAyC5B,IAAM,oBAAoB;AAAA,EACxB;AAAA,EAAY;AAAA,EAAa;AAAA,EAAY;AAAA,EAAU;AAAA,EAC/C;AAAA,EAAY;AAAA,EAAQ;AAAA,EAAU;AAAA,EAAY;AAAA,EAC1C;AAAA,EAAS;AAAA,EAAS;AAAA,EAAa;AAAA,EAAW;AAC5C;AACA,IAAM,kBAAkB;AAAA,EACtB;AAAA,EAAW;AAAA,EAAO;AAAA,EAAY;AAAA,EAAO;AAAA,EAAU;AAAA,EAC/C;AAAA,EAAU;AAAA,EAAO;AAAA,EAAO;AAAA,EAAY;AAAA,EAAW;AAAA,EAC/C;AAAA,EAAO;AAAA,EAAc;AAAA,EAAQ;AAC/B;AACA,IAAM,iBAAiB;AAAA,EACrB;AAAA,EAAO;AAAA,EAAQ;AAAA,EAAiB;AAAA,EAAa;AAAA,EAC7C;AAAA,EAAO;AAAA,EAAgB;AAAA,EAAa;AAAA,EAAY;AAClD;AAEA,SAAS,iBAAiB,UAA6D;AACrF,QAAM,IAAI,SAAS,YAAY;AAC/B,MAAI,kBAAkB,KAAK,QAAM,EAAE,SAAS,EAAE,CAAC,EAAG,QAAO;AACzD,MAAI,gBAAgB,KAAK,QAAM,EAAE,SAAS,EAAE,CAAC,EAAG,QAAO;AACvD,MAAI,eAAe,KAAK,QAAM,EAAE,SAAS,EAAE,CAAC,EAAG,QAAO;AACtD,SAAO;AACT;AAEA,eAAe,yBAAsD;AACnE,MAAI;AAEF,UAAM,WAAW,MAAM,MAAM,mEAAmE;AAAA,MAC9F,SAAS,EAAE,cAAc,gBAAgB,UAAU,mBAAmB;AAAA,MACtE,QAAQ,YAAY,QAAQ,GAAK;AAAA,IACnC,CAAC;AACD,QAAI,CAAC,SAAS,GAAI,QAAO,CAAC;AAC1B,UAAM,OAAO,MAAM,SAAS,KAAK;AACjC,UAAM,UAAU,MAAM,QAAQ,IAAI,IAAI,OAAQ,KAAK,WAAW,CAAC;AAE/D,WAAO,QACJ,OAAO,CAAC,MAAW,CAAC,EAAE,UAAU,EAAE,YAAY,GAAI,EAClD,IAAI,CAAC,MAAW;AACf,YAAM,SAAS,EAAE,eAAe,IAAI,CAAC,MAAc,WAAW,CAAC,IAAI,GAAG,KAAK,CAAC,IAAI,EAAE;AAClF,aAAO;AAAA,QACL,IAAI,QAAQ,EAAE,EAAE;AAAA,QAChB,QAAQ;AAAA,QACR,UAAU,EAAE;AAAA,QACZ,UAAU,iBAAiB,EAAE,QAAQ;AAAA,QACrC,UAAU,OAAO,CAAC,KAAK;AAAA,QACvB,SAAS,OAAO,CAAC,KAAK;AAAA,QACtB,WAAW,EAAE,cAAc;AAAA,QAC3B,aAAa,EAAE,UAAU;AAAA,QACzB,WAAW,EAAE,aAAa;AAAA,QAC1B,gBAAgB;AAAA;AAAA,QAChB,WAAW,EAAE;AAAA,QACb,KAAK,gCAAgC,EAAE,IAAI;AAAA,MAC7C;AAAA,IACF,CAAC,EACA,MAAM,GAAG,EAAE;AAAA,EAChB,SAAS,OAAO;AACd,YAAQ,MAAM,yCAAyC,KAAK;AAC5D,WAAO,CAAC;AAAA,EACV;AACF;AAEA,eAAe,qBAAkD;AAC/D,MAAI;AAEF,QAAI,WAAW,MAAM,MAAM,+EAA+E;AAAA,MACxG,SAAS,EAAE,cAAc,gBAAgB,UAAU,mBAAmB;AAAA,MACtE,QAAQ,YAAY,QAAQ,GAAK;AAAA,IACnC,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AAChB,iBAAW,MAAM,MAAM,6EAA6E;AAAA,QAClG,SAAS,EAAE,cAAc,gBAAgB,UAAU,mBAAmB;AAAA,QACtE,QAAQ,YAAY,QAAQ,GAAK;AAAA,MACnC,CAAC;AAAA,IACH;AAEA,QAAI,CAAC,SAAS,GAAI,QAAO,CAAC;AAC1B,UAAM,OAAO,MAAM,SAAS,KAAK;AACjC,UAAM,UAAU,KAAK,WAAW,CAAC;AAEjC,WAAO,QACJ,OAAO,CAAC,OAAY,EAAE,WAAW,YAAY,EAAE,WAAW,WAAW,EAAE,SAAS,EAAE,EAClF,IAAI,CAAC,MAAW;AACf,YAAM,WAAW,EAAE,UAAU,IAAI,EAAE,UAAU,EAAE;AAC/C,YAAM,UAAU,EAAE,SAAS,IAAI,EAAE,SAAU,MAAM,EAAE;AACnD,YAAM,cAAc,EAAE,aAAa,EAAE;AAErC,aAAO;AAAA,QACL,IAAI,UAAU,EAAE,MAAM;AAAA,QACtB,QAAQ;AAAA,QACR,UAAU,EAAE;AAAA,QACZ,UAAU,iBAAiB,EAAE,KAAK;AAAA,QAClC;AAAA,QACA;AAAA,QACA,WAAW,EAAE,cAAc;AAAA,QAC3B,aAAa,EAAE,UAAU;AAAA,QACzB,WAAW,EAAE,aAAa;AAAA,QAC1B,cAAc,EAAE;AAAA,QAChB,gBAAgB;AAAA,QAChB,WAAW,EAAE;AAAA,QACb,KAAK,8BAA8B,EAAE,MAAM;AAAA,MAC7C;AAAA,IACF,CAAC,EACA,MAAM,GAAG,EAAE;AAAA,EAChB,SAAS,OAAO;AACd,YAAQ,MAAM,qCAAqC,KAAK;AACxD,WAAO,CAAC;AAAA,EACV;AACF;AAEA,eAAe,uBAAmD;AAChE,QAAM,CAAC,aAAa,aAAa,IAAI,MAAM,QAAQ,IAAI;AAAA,IACrD,uBAAuB;AAAA,IACvB,mBAAmB;AAAA,EACrB,CAAC;AAED,QAAM,aAAa,CAAC,GAAG,aAAa,GAAG,aAAa;AAGpD,QAAM,WAAW,WAAW,OAAO,OAAK,EAAE,aAAa,UAAU,EAAE,KAAK,CAAC,GAAG,MAAM,EAAE,YAAY,EAAE,SAAS;AAC3G,QAAMC,UAAS,WAAW,OAAO,OAAK,EAAE,aAAa,QAAQ,EAAE,KAAK,CAAC,GAAG,MAAM,EAAE,YAAY,EAAE,SAAS;AAGvG,QAAM,WAAW,CAAC,GAAG,UAAU,EAC5B,IAAI,QAAM,EAAE,GAAG,GAAG,YAAY,EAAE,aAAa,KAAK,IAAI,EAAE,cAAc,IAAI,GAAG,EAAE,EAC/E,KAAK,CAAC,GAAG,MAAM,EAAE,aAAa,EAAE,UAAU,EAC1C,MAAM,GAAG,EAAE;AAGd,QAAM,iBAAiB,WAAW,OAAO,CAAC,KAAK,MAAM,MAAM,EAAE,WAAW,CAAC;AACzE,QAAM,WAAW,WAAW,OAAO,CAAC,KAAK,MAAM,KAAK,IAAI,EAAE,cAAc,IAAI,KAAK,IAAI,GAAG,IAAI,EAAE,iBAAiB,KAAK,CAAC;AAErH,SAAO;AAAA,IACL,cAAa,oBAAI,KAAK,GAAE,YAAY;AAAA,IACpC,SAAS;AAAA,MACP,YAAY;AAAA,QACV,QAAQ,YAAY,SAAS;AAAA,QAC7B,aAAa,YAAY;AAAA,QACzB,aAAa,YAAY,OAAO,CAAC,KAAK,MAAM,MAAM,EAAE,aAAa,CAAC;AAAA,MACpE;AAAA,MACA,QAAQ;AAAA,QACN,QAAQ,cAAc,SAAS;AAAA,QAC/B,aAAa,cAAc;AAAA,QAC3B,aAAa,cAAc,OAAO,CAAC,KAAK,MAAM,MAAM,EAAE,aAAa,CAAC;AAAA,MACtE;AAAA,IACF;AAAA,IACA,SAAS;AAAA,MACP,UAAU,SAAS,MAAM,GAAG,EAAE;AAAA,MAC9B,QAAQA,QAAO,MAAM,GAAG,EAAE;AAAA,MAC1B;AAAA,IACF;AAAA,IACA,OAAO;AAAA,MACL,cAAc,WAAW;AAAA,MACzB;AAAA,MACA,iBAAiB;AAAA,IACnB;AAAA,EACF;AACF;AAEA,eAAsB,eACpB,SACA,KACe;AAEf,QAAM,sBAAsB,SAAS,GAAG;AAGxC,QAAM,kBAAkB,OAAO;AAG/B,QAAM,oBAAoB,OAAO;AAGjC,QAAM,UAAU,OAAO;AAGvB,QAAM,UAAU,OAAO;AAGvB,QAAM,gBAAgB,OAAO;AAG7B,QAAM,aAAa,OAAO;AAG1B,QAAM,SAAS,OAAO;AAGtB,QAAM,SAAS,OAAO;AAGtB,QAAM,oBAAoB,OAAO;AASjC,UAAQ,KAAqC,yBAAyB,OAAO,QAAQ;AACnF,UAAM,EAAE,SAAS,IAAI,IAAI;AACzB,UAAM,eAAe,CAAC,SAAS,SAAS,UAAU,WAAW,WAAW,QAAQ;AAGhF,QAAI,CAAC,aAAa,SAAS,QAAyB,GAAG;AACrD,aAAO,EAAE,IAAI,OAAO,OAAO,sCAAsC,aAAa,KAAK,IAAI,CAAC,GAAG;AAAA,IAC7F;AAEA,QAAI,iBAAiB,EAAE,cAAc,QAAyB;AAC9D,YAAQ,IAAI,oCAAoC,QAAQ,EAAE;AAE1D,WAAO,EAAE,IAAI,MAAM,SAAS,UAAU,QAAQ,eAAe,SAAS;AAAA,EACxE,CAAC;AAKD,UAAQ,KAAqC,0BAA0B,OAAO,QAAQ;AACpF,UAAM,EAAE,SAAS,IAAI,IAAI;AACzB,UAAM,eAAe,CAAC,SAAS,SAAS,UAAU,WAAW,WAAW,QAAQ;AAGhF,QAAI,CAAC,aAAa,SAAS,QAAyB,GAAG;AACrD,aAAO,EAAE,IAAI,OAAO,OAAO,oBAAoB;AAAA,IACjD;AAEA,QAAI,iBAAiB,EAAE,gBAAgB,QAAyB;AAEhE,WAAO,EAAE,IAAI,MAAM,WAAW,KAAK,IAAI,EAAE;AAAA,EAC3C,CAAC;AAKD,UAAQ,KAAqC,2BAA2B,OAAO,QAAQ;AACrF,UAAM,EAAE,SAAS,IAAI,IAAI;AACzB,UAAM,eAAe,CAAC,SAAS,SAAS,UAAU,WAAW,WAAW,QAAQ;AAGhF,QAAI,CAAC,aAAa,SAAS,QAAyB,GAAG;AACrD,aAAO,EAAE,IAAI,OAAO,OAAO,oBAAoB;AAAA,IACjD;AAEA,QAAI,iBAAiB,EAAE,iBAAiB,QAAyB;AACjE,YAAQ,IAAI,8BAA8B,QAAQ,EAAE;AAEpD,WAAO,EAAE,IAAI,MAAM,SAAS,UAAU,QAAQ,gBAAgB;AAAA,EAChE,CAAC;AASD,UAAQ,IAAI,eAAe,YAAY;AACrC,UAAM,UAAU,IAAI,iBAAiB,EAAE,aAAa;AACpD,UAAM,aAAa,IAAI,iBAAiB,EAAE,oBAAoB;AAE9D,WAAO;AAAA,MACL,IAAI,WAAW,YAAY;AAAA,MAC3B,WAAW,KAAK,IAAI;AAAA,MACpB,SAAS;AAAA,QACP,QAAQ;AAAA,QACR,SAAS;AAAA,MACX;AAAA,IACF;AAAA,EACF,CAAC;AAKD,UAAQ,IAAI,qBAAqB,YAAY;AAC3C,UAAM,QAAQ,IAAI,SAAS;AAG3B,QAAI,OAAO;AACT,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,QAAQ,MAAM,UAAU;AAAA,MAC1B;AAAA,IACF;AAGA,UAAM,aAAa,IAAI,iBAAiB,EAAE,aAAa;AACvD,UAAM,eAAe,WAAW,KAAK,OAAK,EAAE,OAAO,OAAO;AAC1D,QAAI,gBAAgB,aAAa,WAAW;AAG1C,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,QAAQ;AAAA,UACN,SAAS;AAAA,UACT,WAAW;AAAA,UACX,WAAW;AAAA,UACX,eAAe,aAAa;AAAA,UAC5B,SAAS;AAAA,QACX;AAAA,MACF;AAAA,IACF;AAEA,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,OAAO;AAAA,IACT;AAAA,EACF,CAAC;AASD,UAAQ,KAAK,oBAAoB,YAAY;AAC3C,UAAM,QAAQ,IAAI,SAAS;AAE3B,QAAI,CAAC,OAAO;AACV,aAAO,EAAE,IAAI,OAAO,OAAO,sBAAsB;AAAA,IACnD;AAEA,UAAM,MAAM;AACZ,WAAO,EAAE,IAAI,MAAM,SAAS,gBAAgB;AAAA,EAC9C,CAAC;AAKD,UAAQ,KAAK,mBAAmB,YAAY;AAC1C,UAAM,QAAQ,IAAI,SAAS;AAE3B,QAAI,CAAC,OAAO;AACV,aAAO,EAAE,IAAI,OAAO,OAAO,sBAAsB;AAAA,IACnD;AAEA,UAAM,KAAK;AACX,WAAO,EAAE,IAAI,MAAM,SAAS,gBAAgB;AAAA,EAC9C,CAAC;AAKD,UAAQ,KAAkC,oBAAoB,OAAO,QAAQ;AAC3E,UAAM,QAAQ,IAAI,SAAS;AAE3B,QAAI,CAAC,OAAO;AACV,aAAO,EAAE,IAAI,OAAO,OAAO,sBAAsB;AAAA,IACnD;AAEA,UAAM,EAAE,MAAM,IAAI,IAAI;AACtB,UAAM,MAAM,aAAa,KAAK;AAE9B,WAAO,EAAE,IAAI,MAAM,SAAS,mBAAmB,MAAM;AAAA,EACvD,CAAC;AASD,UAAQ,IAAI,iBAAiB,YAAY;AACvC,UAAM,cAAc,IAAI,eAAe;AAEvC,QAAI,CAAC,aAAa;AAChB,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO;AAAA,MACT;AAAA,IACF;AAEA,QAAI;AACF,YAAM,SAAS,MAAM,YAAY,UAAU;AAC3C,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,UAAU;AAAA,UACR,UAAU,OAAO,SAAS,cAAc,SAAS;AAAA,UACjD,YAAY,OAAO,SAAS,WAAW,SAAS;AAAA,UAChD,aAAa,OAAO,SAAS,YAAY,SAAS;AAAA,UAClD,QAAQ,OAAO,OAAO;AAAA,UACtB,aAAa,OAAO;AAAA,YAClB,OAAO,QAAQ,OAAO,SAAS,WAAW,EAAE,IAAI,CAAC,CAAC,GAAG,CAAC,MAAM;AAAA,cAC1D;AAAA,cACA,EAAE,SAAS;AAAA,YACb,CAAC;AAAA,UACH;AAAA,QACF;AAAA,QACA,QAAQ,OAAO;AAAA,MACjB;AAAA,IACF,SAAS,OAAO;AACd,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO;AAAA,MACT;AAAA,IACF;AAAA,EACF,CAAC;AASD,UAAQ,IAAI,qBAAqB,YAAY;AAC3C,UAAM,cAAc,IAAI,eAAe;AAEvC,QAAI,CAAC,aAAa;AAChB,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO;AAAA,MACT;AAAA,IACF;AAEA,QAAI;AACF,YAAM,SAAS,MAAM,YAAY,UAAU;AAC3C,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,eAAe,OAAO,SAAS,cAAc,SAAS;AAAA,QACtD,UAAU;AAAA,UACR,KAAK,OAAO,SAAS,WAAW,SAAS;AAAA,UACzC,MAAM,OAAO,SAAS,YAAY,SAAS;AAAA,QAC7C;AAAA,QACA,aAAa,OAAO;AAAA,UAClB,OAAO,QAAQ,OAAO,SAAS,WAAW,EAAE,IAAI,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC;AAAA,QAC/E;AAAA,QACA,QAAQ,OAAO,OAAO;AAAA,QACtB,UAAU;AAAA,UACR,SAAS;AAAA;AAAA,UACT,UAAU;AAAA,QACZ;AAAA,QACA,SAAS;AAAA,UACP,YAAY;AAAA;AAAA,UACZ,UAAU;AAAA,UACV,UAAU;AAAA,UACV,WAAW;AAAA,QACb;AAAA,MACF;AAAA,IACF,SAAS,OAAO;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,+BAA+B;AAAA,IAC5D;AAAA,EACF,CAAC;AAKD,UAAQ,IAAI,sBAAsB,YAAY;AAC5C,UAAM,eAAe,IAAI,gBAAgB;AAEzC,QAAI,CAAC,cAAc;AACjB,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO;AAAA;AAAA,QAEP,SAAS;AAAA,QACT,SAAS;AAAA,UACP,SAAS,EAAE,OAAO,GAAG,QAAQ,GAAG,SAAS,EAAE;AAAA,UAC3C,SAAS,EAAE,gBAAgB,GAAG,YAAY,GAAG,eAAe,EAAE;AAAA,UAC9D,QAAQ,EAAE,kBAAkB,GAAG,gBAAgB,EAAE;AAAA,UACjD,KAAK,EAAE,aAAa,GAAG,cAAc,GAAG,WAAW,EAAE;AAAA,QACvD;AAAA,QACA,iBAAiB,EAAE,WAAW,GAAG,QAAQ,EAAE;AAAA,MAC7C;AAAA,IACF;AAEA,QAAI;AACF,YAAM,SAAS,aAAa,UAAU;AACtC,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,SAAS,OAAO;AAAA,QAChB,SAAS;AAAA,UACP,SAAS,EAAE,OAAO,GAAG,QAAQ,GAAG,SAAS,EAAE;AAAA;AAAA,UAC3C,SAAS;AAAA,YACP,gBAAgB,OAAO,QAAQ;AAAA,YAC/B,YAAY;AAAA,YACZ,eAAe;AAAA,UACjB;AAAA,UACA,QAAQ;AAAA,YACN,kBAAkB;AAAA,YAClB,gBAAgB;AAAA,UAClB;AAAA,UACA,KAAK,EAAE,aAAa,GAAG,cAAc,GAAG,WAAW,EAAE;AAAA,QACvD;AAAA,QACA,iBAAiB;AAAA,UACf,WAAW,OAAO,iBAAiB,UAAU;AAAA,UAC7C,QAAQ;AAAA,QACV;AAAA,MACF;AAAA,IACF,SAAS,OAAO;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,gCAAgC;AAAA,IAC7D;AAAA,EACF,CAAC;AAKD,UAAQ,IAAI,uBAAuB,YAAY;AAC7C,UAAM,gBAAgB,IAAI,iBAAiB;AAE3C,QAAI,CAAC,eAAe;AAClB,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,EAAE,OAAO,GAAG,UAAU,GAAG,UAAU,EAAE;AAAA,QAC9C,aAAa;AAAA,QACb,SAAS,EAAE,YAAY,GAAG,OAAO,GAAG,UAAU,GAAG,aAAa,EAAE;AAAA,MAClE;AAAA,IACF;AAEA,QAAI;AACF,YAAM,UAAU,cAAc,WAAW;AACzC,YAAM,WAAW,QAAQ,OAAO,CAAC,MAAW,EAAE,WAAW,UAAU;AACnE,YAAM,WAAW,QAAQ,OAAO,CAAC,MAAW,EAAE,WAAW,UAAU;AAEnE,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,SAAS;AAAA,QACT,SAAS;AAAA,UACP,OAAO,QAAQ;AAAA,UACf,UAAU,SAAS;AAAA,UACnB,UAAU,SAAS;AAAA,QACrB;AAAA,QACA,aAAa,SAAS,SAAS,IAAI;AAAA,UACjC,IAAI,SAAS,CAAC,EAAE;AAAA,UAChB,MAAM,SAAS,CAAC,EAAE;AAAA,UAClB,UAAU;AAAA;AAAA,QACZ,IAAI;AAAA,QACJ,SAAS;AAAA,UACP,YAAY,QAAQ;AAAA,UACpB,OAAO;AAAA;AAAA,UACP,UAAU;AAAA,UACV,aAAa;AAAA,QACf;AAAA,MACF;AAAA,IACF,SAAS,OAAO;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,iCAAiC;AAAA,IAC9D;AAAA,EACF,CAAC;AAKD,UAAQ,IAAI,sBAAsB,YAAY;AAG5C,UAAM,QAAQ,IAAI,SAAS;AAE3B,QAAI,OAAO;AACT,YAAM,cAAc,MAAM,UAAU;AACpC,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,WAAW,YAAY;AAAA,QACvB,gBAAgB,YAAY,QAAQ,kBAAkB,CAAC,UAAU,cAAc,SAAS;AAAA,QACxF,kBAAkB,YAAY,QAAQ,oBAAoB;AAAA,QAC1D,cAAc,YAAY,QAAQ,gBAAgB;AAAA,QAClD,mBAAmB,YAAY,QAAQ,qBAAqB;AAAA,QAC5D,mBAAmB,CAAC;AAAA;AAAA,MACtB;AAAA,IACF;AAGA,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,WAAW;AAAA,MACX,gBAAgB,CAAC,UAAU,cAAc,WAAW,aAAa;AAAA,MACjE,kBAAkB;AAAA,MAClB,cAAc;AAAA,MACd,mBAAmB;AAAA,MACnB,mBAAmB,CAAC;AAAA,IACtB;AAAA,EACF,CAAC;AAKD,UAAQ,IAAI,wBAAwB,YAAY;AAC9C,QAAI;AACF,YAAM,WAAW,YAAY;AAC7B,YAAM,SAAS,SAAS,UAAU;AAClC,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO,OAAO;AAAA,QACd,SAAS,OAAO;AAAA,QAChB,OAAO;AAAA,UACL,SAAS,OAAO,MAAM;AAAA,UACtB,UAAU,OAAO,MAAM;AAAA,UACvB,UAAU,OAAO,MAAM;AAAA,QACzB;AAAA,QACA,OAAO,OAAO;AAAA,QACd,OAAO;AAAA,UACL,cAAc,OAAO,MAAM;AAAA,UAC3B,QAAQ,OAAO,MAAM;AAAA,UACrB,WAAW,OAAO,MAAM;AAAA,UACxB,MAAM,OAAO,MAAM;AAAA,UACnB,SAAS;AAAA,QACX;AAAA,QACA,OAAO;AAAA,UACL,cAAc,OAAO,SAAS;AAAA,UAC9B,QAAQ,OAAO,MAAM;AAAA,UACrB,SAAS,OAAO,MAAM;AAAA,QACxB;AAAA,MACF;AAAA,IACF,SAAS,OAAO;AACd,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO,iBAAiB,QAAQ,MAAM,UAAU;AAAA,QAChD,OAAO;AAAA,QACP,OAAO,EAAE,SAAS,GAAG,UAAU,GAAG,UAAU,EAAE;AAAA,QAC9C,OAAO,EAAE,OAAO,GAAG,MAAM,GAAG,QAAQ,GAAG,WAAW,GAAG,aAAa,IAAI;AAAA,QACtE,OAAO,EAAE,cAAc,GAAG,QAAQ,GAAG,WAAW,GAAG,MAAM,GAAG,SAAS,EAAE;AAAA,QACvE,OAAO,EAAE,cAAc,GAAG,QAAQ,GAAG,SAAS,EAAE;AAAA,MAClD;AAAA,IACF;AAAA,EACF,CAAC;AAKD,UAAQ,IAAI,uBAAuB,YAAY;AAC7C,QAAI;AACF,YAAM,WAAW,YAAY;AAC7B,aAAO,EAAE,IAAI,MAAM,OAAO,SAAS,SAAS,EAAE;AAAA,IAChD,SAAS,OAAO;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,iBAAiB,QAAQ,MAAM,UAAU,iBAAiB,OAAO,CAAC,EAAE;AAAA,IACjG;AAAA,EACF,CAAC;AAKD,UAAQ,KAAK,6BAA6B,OAAO,YAAY;AAC3D,QAAI;AACF,YAAM,EAAE,GAAG,IAAI,QAAQ;AACvB,YAAM,WAAW,YAAY;AAC7B,YAAM,SAAS,MAAM,SAAS,QAAQ,EAAE;AACxC,aAAO,EAAE,IAAI,CAAC,CAAC,QAAQ,SAAS,OAAO;AAAA,IACzC,SAAS,OAAO;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,iBAAiB,QAAQ,MAAM,UAAU,gBAAgB;AAAA,IACtF;AAAA,EACF,CAAC;AAKD,UAAQ,KAAK,4BAA4B,OAAO,YAAY;AAC1D,QAAI;AACF,YAAM,EAAE,GAAG,IAAI,QAAQ;AACvB,YAAM,EAAE,OAAO,IAAI,QAAQ,QAAQ,CAAC;AACpC,YAAM,WAAW,YAAY;AAC7B,YAAM,SAAS,MAAM,SAAS,OAAO,IAAI,UAAU,kBAAkB;AACrE,aAAO,EAAE,IAAI,CAAC,CAAC,QAAQ,SAAS,OAAO;AAAA,IACzC,SAAS,OAAO;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,iBAAiB,QAAQ,MAAM,UAAU,gBAAgB;AAAA,IACtF;AAAA,EACF,CAAC;AAKD,UAAQ,IAAI,4BAA4B,YAAY;AAClD,QAAI;AACF,YAAM,WAAW,YAAY;AAC7B,aAAO,EAAE,IAAI,MAAM,YAAY,SAAS,cAAc,EAAE;AAAA,IAC1D,SAAS,OAAO;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,iBAAiB,QAAQ,MAAM,UAAU,gBAAgB;AAAA,IACtF;AAAA,EACF,CAAC;AASD,UAAQ,IAAI,oBAAoB,YAAY;AAG1C,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,WAAW;AAAA,QACT,OAAO;AAAA,QACP,UAAU,EAAE,QAAQ,GAAG,YAAY,GAAG,SAAS,GAAG,OAAO,GAAG,aAAa,EAAE;AAAA,QAC3E,SAAS,CAAC;AAAA,QACV,WAAW;AAAA,MACb;AAAA,MACA,UAAU;AAAA,QACR,OAAO;AAAA,QACP,QAAQ,EAAE,aAAa,GAAG,OAAO,GAAG,SAAS,GAAG,WAAW,EAAE;AAAA,QAC7D,eAAe;AAAA,MACjB;AAAA,MACA,aAAa;AAAA,QACX,OAAO;AAAA,QACP,SAAS;AAAA,QACT,UAAU;AAAA,MACZ;AAAA,MACA,QAAQ,KAAK,IAAI;AAAA,MACjB,eAAe;AAAA,IACjB;AAAA,EACF,CAAC;AAKD,UAAQ,IAAyC,qBAAqB,OAAO,QAAQ;AACnF,UAAM,QAAQ,SAAS,IAAI,MAAM,SAAS,MAAM,EAAE;AAIlD,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,OAAO,CAAC;AAAA,MACR,OAAO;AAAA,MACP;AAAA,IACF;AAAA,EACF,CAAC;AAKD,UAAQ,IAAI,uBAAuB,YAAY;AAE7C,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,UAAU,CAAC;AAAA,MACX,OAAO;AAAA,IACT;AAAA,EACF,CAAC;AAKD,UAAQ,IAAI,0BAA0B,YAAY;AAEhD,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,aAAa,CAAC;AAAA,MACd,OAAO;AAAA,IACT;AAAA,EACF,CAAC;AAKD,UAAQ,KAAkD,qBAAqB,OAAO,QAAQ;AAC5F,UAAM,EAAE,OAAO,QAAQ,GAAG,IAAI,IAAI;AAGlC,WAAO;AAAA,MACL,IAAI;AAAA,MACJ;AAAA,MACA,SAAS,CAAC;AAAA,MACV,OAAO;AAAA,IACT;AAAA,EACF,CAAC;AAKD,UAAQ,KAAoC,qBAAqB,OAAO,QAAQ;AAC9E,UAAM,EAAE,OAAO,IAAI,IAAI;AAGvB,QAAI,YAAY,EAAE,QAAQ,SAAS,0BAA0B,EAAE,QAAQ,UAAU,MAAM,CAAC;AAExF,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,SAAS,SAAS,2BAA2B,MAAM,KAAK;AAAA,IAC1D;AAAA,EACF,CAAC;AAOD,QAAM,EAAE,cAAc,kBAAkB,eAAe,IAAI,MAAM,OAAO,sBAAoB;AAK5F,UAAQ;AAAA,IACN;AAAA,IACA,OAAO,QAAQ;AACb,YAAM,QAAQ,SAAS,IAAI,MAAM,SAAS,MAAM,EAAE;AAClD,YAAM,WAAW,IAAI,MAAM;AAE3B,UAAI;AACJ,UAAI,UAAU;AACZ,iBAAS,IACN,YAAY,EACZ,oBAAoB,UAAiB,KAAK;AAAA,MAC/C,OAAO;AACL,iBAAS,IAAI,YAAY,EAAE,gBAAgB,KAAK;AAAA,MAClD;AAEA,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO,OAAO;AAAA,QACd;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,OAAO,QAAQ;AACb,YAAM,QAAQ,SAAS,IAAI,MAAM,SAAS,MAAM,EAAE;AAClD,YAAM,WAAW,IAAI,MAAM;AAC3B,YAAM,WAAW,IAAI,MAAM;AAE3B,UAAI;AACJ,UAAI,UAAU;AACZ,iBAAS,IACN,YAAY,EACZ,oBAAoB,UAAiB,KAAK;AAAA,MAC/C,OAAO;AACL,iBAAS,IAAI,YAAY,EAAE,gBAAgB,KAAK;AAAA,MAClD;AAGA,UAAI,WAAW,aAAa,MAAM;AAGlC,UAAI,UAAU;AACZ,mBAAW,SAAS,OAAO,CAAC,MAAM,EAAE,aAAa,QAAQ;AAAA,MAC3D;AAEA,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO,SAAS;AAAA,QAChB,QAAQ;AAAA,MACV;AAAA,IACF;AAAA,EACF;AAKA,UAAQ,IAAI,0BAA0B,YAAY;AAChD,UAAM,aAAa,iBAAiB;AACpC,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,YAAY,WAAW,IAAI,CAAC,OAAO;AAAA,QACjC,IAAI;AAAA,QACJ,MAAM,EAAE,OAAO,CAAC,EAAE,YAAY,IAAI,EAAE,MAAM,CAAC;AAAA,QAC3C,MAAM,eAAe,CAAC;AAAA,MACxB,EAAE;AAAA,IACJ;AAAA,EACF,CAAC;AASD,UAAQ,IAAI,gBAAgB,YAAY;AACtC,UAAM,gBAAgB,IAAI,iBAAiB;AAE3C,QAAI,CAAC,eAAe;AAClB,aAAO,EAAE,IAAI,OAAO,OAAO,+BAA+B;AAAA,IAC5D;AAEA,UAAM,UAAU,cAAc,WAAW;AACzC,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,OAAO,QAAQ;AAAA,MACf,OAAO;AAAA,IACT;AAAA,EACF,CAAC;AAKD,UAAQ,KAAK,sBAAsB,YAAY;AAC7C,UAAM,gBAAgB,IAAI,iBAAiB;AAE3C,QAAI,CAAC,eAAe;AAClB,aAAO,EAAE,IAAI,OAAO,OAAO,+BAA+B;AAAA,IAC5D;AAEA,QAAI;AACF,YAAM,gBAAgB,MAAM,cAAc,aAAa;AACvD,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO,cAAc;AAAA,QACrB;AAAA,MACF;AAAA,IACF,SAAS,OAAO;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,mBAAmB;AAAA,IAChD;AAAA,EACF,CAAC;AASD,UAAQ;AAAA,IACN;AAAA,IACA,OAAO,QAAQ;AACb,YAAM,eAAe,IAAI,gBAAgB;AAEzC,UAAI,CAAC,cAAc;AACjB,eAAO,EAAE,IAAI,OAAO,OAAO,8BAA8B;AAAA,MAC3D;AAEA,YAAM,EAAE,KAAK,IAAI,IAAI;AAErB,UAAI;AACF,cAAM,aAAa,YAAY,IAAI;AACnC,cAAM,SAAS,aAAa,UAAU;AAEtC,eAAO;AAAA,UACL,IAAI;AAAA,UACJ;AAAA,UACA,iBAAiB,OAAO;AAAA,QAC1B;AAAA,MACF,SAAS,OAAO;AACd,eAAO,EAAE,IAAI,OAAO,OAAO,4BAA4B;AAAA,MACzD;AAAA,IACF;AAAA,EACF;AASA,UAAQ,IAAI,2BAA2B,YAAY;AACjD,QAAI;AACF,YAAM,cAAc,MAAM,qBAAqB;AAC/C,aAAO;AAAA,IACT,SAAS,OAAO;AACd,cAAQ,MAAM,6CAA6C,KAAK;AAChE,aAAO;AAAA,QACL,cAAa,oBAAI,KAAK,GAAE,YAAY;AAAA,QACpC,SAAS;AAAA,UACP,YAAY,EAAE,QAAQ,OAAO,aAAa,GAAG,aAAa,EAAE;AAAA,UAC5D,QAAQ,EAAE,QAAQ,OAAO,aAAa,GAAG,aAAa,EAAE;AAAA,QAC1D;AAAA,QACA,SAAS,EAAE,UAAU,CAAC,GAAG,QAAQ,CAAC,GAAG,UAAU,CAAC,EAAE;AAAA,QAClD,OAAO,EAAE,cAAc,GAAG,gBAAgB,GAAG,iBAAiB,EAAE;AAAA,MAClE;AAAA,IACF;AAAA,EACF,CAAC;AAGD,UAAQ,IAAI,8BAA8B,YAAY;AACpD,QAAI;AACF,YAAM,cAAc,MAAM,qBAAqB;AAC/C,aAAO;AAAA,IACT,SAAS,OAAO;AACd,cAAQ,MAAM,6CAA6C,KAAK;AAChE,aAAO;AAAA,QACL,cAAa,oBAAI,KAAK,GAAE,YAAY;AAAA,QACpC,SAAS;AAAA,UACP,YAAY,EAAE,QAAQ,OAAO,aAAa,GAAG,aAAa,EAAE;AAAA,UAC5D,QAAQ,EAAE,QAAQ,OAAO,aAAa,GAAG,aAAa,EAAE;AAAA,QAC1D;AAAA,QACA,SAAS,EAAE,UAAU,CAAC,GAAG,QAAQ,CAAC,GAAG,UAAU,CAAC,EAAE;AAAA,QAClD,OAAO,EAAE,cAAc,GAAG,gBAAgB,GAAG,iBAAiB,EAAE;AAAA,MAClE;AAAA,IACF;AAAA,EACF,CAAC;AAOD,QAAM,qBAAqB,oBAAI,IAA+B;AA6B9D,UAAQ,KAiBL,0BAA0B,OAAO,QAAQ;AAC1C,UAAM,EAAE,UAAU,SAAS,CAAC,EAAE,IAAI,IAAI;AACtC,UAAM,cAAc,QAAQ,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,GAAG,CAAC,CAAC;AAGhF,UAAM,YAA+B;AAAA,MACnC,IAAI;AAAA,MACJ,YAAY,SAAS;AAAA,MACrB,cAAc,SAAS;AAAA,MACvB,QAAQ;AAAA,MACR,UAAU;AAAA,MACV,aAAa;AAAA,MACb,OAAO,SAAS,MAAM,IAAI,CAAC,OAAO;AAAA,QAChC,IAAI,EAAE;AAAA,QACN,MAAM,EAAE,QAAQ,EAAE;AAAA,QAClB,QAAQ;AAAA,QACR,WAAW;AAAA,QACX,aAAa;AAAA,QACb,QAAQ;AAAA,QACR,OAAO;AAAA,MACT,EAAE;AAAA,MACF,WAAW,KAAK,IAAI;AAAA,MACpB,aAAa;AAAA,MACb,QAAQ;AAAA,MACR,OAAO;AAAA,IACT;AAEA,uBAAmB,IAAI,aAAa,SAAS;AAG7C,QAAI,YAAY,EAAE,QAAQ,YAAY,oBAAoB;AAAA,MACxD;AAAA,MACA,YAAY,SAAS;AAAA,MACrB,cAAc,SAAS;AAAA,MACvB,WAAW,SAAS,MAAM;AAAA,IAC5B,CAAC;AAGD,yBAAqB,WAAW,UAAU,QAAQ,IAAI,YAAY,CAAC;AAEnE,WAAO;AAAA,MACL,IAAI;AAAA,MACJ;AAAA,MACA,SAAS;AAAA,IACX;AAAA,EACF,CAAC;AAKD,UAAQ;AAAA,IACN;AAAA,IACA,OAAO,QAAQ;AACb,YAAM,EAAE,YAAY,IAAI,IAAI;AAC5B,YAAM,YAAY,mBAAmB,IAAI,WAAW;AAEpD,UAAI,CAAC,WAAW;AACd,eAAO;AAAA,UACL,IAAI;AAAA,UACJ,OAAO,wBAAwB,WAAW;AAAA,QAC5C;AAAA,MACF;AAEA,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,WAAW;AAAA,UACT,IAAI,UAAU;AAAA,UACd,YAAY,UAAU;AAAA,UACtB,cAAc,UAAU;AAAA,UACxB,QAAQ,UAAU;AAAA,UAClB,UAAU,UAAU;AAAA,UACpB,aAAa,UAAU;AAAA,UACvB,OAAO,UAAU;AAAA,UACjB,WAAW,UAAU;AAAA,UACrB,aAAa,UAAU;AAAA,UACvB,UAAU,UAAU,cAChB,UAAU,cAAc,UAAU,YAClC,KAAK,IAAI,IAAI,UAAU;AAAA,UAC3B,QAAQ,UAAU;AAAA,UAClB,OAAO,UAAU;AAAA,QACnB;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,OAAO,QAAQ;AACb,YAAM,QAAQ,SAAS,IAAI,MAAM,SAAS,MAAM,EAAE;AAClD,YAAM,eAAe,IAAI,MAAM;AAE/B,UAAI,aAAa,MAAM,KAAK,mBAAmB,OAAO,CAAC;AAEvD,UAAI,cAAc;AAChB,qBAAa,WAAW,OAAO,CAAC,MAAM,EAAE,WAAW,YAAY;AAAA,MACjE;AAGA,iBAAW,KAAK,CAAC,GAAG,MAAM,EAAE,YAAY,EAAE,SAAS;AAEnD,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO,WAAW;AAAA,QAClB,YAAY,WAAW,MAAM,GAAG,KAAK,EAAE,IAAI,CAAC,OAAO;AAAA,UACjD,IAAI,EAAE;AAAA,UACN,YAAY,EAAE;AAAA,UACd,cAAc,EAAE;AAAA,UAChB,QAAQ,EAAE;AAAA,UACV,UAAU,EAAE;AAAA,UACZ,WAAW,EAAE;AAAA,UACb,aAAa,EAAE;AAAA,UACf,UAAU,EAAE,cACR,EAAE,cAAc,EAAE,YAClB,KAAK,IAAI,IAAI,EAAE;AAAA,QACrB,EAAE;AAAA,MACJ;AAAA,IACF;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,OAAO,QAAQ;AACb,YAAM,EAAE,YAAY,IAAI,IAAI;AAC5B,YAAM,YAAY,mBAAmB,IAAI,WAAW;AAEpD,UAAI,CAAC,WAAW;AACd,eAAO,EAAE,IAAI,OAAO,OAAO,wBAAwB,WAAW,GAAG;AAAA,MACnE;AAEA,UAAI,UAAU,WAAW,aAAa,UAAU,WAAW,WAAW;AACpE,eAAO,EAAE,IAAI,OAAO,OAAO,wCAAwC,UAAU,MAAM,GAAG;AAAA,MACxF;AAEA,gBAAU,SAAS;AACnB,gBAAU,cAAc,KAAK,IAAI;AAEjC,UAAI,YAAY,EAAE,QAAQ,YAAY,sBAAsB;AAAA,QAC1D;AAAA,QACA,YAAY,UAAU;AAAA,MACxB,CAAC;AAED,aAAO,EAAE,IAAI,MAAM,SAAS,qBAAqB;AAAA,IACnD;AAAA,EACF;AAGA,iBAAe,qBACb,WACA,UACA,QACAC,WACe;AACf,QAAI;AACF,gBAAU,SAAS;AAEnB,YAAM,UAAmC,CAAC;AAC1C,YAAM,iBAAiB,oBAAI,IAAY;AACvC,YAAM,aAAa,SAAS,MAAM;AAElC,eAAS,IAAI,GAAG,IAAI,SAAS,MAAM,QAAQ,KAAK;AAE9C,YAAI,UAAU,WAAW,aAAa;AACpC;AAAA,QACF;AAEA,cAAM,OAAO,SAAS,MAAM,CAAC;AAC7B,cAAM,aAAa,UAAU,MAAM,KAAK,CAAC,MAAoB,EAAE,OAAO,KAAK,EAAE;AAG7E,YAAI,KAAK,WAAW,QAAQ;AAC1B,gBAAM,SAAS,KAAK,UAAU,MAAM,CAAC,QAAgB,eAAe,IAAI,GAAG,CAAC;AAC5E,cAAI,CAAC,QAAQ;AACX,uBAAW,SAAS;AACpB,uBAAW,QAAQ;AACnB,YAAAA,UAAS,QAAQ,YAAY,yBAAyB;AAAA,cACpD,aAAa,UAAU;AAAA,cACvB,QAAQ,KAAK;AAAA,cACb,QAAQ;AAAA,YACV,CAAC;AACD;AAAA,UACF;AAAA,QACF;AAGA,kBAAU,cAAc,KAAK;AAC7B,mBAAW,SAAS;AACpB,mBAAW,YAAY,KAAK,IAAI;AAEhC,QAAAA,UAAS,QAAQ,YAAY,yBAAyB;AAAA,UACpD,aAAa,UAAU;AAAA,UACvB,QAAQ,KAAK;AAAA,UACb,MAAM,KAAK;AAAA,QACb,CAAC;AAED,YAAI;AAEF,gBAAM,sBAAsB,MAAM,QAAQ,OAAO;AAEjD,qBAAW,SAAS;AACpB,qBAAW,cAAc,KAAK,IAAI;AAClC,qBAAW,SAAS,EAAE,SAAS,MAAM,MAAM,KAAK,KAAK;AACrD,yBAAe,IAAI,KAAK,EAAE;AAC1B,kBAAQ,KAAK,EAAE,IAAI,WAAW;AAE9B,UAAAA,UAAS,QAAQ,YAAY,2BAA2B;AAAA,YACtD,aAAa,UAAU;AAAA,YACvB,QAAQ,KAAK;AAAA,YACb,UAAU,WAAW,eAAe,WAAW,aAAa;AAAA,UAC9D,CAAC;AAAA,QACH,SAAS,OAAO;AACd,qBAAW,SAAS;AACpB,qBAAW,cAAc,KAAK,IAAI;AAClC,qBAAW,QAAQ,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK;AAExE,UAAAA,UAAS,QAAQ,YAAY,wBAAwB;AAAA,YACnD,aAAa,UAAU;AAAA,YACvB,QAAQ,KAAK;AAAA,YACb,OAAO,WAAW;AAAA,UACpB,CAAC;AAAA,QACH;AAGA,kBAAU,WAAW,KAAK,OAAQ,IAAI,KAAK,aAAc,GAAG;AAAA,MAC9D;AAGA,gBAAU,SAAS,UAAU,MAAM,KAAK,CAAC,MAAoB,EAAE,WAAW,QAAQ,IAAI,WAAW;AACjG,gBAAU,cAAc,KAAK,IAAI;AACjC,gBAAU,cAAc;AACxB,gBAAU,SAAS;AAEnB,MAAAA,UAAS,QAAQ,YAAY,sBAAsB;AAAA,QACjD,aAAa,UAAU;AAAA,QACvB,YAAY,UAAU;AAAA,QACtB,QAAQ,UAAU;AAAA,QAClB,UAAU,UAAU,cAAc,UAAU;AAAA,MAC9C,CAAC;AAAA,IACH,SAAS,OAAO;AACd,gBAAU,SAAS;AACnB,gBAAU,cAAc,KAAK,IAAI;AACjC,gBAAU,QAAQ,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK;AAEvE,MAAAA,UAAS,QAAQ,YAAY,mBAAmB;AAAA,QAC9C,aAAa,UAAU;AAAA,QACvB,YAAY,UAAU;AAAA,QACtB,OAAO,UAAU;AAAA,MACnB,CAAC;AAAA,IACH;AAAA,EACF;AAGA,iBAAe,sBACb,MACA,QACA,SACe;AAEf,UAAM,QAAQ,MAAM,KAAK,OAAO,IAAI;AACpC,UAAM,IAAI,QAAQ,CAAC,YAAY,WAAW,SAAS,KAAK,CAAC;AAGzD,QAAI,KAAK,OAAO,IAAI,KAAK;AACvB,YAAM,IAAI,MAAM,QAAQ,KAAK,EAAE,0BAA0B;AAAA,IAC3D;AAAA,EACF;AAOA,QAAM,EAAE,oBAAoB,IAAI,MAAM,OAAO,yBAAiB;AAC9D,QAAM,YAAY,oBAAoB;AAItC,MAAI,YAAY,EAAE,UAAU,YAAY,oBAAoB,OAAO,SAAc;AAC/E,UAAM,OAAO,mBAAmB,IAAI,KAAK,WAAW;AACpD,QAAI,MAAM;AACR,gBAAU,eAAe,KAAK,YAAY,KAAK,cAAc,KAAK,MAAM,MAAM;AAAA,IAChF;AAAA,EACF,CAAC;AAGD,MAAI,YAAY,EAAE,UAAU,YAAY,2BAA2B,OAAO,SAAc;AACtF,UAAM,OAAO,mBAAmB,IAAI,KAAK,WAAW;AACpD,QAAI,MAAM;AACR,YAAM,OAAO,KAAK,MAAM,KAAK,CAAC,MAAoB,EAAE,OAAO,KAAK,MAAM;AACtE,UAAI,MAAM;AAER,kBAAU;AAAA,UACR,KAAK;AAAA,UACL,KAAK;AAAA,UACL,KAAK;AAAA,UACL;AAAA,UACA,EAAE,OAAO,MAAM,KAAK,OAAO,IAAI,KAAK,QAAQ,MAAM,KAAK,OAAO,IAAI,KAAK,OAAO,EAAE;AAAA,QAClF;AAAA,MACF;AAAA,IACF;AAAA,EACF,CAAC;AAGD,MAAI,YAAY,EAAE,UAAU,YAAY,sBAAsB,OAAO,SAAc;AACjF,cAAU;AAAA,MACR,KAAK;AAAA,MACL,KAAK,WAAW,cAAc,cAAc;AAAA,IAC9C;AAAA,EACF,CAAC;AAKD,UAAQ;AAAA,IACN;AAAA,IACA,OAAO,QAAQ;AACb,YAAM,SAAU,IAAI,MAAM,UAAU;AACpC,YAAM,UAAU,UAAU,WAAW,MAAM;AAE3C,aAAO;AAAA,QACL,IAAI;AAAA,QACJ;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,OAAO,QAAQ;AACb,YAAM,QAAQ,SAAS,IAAI,MAAM,SAAS,MAAM,EAAE;AAClD,YAAM,aAAa,IAAI,MAAM;AAE7B,UAAI;AACJ,UAAI,YAAY;AACd,qBAAa,UAAU,wBAAwB,YAAY,KAAK;AAAA,MAClE,OAAO;AACL,qBAAa,UAAU,oBAAoB,KAAK;AAAA,MAClD;AAEA,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,OAAO,WAAW;AAAA,QAClB;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,OAAO,QAAQ;AACb,YAAM,OAAO,IAAI,MAAM;AACvB,YAAM,QAAQ,UAAU,cAAc,IAAI;AAE1C,UAAI,CAAC,OAAO;AACV,eAAO;AAAA,UACL,IAAI;AAAA,UACJ,OAAO;AAAA,UACP,SAAS;AAAA,QACX;AAAA,MACF;AAEA,aAAO;AAAA,QACL,IAAI;AAAA,QACJ;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,OAAO,QAAQ;AACb,YAAM,SAAU,IAAI,MAAM,UAAU;AACpC,YAAM,YAAY,UAAU,uBAAuB,MAAM;AAEzD,aAAO;AAAA,QACL,IAAI;AAAA,QACJ;AAAA,QACA,GAAG;AAAA,MACL;AAAA,IACF;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,OAAO,QAAQ;AACb,YAAM,SAAU,IAAI,MAAM,UAAU;AACpC,YAAM,UAAU,UAAU,WAAW,MAAM;AAE3C,aAAO;AAAA,QACL,IAAI;AAAA,QACJ;AAAA,QACA,WAAW,QAAQ;AAAA,QACnB,WAAW,QAAQ;AAAA,QACnB,qBAAqB,QAAQ,kBAAkB,IAC3C,QAAQ,YAAY,QAAQ,kBAC5B;AAAA,QACJ,kBAAkB,QAAQ,aAAa,IAAI,CAAC,OAAO;AAAA,UACjD,IAAI,EAAE;AAAA,UACN,MAAM,EAAE;AAAA,UACR,YAAY,EAAE;AAAA,QAChB,EAAE;AAAA,MACJ;AAAA,IACF;AAAA,EACF;AAKA,UAAQ;AAAA,IACN;AAAA,IACA,OAAO,QAAQ;AACb,YAAM,SAAU,IAAI,MAAM,UAAU;AACpC,YAAM,UAAU,UAAU,WAAW,MAAM;AAE3C,aAAO;AAAA,QACL,IAAI;AAAA,QACJ;AAAA,QACA,SAAS;AAAA,UACP,aAAa,QAAQ;AAAA,UACrB,iBAAiB,QAAQ;AAAA,QAC3B;AAAA,QACA,YAAY,QAAQ,aAAa,IAAI,CAAC,OAAO;AAAA,UAC3C,IAAI,EAAE;AAAA,UACN,MAAM,EAAE;AAAA,UACR,aAAa,EAAE;AAAA,UACf,YAAY,EAAE;AAAA,QAChB,EAAE;AAAA,QACF,OAAO,QAAQ;AAAA,MACjB;AAAA,IACF;AAAA,EACF;AAOA,QAAM,EAAE,kBAAkB,IAAI,MAAM,OAAO,wBAA8B;AACzE,QAAM,iBAAiB,kBAAkB;AACzC,QAAM,eAAe,WAAW;AAKhC,UAAQ,IAAI,iBAAiB,YAAY;AACvC,UAAM,WAAW,eAAe,YAAY;AAC5C,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,OAAO,SAAS;AAAA,MAChB,UAAU,SAAS,IAAI,CAAC,OAAO;AAAA,QAC7B,IAAI,EAAE;AAAA,QACN,MAAM,EAAE;AAAA,QACR,KAAK,EAAE;AAAA,QACP,QAAQ,EAAE;AAAA,QACV,SAAS,EAAE;AAAA,QACX,iBAAiB,EAAE;AAAA,QACnB,YAAY,EAAE;AAAA,QACd,cAAc,EAAE;AAAA,QAChB,WAAW,EAAE;AAAA,MACf,EAAE;AAAA,IACJ;AAAA,EACF,CAAC;AAKD,UAAQ,IAAgC,qBAAqB,OAAO,KAAK,UAAU;AACjF,UAAM,UAAU,eAAe,WAAW,IAAI,OAAO,EAAE;AAEvD,QAAI,CAAC,SAAS;AACZ,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,oBAAoB;AAAA,IACjD;AAEA,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,SAAS;AAAA,QACP,IAAI,QAAQ;AAAA,QACZ,MAAM,QAAQ;AAAA,QACd,KAAK,QAAQ;AAAA,QACb,QAAQ,QAAQ;AAAA,QAChB,SAAS,QAAQ;AAAA,QACjB,YAAY,QAAQ;AAAA,QACpB,WAAW,QAAQ;AAAA,QACnB,iBAAiB,QAAQ;AAAA,QACzB,YAAY,QAAQ;AAAA,QACpB,cAAc,QAAQ;AAAA,QACtB,UAAU,QAAQ;AAAA,QAClB,WAAW,QAAQ;AAAA,QACnB,WAAW,QAAQ;AAAA,MACrB;AAAA,IACF;AAAA,EACF,CAAC;AAKD,UAAQ,KAWL,iBAAiB,OAAO,KAAK,UAAU;AACxC,UAAM,EAAE,MAAM,KAAK,QAAQ,QAAQ,SAAS,YAAY,WAAW,SAAS,IAAI,IAAI;AAEpF,QAAI,CAAC,QAAQ,CAAC,KAAK;AACjB,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,4BAA4B;AAAA,IACzD;AAGA,QAAI;AACF,UAAI,IAAI,GAAG;AAAA,IACb,QAAQ;AACN,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,cAAc;AAAA,IAC3C;AAGA,UAAM,gBACJ,UAAU,SAAS,KAAK,IAAI,EAAE,SAAS,EAAE,CAAC,GAAG,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,CAAC,CAAC;AAElF,UAAM,UAAU,MAAM,eAAe,gBAAgB;AAAA,MACnD;AAAA,MACA;AAAA,MACA,QAAQ;AAAA,MACR,QAAS,UAAkB,CAAC,oBAAoB;AAAA,MAChD,SAAS,YAAY;AAAA,MACrB,YAAY,cAAc;AAAA,MAC1B,WAAW,aAAa;AAAA,MACxB,UAAU,YAAY,CAAC;AAAA,IACzB,CAAC;AAED,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,SAAS;AAAA,QACP,IAAI,QAAQ;AAAA,QACZ,MAAM,QAAQ;AAAA,QACd,KAAK,QAAQ;AAAA,QACb,QAAQ,QAAQ;AAAA;AAAA,QAChB,QAAQ,QAAQ;AAAA,QAChB,SAAS,QAAQ;AAAA,QACjB,WAAW,QAAQ;AAAA,MACrB;AAAA,IACF;AAAA,EACF,CAAC;AAKD,UAAQ,MAWL,qBAAqB,OAAO,KAAK,UAAU;AAC5C,UAAM,WAAW,eAAe,WAAW,IAAI,OAAO,EAAE;AAExD,QAAI,CAAC,UAAU;AACb,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,oBAAoB;AAAA,IACjD;AAGA,QAAI,IAAI,KAAK,KAAK;AAChB,UAAI;AACF,YAAI,IAAI,IAAI,KAAK,GAAG;AAAA,MACtB,QAAQ;AACN,cAAM,KAAK,GAAG;AACd,eAAO,EAAE,IAAI,OAAO,OAAO,cAAc;AAAA,MAC3C;AAAA,IACF;AAEA,UAAM,UAAU,eAAe,cAAc,IAAI,OAAO,IAAI;AAAA,MAC1D,GAAI,IAAI,KAAK,QAAQ,EAAE,MAAM,IAAI,KAAK,KAAK;AAAA,MAC3C,GAAI,IAAI,KAAK,OAAO,EAAE,KAAK,IAAI,KAAK,IAAI;AAAA,MACxC,GAAI,IAAI,KAAK,UAAU,EAAE,QAAQ,IAAI,KAAK,OAAc;AAAA,MACxD,GAAI,IAAI,KAAK,YAAY,UAAa,EAAE,SAAS,IAAI,KAAK,QAAQ;AAAA,MAClE,GAAI,IAAI,KAAK,cAAc,EAAE,YAAY,IAAI,KAAK,WAAW;AAAA,MAC7D,GAAI,IAAI,KAAK,aAAa,EAAE,WAAW,IAAI,KAAK,UAAU;AAAA,MAC1D,GAAI,IAAI,KAAK,YAAY,EAAE,UAAU,IAAI,KAAK,SAAS;AAAA,IACzD,CAAC;AAED,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,SAAS;AAAA,QACP,IAAI,QAAS;AAAA,QACb,MAAM,QAAS;AAAA,QACf,KAAK,QAAS;AAAA,QACd,QAAQ,QAAS;AAAA,QACjB,SAAS,QAAS;AAAA,QAClB,WAAW,QAAS;AAAA,MACtB;AAAA,IACF;AAAA,EACF,CAAC;AAKD,UAAQ,OAAmC,qBAAqB,OAAO,KAAK,UAAU;AACpF,UAAM,WAAW,eAAe,WAAW,IAAI,OAAO,EAAE;AAExD,QAAI,CAAC,UAAU;AACb,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,oBAAoB;AAAA,IACjD;AAEA,mBAAe,cAAc,IAAI,OAAO,EAAE;AAE1C,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,SAAS;AAAA,IACX;AAAA,EACF,CAAC;AAKD,UAAQ,KAAiC,0BAA0B,OAAO,KAAK,UAAU;AACvF,UAAM,UAAU,eAAe,WAAW,IAAI,OAAO,EAAE;AAEvD,QAAI,CAAC,SAAS;AACZ,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,oBAAoB;AAAA,IACjD;AAGA,UAAM,eAAe,qBAAqB,sBAAsB;AAAA,MAC9D,IAAI,QAAQ,KAAK,IAAI,CAAC;AAAA,MACtB,YAAY;AAAA,MACZ,cAAc;AAAA,MACd,QAAQ;AAAA,MACR,WAAW,KAAK,IAAI,IAAI;AAAA,MACxB,SAAS,KAAK,IAAI;AAAA,MAClB,UAAU;AAAA,MACV,OAAO,CAAC;AAAA,MACR,MAAM,EAAE,OAAO,MAAM,WAAW,EAAE,KAAK,MAAM,KAAK,GAAG,SAAS,EAAE,GAAG,UAAU,MAAM;AAAA,MACnF,QAAQ,EAAE,OAAO,KAAM,QAAQ,KAAK,OAAO,KAAK;AAAA,IAClD,CAAC;AAED,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,SAAS;AAAA,IACX;AAAA,EACF,CAAC;AAOD,QAAM,EAAE,kBAAkB,qBAAqB,IAAI,MAAM,OAAO,qBAAmB;AACnF,QAAM,QAAQ,MAAM,iBAAiB;AACrC,uBAAqB,OAAO,EAAE,UAAU,CAAC;AAKzC,UAAQ,IAAI,oBAAoB,YAAY;AAC1C,UAAM,QAAQ,MAAM,SAAS;AAC7B,WAAO;AAAA,MACL,IAAI;AAAA,MACJ;AAAA,IACF;AAAA,EACF,CAAC;AAKD,UAAQ,KAcL,mBAAmB,OAAO,KAAK,UAAU;AAC1C,UAAM,EAAE,YAAY,cAAc,QAAQ,OAAO,UAAU,WAAW,IAAI,IAAI;AAE9E,QAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,SAAS,MAAM,WAAW,GAAG;AAChE,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,mDAAmD;AAAA,IAChF;AAEA,UAAM,QAAQ,MAAM,MAAM,OAAO;AAAA,MAC/B;AAAA,MACA;AAAA,MACA,QAAQ,UAAU,CAAC;AAAA,MACnB;AAAA,MACA,UAAW,YAAoB;AAAA,MAC/B;AAAA,IACF,CAAC;AAED,WAAO;AAAA,MACL,IAAI;AAAA,MACJ;AAAA,MACA,SAAS;AAAA,IACX;AAAA,EACF,CAAC;AAKD,UAAQ,IAAgC,uBAAuB,OAAO,KAAK,UAAU;AACnF,UAAM,WAAW,MAAM,YAAY,IAAI,OAAO,EAAE;AAEhD,QAAI,CAAC,UAAU;AACb,YAAM,KAAK,GAAG;AACd,aAAO,EAAE,IAAI,OAAO,OAAO,gBAAgB;AAAA,IAC7C;AAEA,UAAM,MAAM,MAAM,OAAO,IAAI,OAAO,EAAE;AAEtC,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,KAAK,MACD;AAAA,QACE,IAAI,IAAI;AAAA,QACR,YAAY,IAAI;AAAA,QAChB,cAAc,IAAI;AAAA,QAClB,UAAU,IAAI;AAAA,MAChB,IACA;AAAA,MACJ;AAAA,IACF;AAAA,EACF,CAAC;AAKD,UAAQ,KAAK,oBAAoB,YAAY;AAC3C,UAAM,MAAM,MAAM;AAClB,WAAO,EAAE,IAAI,MAAM,SAAS,eAAe;AAAA,EAC7C,CAAC;AAKD,UAAQ,KAAK,qBAAqB,YAAY;AAC5C,UAAM,MAAM,OAAO;AACnB,WAAO,EAAE,IAAI,MAAM,SAAS,gBAAgB;AAAA,EAC9C,CAAC;AACH;;;ACl0DA,OAAO,QAAQ;AACf,SAAS,gBAA+B,gBAAgB;AAmCxD,IAAM,wBAAwB;AAAA,EAC5B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;AAMA,eAAe,WACb,SACA,SACe;AACf,QAAM;AAAA,IACJ,YAAY,QAAQ,IAAI;AAAA,IACxB,eAAe,QAAQ,IAAI,uBAAuB;AAAA,IAClD,eAAe;AAAA,IACf,UAAU,QAAQ,IAAI,aAAa,gBAAgB,QAAQ,IAAI,sBAAsB;AAAA,EACvF,IAAI;AAGJ,QAAM,iBAAiB,IAAI,eAAe;AAAA,IACxC;AAAA,IACA;AAAA,IACA,cAAc;AAAA,IACd,WAAW,CAAC,CAAC;AAAA,EACf,CAAC;AAGD,MAAI,CAAC,SAAS;AACZ,YAAQ,IAAI,mDAAmD;AAC/D,YAAQ,IAAI,oEAAoE;AAAA,EAClF;AAGA,UAAQ,gBAAgB,QAAQ,IAAI;AACpC,UAAQ,gBAAgB,mBAAmB,KAAK;AAGhD,UAAQ,QAAQ,cAAc,OAAO,SAAyB,UAAwB;AAEpF,QAAI,CAAC,SAAS;AACZ,cAAQ,kBAAkB;AAC1B,cAAQ,OAAO,EAAE,QAAQ,YAAY,OAAO,CAAC,GAAG,EAAE;AAClD;AAAA,IACF;AAGA,UAAM,gBAAgB,aAAa,KAAK,CAAC,UAAU;AAEjD,UAAI,QAAQ,QAAQ,MAAO,QAAO;AAElC,UAAI,MAAM,SAAS,GAAG,KAAK,QAAQ,IAAI,WAAW,MAAM,MAAM,GAAG,EAAE,CAAC,EAAG,QAAO;AAE9E,YAAM,WAAW,QAAQ,IAAI,MAAM,GAAG,EAAE,CAAC;AACzC,aAAO,aAAa;AAAA,IACtB,CAAC;AAED,QAAI,eAAe;AACjB,cAAQ,kBAAkB;AAC1B;AAAA,IACF;AAGA,UAAM,aAAa,QAAQ,QAAQ;AAGnC,UAAM,SAAS,eAAe,aAAa;AAAA,MACzC,SAAS;AAAA,QACP,eAAe;AAAA,QACf,eAAe;AAAA,MACjB;AAAA,IACF,CAAC;AAED,QAAI,OAAO,eAAe;AACxB,cAAQ,kBAAkB;AAC1B,cAAQ,OAAO;AAAA,QACb,QAAQ,OAAO;AAAA,QACf,OAAO,OAAO;AAAA,QACd,WAAW,OAAO;AAAA,MACpB;AAAA,IACF,OAAO;AAEL,YAAM,KAAK,GAAG,EAAE,KAAK;AAAA,QACnB,IAAI;AAAA,QACJ,OAAO,OAAO,SAAS;AAAA,QACvB,MAAM;AAAA,MACR,CAAC;AACD;AAAA,IACF;AAAA,EACF,CAAC;AAGD,UAAQ,KAOL,kBAAkB,OAAO,SAAS,UAAU;AAE7C,QAAI,CAAC,QAAQ,MAAM,OAAO,SAAS,OAAO,KAAK,CAAC,QAAQ,MAAM,OAAO,SAAS,GAAG,GAAG;AAClF,YAAM,KAAK,GAAG,EAAE,KAAK;AAAA,QACnB,IAAI;AAAA,QACJ,OAAO;AAAA,QACP,MAAM;AAAA,MACR,CAAC;AACD;AAAA,IACF;AAEA,UAAM,EAAE,MAAM,QAAQ,OAAO,UAAU,IAAI,QAAQ;AAEnD,QAAI,CAAC,MAAM;AACT,YAAM,KAAK,GAAG,EAAE,KAAK;AAAA,QACnB,IAAI;AAAA,QACJ,OAAO;AAAA,QACP,MAAM;AAAA,MACR,CAAC;AACD;AAAA,IACF;AAEA,UAAM,SAAS,eAAe,eAAe;AAAA,MAC3C,QAAQ,UAAU,QAAQ,MAAM,UAAU;AAAA,MAC1C;AAAA,MACA,OAAO,SAAS,CAAC,MAAM;AAAA,MACvB;AAAA,IACF,CAAC;AAED,QAAI,CAAC,QAAQ;AACX,YAAM,KAAK,GAAG,EAAE,KAAK;AAAA,QACnB,IAAI;AAAA,QACJ,OAAO;AAAA,QACP,MAAM;AAAA,MACR,CAAC;AACD;AAAA,IACF;AAEA,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,QAAQ;AAAA,QACN,IAAI,OAAO;AAAA,QACX,KAAK,OAAO;AAAA;AAAA,QACZ,MAAM,OAAO;AAAA,QACb,OAAO,OAAO;AAAA,QACd,WAAW,OAAO;AAAA,QAClB,WAAW,OAAO;AAAA,MACpB;AAAA,MACA,SAAS;AAAA,IACX;AAAA,EACF,CAAC;AAGD,UAAQ,OAEL,yBAAyB,OAAO,SAAS,UAAU;AAEpD,QAAI,CAAC,QAAQ,MAAM,OAAO,SAAS,OAAO,KAAK,CAAC,QAAQ,MAAM,OAAO,SAAS,GAAG,GAAG;AAClF,YAAM,KAAK,GAAG,EAAE,KAAK;AAAA,QACnB,IAAI;AAAA,QACJ,OAAO;AAAA,QACP,MAAM;AAAA,MACR,CAAC;AACD;AAAA,IACF;AAEA,UAAM,EAAE,MAAM,IAAI,QAAQ;AAC1B,UAAM,UAAU,eAAe,aAAa,KAAK;AAEjD,QAAI,CAAC,SAAS;AACZ,YAAM,KAAK,GAAG,EAAE,KAAK;AAAA,QACnB,IAAI;AAAA,QACJ,OAAO;AAAA,QACP,MAAM;AAAA,MACR,CAAC;AACD;AAAA,IACF;AAEA,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,SAAS;AAAA,IACX;AAAA,EACF,CAAC;AAGD,UAAQ,IAAI,gBAAgB,OAAO,YAAY;AAC7C,QAAI,CAAC,QAAQ,mBAAmB,CAAC,QAAQ,MAAM;AAC7C,aAAO;AAAA,QACL,IAAI;AAAA,QACJ,eAAe;AAAA,MACjB;AAAA,IACF;AAEA,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,eAAe;AAAA,MACf,MAAM;AAAA,QACJ,QAAQ,QAAQ,KAAK;AAAA,QACrB,OAAO,QAAQ,KAAK;AAAA,QACpB,WAAW,QAAQ,KAAK;AAAA,MAC1B;AAAA,IACF;AAAA,EACF,CAAC;AAGD,UAAQ,SAAS,gBAAgB,SAAU,eAAkC;AAC3E,WAAO,OAAO,SAAyB,UAAwB;AAC7D,UAAI,CAAC,QAAQ,MAAM,OAAO;AACxB,cAAM,KAAK,GAAG,EAAE,KAAK;AAAA,UACnB,IAAI;AAAA,UACJ,OAAO;AAAA,UACP,MAAM;AAAA,QACR,CAAC;AACD;AAAA,MACF;AAEA,UAAI,CAAC,SAAS,QAAQ,KAAK,OAAO,aAAa,GAAG;AAChD,cAAM,KAAK,GAAG,EAAE,KAAK;AAAA,UACnB,IAAI;AAAA,UACJ,OAAO,mBAAmB,MAAM,QAAQ,aAAa,IAAI,cAAc,KAAK,IAAI,IAAI,aAAa;AAAA,UACjG,MAAM;AAAA,QACR,CAAC;AACD;AAAA,MACF;AAAA,IACF;AAAA,EACF,CAAC;AAED,UAAQ,IAAI,iDAAiD,OAAO,GAAG;AACvE,UAAQ,IAAI,yBAAyB,aAAa,MAAM,EAAE;AAC5D;AAGA,IAAO,sBAAQ,GAAG,YAAY;AAAA,EAC5B,SAAS;AAAA,EACT,MAAM;AACR,CAAC;;;AZ7QM,IAAM,YAAN,MAAgB;AAAA,EACb;AAAA,EACA;AAAA,EACA;AAAA,EAER,YAAY,KAAqB,QAA0B;AACzD,SAAK,MAAM;AACX,SAAK,SAAS;AAAA,MACZ,MAAM,QAAQ,QAAQ;AAAA;AAAA,MACtB,MAAM,QAAQ,QAAQ;AAAA,IACxB;AAEA,SAAK,UAAU,QAAQ;AAAA,MACrB,QAAQ;AAAA,IACV,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aAA4B;AAEhC,UAAM,KAAK,QAAQ,SAAS,aAAa;AAAA,MACvC,QAAQ,CAAC,QAAQ,OAAO;AAEtB,YAAI,CAAC,OAAQ,QAAO,GAAG,MAAM,IAAI;AAEjC,cAAM,iBAAiB;AAAA,UACrB;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA,QAAQ,IAAI;AAAA,QACd,EAAE,OAAO,OAAO;AAEhB,YAAI,eAAe,SAAS,MAAM,GAAG;AACnC,aAAG,MAAM,IAAI;AAAA,QACf,OAAO;AAEL,cAAI,QAAQ,IAAI,aAAa,cAAc;AACzC,oBAAQ,KAAK,kCAAkC,MAAM,EAAE;AAAA,UACzD;AACA,aAAG,MAAM,KAAK;AAAA,QAChB;AAAA,MACF;AAAA,MACA,aAAa;AAAA,MACb,SAAS,CAAC,OAAO,QAAQ,OAAO,SAAS,UAAU,SAAS;AAAA,IAC9D,CAAC;AAGD,UAAM,KAAK,QAAQ,SAAS,gBAAgB;AAG5C,UAAM,KAAK,QAAQ,SAAS,qBAAY;AAAA,MACtC,WAAW,QAAQ,IAAI;AAAA,MACvB,cAAc,QAAQ,IAAI,uBAAuB;AAAA,MACjD,SAAS,QAAQ,IAAI,aAAa,gBAAgB,QAAQ,IAAI,sBAAsB;AAAA,MACpF,cAAc;AAAA,QACZ;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MACF;AAAA,IACF,CAAC;AAGD,UAAM,eAAe,KAAK,SAAS,KAAK,GAAG;AAG3C,SAAK,QAAQ,IAAI,OAAO,EAAE,WAAW,KAAK,GAAG,CAAC,WAAW;AACvD,cAAQ,IAAI,sCAAsC;AAGlD,aAAO,KAAK,KAAK,UAAU;AAAA,QACzB,MAAM;AAAA,QACN,WAAW,KAAK,IAAI;AAAA,QACpB,SAAS;AAAA,MACX,CAAC,CAAC;AAGF,YAAM,UAAU,CAAC,UAAe;AAC9B,YAAI;AACF,iBAAO,KAAK,KAAK,UAAU,KAAK,CAAC;AAAA,QACnC,QAAQ;AAAA,QAER;AAAA,MACF;AAEA,WAAK,IAAI,YAAY,EAAE,GAAG,KAAK,OAAO;AAEtC,aAAO,GAAG,SAAS,MAAM;AACvB,gBAAQ,IAAI,yCAAyC;AACrD,aAAK,IAAI,YAAY,EAAE,IAAI,KAAK,OAAO;AAAA,MACzC,CAAC;AAED,aAAO,GAAG,SAAS,CAAC,QAAQ;AAC1B,gBAAQ,IAAI,8BAA8B,IAAI,OAAO;AAAA,MACvD,CAAC;AAED,aAAO,GAAG,WAAW,CAAC,YAAY;AAChC,YAAI;AACF,gBAAM,OAAO,KAAK,MAAM,QAAQ,SAAS,CAAC;AAG1C,cAAI,KAAK,SAAS,QAAQ;AACxB,mBAAO,KAAK,KAAK,UAAU,EAAE,MAAM,QAAQ,WAAW,KAAK,IAAI,EAAE,CAAC,CAAC;AAAA,UACrE,WAAW,KAAK,SAAS,aAAa;AAEpC,mBAAO,KAAK,KAAK,UAAU;AAAA,cACzB,MAAM;AAAA,cACN,UAAU,KAAK,YAAY,CAAC;AAAA,cAC5B,WAAW,KAAK,IAAI;AAAA,YACtB,CAAC,CAAC;AAAA,UACJ,WAAW,KAAK,WAAW,aAAa;AAEtC,mBAAO,KAAK,KAAK,UAAU;AAAA,cACzB,MAAM;AAAA,cACN,OAAO,KAAK,SAAS,CAAC;AAAA,cACtB,WAAW,KAAK,IAAI;AAAA,YACtB,CAAC,CAAC;AAAA,UACJ;AAAA,QACF,QAAQ;AAAA,QAER;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AAGD,SAAK,QAAQ,IAAI,WAAW,YAAY;AACtC,aAAO,EAAE,IAAI,MAAM,WAAW,KAAK,IAAI,EAAE;AAAA,IAC3C,CAAC;AAGD,SAAK,QAAQ,IAAI,KAAK,YAAY;AAChC,aAAO;AAAA,QACL,SAAS;AAAA,QACT,SAAS;AAAA,QACT,QAAQ;AAAA,QACR,WAAW;AAAA,UACT,QAAQ;AAAA,UACR,KAAK;AAAA,UACL,WAAW;AAAA,UACX,QAAQ;AAAA,UACR,OAAO;AAAA,QACT;AAAA,QACA,WAAW,KAAK,IAAI;AAAA,MACtB;AAAA,IACF,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,QAAuB;AAC3B,UAAM,KAAK,WAAW;AAEtB,UAAM,KAAK,QAAQ,OAAO;AAAA,MACxB,MAAM,KAAK,OAAO;AAAA,MAClB,MAAM,KAAK,OAAO;AAAA,IACpB,CAAC;AAED,YAAQ,IAAI,sCAAsC,KAAK,OAAO,IAAI;AAAA,EACpE;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAsB;AAC1B,UAAM,KAAK,QAAQ,MAAM;AACzB,YAAQ,IAAI,0BAA0B;AAAA,EACxC;AAAA;AAAA;AAAA;AAAA,EAKA,aAA8B;AAC5B,WAAO,KAAK;AAAA,EACd;AACF;;;AatLA,IAAM,8BAAwC;AAAA,EAC5C,IAAI;AAAA,EACJ,MAAM;AAAA,EACN,aAAa;AAAA,EACb,SAAS;AAAA,EACT,SAAS;AAAA,EACT,SAAS,OAAO,KAAK,YAAY;AAC/B,UAAM,eAAe,IAAI,gBAAgB;AACzC,QAAI,CAAC,aAAc;AAEnB,UAAM,EAAE,MAAM,YAAY,IAAI;AAC9B,QAAI,CAAC,KAAM;AAEX,QAAI;AACF,YAAM,aAAa,gBAAgB;AAAA,QACjC;AAAA,QACA,aAAa,eAAe;AAAA,MAC9B,CAAC;AACD,cAAQ,IAAI,iCAAiC,IAAI;AAEjD,UAAI,YAAY,EAAE,QAAQ,YAAY,qBAAqB;AAAA,QACzD,UAAU;AAAA,QACV,SAAS;AAAA,MACX,CAAC;AAAA,IACH,SAAS,OAAO;AACd,cAAQ,MAAM,2CAA2C,KAAK;AAAA,IAChE;AAAA,EACF;AACF;AAMA,IAAM,0BAAoC;AAAA,EACxC,IAAI;AAAA,EACJ,MAAM;AAAA,EACN,aAAa;AAAA,EACb,SAAS;AAAA,EACT,SAAS;AAAA,EACT,SAAS,OAAO,KAAK,YAAY;AAC/B,UAAM,eAAe,IAAI,gBAAgB;AACzC,QAAI,CAAC,aAAc;AAEnB,UAAM,EAAE,QAAQ,OAAO,IAAI;AAC3B,QAAI,CAAC,UAAU,SAAS,IAAK;AAE7B,QAAI;AACF,YAAM,aAAa,YAAY,OAAO;AACtC,cAAQ,IAAI,yCAAyC,MAAM;AAAA,IAC7D,SAAS,OAAO;AACd,cAAQ,MAAM,mCAAmC,KAAK;AAAA,IACxD;AAAA,EACF;AACF;AAMA,IAAM,2BAAqC;AAAA,EACzC,IAAI;AAAA,EACJ,MAAM;AAAA,EACN,aAAa;AAAA,EACb,SAAS;AAAA,EACT,SAAS;AAAA,EACT,SAAS,OAAO,KAAK,YAAY;AAC/B,UAAM,QAAQ,IAAI,SAAS;AAC3B,QAAI,CAAC,MAAO;AAEZ,UAAM,EAAE,UAAU,UAAU,IAAI;AAEhC,YAAQ,KAAK,kDAAkD;AAAA,MAC7D;AAAA,MACA;AAAA,IACF,CAAC;AAGD,QAAI,YAAY,EAAE,QAAQ,YAAY,gBAAgB;AAAA,MACpD,UAAU;AAAA,MACV,SAAS;AAAA,MACT;AAAA,IACF,CAAC;AAAA,EACH;AACF;AAMA,IAAM,uBAAiC;AAAA,EACrC,IAAI;AAAA,EACJ,MAAM;AAAA,EACN,aAAa;AAAA,EACb,SAAS;AAAA,EACT,SAAS;AAAA,EACT,SAAS,OAAO,KAAK,YAAY;AAC/B,UAAM,EAAE,MAAM,IAAI;AAClB,QAAI,UAAU,gBAAiB;AAE/B,UAAM,eAAe,IAAI,gBAAgB;AACzC,QAAI,CAAC,aAAc;AAEnB,QAAI;AACF,YAAM,aAAa,YAAY,QAAQ;AACvC,cAAQ,IAAI,2CAA2C;AAAA,IACzD,SAAS,OAAO;AACd,cAAQ,MAAM,oCAAoC,KAAK;AAAA,IACzD;AAAA,EACF;AACF;AAUA,IAAM,2BAAqC;AAAA,EACzC,IAAI;AAAA,EACJ,MAAM;AAAA,EACN,aAAa;AAAA,EACb,SAAS;AAAA,EACT,SAAS;AAAA,EACT,SAAS,OAAO,KAAK,YAAY;AAC/B,UAAM,EAAE,MAAM,IAAI,OAAO,IAAI;AAE7B,YAAQ,IAAI,mCAAmC,IAAI,WAAM,EAAE,KAAK,MAAM,GAAG;AAGzE,QAAI,OAAO,SAAS;AAClB,cAAQ,IAAI,4DAA4D;AAAA,IAC1E;AAGA,QAAI,OAAO,SAAS;AAClB,cAAQ,IAAI,uDAAuD;AAAA,IACrE;AAEA,QAAI,YAAY,EAAE,QAAQ,YAAY,oBAAoB;AAAA,MACxD,UAAU;AAAA,MACV,MAAM;AAAA,IACR,CAAC;AAAA,EACH;AACF;AAMA,IAAM,+BAAyC;AAAA,EAC7C,IAAI;AAAA,EACJ,MAAM;AAAA,EACN,aAAa;AAAA,EACb,SAAS;AAAA,EACT,SAAS;AAAA,EACT,SAAS,OAAO,KAAK,YAAY;AAC/B,UAAM,EAAE,OAAO,MAAM,YAAY,OAAO,IAAI;AAO5C,YAAQ,IAAI,wCAAwC,IAAI,UAAU,UAAU,eAAe;AAAA,EAI7F;AACF;AAMA,IAAM,2BAAqC;AAAA,EACzC,IAAI;AAAA,EACJ,MAAM;AAAA,EACN,aAAa;AAAA,EACb,SAAS;AAAA,EACT,SAAS;AAAA,EACT,SAAS,OAAO,KAAK,YAAY;AAC/B,UAAM,EAAE,SAAS,MAAM,KAAK,IAAI;AAMhC,YAAQ,IAAI,oCAAoC,OAAO,KAAK,IAAI,QAAQ,IAAI,OAAO;AAAA,EACrF;AACF;AAMO,IAAM,YAAwB;AAAA,EACnC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;AAKO,SAAS,kBAAkB,KAA2B;AAC3D,QAAMC,YAAW,IAAI,YAAY;AAEjC,aAAW,YAAY,WAAW;AAChC,QAAI,CAAC,SAAS,QAAS;AAEvB,IAAAA,UAAS,GAAG,SAAS,SAAgB,OAAO,UAAU;AACpD,cAAQ,IAAI,yBAAyB,SAAS,IAAI;AAElD,UAAI;AACF,cAAM,SAAS,QAAQ,KAAK,MAAM,OAAO;AAAA,MAC3C,SAAS,OAAO;AACd,gBAAQ,MAAM,uBAAuB,SAAS,MAAM,KAAK;AAAA,MAC3D;AAAA,IACF,CAAC;AAAA,EACH;AAEA,UAAQ,IAAI,yBAAyB,UAAU,OAAO,CAAC,MAAM,EAAE,OAAO,EAAE,QAAQ,WAAW;AAC7F;AAKO,SAAS,eAA2B;AACzC,SAAO;AACT;;;ACpQA,SAAS,eAAe;AAGjB,IAAM,mBAAN,MAAuB;AAAA,EACpB,gBAAgC;AAAA,EAChC,4BAA4C;AAAA,EAEpD,cAAc;AAGZ,SAAK,gBAAgB,IAAI;AAAA,MACvB;AAAA;AAAA,MACA,YAAY;AACV,gBAAQ,IAAI,8DAA8D;AAC1E,YAAI;AACF,gBAAM,2BAA2B;AACjC,kBAAQ,IAAI,8DAA8D;AAAA,QAC5E,SAAS,OAAO;AACd,kBAAQ,MAAM,6DAA6D,KAAK;AAAA,QAClF;AAAA,MACF;AAAA,MACA;AAAA;AAAA,MACA;AAAA;AAAA,MACA;AAAA;AAAA,IACF;AAGA,SAAK,4BAA4B,IAAI;AAAA,MACnC;AAAA;AAAA,MACA,YAAY;AACV,gBAAQ,IAAI,uDAAuD;AACnE,YAAI;AACF,gBAAM,6BAA6B;AACnC,kBAAQ,IAAI,uDAAuD;AAAA,QACrE,SAAS,OAAO;AACd,kBAAQ,MAAM,sDAAsD,KAAK;AAAA,QAC3E;AAAA,MACF;AAAA,MACA;AAAA;AAAA,MACA;AAAA;AAAA,MACA;AAAA;AAAA,IACF;AAAA,EACF;AAAA,EAEA,QAAc;AACZ,QAAI,KAAK,iBAAiB,CAAC,KAAK,cAAc,SAAS;AACrD,WAAK,cAAc,MAAM;AACzB,cAAQ,IAAI,wDAAwD;AAAA,IACtE;AACA,QAAI,KAAK,6BAA6B,CAAC,KAAK,0BAA0B,SAAS;AAC7E,WAAK,0BAA0B,MAAM;AACrC,cAAQ,IAAI,yDAAyD;AAAA,IACvE;AAAA,EACF;AAAA,EAEA,OAAa;AACX,QAAI,KAAK,iBAAiB,KAAK,cAAc,SAAS;AACpD,WAAK,cAAc,KAAK;AACxB,cAAQ,IAAI,wDAAwD;AAAA,IACtE;AACA,QAAI,KAAK,6BAA6B,KAAK,0BAA0B,SAAS;AAC5E,WAAK,0BAA0B,KAAK;AACpC,cAAQ,IAAI,yDAAyD;AAAA,IACvE;AAAA,EACF;AACF;AAGA,IAAIC,YAAoC;AAEjC,SAAS,sBAAwC;AACtD,MAAI,CAACA,WAAU;AACb,IAAAA,YAAW,IAAI,iBAAiB;AAAA,EAClC;AACA,SAAOA;AACT;;;AC7BO,IAAM,iBAAN,MAAqB;AAAA,EAClB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,UAAU;AAAA,EACV,YAA2B;AAAA;AAAA,EAG3B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EAER,YAAY,QAA+B;AACzC,SAAK,SAAS;AAAA,MACZ,SAAS,QAAQ,WAAW;AAAA;AAAA,MAC5B,SAAS,QAAQ,WAAW;AAAA,MAC5B,iBAAiB,QAAQ,mBAAmB;AAAA,MAC5C,oBAAoB,QAAQ,sBAAsB;AAAA,IACpD;AAEA,SAAK,mBAAmB;AACxB,SAAK,gBAAgB,IAAI,cAAc,KAAK,gBAAgB;AAC5D,SAAK,YAAY,IAAI,UAAU,MAAM;AAAA,MACnC,MAAM,KAAK,OAAO;AAAA,MAClB,MAAM,KAAK,OAAO;AAAA,IACpB,CAAC;AACD,SAAK,mBAAmB,oBAAoB;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,QAAuB;AAC3B,QAAI,KAAK,SAAS;AAChB,cAAQ,IAAI,uBAAuB;AACnC;AAAA,IACF;AAEA,YAAQ,IAAI,mCAAmC;AAG/C,QAAI,KAAK,OAAO,oBAAoB;AAClC,WAAK,cAAc,kBAAkB;AAAA,IACvC;AAGA,QAAI,KAAK,OAAO,iBAAiB;AAC/B,wBAAkB,IAAI;AAAA,IACxB;AAGA,UAAM,KAAK,UAAU,MAAM;AAG3B,SAAK,iBAAiB,MAAM;AAE5B,SAAK,UAAU;AACf,SAAK,YAAY,KAAK,IAAI;AAE1B,YAAQ,IAAI,yCAAyC,KAAK,OAAO,OAAO;AACxE,SAAK,iBAAiB,QAAQ,OAAO,kBAAkB,EAAE,QAAQ,MAAM,CAAC;AAAA,EAC1E;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAsB;AAC1B,QAAI,CAAC,KAAK,SAAS;AACjB,cAAQ,IAAI,mBAAmB;AAC/B;AAAA,IACF;AAEA,YAAQ,IAAI,mCAAmC;AAG/C,SAAK,cAAc,iBAAiB;AAGpC,UAAM,KAAK,UAAU,KAAK;AAG1B,SAAK,iBAAiB,KAAK;AAE3B,SAAK,UAAU;AAEf,YAAQ,IAAI,+BAA+B;AAC3C,SAAK,iBAAiB,QAAQ,OAAO,kBAAkB,EAAE,QAAQ,MAAM,CAAC;AAAA,EAC1E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,aAAa,OAAwB;AACnC,SAAK,QAAQ;AACb,SAAK,cAAc,cAAc,OAAO;AACxC,YAAQ,IAAI,uBAAuB;AAAA,EACrC;AAAA;AAAA;AAAA;AAAA,EAKA,mBAAmB,QAA2B;AAC5C,SAAK,cAAc;AACnB,SAAK,cAAc,cAAc,OAAO;AACxC,YAAQ,IAAI,8BAA8B;AAG1C,SAAK,YAAY,GAAG,SAAS,CAAC,UAAU;AACtC,WAAK,iBAAiB,QAAQ,SAAS,kBAAkB;AAAA,QACvD,IAAI,MAAM;AAAA,QACV,WAAW,IAAI,KAAK,MAAM,UAAU,EAAE,YAAY;AAAA,QAClD,QAAQ;AAAA,QACR,MAAM;AAAA,QACN,OAAO,GAAG,MAAM,KAAK,YAAY,CAAC,IAAI,MAAM,MAAM;AAAA,QAClD,aAAa,YAAY,MAAM,IAAI,IAAI,MAAM,IAAI,IAAI,MAAM,MAAM,OAAO,MAAM,KAAK;AAAA,QACnF,SAAS;AAAA,UACP,OAAO,MAAM,MAAM,SAAS;AAAA,UAC5B,MAAM,MAAM,KAAK,SAAS;AAAA,UAC1B,UAAU,MAAM,SAAS,SAAS;AAAA,UAClC,KAAK,MAAM,aAAa,SAAS,KAAK;AAAA,QACxC;AAAA,QACA,MAAM,CAAC,WAAW,MAAM,OAAO,YAAY,GAAG,MAAM,IAAI;AAAA,QACxD,QAAQ;AAAA,MACV,CAAC;AAAA,IACH,CAAC;AAED,SAAK,YAAY,GAAG,SAAS,CAAC,YAAY;AAEtC,cAAQ,IAAI,6BAA6B,OAAO,EAAE;AAAA,IACtD,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,oBAAoB,QAA4B;AAC9C,SAAK,eAAe;AACpB,SAAK,cAAc,cAAc,QAAQ;AACzC,YAAQ,IAAI,+BAA+B;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,qBAAqB,QAA6B;AAChD,SAAK,gBAAgB;AACrB,SAAK,cAAc,cAAc,SAAS;AAC1C,YAAQ,IAAI,gCAAgC;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA,EAKA,cAAc,SAAuB;AACnC,SAAK,SAAS;AACd,SAAK,cAAc,cAAc,QAAQ;AACzC,YAAQ,IAAI,wBAAwB;AAGpC,SAAK,iBAAiB,QAAQ,UAAU,eAAe;AAAA,MACrD,MAAM,QAAQ,QAAQ;AAAA,MACtB,SAAS;AAAA,IACX,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAMA,cAAwB;AACtB,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,mBAAkC;AAChC,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,WAAkC;AAChC,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,iBAA0C;AACxC,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,kBAA4C;AAC1C,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,mBAA8C;AAC5C,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,YAAgC;AAC9B,WAAO,KAAK;AAAA,EACd;AAAA;AAAA;AAAA;AAAA,EAKA,YAAuB;AACrB,WAAO;AAAA,MACL,SAAS,KAAK;AAAA,MACd,WAAW,KAAK;AAAA,MAChB,SAAS,KAAK,OAAO;AAAA,MACrB,SAAS,KAAK,cAAc,oBAAoB;AAAA,MAChD,WAAW,KAAK,OAAO,kBAAkB,IAAI;AAAA;AAAA,IAC/C;AAAA,EACF;AACF;AAMA,IAAI,cAAqC;AAKlC,SAAS,eAAe,KAA2B;AACxD,gBAAc;AAChB;AAMO,SAAS,SAIP;AACP,MAAI,CAAC,YAAa,QAAO;AAEzB,QAAMC,YAAW,YAAY,YAAY;AAEzC,SAAO;AAAA,IACL,eAAe,CAAC,SAAiB;AAC/B,MAAAA,UAAS,QAAQ,MAAM,kBAAkB,EAAE,QAAQ,MAAM,WAAW,KAAK,IAAI,EAAE,CAAC;AAAA,IAClF;AAAA,IACA,WAAW,CAAC,SAAiB;AAC3B,MAAAA,UAAS,QAAQ,MAAM,oBAAoB,EAAE,QAAQ,MAAM,WAAW,KAAK,IAAI,EAAE,CAAC;AAAA,IACpF;AAAA,IACA,SAAS,CAAC,QAAgB,MAAc,YAAqC;AAC3E,MAAAA,UAAS,QAAQ,QAAQ,MAAM,OAAO;AAAA,IACxC;AAAA,EACF;AACF;","names":["eventBus","EventEmitter","articleBriefIds","instance","EventEmitter","EventEmitter","org","z","EventEmitter","DEFAULT_CONFIG","EventEmitter","z","path","EventEmitter","path","EventEmitter","generateId","instance","z","EventEmitter","EventEmitter","z","EventEmitter","createHash","randomUUID","EventEmitter","randomUUID","createHash","z","NotificationTypeSchema","EventEmitter","randomUUID","EventEmitter","randomUUID","z","EventEmitter","EventEmitter","config","EventEmitter","EventEmitter","EventEmitter","EventEmitter","z","EventEmitter","createHash","EventEmitter","path","createHash","EventEmitter","EventEmitter","z","EventEmitter","randomUUID","EventEmitter","EventEmitter","EventEmitter","SEVERITY_LEVELS","EventEmitter","EventEmitter","member","z","z","crypto","eventBus","eventBus","instance","eventBus"]}