{"version":3,"sources":["../src/dao-agent.ts","../src/types.ts","../src/platforms/snapshot.ts","../src/platforms/tally.ts","../src/platforms/realms.ts","../src/analyzers/proposal.ts","../src/analyzers/voting-power.ts"],"sourcesContent":["import { z } from \"zod\";\nimport {\n  BaseAgent,\n  type AgentConfig,\n  type AgentContext,\n  type AgentResult,\n  type LLMClient,\n  createLLMClient,\n} from \"@gicm/agent-core\";\nimport type { DAOAgentConfig, DAO, Proposal, Vote, GovernancePlatform, ProposalSummary } from \"./types.js\";\nimport { DAOAgentConfigSchema } from \"./types.js\";\nimport { SnapshotProvider } from \"./platforms/snapshot.js\";\nimport { TallyProvider } from \"./platforms/tally.js\";\nimport { RealmsProvider } from \"./platforms/realms.js\";\nimport { ProposalAnalyzer } from \"./analyzers/proposal.js\";\nimport { VotingPowerAnalyzer, type VotingPowerDistribution } from \"./analyzers/voting-power.js\";\n\nexport interface DAOAgentAnalysis {\n  dao?: DAO;\n  proposals?: Proposal[];\n  summary?: ProposalSummary;\n  votingDistribution?: VotingPowerDistribution;\n  aiSummary?: string;\n}\n\nexport class DAOAgent extends BaseAgent {\n  private platforms: Map<string, GovernancePlatform> = new Map();\n  private proposalAnalyzer: ProposalAnalyzer;\n  private votingPowerAnalyzer: VotingPowerAnalyzer;\n  private daoConfig: DAOAgentConfig;\n  private llmClient?: LLMClient;\n\n  constructor(config: DAOAgentConfig & AgentConfig) {\n    const validatedConfig = DAOAgentConfigSchema.parse(config);\n    super(\"dao-agent\", config);\n\n    this.daoConfig = validatedConfig;\n\n    // Initialize LLM client if API key provided\n    if (config.apiKey) {\n      this.llmClient = createLLMClient({\n        provider: config.llmProvider ?? \"openai\",\n        model: config.llmModel,\n        apiKey: config.apiKey,\n        temperature: config.temperature ?? 0.7,\n        maxTokens: config.maxTokens ?? 4096,\n      });\n    }\n\n    this.proposalAnalyzer = new ProposalAnalyzer(this.llmClient);\n    this.votingPowerAnalyzer = new VotingPowerAnalyzer();\n\n    this.initializePlatforms(validatedConfig);\n    this.initializeTools();\n  }\n\n  private initializePlatforms(config: DAOAgentConfig): void {\n    // Snapshot (no API key required)\n    this.platforms.set(\"snapshot\", new SnapshotProvider(config.snapshotHub));\n\n    // Tally (requires API key)\n    if (config.tallyApiKey) {\n      this.platforms.set(\"tally\", new TallyProvider({ apiKey: config.tallyApiKey }));\n    }\n\n    // Realms (Solana)\n    this.platforms.set(\"realms\", new RealmsProvider(config.realmsRpcUrl));\n  }\n\n  private initializeTools(): void {\n    this.registerTool({\n      name: \"get_dao\",\n      description: \"Get DAO info from governance platform\",\n      parameters: z.object({\n        id: z.string().describe(\"DAO ID or slug\"),\n        platform: z.string().default(\"snapshot\").describe(\"Platform: snapshot, tally, realms\"),\n      }),\n      execute: async (params) => {\n        const { id, platform } = params as { id: string; platform: string };\n        return this.getDAO(id, platform);\n      },\n    });\n\n    this.registerTool({\n      name: \"get_proposals\",\n      description: \"Get proposals for a DAO\",\n      parameters: z.object({\n        daoId: z.string().describe(\"DAO ID or slug\"),\n        platform: z.string().default(\"snapshot\").describe(\"Platform name\"),\n        state: z.string().optional().describe(\"Filter by state: active, closed, pending\"),\n      }),\n      execute: async (params) => {\n        const { daoId, platform, state } = params as {\n          daoId: string;\n          platform: string;\n          state?: string;\n        };\n        return this.getProposals(daoId, platform, state);\n      },\n    });\n\n    this.registerTool({\n      name: \"summarize_proposal\",\n      description: \"Get AI summary of a proposal\",\n      parameters: z.object({\n        proposalId: z.string().describe(\"Proposal ID\"),\n        platform: z.string().default(\"snapshot\").describe(\"Platform name\"),\n      }),\n      execute: async (params) => {\n        const { proposalId, platform } = params as { proposalId: string; platform: string };\n        return this.summarizeProposal(proposalId, platform);\n      },\n    });\n\n    this.registerTool({\n      name: \"get_votes\",\n      description: \"Get votes for a proposal\",\n      parameters: z.object({\n        proposalId: z.string().describe(\"Proposal ID\"),\n        platform: z.string().default(\"snapshot\").describe(\"Platform name\"),\n        limit: z.number().default(100).describe(\"Max votes to return\"),\n      }),\n      execute: async (params) => {\n        const { proposalId, platform, limit } = params as {\n          proposalId: string;\n          platform: string;\n          limit: number;\n        };\n        return this.getVotes(proposalId, platform, limit);\n      },\n    });\n\n    this.registerTool({\n      name: \"analyze_voting_power\",\n      description: \"Analyze voting power distribution\",\n      parameters: z.object({\n        daoId: z.string().describe(\"DAO ID\"),\n        platform: z.string().default(\"snapshot\").describe(\"Platform name\"),\n      }),\n      execute: async (params) => {\n        const { daoId, platform } = params as { daoId: string; platform: string };\n        return this.analyzeVotingPower(daoId, platform);\n      },\n    });\n  }\n\n  getSystemPrompt(): string {\n    return `You are a DAO governance expert. You can:\n- Analyze DAOs and their proposals\n- Summarize complex governance proposals in plain language\n- Track voting power distribution and whale voters\n- Provide voting recommendations based on principles\n- Monitor treasury and governance alerts\n\nAvailable platforms: ${Array.from(this.platforms.keys()).join(\", \")}\n\nWhen analyzing proposals, consider:\n1. Impact on protocol/community\n2. Treasury implications\n3. Security considerations\n4. Alignment with DAO's mission\n5. Historical voting patterns`;\n  }\n\n  async analyze(context: AgentContext): Promise<AgentResult> {\n    const query = context.userQuery ?? \"\";\n\n    if (!this.llmClient) {\n      return this.createResult(\n        false,\n        null,\n        \"LLM client not configured. Provide apiKey in config.\",\n        0,\n        \"No LLM available for AI analysis\"\n      );\n    }\n\n    try {\n      const response = await this.llmClient.chat([\n        { role: \"system\", content: this.getSystemPrompt() },\n        { role: \"user\", content: query },\n      ]);\n\n      return this.createResult(\n        true,\n        { aiSummary: response.content },\n        undefined,\n        0.8,\n        \"AI analysis completed\"\n      );\n    } catch (error) {\n      return this.createResult(\n        false,\n        null,\n        error instanceof Error ? error.message : \"Unknown error\",\n        0,\n        \"Failed to complete AI analysis\"\n      );\n    }\n  }\n\n  async getDAO(id: string, platformName = \"snapshot\"): Promise<DAO | null> {\n    const platform = this.platforms.get(platformName);\n    if (!platform) return null;\n    return platform.getDAO(id);\n  }\n\n  async getProposals(\n    daoId: string,\n    platformName = \"snapshot\",\n    state?: string\n  ): Promise<Proposal[]> {\n    const platform = this.platforms.get(platformName);\n    if (!platform) return [];\n    return platform.getProposals(daoId, state);\n  }\n\n  async getProposal(\n    proposalId: string,\n    platformName = \"snapshot\"\n  ): Promise<Proposal | null> {\n    const platform = this.platforms.get(platformName);\n    if (!platform) return null;\n    return platform.getProposal(proposalId);\n  }\n\n  async summarizeProposal(\n    proposalId: string,\n    platformName = \"snapshot\"\n  ): Promise<ProposalSummary | null> {\n    const proposal = await this.getProposal(proposalId, platformName);\n    if (!proposal) return null;\n    return this.proposalAnalyzer.summarizeProposal(proposal);\n  }\n\n  async getVotes(\n    proposalId: string,\n    platformName = \"snapshot\",\n    limit = 100\n  ): Promise<Vote[]> {\n    const platform = this.platforms.get(platformName);\n    if (!platform) return [];\n    return platform.getVotes(proposalId, limit);\n  }\n\n  async analyzeVotingPower(\n    daoId: string,\n    platformName = \"snapshot\"\n  ): Promise<VotingPowerDistribution | null> {\n    const platform = this.platforms.get(platformName);\n    if (!platform) return null;\n\n    // Get recent proposals to analyze voting patterns\n    const proposals = await platform.getProposals(daoId);\n    if (proposals.length === 0) {\n      return {\n        totalPower: 0,\n        topHolders: [],\n        concentrationScore: 0,\n        giniCoefficient: 0,\n      };\n    }\n\n    // Aggregate votes from recent proposals (up to 10)\n    const recentProposals = proposals.slice(0, 10);\n    const voterPowerMap = new Map<string, { power: number; voteCount: number }>();\n\n    for (const proposal of recentProposals) {\n      const votes = await platform.getVotes(proposal.id, 500);\n\n      for (const vote of votes) {\n        const existing = voterPowerMap.get(vote.voter);\n        if (existing) {\n          // Use max voting power seen (power can vary by proposal strategy)\n          existing.power = Math.max(existing.power, vote.votingPower);\n          existing.voteCount++;\n        } else {\n          voterPowerMap.set(vote.voter, {\n            power: vote.votingPower,\n            voteCount: 1,\n          });\n        }\n      }\n    }\n\n    // Convert to VotingPower array for analyzer\n    const holders: import(\"./types.js\").VotingPower[] = Array.from(\n      voterPowerMap.entries()\n    ).map(([address, data]) => ({\n      address,\n      power: data.power,\n      percentage: 0, // Will be calculated by analyzer\n    }));\n\n    // Use the voting power analyzer\n    return this.votingPowerAnalyzer.analyzeDistribution(holders);\n  }\n\n  async getActiveProposals(\n    daoId: string,\n    platformName = \"snapshot\"\n  ): Promise<Proposal[]> {\n    return this.getProposals(daoId, platformName, \"active\");\n  }\n\n  async getWhaleVoters(\n    proposalId: string,\n    platformName = \"snapshot\"\n  ): Promise<Array<{ address: string; totalPower: number; voteCount: number }>> {\n    const votes = await this.getVotes(proposalId, platformName, 1000);\n    return this.votingPowerAnalyzer.findWhaleVoters(votes);\n  }\n}\n","import { z } from \"zod\";\n\nexport const DAOAgentConfigSchema = z.object({\n  snapshotHub: z.string().default(\"https://hub.snapshot.org/graphql\"),\n  tallyApiKey: z.string().optional(),\n  realmsRpcUrl: z.string().default(\"https://api.mainnet-beta.solana.com\"),\n});\n\nexport type DAOAgentConfig = z.infer<typeof DAOAgentConfigSchema>;\n\nexport interface DAO {\n  id: string;\n  name: string;\n  platform: \"snapshot\" | \"tally\" | \"realms\";\n  network: string;\n  avatar?: string;\n  website?: string;\n  github?: string;\n  twitter?: string;\n  treasury?: TreasuryInfo;\n  memberCount?: number;\n  proposalCount?: number;\n}\n\nexport interface TreasuryInfo {\n  address: string;\n  totalValueUsd: number;\n  tokens: Array<{\n    symbol: string;\n    balance: number;\n    valueUsd: number;\n  }>;\n}\n\nexport interface Proposal {\n  id: string;\n  title: string;\n  body: string;\n  author: string;\n  state: \"pending\" | \"active\" | \"closed\" | \"executed\" | \"defeated\";\n  start: Date;\n  end: Date;\n  choices: string[];\n  scores: number[];\n  quorum: number;\n  totalVotes: number;\n  platform: \"snapshot\" | \"tally\" | \"realms\";\n  link?: string;\n}\n\nexport interface Vote {\n  voter: string;\n  choice: number | number[];\n  votingPower: number;\n  timestamp: Date;\n  reason?: string;\n}\n\nexport interface VotingPower {\n  address: string;\n  power: number;\n  percentage: number;\n  delegatedFrom?: string[];\n  tokens?: Array<{ symbol: string; balance: number }>;\n}\n\nexport interface ProposalSummary {\n  title: string;\n  tldr: string;\n  keyPoints: string[];\n  impact: \"high\" | \"medium\" | \"low\";\n  recommendation?: \"for\" | \"against\" | \"abstain\";\n  risks: string[];\n}\n\nexport interface GovernancePlatform {\n  name: string;\n  platform: \"snapshot\" | \"tally\" | \"realms\";\n\n  getDAO(id: string): Promise<DAO | null>;\n  getProposals(daoId: string, state?: string): Promise<Proposal[]>;\n  getProposal(proposalId: string): Promise<Proposal | null>;\n  getVotes(proposalId: string, limit?: number): Promise<Vote[]>;\n  getVotingPower(daoId: string, address: string): Promise<VotingPower | null>;\n}\n","import type { GovernancePlatform, DAO, Proposal, Vote, VotingPower } from \"../types.js\";\n\ninterface SnapshotSpace {\n  id: string;\n  name: string;\n  avatar?: string;\n  website?: string;\n  github?: string;\n  twitter?: string;\n  network?: string;\n  members?: string[];\n  proposalsCount?: number;\n}\n\ninterface SnapshotProposal {\n  id: string;\n  title: string;\n  body: string;\n  author: string;\n  state: string;\n  start: number;\n  end: number;\n  choices: string[];\n  scores: number[];\n  quorum: number;\n  scores_total: number;\n  link?: string;\n}\n\ninterface SnapshotVote {\n  voter: string;\n  choice: number | number[];\n  vp: number;\n  created: number;\n  reason?: string;\n}\n\ninterface SnapshotVP {\n  vp: number;\n  vp_by_strategy: number[];\n}\n\ninterface GraphQLResponse<T> {\n  data?: T;\n  errors?: Array<{ message: string }>;\n}\n\nexport class SnapshotProvider implements GovernancePlatform {\n  name = \"snapshot\";\n  platform = \"snapshot\" as const;\n  private hubUrl: string;\n\n  constructor(hubUrl = \"https://hub.snapshot.org/graphql\") {\n    this.hubUrl = hubUrl;\n  }\n\n  private async query<T>(query: string, variables?: Record<string, unknown>): Promise<T | null> {\n    try {\n      const response = await fetch(this.hubUrl, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ query, variables }),\n      });\n      const data = (await response.json()) as GraphQLResponse<T>;\n      if (data.errors) {\n        console.error(\"Snapshot GraphQL errors:\", data.errors);\n        return null;\n      }\n      return data.data ?? null;\n    } catch (error) {\n      console.error(\"Snapshot query failed:\", error);\n      return null;\n    }\n  }\n\n  async getDAO(spaceId: string): Promise<DAO | null> {\n    const query = `\n      query Space($id: String!) {\n        space(id: $id) {\n          id\n          name\n          avatar\n          website\n          github\n          twitter\n          network\n          members\n          proposalsCount\n        }\n      }\n    `;\n\n    const result = await this.query<{ space: SnapshotSpace }>(query, { id: spaceId });\n    if (!result?.space) return null;\n\n    const space = result.space;\n    return {\n      id: space.id,\n      name: space.name,\n      platform: \"snapshot\",\n      network: space.network ?? \"ethereum\",\n      avatar: space.avatar,\n      website: space.website,\n      github: space.github,\n      twitter: space.twitter,\n      memberCount: space.members?.length,\n      proposalCount: space.proposalsCount,\n    };\n  }\n\n  async getProposals(spaceId: string, state?: string): Promise<Proposal[]> {\n    const query = `\n      query Proposals($space: String!, $state: String, $first: Int!) {\n        proposals(\n          first: $first,\n          where: { space: $space, state: $state },\n          orderBy: \"created\",\n          orderDirection: desc\n        ) {\n          id\n          title\n          body\n          author\n          state\n          start\n          end\n          choices\n          scores\n          quorum\n          scores_total\n          link\n        }\n      }\n    `;\n\n    const result = await this.query<{ proposals: SnapshotProposal[] }>(query, {\n      space: spaceId,\n      state: state ?? null,\n      first: 100,\n    });\n\n    if (!result?.proposals) return [];\n\n    return result.proposals.map((p) => ({\n      id: p.id,\n      title: p.title,\n      body: p.body,\n      author: p.author,\n      state: this.mapState(p.state),\n      start: new Date(p.start * 1000),\n      end: new Date(p.end * 1000),\n      choices: p.choices,\n      scores: p.scores,\n      quorum: p.quorum,\n      totalVotes: p.scores_total,\n      platform: \"snapshot\" as const,\n      link: p.link ?? `https://snapshot.org/#/${spaceId}/proposal/${p.id}`,\n    }));\n  }\n\n  private mapState(state: string): Proposal[\"state\"] {\n    switch (state.toLowerCase()) {\n      case \"pending\":\n        return \"pending\";\n      case \"active\":\n        return \"active\";\n      case \"closed\":\n        return \"closed\";\n      default:\n        return \"closed\";\n    }\n  }\n\n  async getProposal(proposalId: string): Promise<Proposal | null> {\n    const query = `\n      query Proposal($id: String!) {\n        proposal(id: $id) {\n          id\n          title\n          body\n          author\n          state\n          start\n          end\n          choices\n          scores\n          quorum\n          scores_total\n          space { id }\n          link\n        }\n      }\n    `;\n\n    const result = await this.query<{\n      proposal: SnapshotProposal & { space?: { id: string } };\n    }>(query, { id: proposalId });\n\n    if (!result?.proposal) return null;\n\n    const p = result.proposal;\n    return {\n      id: p.id,\n      title: p.title,\n      body: p.body,\n      author: p.author,\n      state: this.mapState(p.state),\n      start: new Date(p.start * 1000),\n      end: new Date(p.end * 1000),\n      choices: p.choices,\n      scores: p.scores,\n      quorum: p.quorum,\n      totalVotes: p.scores_total,\n      platform: \"snapshot\",\n      link: p.link ?? `https://snapshot.org/#/${p.space?.id}/proposal/${p.id}`,\n    };\n  }\n\n  async getVotes(proposalId: string, limit = 100): Promise<Vote[]> {\n    const query = `\n      query Votes($proposal: String!, $first: Int!) {\n        votes(\n          first: $first,\n          where: { proposal: $proposal },\n          orderBy: \"vp\",\n          orderDirection: desc\n        ) {\n          voter\n          choice\n          vp\n          created\n          reason\n        }\n      }\n    `;\n\n    const result = await this.query<{ votes: SnapshotVote[] }>(query, {\n      proposal: proposalId,\n      first: limit,\n    });\n\n    if (!result?.votes) return [];\n\n    return result.votes.map((v) => ({\n      voter: v.voter,\n      choice: v.choice,\n      votingPower: v.vp,\n      timestamp: new Date(v.created * 1000),\n      reason: v.reason,\n    }));\n  }\n\n  async getVotingPower(spaceId: string, address: string): Promise<VotingPower | null> {\n    const query = `\n      query VP($space: String!, $voter: String!) {\n        vp(space: $space, voter: $voter) {\n          vp\n          vp_by_strategy\n        }\n      }\n    `;\n\n    const result = await this.query<{ vp: SnapshotVP }>(query, {\n      space: spaceId,\n      voter: address,\n    });\n\n    if (!result?.vp) return null;\n\n    return {\n      address,\n      power: result.vp.vp,\n      percentage: 0, // Would need total supply to calculate\n    };\n  }\n}\n","import type { GovernancePlatform, DAO, Proposal, Vote, VotingPower } from \"../types.js\";\n\ninterface TallyOrganization {\n  id: string;\n  name: string;\n  slug: string;\n  chainIds: string[];\n  governorIds: string[];\n  proposalsCount?: number;\n  website?: string;\n  twitter?: string;\n}\n\ninterface TallyProposal {\n  id: string;\n  title: string;\n  description: string;\n  proposer: { address: string };\n  status: string;\n  start: { timestamp: string };\n  end: { timestamp: string };\n  voteStats: Array<{\n    support: string;\n    weight: string;\n    votes: string;\n  }>;\n  quorum: string;\n}\n\ninterface TallyVote {\n  voter: { address: string };\n  support: string;\n  weight: string;\n  block: { timestamp: string };\n  reason?: string;\n}\n\ninterface GraphQLResponse<T> {\n  data?: T;\n  errors?: Array<{ message: string }>;\n}\n\nexport class TallyProvider implements GovernancePlatform {\n  name = \"tally\";\n  platform = \"tally\" as const;\n  private apiKey: string;\n  private baseUrl = \"https://api.tally.xyz/query\";\n\n  constructor(config: { apiKey: string }) {\n    this.apiKey = config.apiKey;\n  }\n\n  private async query<T>(query: string, variables?: Record<string, unknown>): Promise<T | null> {\n    try {\n      const response = await fetch(this.baseUrl, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"Api-Key\": this.apiKey,\n        },\n        body: JSON.stringify({ query, variables }),\n      });\n      const data = (await response.json()) as GraphQLResponse<T>;\n      if (data.errors) {\n        console.error(\"Tally GraphQL errors:\", data.errors);\n        return null;\n      }\n      return data.data ?? null;\n    } catch (error) {\n      console.error(\"Tally query failed:\", error);\n      return null;\n    }\n  }\n\n  async getDAO(slug: string): Promise<DAO | null> {\n    const query = `\n      query Organization($slug: String!) {\n        organization(slug: $slug) {\n          id\n          name\n          slug\n          chainIds\n          governorIds\n          proposalsCount\n          website\n          twitter\n        }\n      }\n    `;\n\n    const result = await this.query<{ organization: TallyOrganization }>(query, { slug });\n    if (!result?.organization) return null;\n\n    const org = result.organization;\n    return {\n      id: org.id,\n      name: org.name,\n      platform: \"tally\",\n      network: org.chainIds[0] ?? \"ethereum\",\n      website: org.website,\n      twitter: org.twitter,\n      proposalCount: org.proposalsCount,\n    };\n  }\n\n  async getProposals(governorId: string, _state?: string): Promise<Proposal[]> {\n    const query = `\n      query Proposals($governorId: AccountID!, $first: Int!) {\n        proposals(governorId: $governorId, pagination: { limit: $first }) {\n          id\n          title\n          description\n          proposer { address }\n          status\n          start { timestamp }\n          end { timestamp }\n          voteStats {\n            support\n            weight\n            votes\n          }\n          quorum\n        }\n      }\n    `;\n\n    const result = await this.query<{ proposals: TallyProposal[] }>(query, {\n      governorId,\n      first: 100,\n    });\n\n    if (!result?.proposals) return [];\n\n    return result.proposals.map((p) => this.mapProposal(p));\n  }\n\n  private mapProposal(p: TallyProposal): Proposal {\n    const scores = p.voteStats.map((v) => parseFloat(v.weight));\n\n    return {\n      id: p.id,\n      title: p.title,\n      body: p.description,\n      author: p.proposer.address,\n      state: this.mapState(p.status),\n      start: new Date(p.start.timestamp),\n      end: new Date(p.end.timestamp),\n      choices: [\"Against\", \"For\", \"Abstain\"],\n      scores,\n      quorum: parseFloat(p.quorum),\n      totalVotes: scores.reduce((a, b) => a + b, 0),\n      platform: \"tally\",\n      link: `https://www.tally.xyz/proposal/${p.id}`,\n    };\n  }\n\n  private mapState(status: string): Proposal[\"state\"] {\n    switch (status.toLowerCase()) {\n      case \"pending\":\n        return \"pending\";\n      case \"active\":\n        return \"active\";\n      case \"succeeded\":\n      case \"queued\":\n        return \"closed\";\n      case \"executed\":\n        return \"executed\";\n      case \"defeated\":\n      case \"expired\":\n      case \"canceled\":\n        return \"defeated\";\n      default:\n        return \"closed\";\n    }\n  }\n\n  async getProposal(proposalId: string): Promise<Proposal | null> {\n    const query = `\n      query Proposal($id: ID!) {\n        proposal(id: $id) {\n          id\n          title\n          description\n          proposer { address }\n          status\n          start { timestamp }\n          end { timestamp }\n          voteStats {\n            support\n            weight\n            votes\n          }\n          quorum\n        }\n      }\n    `;\n\n    const result = await this.query<{ proposal: TallyProposal }>(query, { id: proposalId });\n    if (!result?.proposal) return null;\n\n    return this.mapProposal(result.proposal);\n  }\n\n  async getVotes(proposalId: string, limit = 100): Promise<Vote[]> {\n    const query = `\n      query Votes($proposalId: ID!, $first: Int!) {\n        votes(proposalId: $proposalId, pagination: { limit: $first }) {\n          voter { address }\n          support\n          weight\n          block { timestamp }\n          reason\n        }\n      }\n    `;\n\n    const result = await this.query<{ votes: TallyVote[] }>(query, {\n      proposalId,\n      first: limit,\n    });\n\n    if (!result?.votes) return [];\n\n    return result.votes.map((v) => ({\n      voter: v.voter.address,\n      choice: this.mapSupport(v.support),\n      votingPower: parseFloat(v.weight),\n      timestamp: new Date(v.block.timestamp),\n      reason: v.reason,\n    }));\n  }\n\n  private mapSupport(support: string): number {\n    switch (support.toLowerCase()) {\n      case \"against\":\n        return 0;\n      case \"for\":\n        return 1;\n      case \"abstain\":\n        return 2;\n      default:\n        return -1;\n    }\n  }\n\n  async getVotingPower(governorId: string, address: string): Promise<VotingPower | null> {\n    const query = `\n      query VotingPower($governorId: AccountID!, $address: Address!) {\n        delegate(governorId: $governorId, address: $address) {\n          votesCount\n          delegatorsCount\n        }\n      }\n    `;\n\n    const result = await this.query<{\n      delegate: { votesCount: string; delegatorsCount: number };\n    }>(query, { governorId, address });\n\n    if (!result?.delegate) return null;\n\n    return {\n      address,\n      power: parseFloat(result.delegate.votesCount),\n      percentage: 0,\n    };\n  }\n}\n","import type { GovernancePlatform, DAO, Proposal, Vote, VotingPower } from \"../types.js\";\n\ninterface RealmsRPCResponse<T> {\n  jsonrpc: string;\n  result?: T;\n  id: number;\n}\n\ninterface RealmAccount {\n  pubkey: string;\n  account: {\n    data: {\n      parsed?: {\n        info?: {\n          name?: string;\n          communityMint?: string;\n          councilMint?: string;\n          authority?: string;\n        };\n      };\n    };\n  };\n}\n\ninterface ProposalAccount {\n  pubkey: string;\n  account: {\n    data: {\n      parsed?: {\n        info?: {\n          name?: string;\n          descriptionLink?: string;\n          state?: number;\n          draftAt?: number;\n          signingOffAt?: number;\n          votingAt?: number;\n          votingCompletedAt?: number;\n          executingAt?: number;\n          closedAt?: number;\n          options?: Array<{\n            label: string;\n            voteWeight: string;\n          }>;\n        };\n      };\n    };\n  };\n}\n\nexport class RealmsProvider implements GovernancePlatform {\n  name = \"realms\";\n  platform = \"realms\" as const;\n  private rpcUrl: string;\n\n  constructor(rpcUrl = \"https://api.mainnet-beta.solana.com\") {\n    this.rpcUrl = rpcUrl;\n  }\n\n  private async rpc<T>(method: string, params: unknown[]): Promise<T | null> {\n    try {\n      const response = await fetch(this.rpcUrl, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          jsonrpc: \"2.0\",\n          id: 1,\n          method,\n          params,\n        }),\n      });\n      const data = (await response.json()) as RealmsRPCResponse<T>;\n      return data.result ?? null;\n    } catch (error) {\n      console.error(\"Realms RPC failed:\", error);\n      return null;\n    }\n  }\n\n  async getDAO(realmPubkey: string): Promise<DAO | null> {\n    try {\n      // Get realm account info\n      const result = await this.rpc<RealmAccount[\"account\"]>(\"getAccountInfo\", [\n        realmPubkey,\n        { encoding: \"jsonParsed\" },\n      ]);\n\n      if (!result) return null;\n\n      const info = result.data?.parsed?.info;\n\n      return {\n        id: realmPubkey,\n        name: info?.name ?? realmPubkey.slice(0, 8),\n        platform: \"realms\",\n        network: \"solana\",\n      };\n    } catch {\n      return null;\n    }\n  }\n\n  async getProposals(realmPubkey: string, _state?: string): Promise<Proposal[]> {\n    // Realms uses getProgramAccounts with specific filters\n    // This is a simplified implementation - full version would need\n    // the governance program ID and proper account parsing\n\n    try {\n      // In practice, you'd query the Realms API or index the blockchain\n      // For now, return empty array as direct RPC querying is complex\n      return [];\n    } catch {\n      return [];\n    }\n  }\n\n  async getProposal(proposalPubkey: string): Promise<Proposal | null> {\n    try {\n      const result = await this.rpc<ProposalAccount[\"account\"]>(\"getAccountInfo\", [\n        proposalPubkey,\n        { encoding: \"jsonParsed\" },\n      ]);\n\n      if (!result) return null;\n\n      const info = result.data?.parsed?.info;\n      if (!info) return null;\n\n      const options = info.options ?? [];\n      const choices = options.map((o) => o.label);\n      const scores = options.map((o) => parseFloat(o.voteWeight));\n\n      return {\n        id: proposalPubkey,\n        title: info.name ?? \"Untitled\",\n        body: info.descriptionLink ?? \"\",\n        author: \"\",\n        state: this.mapState(info.state ?? 0),\n        start: new Date((info.votingAt ?? 0) * 1000),\n        end: new Date((info.votingCompletedAt ?? Date.now() / 1000) * 1000),\n        choices,\n        scores,\n        quorum: 0,\n        totalVotes: scores.reduce((a, b) => a + b, 0),\n        platform: \"realms\",\n        link: `https://realms.today/dao/${proposalPubkey}`,\n      };\n    } catch {\n      return null;\n    }\n  }\n\n  private mapState(state: number): Proposal[\"state\"] {\n    // Realms proposal states:\n    // 0 = Draft, 1 = SigningOff, 2 = Voting, 3 = Succeeded,\n    // 4 = Executing, 5 = Completed, 6 = Cancelled, 7 = Defeated\n    switch (state) {\n      case 0:\n      case 1:\n        return \"pending\";\n      case 2:\n        return \"active\";\n      case 3:\n      case 4:\n      case 5:\n        return \"executed\";\n      case 6:\n      case 7:\n        return \"defeated\";\n      default:\n        return \"closed\";\n    }\n  }\n\n  async getVotes(_proposalPubkey: string, _limit = 100): Promise<Vote[]> {\n    // Realms votes are stored in VoteRecord accounts\n    // Would need to query getProgramAccounts with filters\n    return [];\n  }\n\n  async getVotingPower(realmPubkey: string, address: string): Promise<VotingPower | null> {\n    // Would need to check token holdings and delegation\n    // Simplified implementation\n    try {\n      const dao = await this.getDAO(realmPubkey);\n      if (!dao) return null;\n\n      return {\n        address,\n        power: 0,\n        percentage: 0,\n      };\n    } catch {\n      return null;\n    }\n  }\n}\n","import type { Proposal, ProposalSummary } from \"../types.js\";\nimport type { LLMClient } from \"@gicm/agent-core\";\n\nexport class ProposalAnalyzer {\n  private llmClient?: LLMClient;\n\n  constructor(llmClient?: LLMClient) {\n    this.llmClient = llmClient;\n  }\n\n  async summarizeProposal(proposal: Proposal): Promise<ProposalSummary> {\n    if (!this.llmClient) {\n      return this.basicSummary(proposal);\n    }\n\n    try {\n      const response = await this.llmClient.chat([\n        {\n          role: \"system\",\n          content: `You are a DAO governance expert. Analyze proposals and provide clear, concise summaries.\nReturn JSON with this exact structure:\n{\n  \"title\": \"short title\",\n  \"tldr\": \"one sentence summary\",\n  \"keyPoints\": [\"point 1\", \"point 2\", \"point 3\"],\n  \"impact\": \"high\" | \"medium\" | \"low\",\n  \"recommendation\": \"for\" | \"against\" | \"abstain\",\n  \"risks\": [\"risk 1\", \"risk 2\"]\n}`,\n        },\n        {\n          role: \"user\",\n          content: `Analyze this proposal:\n\nTitle: ${proposal.title}\n\nBody:\n${proposal.body.slice(0, 4000)}\n\nChoices: ${proposal.choices.join(\", \")}\nCurrent Scores: ${proposal.scores.map((s, i) => `${proposal.choices[i]}: ${s}`).join(\", \")}\nState: ${proposal.state}\nQuorum: ${proposal.quorum}`,\n        },\n      ]);\n\n      try {\n        const parsed = JSON.parse(response.content) as ProposalSummary;\n        return {\n          title: parsed.title ?? proposal.title,\n          tldr: parsed.tldr ?? \"\",\n          keyPoints: parsed.keyPoints ?? [],\n          impact: parsed.impact ?? \"medium\",\n          recommendation: parsed.recommendation,\n          risks: parsed.risks ?? [],\n        };\n      } catch {\n        return this.basicSummary(proposal);\n      }\n    } catch {\n      return this.basicSummary(proposal);\n    }\n  }\n\n  private basicSummary(proposal: Proposal): ProposalSummary {\n    const bodyPreview = proposal.body.slice(0, 200).trim();\n    const leadingChoice = this.getLeadingChoice(proposal);\n\n    return {\n      title: proposal.title,\n      tldr: bodyPreview + (proposal.body.length > 200 ? \"...\" : \"\"),\n      keyPoints: [\n        `Author: ${proposal.author.slice(0, 10)}...`,\n        `State: ${proposal.state}`,\n        `Leading: ${leadingChoice}`,\n      ],\n      impact: this.estimateImpact(proposal),\n      risks: [],\n    };\n  }\n\n  private getLeadingChoice(proposal: Proposal): string {\n    if (proposal.scores.length === 0) return \"No votes\";\n\n    const maxScore = Math.max(...proposal.scores);\n    const leadingIndex = proposal.scores.indexOf(maxScore);\n    return proposal.choices[leadingIndex] ?? \"Unknown\";\n  }\n\n  private estimateImpact(proposal: Proposal): \"high\" | \"medium\" | \"low\" {\n    const bodyLower = proposal.body.toLowerCase();\n\n    // High impact keywords\n    if (\n      bodyLower.includes(\"treasury\") ||\n      bodyLower.includes(\"upgrade\") ||\n      bodyLower.includes(\"migration\") ||\n      bodyLower.includes(\"emergency\")\n    ) {\n      return \"high\";\n    }\n\n    // Medium impact keywords\n    if (\n      bodyLower.includes(\"parameter\") ||\n      bodyLower.includes(\"fee\") ||\n      bodyLower.includes(\"grant\")\n    ) {\n      return \"medium\";\n    }\n\n    return \"low\";\n  }\n\n  analyzeVotingPatterns(proposals: Proposal[]): {\n    avgParticipation: number;\n    avgDuration: number;\n    passRate: number;\n    topChoices: Array<{ choice: string; count: number }>;\n  } {\n    if (proposals.length === 0) {\n      return {\n        avgParticipation: 0,\n        avgDuration: 0,\n        passRate: 0,\n        topChoices: [],\n      };\n    }\n\n    const choiceCounts = new Map<string, number>();\n    let totalParticipation = 0;\n    let totalDuration = 0;\n    let passedCount = 0;\n\n    for (const proposal of proposals) {\n      totalParticipation += proposal.totalVotes;\n      totalDuration += proposal.end.getTime() - proposal.start.getTime();\n\n      if (proposal.state === \"executed\") {\n        passedCount++;\n      }\n\n      // Count winning choices\n      if (proposal.scores.length > 0) {\n        const maxScore = Math.max(...proposal.scores);\n        const winningIndex = proposal.scores.indexOf(maxScore);\n        const winningChoice = proposal.choices[winningIndex];\n        if (winningChoice) {\n          choiceCounts.set(winningChoice, (choiceCounts.get(winningChoice) ?? 0) + 1);\n        }\n      }\n    }\n\n    const topChoices = Array.from(choiceCounts.entries())\n      .map(([choice, count]) => ({ choice, count }))\n      .sort((a, b) => b.count - a.count)\n      .slice(0, 5);\n\n    return {\n      avgParticipation: totalParticipation / proposals.length,\n      avgDuration: totalDuration / proposals.length / (1000 * 60 * 60 * 24), // Days\n      passRate: passedCount / proposals.length,\n      topChoices,\n    };\n  }\n}\n","import type { Vote, VotingPower } from \"../types.js\";\n\nexport interface VotingPowerDistribution {\n  totalPower: number;\n  topHolders: Array<{\n    address: string;\n    power: number;\n    percentage: number;\n  }>;\n  concentrationScore: number; // 0-1, higher = more concentrated\n  giniCoefficient: number;\n}\n\nexport interface VoterAnalysis {\n  address: string;\n  totalVotes: number;\n  participationRate: number;\n  avgVotingPower: number;\n  votingHistory: Array<{\n    proposalId: string;\n    choice: number | number[];\n    power: number;\n    timestamp: Date;\n  }>;\n}\n\nexport class VotingPowerAnalyzer {\n  analyzeDistribution(\n    holders: VotingPower[],\n    totalSupply?: number\n  ): VotingPowerDistribution {\n    if (holders.length === 0) {\n      return {\n        totalPower: 0,\n        topHolders: [],\n        concentrationScore: 0,\n        giniCoefficient: 0,\n      };\n    }\n\n    const sorted = [...holders].sort((a, b) => b.power - a.power);\n    const totalPower = totalSupply ?? sorted.reduce((sum, h) => sum + h.power, 0);\n\n    const topHolders = sorted.slice(0, 20).map((h) => ({\n      address: h.address,\n      power: h.power,\n      percentage: totalPower > 0 ? (h.power / totalPower) * 100 : 0,\n    }));\n\n    // Calculate concentration score (top 10 holders' share)\n    const top10Power = sorted.slice(0, 10).reduce((sum, h) => sum + h.power, 0);\n    const concentrationScore = totalPower > 0 ? top10Power / totalPower : 0;\n\n    // Calculate Gini coefficient\n    const giniCoefficient = this.calculateGini(sorted.map((h) => h.power));\n\n    return {\n      totalPower,\n      topHolders,\n      concentrationScore,\n      giniCoefficient,\n    };\n  }\n\n  private calculateGini(values: number[]): number {\n    if (values.length === 0) return 0;\n\n    const sorted = [...values].sort((a, b) => a - b);\n    const n = sorted.length;\n    const sum = sorted.reduce((a, b) => a + b, 0);\n\n    if (sum === 0) return 0;\n\n    let cumulativeSum = 0;\n    let giniSum = 0;\n\n    for (let i = 0; i < n; i++) {\n      cumulativeSum += sorted[i]!;\n      giniSum += cumulativeSum;\n    }\n\n    const gini = (2 * giniSum) / (n * sum) - (n + 1) / n;\n    return Math.max(0, Math.min(1, gini));\n  }\n\n  analyzeVoter(\n    address: string,\n    votes: Vote[],\n    totalProposals: number\n  ): VoterAnalysis {\n    const voterVotes = votes.filter(\n      (v) => v.voter.toLowerCase() === address.toLowerCase()\n    );\n\n    if (voterVotes.length === 0) {\n      return {\n        address,\n        totalVotes: 0,\n        participationRate: 0,\n        avgVotingPower: 0,\n        votingHistory: [],\n      };\n    }\n\n    const avgPower =\n      voterVotes.reduce((sum, v) => sum + v.votingPower, 0) / voterVotes.length;\n\n    return {\n      address,\n      totalVotes: voterVotes.length,\n      participationRate: totalProposals > 0 ? voterVotes.length / totalProposals : 0,\n      avgVotingPower: avgPower,\n      votingHistory: voterVotes.map((v) => ({\n        proposalId: \"\", // Would need proposal context\n        choice: v.choice,\n        power: v.votingPower,\n        timestamp: v.timestamp,\n      })),\n    };\n  }\n\n  findWhaleVoters(\n    votes: Vote[],\n    threshold = 0.01 // 1% of total votes\n  ): Array<{ address: string; totalPower: number; voteCount: number }> {\n    const voterTotals = new Map<string, { power: number; count: number }>();\n\n    for (const vote of votes) {\n      const existing = voterTotals.get(vote.voter) ?? { power: 0, count: 0 };\n      voterTotals.set(vote.voter, {\n        power: existing.power + vote.votingPower,\n        count: existing.count + 1,\n      });\n    }\n\n    const totalPower = votes.reduce((sum, v) => sum + v.votingPower, 0);\n    const whaleThreshold = totalPower * threshold;\n\n    return Array.from(voterTotals.entries())\n      .filter(([, data]) => data.power >= whaleThreshold)\n      .map(([address, data]) => ({\n        address,\n        totalPower: data.power,\n        voteCount: data.count,\n      }))\n      .sort((a, b) => b.totalPower - a.totalPower);\n  }\n\n  calculateQuorumHealth(\n    currentVotes: number,\n    quorum: number,\n    timeRemaining: number, // milliseconds\n    historicalAvgVelocity?: number // votes per hour\n  ): {\n    currentProgress: number;\n    projectedFinal: number;\n    willReachQuorum: boolean;\n    confidence: number;\n  } {\n    const currentProgress = quorum > 0 ? currentVotes / quorum : 0;\n\n    if (timeRemaining <= 0) {\n      return {\n        currentProgress,\n        projectedFinal: currentVotes,\n        willReachQuorum: currentVotes >= quorum,\n        confidence: 1,\n      };\n    }\n\n    // Simple linear projection if we have historical data\n    const hoursRemaining = timeRemaining / (1000 * 60 * 60);\n    const velocity = historicalAvgVelocity ?? 0;\n    const projectedAdditional = velocity * hoursRemaining;\n    const projectedFinal = currentVotes + projectedAdditional;\n\n    return {\n      currentProgress,\n      projectedFinal,\n      willReachQuorum: projectedFinal >= quorum,\n      confidence: velocity > 0 ? 0.7 : 0.3, // Lower confidence without velocity data\n    };\n  }\n}\n"],"mappings":"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","names":["z","z"]}