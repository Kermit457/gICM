{"version":3,"sources":["../src/index.ts","../src/core/config.ts","../src/router/index.ts","../src/router/classifier.ts","../src/router/boundaries.ts","../src/router/escalation.ts","../src/utils/logger.ts","../src/executor/index.ts","../src/executor/safe-actions.ts","../src/executor/rollback.ts","../src/approval/queue.ts","../src/approval/notifications.ts","../src/audit/index.ts"],"sourcesContent":["/**\n * gICM Autonomy Level 2\n *\n * Bounded autonomous decision-making system.\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport type { Action, Boundaries, EngineType, DecisionRoute } from \"./core/types.js\";\nimport { getDefaultBoundaries, mergeBoundaries } from \"./core/config.js\";\nimport { DecisionRouter } from \"./router/index.js\";\nimport { AutoExecutor } from \"./executor/index.js\";\nimport { ApprovalQueue, NotificationManager, type NotificationConfig } from \"./approval/index.js\";\nimport { AuditLogger } from \"./audit/index.js\";\nimport { Logger } from \"./utils/logger.js\";\n\nexport interface AutonomyConfig {\n  boundaries?: Partial<Boundaries>;\n  notifications?: NotificationConfig;\n  enableBatching?: boolean;\n}\n\ninterface AutonomyEvents {\n  \"action:auto_executed\": (action: Action) => void;\n  \"action:queued\": (action: Action) => void;\n  \"action:escalated\": (action: Action) => void;\n  \"action:approved\": (action: Action) => void;\n  \"action:rejected\": (action: Action) => void;\n  \"action:executed\": (action: Action) => void;\n  \"action:failed\": (action: Action, error: Error) => void;\n}\n\nexport class AutonomySystem extends EventEmitter<AutonomyEvents> {\n  private router: DecisionRouter;\n  private executor: AutoExecutor;\n  private approvalQueue: ApprovalQueue;\n  private notifications: NotificationManager;\n  private auditLogger: AuditLogger;\n  private logger: Logger;\n  private boundaries: Boundaries;\n\n  constructor(config: AutonomyConfig = {}) {\n    super();\n    this.logger = new Logger(\"Autonomy\");\n    this.boundaries = mergeBoundaries(getDefaultBoundaries(), config.boundaries || {});\n    this.router = new DecisionRouter(this.boundaries);\n    this.executor = new AutoExecutor();\n    this.approvalQueue = new ApprovalQueue();\n    this.notifications = new NotificationManager(config.notifications);\n    this.auditLogger = new AuditLogger();\n    this.setupEventHandlers();\n    if (config.enableBatching !== false) {\n      this.approvalQueue.startBatchTimer();\n    }\n    this.logger.info(\"Autonomy System initialized (Level 2)\");\n  }\n\n  async processAction(action: Partial<Action> & { type: string; engine: EngineType }): Promise<{\n    route: DecisionRoute;\n    action: Action;\n  }> {\n    const fullAction: Action = {\n      id: action.id || this.generateId(),\n      engine: action.engine,\n      type: action.type,\n      description: action.description || action.type,\n      params: action.params || {},\n      risk: action.risk || {\n        level: \"safe\",\n        score: 0,\n        factors: [],\n        estimatedCost: 0,\n        maxPotentialLoss: 0,\n        reversible: true,\n      },\n      route: \"queue\",\n      status: \"pending\",\n      createdAt: Date.now(),\n    };\n\n    const route = await this.router.route(fullAction);\n\n    if (route === \"auto\") {\n      const success = await this.executor.execute(fullAction);\n      this.auditLogger.log(fullAction, success ? \"success\" : \"failed\", fullAction.risk.estimatedCost);\n      if (success) this.router.recordExecution(fullAction);\n    } else if (route === \"queue\") {\n      this.approvalQueue.add(fullAction, \"Requires review\");\n    }\n\n    return { route, action: fullAction };\n  }\n\n  async approveAction(actionId: string, feedback?: string): Promise<boolean> {\n    const item = this.approvalQueue.get(actionId);\n    if (!item) return false;\n    this.approvalQueue.approve(actionId, feedback);\n    const success = await this.executor.execute(item.action);\n    this.auditLogger.log(item.action, success ? \"success\" : \"failed\", item.action.risk.estimatedCost);\n    return success;\n  }\n\n  rejectAction(actionId: string, feedback?: string): boolean {\n    const item = this.approvalQueue.get(actionId);\n    if (!item) return false;\n    this.approvalQueue.reject(actionId, feedback);\n    this.auditLogger.log(item.action, \"failed\", 0, 0);\n    return true;\n  }\n\n  getPendingApprovals() { return this.approvalQueue.getPending(); }\n  getBatch() { return this.approvalQueue.getBatch(); }\n  getBoundaries(): Boundaries { return this.boundaries; }\n  \n  updateBoundaries(newBoundaries: Partial<Boundaries>): void {\n    this.boundaries = mergeBoundaries(this.boundaries, newBoundaries);\n    this.router.updateBoundaries(this.boundaries);\n  }\n\n  getAuditSummary(since?: number) { return this.auditLogger.getSummary(since); }\n  getDailySummary() { return this.auditLogger.getDailySummary(); }\n  getQueueStats() { return this.approvalQueue.getStats(); }\n\n  registerActionHandler(actionType: string, handler: (action: Action) => Promise<unknown>): void {\n    this.executor.registerHandler(actionType, handler);\n  }\n\n  setNotificationConfig(config: NotificationConfig): void {\n    this.notifications.setConfig(config);\n  }\n\n  async sendDailySummary(): Promise<void> {\n    const summary = this.getDailySummary();\n    await this.notifications.sendDailySummary(summary);\n  }\n\n  shutdown(): void {\n    this.approvalQueue.stopBatchTimer();\n    this.logger.info(\"Autonomy System shutdown\");\n  }\n\n  private setupEventHandlers(): void {\n    this.router.on(\"action:auto_approved\", (action) => this.emit(\"action:auto_executed\", action));\n    this.router.on(\"action:queued\", (action) => this.emit(\"action:queued\", action));\n    this.router.on(\"action:escalated\", (action) => {\n      this.emit(\"action:escalated\", action);\n      this.notifications.escalate(action).catch(() => {});\n    });\n    this.executor.on(\"executed\", (action) => this.emit(\"action:executed\", action));\n    this.executor.on(\"failed\", (action, error) => this.emit(\"action:failed\", action, error));\n    this.approvalQueue.on(\"item_approved\", (item) => this.emit(\"action:approved\", item.action));\n    this.approvalQueue.on(\"item_rejected\", (item) => this.emit(\"action:rejected\", item.action));\n    this.approvalQueue.on(\"batch_ready\", (batch) => this.notifications.notifyBatchReady(batch).catch(() => {}));\n  }\n\n  private generateId(): string {\n    return \"action-\" + Date.now() + \"-\" + Math.random().toString(36).slice(2, 8);\n  }\n}\n\n// Exports\nexport type { Action, Boundaries, RiskLevel, RiskAssessment, RiskFactor, DecisionRoute, EngineType, ApprovalItem, BatchApproval, AuditEntry, BoundaryCheckResult } from \"./core/types.js\";\nexport { getDefaultBoundaries, mergeBoundaries } from \"./core/config.js\";\nexport { DecisionRouter, RiskClassifier, BoundaryChecker, EscalationManager } from \"./router/index.js\";\nexport { AutoExecutor, SafeActions, RollbackManager } from \"./executor/index.js\";\nexport type { ActionHandler } from \"./executor/index.js\";\nexport { ApprovalQueue, NotificationManager } from \"./approval/index.js\";\nexport type { NotificationConfig } from \"./approval/index.js\";\nexport { AuditLogger } from \"./audit/index.js\";\n","/**\n * Boundary Configuration Manager\n */\n\nimport type { Boundaries } from \"./types.js\";\n\nconst DEFAULT_BOUNDARIES: Boundaries = {\n  financial: {\n    maxAutoExpense: 50,\n    maxQueuedExpense: 200,\n    maxDailySpend: 100,\n    maxTradeSize: 500,\n    maxDailyTradingLoss: 5,\n    minTreasuryBalance: 1000,\n  },\n  content: {\n    maxAutoPostsPerDay: 10,\n    maxAutoBlogsPerWeek: 3,\n    requireReviewForTopics: [\"controversial\", \"financial_advice\", \"competitor_criticism\"],\n  },\n  development: {\n    maxAutoCommitLines: 100,\n    maxAutoFilesChanged: 5,\n    requireReviewForPaths: [\"src/core/\", \"src/config/\", \".env\"],\n    autoDeployToStaging: true,\n    autoDeployToProduction: false,\n  },\n  trading: {\n    allowedBots: [\"dca\"],\n    allowedTokens: [\"SOL\", \"USDC\"],\n    maxPositionPercent: 20,\n    requireApprovalForNewTokens: true,\n  },\n  time: {\n    activeHours: { start: 6, end: 22 },\n    quietHours: { start: 23, end: 6 },\n    maintenanceWindow: { day: 0, hour: 4 },\n  },\n};\n\nexport function getDefaultBoundaries(): Boundaries {\n  return JSON.parse(JSON.stringify(DEFAULT_BOUNDARIES));\n}\n\nexport function mergeBoundaries(\n  base: Boundaries,\n  overrides: Partial<Boundaries>\n): Boundaries {\n  return {\n    financial: { ...base.financial, ...overrides.financial },\n    content: { ...base.content, ...overrides.content },\n    development: { ...base.development, ...overrides.development },\n    trading: { ...base.trading, ...overrides.trading },\n    time: { ...base.time, ...overrides.time },\n  };\n}\n","/**\n * Decision Router\n *\n * Routes actions to auto-execute, queue, or escalate based on boundaries.\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport type { Action, Boundaries, DecisionRoute } from \"../core/types.js\";\nimport { RiskClassifier } from \"./classifier.js\";\nimport { BoundaryChecker } from \"./boundaries.js\";\nimport { EscalationManager } from \"./escalation.js\";\nimport { Logger } from \"../utils/logger.js\";\n\ninterface RouterEvents {\n  \"action:routed\": (action: Action, route: DecisionRoute) => void;\n  \"action:auto_approved\": (action: Action) => void;\n  \"action:queued\": (action: Action, reason: string) => void;\n  \"action:escalated\": (action: Action) => void;\n}\n\nexport class DecisionRouter extends EventEmitter<RouterEvents> {\n  private classifier: RiskClassifier;\n  private boundaryChecker: BoundaryChecker;\n  private escalation: EscalationManager;\n  private logger: Logger;\n  private boundaries: Boundaries;\n\n  constructor(boundaries: Boundaries) {\n    super();\n    this.boundaries = boundaries;\n    this.classifier = new RiskClassifier();\n    this.boundaryChecker = new BoundaryChecker(boundaries);\n    this.escalation = new EscalationManager();\n    this.logger = new Logger(\"DecisionRouter\");\n\n    // Forward escalation events\n    this.escalation.on(\"escalated\", (action) => {\n      this.emit(\"action:escalated\", action);\n    });\n  }\n\n  /**\n   * Route an action to the appropriate handler\n   */\n  async route(action: Action): Promise<DecisionRoute> {\n    this.logger.info(\"Routing action: \" + action.type + \" from \" + action.engine);\n\n    // 1. Assess risk\n    const risk = await this.classifier.assess(action);\n    action.risk = risk;\n\n    // 2. Check boundaries\n    const boundaryResult = this.boundaryChecker.check(action);\n\n    // 3. Determine route\n    let route: DecisionRoute;\n    let reason = \"\";\n\n    if (risk.level === \"critical\" || boundaryResult.violated) {\n      route = \"escalate\";\n      reason = boundaryResult.violations.join(\"; \") || \"Critical risk level\";\n    } else if (risk.level === \"high\" || boundaryResult.needsReview) {\n      route = \"queue\";\n      reason = boundaryResult.warnings.join(\"; \") || \"High risk requires review\";\n    } else if (risk.level === \"safe\" && boundaryResult.withinLimits) {\n      route = \"auto\";\n      reason = \"Within safe boundaries\";\n    } else {\n      route = \"queue\"; // Default to queue if uncertain\n      reason = \"Moderate risk - queued for review\";\n    }\n\n    action.route = route;\n\n    this.logger.info(\n      \"Action routed: \" + route + \" (risk: \" + risk.level + \", score: \" + risk.score + \")\"\n    );\n\n    // 4. Handle based on route\n    await this.handleRoute(action, route, reason);\n\n    // 5. Emit event\n    this.emit(\"action:routed\", action, route);\n\n    return route;\n  }\n\n  /**\n   * Handle action based on route\n   */\n  private async handleRoute(\n    action: Action,\n    route: DecisionRoute,\n    reason: string\n  ): Promise<void> {\n    switch (route) {\n      case \"auto\":\n        // Auto-approve\n        this.logger.info(\"Auto-approved: \" + action.type);\n        action.status = \"approved\";\n        action.approvedBy = \"auto\";\n        action.approvedAt = Date.now();\n        this.emit(\"action:auto_approved\", action);\n        break;\n\n      case \"queue\":\n        // Add to approval queue\n        this.logger.info(\"Queued for review: \" + action.type + \" - \" + reason);\n        action.status = \"pending\";\n        this.emit(\"action:queued\", action, reason);\n        break;\n\n      case \"escalate\":\n        // Notify human immediately\n        this.logger.warn(\"Escalating: \" + action.type + \" - \" + reason);\n        action.status = \"pending\";\n        await this.escalation.notify(action);\n        break;\n    }\n  }\n\n  /**\n   * Record that an action was executed (updates daily limits)\n   */\n  recordExecution(action: Action): void {\n    this.boundaryChecker.recordExecution(action);\n  }\n\n  /**\n   * Update boundaries\n   */\n  updateBoundaries(newBoundaries: Boundaries): void {\n    this.boundaries = newBoundaries;\n    this.boundaryChecker.updateBoundaries(newBoundaries);\n    this.logger.info(\"Boundaries updated\");\n  }\n\n  /**\n   * Get current boundaries\n   */\n  getBoundaries(): Boundaries {\n    return this.boundaries;\n  }\n\n  /**\n   * Get escalation manager (for handling escalations)\n   */\n  getEscalationManager(): EscalationManager {\n    return this.escalation;\n  }\n\n  /**\n   * Get boundary checker (for manual checks)\n   */\n  getBoundaryChecker(): BoundaryChecker {\n    return this.boundaryChecker;\n  }\n}\n\n// Re-exports\nexport { RiskClassifier } from \"./classifier.js\";\nexport { BoundaryChecker } from \"./boundaries.js\";\nexport { EscalationManager } from \"./escalation.js\";\n","/**\n * Risk Classifier\n *\n * Assesses risk level of actions.\n */\n\nimport type { Action, RiskAssessment, RiskFactor, RiskLevel } from \"../core/types.js\";\n\nexport class RiskClassifier {\n  /**\n   * Assess risk of an action\n   */\n  async assess(action: Action): Promise<RiskAssessment> {\n    const factors = this.identifyRiskFactors(action);\n    const score = this.calculateScore(factors);\n    const level = this.determineLevel(score);\n\n    return {\n      level,\n      score,\n      factors,\n      estimatedCost: this.estimateCost(action),\n      maxPotentialLoss: this.estimateMaxLoss(action),\n      reversible: this.isReversible(action),\n      rollbackPlan: this.generateRollbackPlan(action),\n    };\n  }\n\n  /**\n   * Identify risk factors for an action\n   */\n  private identifyRiskFactors(action: Action): RiskFactor[] {\n    const factors: RiskFactor[] = [];\n    const params = action.params as Record<string, number | string | undefined>;\n\n    // Financial risk\n    const amount = (params.amount || params.cost || 0) as number;\n    if (amount > 0) {\n      factors.push({\n        name: \"financial_exposure\",\n        weight: 0.3,\n        value: amount,\n        threshold: 100,\n        exceeded: amount > 100,\n      });\n    }\n\n    // Irreversibility risk\n    const irreversibleActions = [\"deploy_production\", \"delete\", \"publish\", \"trade_execute\"];\n    if (irreversibleActions.some((a) => action.type.includes(a))) {\n      factors.push({\n        name: \"irreversibility\",\n        weight: 0.25,\n        value: 1,\n        threshold: 0,\n        exceeded: true,\n      });\n    }\n\n    // Scope risk (how much is affected)\n    const filesChanged = (params.filesChanged || 0) as number;\n    const linesChanged = (params.linesChanged || 0) as number;\n    factors.push({\n      name: \"change_scope\",\n      weight: 0.2,\n      value: filesChanged * 10 + linesChanged / 10,\n      threshold: 100,\n      exceeded: filesChanged > 5 || linesChanged > 100,\n    });\n\n    // External impact risk\n    const externalActions = [\"tweet\", \"blog_publish\", \"email\", \"api_call\"];\n    if (externalActions.some((a) => action.type.includes(a))) {\n      factors.push({\n        name: \"external_visibility\",\n        weight: 0.15,\n        value: 1,\n        threshold: 0,\n        exceeded: true,\n      });\n    }\n\n    // Time sensitivity\n    const isQuietHours = this.isQuietHours();\n    if (isQuietHours) {\n      factors.push({\n        name: \"quiet_hours\",\n        weight: 0.1,\n        value: 1,\n        threshold: 0,\n        exceeded: true,\n      });\n    }\n\n    return factors;\n  }\n\n  /**\n   * Calculate overall risk score\n   */\n  private calculateScore(factors: RiskFactor[]): number {\n    let totalWeight = 0;\n    let weightedScore = 0;\n\n    for (const factor of factors) {\n      totalWeight += factor.weight;\n      const factorScore = factor.exceeded ? 100 : (factor.value / factor.threshold) * 50;\n      weightedScore += factor.weight * factorScore;\n    }\n\n    return totalWeight > 0 ? Math.round(weightedScore / totalWeight) : 0;\n  }\n\n  /**\n   * Determine risk level from score\n   */\n  private determineLevel(score: number): RiskLevel {\n    if (score < 25) return \"safe\";\n    if (score < 50) return \"moderate\";\n    if (score < 75) return \"high\";\n    return \"critical\";\n  }\n\n  private estimateCost(action: Action): number {\n    const params = action.params as Record<string, number | undefined>;\n    return params.cost || params.amount || 0;\n  }\n\n  private estimateMaxLoss(action: Action): number {\n    const params = action.params as Record<string, number | undefined>;\n    // Could lose all if trade, nothing if content\n    if (action.type.includes(\"trade\")) {\n      return params.amount || 0;\n    }\n    return 0;\n  }\n\n  private isReversible(action: Action): boolean {\n    const irreversible = [\"trade\", \"publish\", \"deploy_prod\", \"send\", \"delete\"];\n    return !irreversible.some((i) => action.type.includes(i));\n  }\n\n  private generateRollbackPlan(action: Action): string | undefined {\n    if (action.type.includes(\"deploy\")) {\n      return \"Revert to previous deployment version\";\n    }\n    if (action.type.includes(\"commit\")) {\n      return \"Git revert commit\";\n    }\n    return undefined;\n  }\n\n  private isQuietHours(): boolean {\n    const hour = new Date().getUTCHours();\n    return hour < 6 || hour > 22;\n  }\n}\n","/**\n * Boundary Checker\n *\n * Validates actions against configured boundaries.\n */\n\nimport type { Action, Boundaries, BoundaryCheckResult } from \"../core/types.js\";\n\nexport class BoundaryChecker {\n  private boundaries: Boundaries;\n  private dailySpend = 0;\n  private dailyPosts = 0;\n  private weeklyBlogs = 0;\n  private lastResetDay = new Date().getDate();\n\n  constructor(boundaries: Boundaries) {\n    this.boundaries = boundaries;\n  }\n\n  /**\n   * Check if action is within boundaries\n   */\n  check(action: Action): BoundaryCheckResult {\n    this.resetDailyCountersIfNeeded();\n\n    const violations: string[] = [];\n    const warnings: string[] = [];\n\n    // Check financial boundaries\n    this.checkFinancialBoundaries(action, violations, warnings);\n\n    // Check content boundaries\n    this.checkContentBoundaries(action, violations, warnings);\n\n    // Check development boundaries\n    this.checkDevelopmentBoundaries(action, violations, warnings);\n\n    // Check trading boundaries\n    this.checkTradingBoundaries(action, violations, warnings);\n\n    // Check time boundaries\n    this.checkTimeBoundaries(action, warnings);\n\n    return {\n      withinLimits: violations.length === 0 && warnings.length === 0,\n      needsReview: warnings.length > 0,\n      violated: violations.length > 0,\n      violations,\n      warnings,\n    };\n  }\n\n  private checkFinancialBoundaries(\n    action: Action,\n    violations: string[],\n    warnings: string[]\n  ): void {\n    const params = action.params as Record<string, number | undefined>;\n    const amount = params.amount || params.cost || 0;\n\n    if (amount > 0) {\n      // Check single expense limit\n      if (amount > this.boundaries.financial.maxQueuedExpense) {\n        violations.push(\n          \"Expense \" + amount + \" exceeds max queued limit (\" +\n          this.boundaries.financial.maxQueuedExpense + \")\"\n        );\n      } else if (amount > this.boundaries.financial.maxAutoExpense) {\n        warnings.push(\n          \"Expense \" + amount + \" exceeds auto-approve limit (\" +\n          this.boundaries.financial.maxAutoExpense + \")\"\n        );\n      }\n\n      // Check daily spend\n      if (this.dailySpend + amount > this.boundaries.financial.maxDailySpend) {\n        violations.push(\n          \"Would exceed daily spend limit (\" +\n          this.boundaries.financial.maxDailySpend + \")\"\n        );\n      }\n    }\n\n    // Check trade size\n    if (action.type.includes(\"trade\")) {\n      if (amount > this.boundaries.financial.maxTradeSize) {\n        violations.push(\n          \"Trade size \" + amount + \" exceeds limit (\" +\n          this.boundaries.financial.maxTradeSize + \")\"\n        );\n      }\n    }\n  }\n\n  private checkContentBoundaries(\n    action: Action,\n    violations: string[],\n    warnings: string[]\n  ): void {\n    const params = action.params as Record<string, string | undefined>;\n\n    // Check post limits\n    if (action.type.includes(\"tweet\") || action.type.includes(\"post\")) {\n      if (this.dailyPosts >= this.boundaries.content.maxAutoPostsPerDay) {\n        warnings.push(\n          \"Daily post limit reached (\" +\n          this.boundaries.content.maxAutoPostsPerDay + \")\"\n        );\n      }\n    }\n\n    // Check blog limits\n    if (action.type.includes(\"blog\")) {\n      if (this.weeklyBlogs >= this.boundaries.content.maxAutoBlogsPerWeek) {\n        warnings.push(\n          \"Weekly blog limit reached (\" +\n          this.boundaries.content.maxAutoBlogsPerWeek + \")\"\n        );\n      }\n    }\n\n    // Check topic restrictions\n    const topic = params.topic || params.category || \"\";\n    if (this.boundaries.content.requireReviewForTopics.some((t) =>\n      topic.toLowerCase().includes(t.toLowerCase())\n    )) {\n      warnings.push(\"Topic '\" + topic + \"' requires human review\");\n    }\n  }\n\n  private checkDevelopmentBoundaries(\n    action: Action,\n    violations: string[],\n    warnings: string[]\n  ): void {\n    const params = action.params as Record<string, number | string | string[] | undefined>;\n\n    // Check commit size\n    if (action.type.includes(\"commit\")) {\n      const lines = (params.linesChanged || 0) as number;\n      const files = (params.filesChanged || 0) as number;\n\n      if (lines > this.boundaries.development.maxAutoCommitLines) {\n        warnings.push(\n          \"Commit has \" + lines + \" lines (limit: \" +\n          this.boundaries.development.maxAutoCommitLines + \")\"\n        );\n      }\n\n      if (files > this.boundaries.development.maxAutoFilesChanged) {\n        warnings.push(\n          \"Commit changes \" + files + \" files (limit: \" +\n          this.boundaries.development.maxAutoFilesChanged + \")\"\n        );\n      }\n    }\n\n    // Check path restrictions\n    const paths = (params.paths || []) as string[];\n    for (const path of paths) {\n      if (this.boundaries.development.requireReviewForPaths.some((p) =>\n        path.includes(p)\n      )) {\n        warnings.push(\"Path '\" + path + \"' requires human review\");\n      }\n    }\n\n    // Check production deployment\n    if (action.type.includes(\"deploy_prod\")) {\n      if (!this.boundaries.development.autoDeployToProduction) {\n        violations.push(\"Production deployments require approval\");\n      }\n    }\n  }\n\n  private checkTradingBoundaries(\n    action: Action,\n    violations: string[],\n    warnings: string[]\n  ): void {\n    const params = action.params as Record<string, string | undefined>;\n\n    if (action.type.includes(\"trade\")) {\n      // Check bot allowlist\n      const bot = params.bot || \"\";\n      if (bot && !this.boundaries.trading.allowedBots.includes(bot)) {\n        violations.push(\"Bot '\" + bot + \"' not in allowed list\");\n      }\n\n      // Check token allowlist\n      const token = params.token || \"\";\n      if (token && !this.boundaries.trading.allowedTokens.includes(token)) {\n        if (this.boundaries.trading.requireApprovalForNewTokens) {\n          warnings.push(\"Token '\" + token + \"' requires approval\");\n        }\n      }\n    }\n  }\n\n  private checkTimeBoundaries(action: Action, warnings: string[]): void {\n    const hour = new Date().getUTCHours();\n    const { activeHours, quietHours } = this.boundaries.time;\n\n    // Outside active hours - queue unless urgent\n    if (hour < activeHours.start || hour > activeHours.end) {\n      warnings.push(\"Outside active hours (\" + activeHours.start + \"-\" + activeHours.end + \" UTC)\");\n    }\n\n    // During quiet hours - no notifications\n    if (hour >= quietHours.start || hour < quietHours.end) {\n      // This is informational, doesn't affect routing\n    }\n  }\n\n  /**\n   * Record that an action was executed (for daily limits)\n   */\n  recordExecution(action: Action): void {\n    const params = action.params as Record<string, number | undefined>;\n    const amount = params.amount || params.cost || 0;\n\n    this.dailySpend += amount;\n\n    if (action.type.includes(\"tweet\") || action.type.includes(\"post\")) {\n      this.dailyPosts++;\n    }\n\n    if (action.type.includes(\"blog\")) {\n      this.weeklyBlogs++;\n    }\n  }\n\n  private resetDailyCountersIfNeeded(): void {\n    const today = new Date().getDate();\n    if (today !== this.lastResetDay) {\n      this.dailySpend = 0;\n      this.dailyPosts = 0;\n      this.lastResetDay = today;\n\n      // Reset weekly on Sunday\n      if (new Date().getDay() === 0) {\n        this.weeklyBlogs = 0;\n      }\n    }\n  }\n\n  /**\n   * Update boundaries\n   */\n  updateBoundaries(newBoundaries: Boundaries): void {\n    this.boundaries = newBoundaries;\n  }\n\n  /**\n   * Get current boundaries\n   */\n  getBoundaries(): Boundaries {\n    return this.boundaries;\n  }\n}\n","/**\n * Escalation Manager\n *\n * Handles immediate notification for critical actions.\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport type { Action } from \"../core/types.js\";\nimport { Logger } from \"../utils/logger.js\";\n\ninterface EscalationEvents {\n  escalated: (action: Action) => void;\n  resolved: (actionId: string, approved: boolean) => void;\n}\n\nexport class EscalationManager extends EventEmitter<EscalationEvents> {\n  private logger: Logger;\n  private pendingEscalations: Map<string, Action> = new Map();\n\n  constructor() {\n    super();\n    this.logger = new Logger(\"Escalation\");\n  }\n\n  /**\n   * Escalate an action for immediate human review\n   */\n  async notify(action: Action): Promise<void> {\n    this.pendingEscalations.set(action.id, action);\n\n    this.logger.warn(\n      \"ESCALATION: \" + action.type + \" from \" + action.engine +\n      \" (Risk: \" + action.risk.level + \", Score: \" + action.risk.score + \")\"\n    );\n\n    // Format escalation details\n    const details = this.formatEscalationDetails(action);\n    this.logger.warn(details);\n\n    // Emit event for notification handlers\n    this.emit(\"escalated\", action);\n  }\n\n  /**\n   * Resolve an escalation\n   */\n  resolve(actionId: string, approved: boolean, feedback?: string): void {\n    const action = this.pendingEscalations.get(actionId);\n    if (!action) {\n      this.logger.warn(\"No pending escalation found for: \" + actionId);\n      return;\n    }\n\n    this.pendingEscalations.delete(actionId);\n\n    action.status = approved ? \"approved\" : \"rejected\";\n    action.approvedBy = \"human\";\n    action.approvedAt = Date.now();\n\n    if (feedback) {\n      (action as Action & { feedback?: string }).feedback = feedback;\n    }\n\n    this.logger.info(\n      \"Escalation \" + (approved ? \"APPROVED\" : \"REJECTED\") + \": \" + action.type\n    );\n\n    this.emit(\"resolved\", actionId, approved);\n  }\n\n  /**\n   * Get pending escalations\n   */\n  getPending(): Action[] {\n    return Array.from(this.pendingEscalations.values());\n  }\n\n  /**\n   * Get pending count\n   */\n  getPendingCount(): number {\n    return this.pendingEscalations.size;\n  }\n\n  /**\n   * Format escalation details for logging/notification\n   */\n  private formatEscalationDetails(action: Action): string {\n    const lines = [\n      \"----------------------------------------\",\n      \"ACTION REQUIRES IMMEDIATE REVIEW\",\n      \"----------------------------------------\",\n      \"Type: \" + action.type,\n      \"Engine: \" + action.engine,\n      \"Description: \" + action.description,\n      \"\",\n      \"Risk Assessment:\",\n      \"  Level: \" + action.risk.level.toUpperCase(),\n      \"  Score: \" + action.risk.score + \"/100\",\n      \"  Est. Cost: $\" + action.risk.estimatedCost,\n      \"  Max Loss: $\" + action.risk.maxPotentialLoss,\n      \"  Reversible: \" + (action.risk.reversible ? \"Yes\" : \"NO\"),\n      \"\",\n      \"Risk Factors:\",\n    ];\n\n    for (const factor of action.risk.factors) {\n      lines.push(\n        \"  - \" + factor.name + \": \" +\n        (factor.exceeded ? \"EXCEEDED\" : \"OK\") +\n        \" (\" + factor.value + \"/\" + factor.threshold + \")\"\n      );\n    }\n\n    if (action.risk.rollbackPlan) {\n      lines.push(\"\");\n      lines.push(\"Rollback Plan: \" + action.risk.rollbackPlan);\n    }\n\n    lines.push(\"----------------------------------------\");\n\n    return lines.join(\"\\n\");\n  }\n}\n","/**\n * Simple Logger\n */\n\nexport class Logger {\n  private prefix: string;\n\n  constructor(name: string) {\n    this.prefix = \"[\" + name + \"]\";\n  }\n\n  info(message: string): void {\n    console.log(this.prefix, message);\n  }\n\n  warn(message: string): void {\n    console.warn(this.prefix, \"WARN:\", message);\n  }\n\n  error(message: string): void {\n    console.error(this.prefix, \"ERROR:\", message);\n  }\n\n  debug(message: string): void {\n    if (process.env.DEBUG) {\n      console.log(this.prefix, \"DEBUG:\", message);\n    }\n  }\n}\n","/**\n * Auto-Executor\n *\n * Executes approved actions automatically.\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport type { Action } from \"../core/types.js\";\nimport { SafeActions, type ActionHandler } from \"./safe-actions.js\";\nimport { RollbackManager } from \"./rollback.js\";\nimport { Logger } from \"../utils/logger.js\";\n\ninterface ExecutorEvents {\n  executed: (action: Action) => void;\n  failed: (action: Action, error: Error) => void;\n  rolled_back: (action: Action) => void;\n}\n\nexport class AutoExecutor extends EventEmitter<ExecutorEvents> {\n  private safeActions: SafeActions;\n  private rollback: RollbackManager;\n  private logger: Logger;\n  private executing: Set<string> = new Set();\n\n  constructor() {\n    super();\n    this.safeActions = new SafeActions();\n    this.rollback = new RollbackManager();\n    this.logger = new Logger(\"AutoExecutor\");\n  }\n\n  /**\n   * Execute an auto-approved action\n   */\n  async execute(action: Action): Promise<boolean> {\n    if (action.route !== \"auto\" || !action.approvedBy) {\n      this.logger.error(\"Action \" + action.id + \" not approved for auto-execution\");\n      return false;\n    }\n\n    if (this.executing.has(action.id)) {\n      this.logger.warn(\"Action \" + action.id + \" already executing\");\n      return false;\n    }\n\n    this.executing.add(action.id);\n    this.logger.info(\"Executing: \" + action.type);\n\n    try {\n      // Create rollback point if reversible\n      if (action.risk.reversible) {\n        await this.rollback.createCheckpoint(action);\n      }\n\n      // Execute the action\n      const result = await this.safeActions.execute(action);\n\n      action.status = \"executed\";\n      action.executedAt = Date.now();\n      action.result = result;\n\n      this.logger.info(\"Executed successfully: \" + action.type);\n      this.emit(\"executed\", action);\n\n      // Clear checkpoint on success\n      if (action.risk.reversible) {\n        this.rollback.clearCheckpoint(action.id);\n      }\n\n      return true;\n    } catch (error) {\n      action.status = \"failed\";\n      action.error = (error as Error).message;\n\n      this.logger.error(\"Execution failed: \" + action.type + \" - \" + action.error);\n      this.emit(\"failed\", action, error as Error);\n\n      // Auto-rollback if possible\n      if (action.risk.reversible) {\n        await this.attemptRollback(action);\n      }\n\n      return false;\n    } finally {\n      this.executing.delete(action.id);\n    }\n  }\n\n  /**\n   * Attempt to rollback a failed action\n   */\n  private async attemptRollback(action: Action): Promise<void> {\n    try {\n      await this.rollback.restore(action);\n      action.status = \"rolled_back\";\n      this.logger.info(\"Rolled back: \" + action.type);\n      this.emit(\"rolled_back\", action);\n    } catch (error) {\n      this.logger.error(\"Rollback failed: \" + action.type);\n    }\n  }\n\n  /**\n   * Execute multiple actions in sequence\n   */\n  async executeBatch(actions: Action[]): Promise<{ success: Action[]; failed: Action[] }> {\n    const success: Action[] = [];\n    const failed: Action[] = [];\n\n    for (const action of actions) {\n      const result = await this.execute(action);\n      if (result) {\n        success.push(action);\n      } else {\n        failed.push(action);\n      }\n    }\n\n    return { success, failed };\n  }\n\n  /**\n   * Register custom action handler\n   */\n  registerHandler(actionType: string, handler: ActionHandler): void {\n    this.safeActions.register(actionType, handler);\n  }\n\n  /**\n   * Check if action type can be executed\n   */\n  canExecute(actionType: string): boolean {\n    return this.safeActions.hasHandler(actionType);\n  }\n\n  /**\n   * Get rollback manager\n   */\n  getRollbackManager(): RollbackManager {\n    return this.rollback;\n  }\n}\n\n// Re-exports\nexport { SafeActions, type ActionHandler } from \"./safe-actions.js\";\nexport { RollbackManager } from \"./rollback.js\";\n","/**\n * Safe Actions Registry\n *\n * Defines and executes pre-approved action types.\n */\n\nimport type { Action } from \"../core/types.js\";\nimport { Logger } from \"../utils/logger.js\";\n\nexport type ActionHandler = (action: Action) => Promise<unknown>;\n\nexport class SafeActions {\n  private handlers: Map<string, ActionHandler> = new Map();\n  private logger: Logger;\n\n  constructor() {\n    this.logger = new Logger(\"SafeActions\");\n    this.registerDefaultHandlers();\n  }\n\n  /**\n   * Register a handler for an action type\n   */\n  register(actionType: string, handler: ActionHandler): void {\n    this.handlers.set(actionType, handler);\n    this.logger.debug(\"Registered handler for: \" + actionType);\n  }\n\n  /**\n   * Execute an action using registered handler\n   */\n  async execute(action: Action): Promise<unknown> {\n    const handler = this.findHandler(action.type);\n\n    if (!handler) {\n      throw new Error(\"No handler registered for action type: \" + action.type);\n    }\n\n    this.logger.info(\"Executing: \" + action.type);\n    const result = await handler(action);\n    this.logger.info(\"Completed: \" + action.type);\n\n    return result;\n  }\n\n  /**\n   * Check if action type has a handler\n   */\n  hasHandler(actionType: string): boolean {\n    return this.findHandler(actionType) !== undefined;\n  }\n\n  /**\n   * Find handler for action type (supports wildcards)\n   */\n  private findHandler(actionType: string): ActionHandler | undefined {\n    // Exact match first\n    if (this.handlers.has(actionType)) {\n      return this.handlers.get(actionType);\n    }\n\n    // Check wildcard patterns\n    for (const [pattern, handler] of this.handlers) {\n      if (pattern.endsWith(\"*\")) {\n        const prefix = pattern.slice(0, -1);\n        if (actionType.startsWith(prefix)) {\n          return handler;\n        }\n      }\n    }\n\n    return undefined;\n  }\n\n  /**\n   * Register default safe action handlers\n   */\n  private registerDefaultHandlers(): void {\n    // Content generation (safe - just creates content)\n    this.register(\"content:generate:*\", async (action) => {\n      this.logger.info(\"Content generation: \" + JSON.stringify(action.params));\n      return { generated: true, type: action.params.type };\n    });\n\n    // Tweet posting (safe within limits)\n    this.register(\"twitter:post\", async (action) => {\n      this.logger.info(\"Twitter post: \" + action.description);\n      return { posted: true };\n    });\n\n    // Blog publishing (safe within limits)\n    this.register(\"blog:publish\", async (action) => {\n      this.logger.info(\"Blog publish: \" + action.description);\n      return { published: true };\n    });\n\n    // DCA buy (safe - scheduled recurring)\n    this.register(\"trading:dca:buy\", async (action) => {\n      const params = action.params as { amount?: number; token?: string };\n      this.logger.info(\"DCA buy: \" + params.amount + \" \" + params.token);\n      return { executed: true, amount: params.amount };\n    });\n\n    // Code commit (safe within line limits)\n    this.register(\"code:commit\", async (action) => {\n      this.logger.info(\"Code commit: \" + action.description);\n      return { committed: true };\n    });\n\n    // Discovery scan (safe - just reads)\n    this.register(\"discovery:scan\", async (action) => {\n      this.logger.info(\"Discovery scan: \" + action.params.source);\n      return { scanned: true };\n    });\n\n    // Metric collection (safe - just reads)\n    this.register(\"metrics:collect\", async (action) => {\n      this.logger.info(\"Metrics collection\");\n      return { collected: true };\n    });\n\n    // Status check (safe - just reads)\n    this.register(\"status:check\", async (action) => {\n      this.logger.info(\"Status check: \" + action.params.engine);\n      return { checked: true };\n    });\n  }\n}\n","/**\n * Rollback Manager\n *\n * Manages checkpoints and rollback for reversible actions.\n */\n\nimport type { Action } from \"../core/types.js\";\nimport { Logger } from \"../utils/logger.js\";\n\ninterface Checkpoint {\n  actionId: string;\n  createdAt: number;\n  state: unknown;\n  rollbackFn?: () => Promise<void>;\n}\n\nexport class RollbackManager {\n  private checkpoints: Map<string, Checkpoint> = new Map();\n  private logger: Logger;\n  private maxCheckpoints = 100;\n\n  constructor() {\n    this.logger = new Logger(\"Rollback\");\n  }\n\n  /**\n   * Create a checkpoint before executing an action\n   */\n  async createCheckpoint(action: Action, state?: unknown): Promise<void> {\n    const checkpoint: Checkpoint = {\n      actionId: action.id,\n      createdAt: Date.now(),\n      state,\n    };\n\n    // Generate rollback function based on action type\n    checkpoint.rollbackFn = this.generateRollbackFn(action);\n\n    this.checkpoints.set(action.id, checkpoint);\n    this.logger.debug(\"Checkpoint created for: \" + action.id);\n\n    // Cleanup old checkpoints\n    this.cleanupOldCheckpoints();\n  }\n\n  /**\n   * Restore from checkpoint (rollback)\n   */\n  async restore(action: Action): Promise<void> {\n    const checkpoint = this.checkpoints.get(action.id);\n\n    if (!checkpoint) {\n      this.logger.warn(\"No checkpoint found for: \" + action.id);\n      throw new Error(\"No checkpoint available for rollback\");\n    }\n\n    if (checkpoint.rollbackFn) {\n      this.logger.info(\"Executing rollback for: \" + action.id);\n      await checkpoint.rollbackFn();\n      this.logger.info(\"Rollback completed for: \" + action.id);\n    } else {\n      this.logger.warn(\"No rollback function for: \" + action.id);\n    }\n\n    // Remove checkpoint after use\n    this.checkpoints.delete(action.id);\n  }\n\n  /**\n   * Check if rollback is available\n   */\n  hasCheckpoint(actionId: string): boolean {\n    return this.checkpoints.has(actionId);\n  }\n\n  /**\n   * Get checkpoint state\n   */\n  getState(actionId: string): unknown | undefined {\n    return this.checkpoints.get(actionId)?.state;\n  }\n\n  /**\n   * Clear checkpoint (after successful verification)\n   */\n  clearCheckpoint(actionId: string): void {\n    this.checkpoints.delete(actionId);\n    this.logger.debug(\"Checkpoint cleared for: \" + actionId);\n  }\n\n  /**\n   * Generate rollback function based on action type\n   */\n  private generateRollbackFn(action: Action): (() => Promise<void>) | undefined {\n    const type = action.type;\n\n    if (type.includes(\"commit\")) {\n      return async () => {\n        this.logger.info(\"Would execute: git revert \" + action.params.commitHash);\n        // In real implementation: await execAsync(\"git revert --no-commit \" + action.params.commitHash);\n      };\n    }\n\n    if (type.includes(\"deploy:staging\")) {\n      return async () => {\n        this.logger.info(\"Would rollback staging deployment\");\n        // In real implementation: trigger rollback deployment\n      };\n    }\n\n    if (type.includes(\"config:update\")) {\n      return async () => {\n        this.logger.info(\"Would restore previous config\");\n        // In real implementation: restore from checkpoint state\n      };\n    }\n\n    // Default: no automatic rollback\n    return undefined;\n  }\n\n  /**\n   * Cleanup old checkpoints (keep last N)\n   */\n  private cleanupOldCheckpoints(): void {\n    if (this.checkpoints.size <= this.maxCheckpoints) {\n      return;\n    }\n\n    // Sort by creation time and remove oldest\n    const entries = Array.from(this.checkpoints.entries())\n      .sort((a, b) => a[1].createdAt - b[1].createdAt);\n\n    const toRemove = entries.slice(0, entries.length - this.maxCheckpoints);\n    for (const [id] of toRemove) {\n      this.checkpoints.delete(id);\n    }\n\n    this.logger.debug(\"Cleaned up \" + toRemove.length + \" old checkpoints\");\n  }\n}\n","/**\n * Approval Queue\n *\n * Manages pending approvals and batch review.\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport type { Action, ApprovalItem, BatchApproval, RiskLevel } from \"../core/types.js\";\nimport { Logger } from \"../utils/logger.js\";\n\ninterface QueueEvents {\n  item_added: (item: ApprovalItem) => void;\n  item_approved: (item: ApprovalItem) => void;\n  item_rejected: (item: ApprovalItem) => void;\n  batch_ready: (batch: BatchApproval) => void;\n}\n\nexport class ApprovalQueue extends EventEmitter<QueueEvents> {\n  private queue: Map<string, ApprovalItem> = new Map();\n  private logger: Logger;\n  private batchInterval: number = 4 * 60 * 60 * 1000; // 4 hours\n  private batchTimer?: NodeJS.Timeout;\n\n  constructor() {\n    super();\n    this.logger = new Logger(\"ApprovalQueue\");\n  }\n\n  /**\n   * Start batch timer\n   */\n  startBatchTimer(): void {\n    this.batchTimer = setInterval(() => {\n      const stats = this.getStats();\n      if (stats.pending > 0) {\n        const batch = this.getBatch();\n        this.emit(\"batch_ready\", batch);\n      }\n    }, this.batchInterval);\n  }\n\n  /**\n   * Stop batch timer\n   */\n  stopBatchTimer(): void {\n    if (this.batchTimer) {\n      clearInterval(this.batchTimer);\n      this.batchTimer = undefined;\n    }\n  }\n\n  /**\n   * Add action to approval queue\n   */\n  add(action: Action, reason: string): ApprovalItem {\n    const item: ApprovalItem = {\n      action,\n      reason,\n      recommendation: this.generateRecommendation(action),\n      confidence: this.calculateConfidence(action),\n      relatedActions: [],\n      urgency: this.determineUrgency(action),\n      status: \"pending\",\n    };\n\n    // Set expiry for time-sensitive items\n    if (item.urgency === \"critical\") {\n      item.expiresAt = Date.now() + 1 * 60 * 60 * 1000; // 1 hour\n    } else if (item.urgency === \"high\") {\n      item.expiresAt = Date.now() + 4 * 60 * 60 * 1000; // 4 hours\n    }\n\n    this.queue.set(action.id, item);\n    this.logger.info(\"Added to queue: \" + action.type + \" (\" + item.urgency + \")\");\n    this.emit(\"item_added\", item);\n\n    return item;\n  }\n\n  /**\n   * Approve an item\n   */\n  approve(actionId: string, feedback?: string): boolean {\n    const item = this.queue.get(actionId);\n    if (!item) return false;\n\n    item.status = \"approved\";\n    item.reviewedAt = Date.now();\n    item.reviewedBy = \"human\";\n    item.feedback = feedback;\n    item.action.status = \"approved\";\n    item.action.approvedBy = \"human\";\n    item.action.approvedAt = Date.now();\n\n    this.logger.info(\"Approved: \" + item.action.type);\n    this.emit(\"item_approved\", item);\n\n    return true;\n  }\n\n  /**\n   * Reject an item\n   */\n  reject(actionId: string, feedback?: string): boolean {\n    const item = this.queue.get(actionId);\n    if (!item) return false;\n\n    item.status = \"rejected\";\n    item.reviewedAt = Date.now();\n    item.reviewedBy = \"human\";\n    item.feedback = feedback;\n    item.action.status = \"rejected\";\n\n    this.logger.info(\"Rejected: \" + item.action.type);\n    this.emit(\"item_rejected\", item);\n\n    return true;\n  }\n\n  /**\n   * Get a specific item\n   */\n  get(actionId: string): ApprovalItem | undefined {\n    return this.queue.get(actionId);\n  }\n\n  /**\n   * Get all pending items\n   */\n  getPending(): ApprovalItem[] {\n    return Array.from(this.queue.values()).filter((i) => i.status === \"pending\");\n  }\n\n  /**\n   * Get pending items for batch review\n   */\n  getBatch(): BatchApproval {\n    const items = this.getPending();\n\n    const byEngine: Record<string, number> = {};\n    const byRisk: Record<RiskLevel, number> = { safe: 0, moderate: 0, high: 0, critical: 0 };\n    let totalCost = 0;\n\n    for (const item of items) {\n      byEngine[item.action.engine] = (byEngine[item.action.engine] || 0) + 1;\n      byRisk[item.action.risk.level]++;\n      totalCost += item.action.risk.estimatedCost;\n    }\n\n    const self = this;\n    return {\n      id: \"batch-\" + Date.now(),\n      items,\n      totalActions: items.length,\n      byEngine,\n      byRisk,\n      estimatedTotalCost: totalCost,\n      approveAll: async () => {\n        for (const item of items) {\n          self.approve(item.action.id);\n        }\n      },\n      rejectAll: async () => {\n        for (const item of items) {\n          self.reject(item.action.id);\n        }\n      },\n      approveSelected: async (ids: string[]) => {\n        for (const id of ids) {\n          self.approve(id);\n        }\n      },\n    };\n  }\n\n  /**\n   * Get queue stats\n   */\n  getStats(): {\n    pending: number;\n    approved: number;\n    rejected: number;\n    byUrgency: Record<string, number>;\n  } {\n    const items = Array.from(this.queue.values());\n    const byUrgency: Record<string, number> = {};\n\n    for (const item of items) {\n      if (item.status === \"pending\") {\n        byUrgency[item.urgency] = (byUrgency[item.urgency] || 0) + 1;\n      }\n    }\n\n    return {\n      pending: items.filter((i) => i.status === \"pending\").length,\n      approved: items.filter((i) => i.status === \"approved\").length,\n      rejected: items.filter((i) => i.status === \"rejected\").length,\n      byUrgency,\n    };\n  }\n\n  /**\n   * Clear processed items\n   */\n  clearProcessed(): void {\n    for (const [id, item] of this.queue) {\n      if (item.status !== \"pending\") {\n        this.queue.delete(id);\n      }\n    }\n  }\n\n  private generateRecommendation(action: Action): ApprovalItem[\"recommendation\"] {\n    if (action.risk.score < 30) return \"approve\";\n    if (action.risk.score > 70) return \"reject\";\n    return \"modify\";\n  }\n\n  private calculateConfidence(action: Action): number {\n    const wellKnown = [\"dca_buy\", \"blog_generate\", \"tweet_post\"];\n    if (wellKnown.some((w) => action.type.includes(w))) {\n      return 85;\n    }\n    return 60;\n  }\n\n  private determineUrgency(action: Action): ApprovalItem[\"urgency\"] {\n    if (action.risk.level === \"critical\") return \"critical\";\n    if (action.type.includes(\"trade\") || action.type.includes(\"alert\")) return \"high\";\n    if (action.type.includes(\"deploy\")) return \"medium\";\n    return \"low\";\n  }\n}\n","/**\n * Notification System\n *\n * Alerts human for escalations and batch reviews.\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport type { Action, BatchApproval } from \"../core/types.js\";\nimport { Logger } from \"../utils/logger.js\";\n\nexport interface NotificationConfig {\n  telegram?: {\n    botToken: string;\n    chatId: string;\n  };\n  discord?: {\n    webhookUrl: string;\n  };\n  email?: {\n    to: string;\n  };\n}\n\ninterface NotificationEvents {\n  sent: (channel: string, type: string) => void;\n  failed: (channel: string, error: Error) => void;\n}\n\nexport class NotificationManager extends EventEmitter<NotificationEvents> {\n  private config: NotificationConfig;\n  private logger: Logger;\n\n  constructor(config: NotificationConfig = {}) {\n    super();\n    this.config = config;\n    this.logger = new Logger(\"Notifications\");\n  }\n\n  /**\n   * Update configuration\n   */\n  setConfig(config: NotificationConfig): void {\n    this.config = config;\n  }\n\n  /**\n   * Send escalation alert (immediate)\n   */\n  async escalate(action: Action): Promise<void> {\n    const message = this.formatEscalation(action);\n    await this.sendAll(message, \"ESCALATION\");\n    this.logger.warn(\"Escalation sent: \" + action.type);\n  }\n\n  /**\n   * Send batch review notification\n   */\n  async notifyBatchReady(batch: BatchApproval): Promise<void> {\n    const message = this.formatBatch(batch);\n    await this.sendAll(message, \"BATCH REVIEW\");\n    this.logger.info(\"Batch notification sent: \" + batch.totalActions + \" items\");\n  }\n\n  /**\n   * Send daily summary\n   */\n  async sendDailySummary(summary: {\n    autoExecuted: number;\n    queued: number;\n    escalated: number;\n    costIncurred: number;\n    revenueGenerated: number;\n  }): Promise<void> {\n    const message = [\n      \"Daily Autonomy Summary\",\n      \"\",\n      \"Auto-executed: \" + summary.autoExecuted + \" actions\",\n      \"Queued for review: \" + summary.queued,\n      \"Escalated: \" + summary.escalated,\n      \"\",\n      \"Cost: $\" + summary.costIncurred.toFixed(2),\n      \"Revenue: $\" + summary.revenueGenerated.toFixed(2),\n    ].join(\"\\n\");\n\n    await this.sendAll(message, \"DAILY SUMMARY\");\n  }\n\n  /**\n   * Format escalation message\n   */\n  private formatEscalation(action: Action): string {\n    const lines = [\n      \"Action Requires Immediate Review\",\n      \"\",\n      \"Type: \" + action.type,\n      \"Engine: \" + action.engine,\n      \"Risk Level: \" + action.risk.level.toUpperCase(),\n      \"Risk Score: \" + action.risk.score + \"/100\",\n      \"\",\n      \"Est. Cost: $\" + action.risk.estimatedCost,\n      \"Reversible: \" + (action.risk.reversible ? \"Yes\" : \"NO\"),\n      \"\",\n      \"Description:\",\n      action.description,\n      \"\",\n      \"Risk Factors:\",\n    ];\n\n    for (const factor of action.risk.factors) {\n      lines.push(\"  - \" + factor.name + \": \" + (factor.exceeded ? \"EXCEEDED\" : \"OK\"));\n    }\n\n    lines.push(\"\");\n    lines.push(\"Reply with APPROVE or REJECT\");\n\n    return lines.join(\"\\n\");\n  }\n\n  /**\n   * Format batch message\n   */\n  private formatBatch(batch: BatchApproval): string {\n    const lines = [\n      batch.totalActions + \" Actions Pending Review\",\n      \"\",\n      \"By Engine:\",\n    ];\n\n    for (const [engine, count] of Object.entries(batch.byEngine)) {\n      lines.push(\"  \" + engine + \": \" + count);\n    }\n\n    lines.push(\"\");\n    lines.push(\"By Risk:\");\n\n    for (const [risk, count] of Object.entries(batch.byRisk)) {\n      if (count > 0) {\n        lines.push(\"  \" + risk + \": \" + count);\n      }\n    }\n\n    lines.push(\"\");\n    lines.push(\"Total Est. Cost: $\" + batch.estimatedTotalCost.toFixed(2));\n    lines.push(\"\");\n    lines.push(\"Review at: [Dashboard]\");\n\n    return lines.join(\"\\n\");\n  }\n\n  /**\n   * Send to all configured channels\n   */\n  private async sendAll(message: string, title: string): Promise<void> {\n    const promises: Promise<void>[] = [];\n\n    if (this.config.telegram) {\n      promises.push(this.sendTelegram(message, title));\n    }\n    if (this.config.discord) {\n      promises.push(this.sendDiscord(message, title));\n    }\n\n    // Log if no channels configured\n    if (promises.length === 0) {\n      this.logger.info(\"[\" + title + \"] \" + message.split(\"\\n\")[0]);\n    }\n\n    await Promise.allSettled(promises);\n  }\n\n  /**\n   * Send via Telegram\n   */\n  private async sendTelegram(message: string, title: string): Promise<void> {\n    if (!this.config.telegram) return;\n\n    const { botToken, chatId } = this.config.telegram;\n    const url = \"https://api.telegram.org/bot\" + botToken + \"/sendMessage\";\n\n    try {\n      const response = await fetch(url, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          chat_id: chatId,\n          text: title + \"\\n\\n\" + message,\n          parse_mode: \"Markdown\",\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Telegram API error: \" + response.status);\n      }\n\n      this.emit(\"sent\", \"telegram\", title);\n    } catch (error) {\n      this.logger.error(\"Telegram send failed: \" + (error as Error).message);\n      this.emit(\"failed\", \"telegram\", error as Error);\n    }\n  }\n\n  /**\n   * Send via Discord webhook\n   */\n  private async sendDiscord(message: string, title: string): Promise<void> {\n    if (!this.config.discord) return;\n\n    try {\n      const response = await fetch(this.config.discord.webhookUrl, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          embeds: [\n            {\n              title,\n              description: message,\n              color: title.includes(\"ESCALATION\") ? 0xff0000 : 0x00ff00,\n            },\n          ],\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Discord webhook error: \" + response.status);\n      }\n\n      this.emit(\"sent\", \"discord\", title);\n    } catch (error) {\n      this.logger.error(\"Discord send failed: \" + (error as Error).message);\n      this.emit(\"failed\", \"discord\", error as Error);\n    }\n  }\n}\n","/**\n * Audit Trail\n *\n * Logs all autonomous actions for review and learning.\n */\n\nimport type { Action, AuditEntry, DecisionRoute } from \"../core/types.js\";\nimport { Logger } from \"../utils/logger.js\";\n\nexport class AuditLogger {\n  private entries: AuditEntry[] = [];\n  private logger: Logger;\n  private maxEntries = 10000;\n\n  constructor() {\n    this.logger = new Logger(\"Audit\");\n  }\n\n  /**\n   * Log an action\n   */\n  log(\n    action: Action,\n    outcome: \"success\" | \"failed\" | \"rolled_back\",\n    costIncurred = 0,\n    revenueGenerated = 0\n  ): AuditEntry {\n    const entry: AuditEntry = {\n      id: \"audit-\" + Date.now() + \"-\" + Math.random().toString(36).slice(2, 8),\n      timestamp: Date.now(),\n      actionId: action.id,\n      actionType: action.type,\n      engine: action.engine,\n      route: action.route,\n      approvedBy: action.approvedBy || \"auto\",\n      status: outcome,\n      result: action.result,\n      error: action.error,\n      costIncurred,\n      revenueGenerated,\n    };\n\n    this.entries.push(entry);\n\n    // Cleanup old entries\n    if (this.entries.length > this.maxEntries) {\n      this.entries = this.entries.slice(-this.maxEntries);\n    }\n\n    this.logger.debug(\"Logged: \" + action.type + \" -> \" + outcome);\n\n    return entry;\n  }\n\n  /**\n   * Add human feedback to an entry\n   */\n  addFeedback(entryId: string, wasGoodDecision: boolean, notes?: string): void {\n    const entry = this.entries.find((e) => e.id === entryId);\n    if (entry) {\n      entry.wasGoodDecision = wasGoodDecision;\n      entry.notes = notes;\n    }\n  }\n\n  /**\n   * Get entries for time range\n   */\n  getEntries(options: {\n    since?: number;\n    until?: number;\n    engine?: string;\n    route?: DecisionRoute;\n    status?: AuditEntry[\"status\"];\n    limit?: number;\n  } = {}): AuditEntry[] {\n    let filtered = this.entries;\n\n    if (options.since) {\n      filtered = filtered.filter((e) => e.timestamp >= options.since!);\n    }\n    if (options.until) {\n      filtered = filtered.filter((e) => e.timestamp <= options.until!);\n    }\n    if (options.engine) {\n      filtered = filtered.filter((e) => e.engine === options.engine);\n    }\n    if (options.route) {\n      filtered = filtered.filter((e) => e.route === options.route);\n    }\n    if (options.status) {\n      filtered = filtered.filter((e) => e.status === options.status);\n    }\n\n    // Sort by timestamp descending\n    filtered.sort((a, b) => b.timestamp - a.timestamp);\n\n    if (options.limit) {\n      filtered = filtered.slice(0, options.limit);\n    }\n\n    return filtered;\n  }\n\n  /**\n   * Get summary statistics\n   */\n  getSummary(since?: number): {\n    total: number;\n    byRoute: Record<DecisionRoute, number>;\n    byStatus: Record<string, number>;\n    byEngine: Record<string, number>;\n    totalCost: number;\n    totalRevenue: number;\n    successRate: number;\n  } {\n    let entries = this.entries;\n    if (since) {\n      entries = entries.filter((e) => e.timestamp >= since);\n    }\n\n    const byRoute: Record<DecisionRoute, number> = { auto: 0, queue: 0, escalate: 0 };\n    const byStatus: Record<string, number> = {};\n    const byEngine: Record<string, number> = {};\n    let totalCost = 0;\n    let totalRevenue = 0;\n    let successes = 0;\n\n    for (const entry of entries) {\n      byRoute[entry.route]++;\n      byStatus[entry.status] = (byStatus[entry.status] || 0) + 1;\n      byEngine[entry.engine] = (byEngine[entry.engine] || 0) + 1;\n      totalCost += entry.costIncurred;\n      totalRevenue += entry.revenueGenerated;\n\n      if (entry.status === \"success\") {\n        successes++;\n      }\n    }\n\n    return {\n      total: entries.length,\n      byRoute,\n      byStatus,\n      byEngine,\n      totalCost,\n      totalRevenue,\n      successRate: entries.length > 0 ? (successes / entries.length) * 100 : 0,\n    };\n  }\n\n  /**\n   * Get daily summary\n   */\n  getDailySummary(): {\n    autoExecuted: number;\n    queued: number;\n    escalated: number;\n    costIncurred: number;\n    revenueGenerated: number;\n  } {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    const since = today.getTime();\n\n    const summary = this.getSummary(since);\n\n    return {\n      autoExecuted: summary.byRoute.auto,\n      queued: summary.byRoute.queue,\n      escalated: summary.byRoute.escalate,\n      costIncurred: summary.totalCost,\n      revenueGenerated: summary.totalRevenue,\n    };\n  }\n\n  /**\n   * Export entries to JSON\n   */\n  export(): string {\n    return JSON.stringify(this.entries, null, 2);\n  }\n\n  /**\n   * Import entries from JSON\n   */\n  import(json: string): void {\n    const imported = JSON.parse(json) as AuditEntry[];\n    this.entries = [...this.entries, ...imported];\n\n    // Deduplicate by id\n    const seen = new Set<string>();\n    this.entries = this.entries.filter((e) => {\n      if (seen.has(e.id)) return false;\n      seen.add(e.id);\n      return true;\n    });\n  }\n}\n"],"mappings":"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","names":["EventEmitter","EventEmitter","EventEmitter","EventEmitter","EventEmitter","EventEmitter","EventEmitter","EventEmitter","EventEmitter","EventEmitter"]}