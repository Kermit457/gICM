{"version":3,"sources":["../src/index.ts","../src/watcher.ts","../src/debouncer.ts","../src/incremental-indexer.ts","../src/supabase-sync.ts"],"sourcesContent":["/**\n * @gicm/watcher\n * Live file watching with auto-reindex for the gICM platform\n */\n\nexport { FileWatcher } from \"./watcher.js\";\nexport { Debouncer } from \"./debouncer.js\";\nexport { IncrementalIndexer } from \"./incremental-indexer.js\";\nexport { SupabaseSync, createSyncFromEnv } from \"./supabase-sync.js\";\nexport type { SyncResult, SyncConfig } from \"./supabase-sync.js\";\nexport type {\n  WatcherConfig,\n  WatcherState,\n  WatcherEvents,\n  FileChange,\n  IndexResult,\n} from \"./types.js\";\n","/**\n * File Watcher\n * Main watcher class using chokidar for file system watching\n */\n\nimport { EventEmitter } from \"eventemitter3\";\nimport chokidar from \"chokidar\";\nimport * as fs from \"fs\";\nimport * as path from \"path\";\nimport pino from \"pino\";\nimport type {\n  WatcherConfig,\n  WatcherState,\n  WatcherEvents,\n  FileChange,\n  DEFAULT_WATCHER_CONFIG,\n} from \"./types.js\";\nimport { Debouncer } from \"./debouncer.js\";\nimport { IncrementalIndexer } from \"./incremental-indexer.js\";\n\nexport class FileWatcher extends EventEmitter<WatcherEvents> {\n  private config: WatcherConfig;\n  private watcher: chokidar.FSWatcher | null = null;\n  private debouncer: Debouncer;\n  private indexer: IncrementalIndexer;\n  private state: WatcherState;\n  private logger: pino.Logger;\n  private changesLogPath: string;\n  private pidFilePath: string;\n\n  constructor(config: Partial<WatcherConfig> = {}) {\n    super();\n    this.config = {\n      path: config.path || process.cwd(),\n      autoIndex: config.autoIndex ?? true,\n      debounceMs: config.debounceMs ?? 500,\n      ignorePatterns: config.ignorePatterns || [\n        \"**/node_modules/**\",\n        \"**/.git/**\",\n        \"**/dist/**\",\n        \"**/.next/**\",\n        \"**/coverage/**\",\n        \"**/*.log\",\n      ],\n      contextEngineUrl: config.contextEngineUrl || \"http://localhost:8000\",\n    };\n\n    this.state = {\n      status: \"idle\",\n      watchPath: this.config.path,\n      totalChanges: 0,\n      pendingIndex: 0,\n    };\n\n    this.logger = pino({\n      level: \"info\",\n      transport: {\n        target: \"pino-pretty\",\n        options: { colorize: true },\n      },\n    });\n\n    this.indexer = new IncrementalIndexer(this.config.contextEngineUrl);\n    this.debouncer = new Debouncer(this.config.debounceMs, (changes) =>\n      this.handleDebouncedChanges(changes)\n    );\n\n    // Setup paths\n    const gicmDir = path.join(this.config.path, \".gicm\");\n    this.changesLogPath = path.join(gicmDir, \"changes.log\");\n    this.pidFilePath = path.join(gicmDir, \"watch.pid\");\n  }\n\n  /**\n   * Start watching\n   */\n  async start(): Promise<void> {\n    if (this.state.status === \"watching\") {\n      this.logger.warn(\"Watcher already running\");\n      return;\n    }\n\n    // Ensure .gicm directory exists\n    const gicmDir = path.dirname(this.pidFilePath);\n    if (!fs.existsSync(gicmDir)) {\n      fs.mkdirSync(gicmDir, { recursive: true });\n    }\n\n    // Write PID file\n    fs.writeFileSync(this.pidFilePath, String(process.pid));\n\n    // Initialize watcher\n    this.watcher = chokidar.watch(this.config.path, {\n      ignored: this.config.ignorePatterns,\n      persistent: true,\n      ignoreInitial: true,\n      awaitWriteFinish: {\n        stabilityThreshold: 200,\n        pollInterval: 100,\n      },\n    });\n\n    // Set up event handlers\n    this.watcher.on(\"add\", (filePath) => this.handleChange(\"add\", filePath));\n    this.watcher.on(\"change\", (filePath) => this.handleChange(\"change\", filePath));\n    this.watcher.on(\"unlink\", (filePath) => this.handleChange(\"unlink\", filePath));\n    this.watcher.on(\"error\", (error) => {\n      this.state.status = \"error\";\n      this.state.error = error.message;\n      this.emit(\"error\", error);\n    });\n\n    this.watcher.on(\"ready\", () => {\n      this.state.status = \"watching\";\n      this.state.startedAt = new Date().toISOString();\n      this.logger.info({ path: this.config.path }, \"Watcher started\");\n      this.emit(\"started\", this.state);\n    });\n  }\n\n  /**\n   * Stop watching\n   */\n  async stop(): Promise<void> {\n    if (this.watcher) {\n      await this.watcher.close();\n      this.watcher = null;\n    }\n\n    this.debouncer.cancel();\n    this.state.status = \"stopped\";\n\n    // Remove PID file\n    if (fs.existsSync(this.pidFilePath)) {\n      fs.unlinkSync(this.pidFilePath);\n    }\n\n    this.logger.info(\"Watcher stopped\");\n    this.emit(\"stopped\", this.state);\n  }\n\n  /**\n   * Get current state\n   */\n  getState(): WatcherState {\n    return {\n      ...this.state,\n      pendingIndex: this.debouncer.getPendingCount(),\n    };\n  }\n\n  /**\n   * Get recent changes\n   */\n  getRecentChanges(limit: number = 50): FileChange[] {\n    if (!fs.existsSync(this.changesLogPath)) {\n      return [];\n    }\n\n    try {\n      const content = fs.readFileSync(this.changesLogPath, \"utf-8\");\n      const lines = content.trim().split(\"\\n\").filter(Boolean);\n      return lines\n        .slice(-limit)\n        .map((line) => JSON.parse(line) as FileChange)\n        .reverse();\n    } catch {\n      return [];\n    }\n  }\n\n  /**\n   * Handle a file change\n   */\n  private handleChange(type: \"add\" | \"change\" | \"unlink\", filePath: string): void {\n    const change: FileChange = {\n      type,\n      path: filePath,\n      timestamp: new Date().toISOString(),\n    };\n\n    // Get file size for adds/changes\n    if (type !== \"unlink\" && fs.existsSync(filePath)) {\n      try {\n        const stats = fs.statSync(filePath);\n        change.size = stats.size;\n      } catch {\n        // Ignore stat errors\n      }\n    }\n\n    this.state.totalChanges++;\n    this.state.lastChangeAt = change.timestamp;\n\n    // Log change\n    this.logChange(change);\n\n    // Emit event\n    this.emit(\"change\", change);\n\n    // Add to debouncer for batched indexing\n    if (this.config.autoIndex) {\n      this.debouncer.add(change);\n    }\n  }\n\n  /**\n   * Handle debounced changes (batch)\n   */\n  private async handleDebouncedChanges(changes: FileChange[]): Promise<void> {\n    if (changes.length === 0) {\n      return;\n    }\n\n    this.state.status = \"indexing\";\n    this.logger.info({ count: changes.length }, \"Indexing changes\");\n\n    const startTime = Date.now();\n    const result = await this.indexer.indexChanges(changes);\n\n    this.state.status = \"watching\";\n\n    if (result.success) {\n      this.logger.info(\n        { files: result.filesIndexed, duration: result.duration },\n        \"Indexing complete\"\n      );\n      this.emit(\n        \"indexed\",\n        changes.map((c) => c.path),\n        result.duration\n      );\n    } else {\n      this.logger.warn({ error: result.error }, \"Indexing failed\");\n    }\n  }\n\n  /**\n   * Log change to file\n   */\n  private logChange(change: FileChange): void {\n    try {\n      const dir = path.dirname(this.changesLogPath);\n      if (!fs.existsSync(dir)) {\n        fs.mkdirSync(dir, { recursive: true });\n      }\n      fs.appendFileSync(this.changesLogPath, JSON.stringify(change) + \"\\n\");\n\n      // Rotate log if too large (> 1MB)\n      const stats = fs.statSync(this.changesLogPath);\n      if (stats.size > 1024 * 1024) {\n        this.rotateLog();\n      }\n    } catch {\n      // Ignore log errors\n    }\n  }\n\n  /**\n   * Rotate log file\n   */\n  private rotateLog(): void {\n    const backupPath = this.changesLogPath + \".old\";\n    if (fs.existsSync(backupPath)) {\n      fs.unlinkSync(backupPath);\n    }\n    fs.renameSync(this.changesLogPath, backupPath);\n  }\n\n  /**\n   * Check if watcher process is already running\n   */\n  static isRunning(watchPath: string = process.cwd()): { running: boolean; pid?: number } {\n    const pidFile = path.join(watchPath, \".gicm\", \"watch.pid\");\n    if (!fs.existsSync(pidFile)) {\n      return { running: false };\n    }\n\n    try {\n      const pid = parseInt(fs.readFileSync(pidFile, \"utf-8\").trim(), 10);\n      // Check if process is still running\n      process.kill(pid, 0);\n      return { running: true, pid };\n    } catch {\n      // Process not running, clean up stale PID file\n      fs.unlinkSync(pidFile);\n      return { running: false };\n    }\n  }\n}\n","/**\n * Debouncer\n * Debounce rapid file changes to avoid excessive re-indexing\n */\n\nimport type { FileChange } from \"./types.js\";\n\nexport class Debouncer {\n  private pending: Map<string, FileChange> = new Map();\n  private timer: NodeJS.Timeout | null = null;\n  private debounceMs: number;\n  private callback: (changes: FileChange[]) => void;\n\n  constructor(debounceMs: number, callback: (changes: FileChange[]) => void) {\n    this.debounceMs = debounceMs;\n    this.callback = callback;\n  }\n\n  /**\n   * Add a change to be debounced\n   */\n  add(change: FileChange): void {\n    // Use path as key - latest change wins\n    this.pending.set(change.path, change);\n\n    // Reset timer\n    if (this.timer) {\n      clearTimeout(this.timer);\n    }\n\n    this.timer = setTimeout(() => {\n      this.flush();\n    }, this.debounceMs);\n  }\n\n  /**\n   * Flush all pending changes\n   */\n  flush(): void {\n    if (this.pending.size === 0) {\n      return;\n    }\n\n    const changes = Array.from(this.pending.values());\n    this.pending.clear();\n\n    if (this.timer) {\n      clearTimeout(this.timer);\n      this.timer = null;\n    }\n\n    this.callback(changes);\n  }\n\n  /**\n   * Get count of pending changes\n   */\n  getPendingCount(): number {\n    return this.pending.size;\n  }\n\n  /**\n   * Cancel all pending changes\n   */\n  cancel(): void {\n    this.pending.clear();\n    if (this.timer) {\n      clearTimeout(this.timer);\n      this.timer = null;\n    }\n  }\n}\n","/**\n * Incremental Indexer\n * Handles partial re-indexing of changed files\n */\n\nimport axios from \"axios\";\nimport * as fs from \"fs\";\nimport * as path from \"path\";\nimport type { FileChange, IndexResult } from \"./types.js\";\n\nexport class IncrementalIndexer {\n  private contextEngineUrl: string;\n\n  constructor(contextEngineUrl: string) {\n    this.contextEngineUrl = contextEngineUrl;\n  }\n\n  /**\n   * Index a set of changed files\n   */\n  async indexChanges(changes: FileChange[]): Promise<IndexResult> {\n    const startTime = Date.now();\n    const filesToIndex: string[] = [];\n\n    // Filter to files that exist and need indexing\n    for (const change of changes) {\n      if (change.type === \"unlink\") {\n        // For deleted files, we'd need to remove from index\n        // This would require a different API endpoint\n        continue;\n      }\n\n      if (fs.existsSync(change.path)) {\n        filesToIndex.push(change.path);\n      }\n    }\n\n    if (filesToIndex.length === 0) {\n      return {\n        success: true,\n        filesIndexed: 0,\n        duration: Date.now() - startTime,\n      };\n    }\n\n    try {\n      // Read file contents and send to context engine\n      const files = filesToIndex.map((filePath) => ({\n        path: filePath,\n        content: fs.readFileSync(filePath, \"utf-8\"),\n        type: this.getFileType(filePath),\n      }));\n\n      const response = await axios.post(\n        `${this.contextEngineUrl}/index/incremental`,\n        { files },\n        { timeout: 30000 }\n      );\n\n      return {\n        success: response.data?.success ?? true,\n        filesIndexed: filesToIndex.length,\n        duration: Date.now() - startTime,\n      };\n    } catch (error) {\n      // If context engine is not available, log but don't fail\n      return {\n        success: false,\n        filesIndexed: 0,\n        duration: Date.now() - startTime,\n        error: error instanceof Error ? error.message : String(error),\n      };\n    }\n  }\n\n  /**\n   * Get file type from extension\n   */\n  private getFileType(filePath: string): string {\n    const ext = path.extname(filePath).toLowerCase();\n    const typeMap: Record<string, string> = {\n      \".ts\": \"typescript\",\n      \".tsx\": \"typescript\",\n      \".js\": \"javascript\",\n      \".jsx\": \"javascript\",\n      \".py\": \"python\",\n      \".rs\": \"rust\",\n      \".go\": \"go\",\n      \".md\": \"markdown\",\n      \".json\": \"json\",\n      \".yaml\": \"yaml\",\n      \".yml\": \"yaml\",\n    };\n    return typeMap[ext] || \"text\";\n  }\n\n  /**\n   * Check if context engine is available\n   */\n  async isAvailable(): Promise<boolean> {\n    try {\n      const response = await axios.get(`${this.contextEngineUrl}/health`, {\n        timeout: 2000,\n      });\n      return response.status === 200;\n    } catch {\n      return false;\n    }\n  }\n}\n","/**\n * Supabase Sync\n * Sync file changes to Supabase for cloud storage and team collaboration\n */\n\nimport type { FileChange } from \"./types.js\";\n\ninterface SupabaseConfig {\n  url: string;\n  key: string;\n  tablePrefix?: string;\n}\n\ninterface SupabaseClient {\n  from: (table: string) => SupabaseQueryBuilder;\n  channel: (name: string) => SupabaseChannel;\n}\n\ninterface SupabaseQueryBuilder {\n  select: (columns?: string) => SupabaseQueryBuilder;\n  insert: (data: unknown) => SupabaseQueryBuilder;\n  upsert: (data: unknown) => SupabaseQueryBuilder;\n  delete: () => SupabaseQueryBuilder;\n  eq: (column: string, value: unknown) => SupabaseQueryBuilder;\n  order: (column: string, options?: { ascending?: boolean }) => SupabaseQueryBuilder;\n  limit: (count: number) => SupabaseQueryBuilder;\n  then: <T>(resolve: (result: { data: T | null; error: Error | null }) => void) => Promise<void>;\n}\n\ninterface SupabaseChannel {\n  on: (event: string, config: unknown, callback: (payload: unknown) => void) => SupabaseChannel;\n  subscribe: () => void;\n  unsubscribe: () => void;\n}\n\nexport interface SyncResult {\n  success: boolean;\n  synced: number;\n  failed: number;\n  error?: string;\n}\n\nexport interface SyncConfig {\n  supabaseUrl: string;\n  supabaseKey: string;\n  tablePrefix?: string;\n  projectId: string;\n  teamId?: string;\n  enableRealtime?: boolean;\n}\n\n/**\n * Supabase sync for file changes\n *\n * Required Supabase tables (run these SQL commands in Supabase):\n *\n * ```sql\n * -- File changes table\n * CREATE TABLE gicm_file_changes (\n *   id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n *   project_id TEXT NOT NULL,\n *   team_id TEXT,\n *   type TEXT NOT NULL CHECK (type IN ('add', 'change', 'unlink')),\n *   path TEXT NOT NULL,\n *   size INTEGER,\n *   timestamp TIMESTAMPTZ NOT NULL,\n *   synced_at TIMESTAMPTZ DEFAULT NOW(),\n *   synced_by TEXT\n * );\n *\n * -- Indexes\n * CREATE INDEX idx_changes_project ON gicm_file_changes(project_id);\n * CREATE INDEX idx_changes_team ON gicm_file_changes(team_id);\n * CREATE INDEX idx_changes_timestamp ON gicm_file_changes(timestamp DESC);\n *\n * -- Enable realtime\n * ALTER PUBLICATION supabase_realtime ADD TABLE gicm_file_changes;\n * ```\n */\nexport class SupabaseSync {\n  private client: SupabaseClient | null = null;\n  private config: SyncConfig;\n  private tableName: string;\n  private channel: SupabaseChannel | null = null;\n  private changeHandlers: ((change: FileChange) => void)[] = [];\n\n  constructor(config: SyncConfig) {\n    this.config = config;\n    const prefix = config.tablePrefix || \"gicm\";\n    this.tableName = `${prefix}_file_changes`;\n  }\n\n  /**\n   * Lazy initialize Supabase client\n   */\n  private async getClient(): Promise<SupabaseClient> {\n    if (this.client) return this.client;\n\n    try {\n      const { createClient } = await import(\"@supabase/supabase-js\");\n      this.client = createClient(\n        this.config.supabaseUrl,\n        this.config.supabaseKey\n      ) as unknown as SupabaseClient;\n      return this.client;\n    } catch {\n      throw new Error(\n        \"Supabase client not available. Install @supabase/supabase-js: pnpm add @supabase/supabase-js\"\n      );\n    }\n  }\n\n  /**\n   * Sync file changes to Supabase\n   */\n  async syncChanges(changes: FileChange[]): Promise<SyncResult> {\n    if (changes.length === 0) {\n      return { success: true, synced: 0, failed: 0 };\n    }\n\n    try {\n      const client = await this.getClient();\n\n      const rows = changes.map((change) => ({\n        project_id: this.config.projectId,\n        team_id: this.config.teamId,\n        type: change.type,\n        path: change.path,\n        size: change.size,\n        timestamp: change.timestamp,\n        synced_by: process.env.USER || process.env.USERNAME || \"unknown\",\n      }));\n\n      const { error } = await client.from(this.tableName).insert(rows) as {\n        data: unknown;\n        error: Error | null;\n      };\n\n      if (error) {\n        return {\n          success: false,\n          synced: 0,\n          failed: changes.length,\n          error: error.message,\n        };\n      }\n\n      return {\n        success: true,\n        synced: changes.length,\n        failed: 0,\n      };\n    } catch (error) {\n      return {\n        success: false,\n        synced: 0,\n        failed: changes.length,\n        error: error instanceof Error ? error.message : \"Unknown error\",\n      };\n    }\n  }\n\n  /**\n   * Get recent changes from Supabase (for team sync)\n   */\n  async getRemoteChanges(\n    since?: Date,\n    limit: number = 100\n  ): Promise<FileChange[]> {\n    try {\n      const client = await this.getClient();\n\n      let query = client\n        .from(this.tableName)\n        .select(\"*\")\n        .eq(\"project_id\", this.config.projectId);\n\n      if (this.config.teamId) {\n        query = query.eq(\"team_id\", this.config.teamId);\n      }\n\n      query = query\n        .order(\"timestamp\", { ascending: false })\n        .limit(limit);\n\n      const { data, error } = await query as {\n        data: Record<string, unknown>[] | null;\n        error: Error | null;\n      };\n\n      if (error || !data) {\n        return [];\n      }\n\n      return data.map((row) => ({\n        type: row.type as FileChange[\"type\"],\n        path: row.path as string,\n        size: row.size as number | undefined,\n        timestamp: row.timestamp as string,\n      }));\n    } catch {\n      return [];\n    }\n  }\n\n  /**\n   * Subscribe to realtime changes (for team collaboration)\n   */\n  async subscribeToChanges(\n    handler: (change: FileChange) => void\n  ): Promise<void> {\n    if (!this.config.enableRealtime) {\n      return;\n    }\n\n    try {\n      const client = await this.getClient();\n      this.changeHandlers.push(handler);\n\n      if (!this.channel) {\n        this.channel = client.channel(`${this.tableName}:${this.config.projectId}`);\n\n        this.channel.on(\n          \"postgres_changes\",\n          {\n            event: \"INSERT\",\n            schema: \"public\",\n            table: this.tableName,\n            filter: `project_id=eq.${this.config.projectId}`,\n          },\n          (payload: unknown) => {\n            const row = (payload as { new: Record<string, unknown> }).new;\n            const change: FileChange = {\n              type: row.type as FileChange[\"type\"],\n              path: row.path as string,\n              size: row.size as number | undefined,\n              timestamp: row.timestamp as string,\n            };\n\n            // Notify all handlers\n            for (const h of this.changeHandlers) {\n              h(change);\n            }\n          }\n        );\n\n        this.channel.subscribe();\n      }\n    } catch {\n      // Realtime not available\n    }\n  }\n\n  /**\n   * Unsubscribe from realtime changes\n   */\n  unsubscribe(): void {\n    if (this.channel) {\n      this.channel.unsubscribe();\n      this.channel = null;\n    }\n    this.changeHandlers = [];\n  }\n\n  /**\n   * Check if Supabase is configured and available\n   */\n  async isAvailable(): Promise<boolean> {\n    try {\n      await this.getClient();\n      return true;\n    } catch {\n      return false;\n    }\n  }\n}\n\n/**\n * Create SupabaseSync from environment variables\n */\nexport function createSyncFromEnv(): SupabaseSync | null {\n  const url = process.env.SUPABASE_URL;\n  const key = process.env.SUPABASE_ANON_KEY || process.env.SUPABASE_SERVICE_KEY;\n  const projectId = process.env.GICM_PROJECT_ID;\n\n  if (!url || !key || !projectId) {\n    return null;\n  }\n\n  return new SupabaseSync({\n    supabaseUrl: url,\n    supabaseKey: key,\n    projectId,\n    teamId: process.env.GICM_TEAM_ID,\n    tablePrefix: process.env.GICM_TABLE_PREFIX || \"gicm\",\n    enableRealtime: process.env.GICM_REALTIME === \"true\",\n  });\n}\n"],"mappings":"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","names":["fs","path","axios","pino","chokidar"]}